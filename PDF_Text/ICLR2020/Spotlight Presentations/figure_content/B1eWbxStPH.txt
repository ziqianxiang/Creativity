Figure 1: Aggregationscheme for messageembeddings.
Figure 2: 2D spheri-cal Fourier-Bessel basisaSBF,ln (d, α).
Figure 3: Radial Bessel ba-with n ∈ [1 . . NRBF]. Both of these bases are purely real-valued and sis for NRBF = 5.
Figure 4: The DimeNet architecture. denotes the layer’s input and k denotes concatenation. Thedistances dji are represented using spherical Bessel functions and the distances dkj and angles α(kj,ji)are jointly represented using a 2D spherical Fourier-Bessel basis. An embedding block generatesthe inital message embeddings mji . These embeddings are updated in multiple interaction blocksvia directional message passing, which uses the neighboring messages mkj , k ∈ Nj \ {i}, the2D representations a(SkBjF,ji), and the distance representations e(RjBiF) . Each block passes the resulting(ji)embeddings to an output block, which transforms them using the radial basis eRBF and sums them upper atom. Finally, the outputs of all layers are summed up to generate the prediction.
Figure 5: Examples of DimeNet filters. Theyexhibit a clear 2D structure. For details seeAppendix D.
Figure 6: A standard non-directional GNN cannot distinguish between a hexagonal (left) and twotriangular molecules (right) with the same bond lengths, since the neighborhood of each atom isexactly the same. An example of this would be Cyclohexane and two Cyclopropane moleculeswith slightly stretched bonds, when the GNN either uses the molecular graph or a cutoff distanceof C ≤ 2.5 A. Directional message passing solves this problem by considering the direction of eachbond.
