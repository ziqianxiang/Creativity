Figure 1: Applicability of CRN in cancer treatment planning. We illustrate 3 patients with differentcovariate and treatment histories Ht. For a current time t, CRN can predict counterfactual trajectories(the coloured dashed branches) for planned treatments in the future. Through the counterfactualpredictions, we can decide which treatment plan results in the best patient outcome (in this case, thelowest tumour volume). This way, CRN can be used to perform all of the following: choose optimaltreatments (a), find timing when treatment is most effective (b) decide when to stop treatment (c).
Figure 2: CRN architecture. Encoder builds representation Φ(Ht) that maximizes loss of treatmentclassifier Ga and minimizes loss of outcome predictor Gy. Φ(Ht) is used to initialize the decoder,which continues to update it to predict counterfactual outcomes of a sequence of future treatments.
Figure 3: Training procedure for build-ing balancing representation.
Figure 4:	Results for prediction of patient counterfactuals.
Figure 5:	TSNE embedding of the balancing representation Φ(HHt) learnt by the CRN encoder atdifferent timesteps t. Notice that Φ(Ht) is not predictive of the treatment At given at timestep t.
Figure 6:	Causal graphs for 2-step time-varying exposures (Robins et al., 2000). Xo, Xi are patientcovariates, Ao, Ai are treatments, Uo, Ui are unobserved variable and Y2 is the outcome.
Figure 7: Results for prediction of patient counterfactuals for multiple steps ahead.
