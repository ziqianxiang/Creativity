Published as a conference paper at ICLR 2020
Smoothness and Stability in GANs
Casey Chu
Stanford University
caseychu@stanford.edu
Kentaro Minami
Preferred Networks, Inc.
minami@preferred.jp
Kenji Fukumizu
The Institute of Statistical Mathematics / Preferred Networks, Inc.
fukumizu@ism.ac.jp
Ab stract
Generative adversarial networks, or GANs, commonly display unstable behavior
during training. In this work, we develop a principled theoretical framework for
understanding the stability of various types of GANs. In particular, we derive
conditions that guarantee eventual stationarity of the generator when it is trained
with gradient descent, conditions that must be satisfied by the divergence that is
minimized by the GAN and the generator’s architecture. We find that existing
GAN variants satisfy some, but not all, of these conditions. Using tools from
convex analysis, optimal transport, and reproducing kernels, we construct a GAN
that fulfills these conditions simultaneously. In the process, we explain and clarify
the need for various existing GAN stabilization techniques, including Lipschitz
constraints, gradient penalties, and smooth activation functions.
1 Introduction: taming instability with smoothness
Generative adversarial networks (Goodfellow et al., 2014), or GANs, are a powerful class of gen-
erative models defined through minimax game. GANs and their variants have shown impressive
performance in synthesizing various types of datasets, especially natural images. Despite these suc-
cesses, the training of GANs remains quite unstable in nature, and this instability remains difficult
to understand theoretically.
Since the introduction of GANs, there have been many techniques proposed to stabilize GANs
training, including studies of new generator/discriminator architectures, loss functions, and regular-
ization techniques. Notably, Arjovsky et al. (2017) proposed Wasserstein GAN (WGAN), which
in principle avoids instability caused by mismatched generator and data distribution supports. In
practice, this is enforced by Lipschitz constraints, which in turn motivated developments like gradi-
ent penalties (Gulrajani et al., 2017) and spectral normalization (Miyato et al., 2018). Indeed, these
stabilization techniques have proven essential to achieving the latest state-of-the-art results (Karras
et al., 2018; Brock et al., 2019).
On the other hand, a solid theoretical understanding of training stability has not been established.
Several empirical observations point to an incomplete understanding. For example, why does apply-
ing a gradient penalty together spectral norm seem to improve performance (Miyato et al., 2018),
even though in principle they serve the same purpose? Why does applying only spectral normal-
ization with the Wasserstein loss fail (Miyato, 2018), even though the analysis of Arjovsky et al.
(2017) suggests it should be sufficient? Why is applying gradient penalties effective, even outside
their original context of the Wasserstein GAN (Fedus et al., 2018)?
In this work, we develop a framework to analyze the stability of GAN training that resolves these
apparent contradictions and clarifies the roles of these regularization techniques. Our approach con-
siders the smoothness of the loss function used. In optimization, smoothness is a well-known con-
dition that ensures that gradient descent and its variants become stable (see e.g., Bertsekas (1999)).
For example, the following well-known proposition is the starting point of our stability analysis:
Proposition 1 (Bertsekas (1999), Proposition 1.2.3). Suppose f : Rp → R is L-smooth and
bounded below. Let xk+ι := Xk 一 L▽/(Xk). Then "▽/(Xk)|| → 0 as k → ∞.
1
Published as a conference paper at ICLR 2020
This proposition says that under a smoothness condition on the function, gradient descent with a
constant step size L approaches stationarity (i.e., the gradient norm approaches zero). This is a
rather weak notion of convergence, as it does not guarantee that the iterates converge to a point, and
even if the iterates do converge, the limit is a stationary point and not necessarily an minimizer.
Nevertheless, empirically, not even this stationarity is satisfied by GANs, which are known to fre-
quently destabilize and diverge during training. To diagnose this instability, we consider the smooth-
ness of the GAN’s loss function. GANs are typically framed as minimax problems of the form
inf sup J(μθM,	(1)
θ φ
where J is a loss function that takes a generator distribution μθ and discriminator 夕，and θ ∈ Rp
denotes the parameters of the generator. Unfortunately, the minimax nature of this problem makes
stability and convergence difficult to analyze. To make the analysis more tractable, we define J(μ) =
SuPW J(μ,夕)，so that (1) becomes simply
infJ(μθ).	(2)
θ
This choice corresponds to the common assumption that the discriminator is allowed to reach opti-
mality at every training step. Now, the GAN algorithm can be regarded as simply gradient descent
on the Rp → R function θ 7→ J(μθ), which may be analyzed using Proposition 1. In particular,
if this function θ 7→ J(μθ) satisfies the smoothness assumption, then the GAN training should be
stable in that it should approach stationarity under the assumption ofan optimal discriminator.
In the remainder of this paper, we investigate whether the smoothness assumption is satisfied for
various GAN losses. Our analysis answers two questions:
Q1. Which existing GAN losses, if any, satisfy the smoothness condition in Proposition 1?
Q2. Are there choices of loss, regularization, or architecture that enforce smoothness in GANs?
As results of our analysis, our contributions are as follows:
1.	We derive sufficient conditions for the GAN algorithm to be stationary under certain as-
sumptions (Theorem 1). Our conditions relate to the smoothness of GAN loss used as well
as the parameterization of the generator.
2.	We show that most common GAN losses do not satisfy the all of the smoothness conditions,
thereby corroborating their empirical instability.
3.	We develop regularization techniques that enforce the smoothness conditions. These reg-
ularizers recover common GAN stabilization techniques such as gradient penalties and
spectral normalization, thereby placing their use on a firmer theoretical foundation.
4.	Our analysis provides several practical insights, suggesting for example the use of smooth
activation functions, simultaneous spectral normalization and gradient penalties, and a par-
ticular learning rate for the generator.
1.1	Related work
Divergence minimization Our analysis regards the GAN algorithm as minimizing a divergence
between the current generator distribution and the desired data distribution, under the assumption of
an optimal discriminator at every training step. This perspective originates from the earliest GAN
paper, in which Goodfellow et al. (2014) show that the original minimax GAN implicitly mini-
mizes the Jensen-Shannon divergence. Since then, the community has introduced a large number
of GAN or GAN-like variants that learn generative models by implicitly minimizing various di-
vergences, including f -divergences (Nowozin et al., 2016), Wasserstein distance (Arjovsky et al.,
2017), and maximum-mean discrepancy (Li et al., 2015; Unterthiner et al., 2018). Meanwhile, the
non-saturating GAN (Goodfellow et al., 2014) has been shown to minimize a certain Kullback-
Leibler divergence (Arjovsky & Bottou, 2017). Several more theoretical works consider the topo-
logical, geometric, and convexity properties of divergence minimization (Arjovsky & Bottou, 2017;
Liu et al., 2017; Bottou et al., 2018; Farnia & Tse, 2018; Chu et al., 2019), perspectives that we draw
heavily upon. Sanjabi et al. (2018) also prove smoothness of GAN losses in the specific case of the
regularized optimal transport loss. Their assumption for smoothness is entangled in that it involves a
composite condition on generators and discriminators, while our analysis addresses them separately.
2
Published as a conference paper at ICLR 2020
Table 1: Common GANs, their corresponding loss functions, and their optimal discriminators.
	Loss function J(μ)	Optimal discriminator Φμ(x)
Minimax GAN	DJS (μ || μo)	2 log μ(xμ+μθ(x)
Non-saturating GAN	Dkl(1 μ + 1 μo Il μo)	-1 log —μ0(X)— 2 μ μ(x)+μo(x)
Wasserstein GAN	W1(μ,μ0)	argmaχf∈Lip1 Ey~μ[f(y)] - Ey~μ0 [f(y)]
GMMN, Coulomb GAN	1 MMD2(μ, μo)	Ey~μ [K(x, y)] - Ey 〜μ0 [K(x, y)]
IPM-GAN	IPMF (μ,μo)	argmaxf∈fEy~“[f(y)] - Ey~“°[f(y)]
Other approaches Even though many analyses, including ours, operate under the assumption of
an optimal discriminator, this assumption is unrealistic in practice. Li et al. (2017b) contrast this
optimal discriminator dynamics with first-order dynamics, which assumes that the generator and
discriminator use alternating gradient updates and is what is used computationally. As this is a
differing approach from ours, we only briefly mention some results in this area, which typically
rely on game-theoretic notions (Kodali et al., 2017; Grnarova et al., 2018; Oliehoek et al., 2018) or
local analysis (Nagarajan & Kolter, 2017; Mescheder et al., 2018). Some of these results rely on
continuous dynamics approximations of gradient updates; in contrast, our work focuses on discrete
dynamics.
1.2	Notation
Let R := R ∪ {∞, -∞}. We let P(X) denote the set of all probability measures on a compact
set X ⊆ Rd. We let M(X) and C(X) denote the dual pair consisting of the set of all finite signed
measures on X and the set of all continuous functions X → R. For any statement A, we let χ{A} be
0 if A is true and ∞ if A is false. For a Euclidean vector x, its Euclidean norm is denoted by kxk2,
and the operator norm of a matrix A is denoted by kAk2, i.e., kAk2 = supkxk2≤1 kAxk2/kxk2. A
function f : X → Y between two metric spaces is α-Lipschitz ifdY (f(x1), f(x2)) ≤ αdX(x1, x2).
A function f : Rd → R is β-smooth if its gradients are β-Lipschitz, that is, for all x, y ∈ Rd,
INf(X)- Vf(y)k2 ≤ βkχ - y∣∣2.
2 Smoothness of GAN losses
This section presents Theorem 1, which provides concise criteria for the smoothness of GAN losses.
In order to keep our analysis agnostic to the particular GAN used, let J : P (X) → R bean arbitrary
convex loss function, which takes a distribution over X ⊂ Rd and outputs a real number. Note
that the typical minimax formulation of GANs can be recovered from just the loss function J using
convex duality. In particular, recall that the convex conjugate J? : C(X) → R of J satisfies the
following remarkable duality, known as the Fenchel-Moreau theorem:
J?(夕)：=	sup /	2(x)	dμ —	J(μ),	J(μ)	= sup /	2(x)	dμ —	J?(4).
μ∈M(X) J	φ∈C(X) J
Based on this duality, minimizing J can be framed as the minimax problem
inf J(μ) = inf SUp	/	ω(x)	dμ — J?(勿)：= inf Sup J(μ, ω),
μ∈P(X) U μ∈P(X) φ∈C(X)J	μ∈P(X)	φ∈C(X)
(3)
(4)
recovering the well-known adversarial formulation of GANs. We now define the notion of an opti-
mal discriminator for an arbitrary loss function J, based on this convex duality:
Definition 1 (Optimal discriminator). Let J : M(X) → R be a convex, l.s.c., proper function. An
optimal discriminator for a probability distribution μ ∈ P (X) is a continuous function Φμ : X →
R that attains the maximum ofthe second equation in (3), i.e., J(μ) = J Φμ(x) dμ — J*(Φ*).
This definition recovers the optimal discriminators of many existing GAN and GAN-like algorithms
(Farnia & Tse, 2018; Chu et al., 2019), most notably those in Table 1. Our analysis will apply to any
algorithm in this family of algorithms. See Appendix B for more details on this perspective.
3
Published as a conference paper at ICLR 2020
We also formalize the notion of a family of generators:
Definition 2 (Family of generators). A family of generators is a set of pushforward probability
measures {μθ = fg#3 : θ ∈ Rp}, where ω is a fixed probability distribution on Z (the latent
variable) and fθ : Z → X is a measurable function (the generator).
Now, in light of Proposition 1, We are interested in the smoothness of the mapping θ → J(μθ),
which would guarantee the stationarity of gradient descent on this objective, which in turn implies
stationarity of the GAN algorithm under the assumption of an optimal discriminator. The following
theorem is our central result, which decomposes the smoothness of θ → J(μθ) into conditions on
optimal discriminators and the family of generators.
Theorem 1 (Smoothness decomposition for GANs). Let J : M(X) → R be a convex function
whose optimal discriminators Φμ : X → R satisfy the following regularity conditions:
(D1) X → Φμ(x) is α-Lipschitz,
(D2) x → VχΦμ(x) is βι-Lipschitz,
(D3) μ → VχΦμ(x) is β2-Lipschitz w.r.t. the 1 -Wasserstein distance.
Also, let μθ = fg#3 be afamily ofgenerators that satisfies:
(G1) θ → fθ(Z) is A-Lipschitz in expectation for Z 〜 ω, i.e., Ez〜ω [kfθι (Z) — fθ2 (z)k2] ≤
Akθ1 - θ2k2, and
(G2) θ → Dθfθ(z) is B-Lipschitz in expectation for Z 〜ω, i.e., Ez〜ω [∣∣Dθι fθι (z) 一
Dθ2fθ2(Z)k2] ≤Bkθ1 -θ2k2.
Then θ → J(μθ) is L-smooth, with L = αB + A2(β1 + β2).
Theorem 1 connects the smoothness properties of the loss function J with the smoothness properties
of the optimal discriminator Φμ, and once paired with Proposition 1, it suggests a quantitative value
L for a stable generator learning rate. In order to obtain claims of stability for practically sized
learning rates, it is important to tightly bound the relevant constants.
In Sections 4 to 6, we carefully analyze which GAN losses satisfy (D1), (D2), and (D3), and with
what constants. We summarize our results in Table 2: it turns out that none of the listed losses,
except for one, satisfy (D1), (D2), and (D3) simultaneously with a finite constant. The MMD-based
loss satisfies the three conditions, but its constant for (D1) grows as α = O(√d), which is an
unfavorable dependence on the data dimension d that forces an unacceptably small learning rate.
See for complete details of each condition. This failure of existing GANs to satisfy the stationarity
conditions corroborates the observed instability of GANs.
Table 2: Regularity of common GAN losses.
	(D1)	(D2)	(D3)
Minimax GAN	X	X	X
Non-saturating GAN	X	X	X
Wasserstein GAN ∣	✓	X	?
IPMS	X	✓	?
MMD2	I	✓*	✓	✓
Theorem 1 decomposes smoothness into conditions on the generator and conditions on the dis-
criminator, allowing a clean separation of concerns. In this paper, we focus on the discriminator
conditions (D1), (D2), and (D3) and only provide an extremely simple example of a generator that
satisfies (G1) and (G2), in Section 7. Because analysis of the generator conditions may become quite
complicated and will vary with the choice of architecture considered (feedforward, convolutional,
ResNet, etc.), we leave a detailed analysis of the generator conditions (G1) and (G2) as a promising
avenue for future work. Indeed, such analyses may lead to new generator architectures or generator
regularization techniques that stabilize GAN training.
4
Published as a conference paper at ICLR 2020
3 Enforcing smoothness with inf-convolutions
In this section, we present a generic regularization technique that imposes the three conditions suf-
ficient for stable learning on an arbitrary loss function J, thereby stabilizing training. In Section 2,
we observe that the Wasserstein, IPM, and MMD losses respectively satisfy (D1), (D2), and (D3)
individually, but not all of of them at the same time. Using techniques from convex analysis, we
convert these three GAN losses into three regularizers that, when applied simultaneously, causes the
resulting loss to satisfy all the three conditions. Here, we only outline the technique; the specifics of
each case are deferred to Sections 4 to 6.
We start with an arbitrary base loss function J to be regularized. Next, we take an existing GAN
loss that satisfies the desired regularity condition and convert it into a regularizer function R :
M(X) → R. Then, We consider J ㊉ R, which denotes the inf-convolution defined as
∙-v	∙-v
(J ㊉ R)(ξ) = ~ inf	J(ξ) + R(ξ -ξ).	(5)
ξ∈M(X)
This new function J ㊉ R inherits the regularity of R, making it a stable candidate as a GAN loss.
Moreover, because the inf-convolution is a commutative operation, we can sequentially apply multi-
ple regularizers R1, R2, and R3 without destroying the added regularity. In particular, if we carefully
∙-v
choose functions Ri, R2, and R3, then J = J ㊉ Ri ㊉ R2㊉ R3 will satisfy (D1), (D2), and (D3)
∙-v
simultaneously. Moreover, under some technical assumptions, this composite function J inherits
the original minimizers of J, making it a sensible GAN loss:
Proposition 2 (Invariance of minimizers). Let Rι(ξ) := ∣∣ξ∣∣κR, R2(ξ) := ∣∣ξ∣∣s*, and R3(ξ):=
11lflIH be the three regularizer defined by (8), (12), and (19) respectively. Assume that J :
M(X) → R has a unique minimizer at μo with J(μo) = 0, and J(μ) ≥ c∣μ 一 μo∣H for some
∙-v
c > 0. Then the inf-convolution J = J ㊉ Ri ㊉ R2㊉ R3 has a unique minimizer at μo with
∙-v
J (μo ) = 0.
The duality formulation (4) provides a practical method for minimizing this composite function. We
leverage the duality relation (J ㊉ Ri ㊉ R2㊉ R3)? = J ? + R? + R? + R? and apply (4):
inf(J ㊉ Ri ㊉ R2 ㊉ R3)(μ)
μ
inf sup / φdμ — J?(夕)一R?(夕)
μ φ J
一 R?(0 — R?(0
inf SUP J(μ, φ) - Ri(φ) - R2 (φ) - R3(φ)∙
(6)
(7)
This minimax problem can be seen as a GAN whose discriminator objective has three added regu-
larization terms.
The concrete form of these regularizers are summarized in Table 3. Notably, we observe that we
recover standard techniques for stabilizing GANs:
•	(D1) is enforced by Lipschitz constraints (i.e., spectral normalization) on the discrimi-
nator.
•	(D2) is enforced by spectral normalization and a choice of Lipschitz, smooth activation
functions for the discriminator.
Table 3: Smoothness-inducing regularizers and their convex conjugates. To enforce a regularity
condition on a loss function J, we take a source loss that satisfies it and view it as a regularizer R.
We then consider the inf-convolution J ㊉ R, which corresponds to an added regularization term R?
on the discriminator φ. These regularization terms correspond to existing GAN techniques.
Purpose	Source loss	R(ξ)	R2(φ)	GAN techniques
(D1)	Wi	lξlKR	χ{kφkLip ≤ 1}	spectral norm
(D2)	IPMS	kξks*	χ{φ ∈ S}	smooth activations, spectral norm
(D3)	MMD2	2 kξkH	2 kφkH	gradient penalties
5
Published as a conference paper at ICLR 2020
•	(D3) is enforced by gradient penalties on the discriminator.
Our analysis therefore puts these regularization techniques on a firm theoretical foundation (Propo-
sition 1 and Theorem 1) and provides insight into their function.
4	Enforcing (D1) with Lipschitz constraints
In this section, we show that enforcing (D1) leads to techniques and notions commonly used to sta-
bilize GANs, including the Wasserstein distance, Lipschitz constraints and spectral normalization.
Recall that (D1) demands that the optimal discriminator Φμ is Lipschitz:
(D1) X → Φμ(x) is a-Lipschitzfor all μ ∈ P(X), i.e., ∣Φμ(x) 一 Φμ(y)∣ ≤ α∣∣x 一 y∣∣2.
If Φμ is differentiable, this is equivalent to that the optimal discriminator has a gradient with bounded
norm. This is a sensible criterion, since a discriminator whose gradient norm is too large may push
the generator too hard and destabilize its training.
To check (D1), the following proposition shows that it suffices to check whether | J(μ) 一 J(V)| ≤
αWι (μ, ν) for all distributions μ, ν:
Proposition 3. (D1) holds if and only ifJ is α-Lipschitz w.r.t. the Wasserstein-1 distance.
Arjovsky et al. (2017) show that this property does not hold for common divergences based on the
Kullback-Leibler or Jensen-Shannon divergence, while it does hold for the Wasserstein-I distance.
Indeed, itis this desirable property that motivates their introduction of the Wasserstein GAN. Framed
in our context, their result is summarized as follows:
Proposition 4. The minimax and non-saturating GAN losses do not satisfy (D1)for some μo.
Proposition 5. The Wasserstein GAN loss satisfies (D1) with α = 1 for any μo.
Our stability analysis therefore deepens the analysis of Arjovsky et al. (2017) and provides an alter-
native reason that the Wasserstein distance is desirable as a metric: it is part ofa sufficient condition
that ensures stationarity of gradient descent.
4.1	From Wasserstein distance to Lipschitz constraints
Having identified the Wasserstein GAN loss as one that satisfies (D1), we next follow the strategy
outlined in Section 3 to convert it into a regularizer for an arbitrary loss function. Towards this, we
define the regularizer Ri : M(X) → R and compute its convex conjugate R? : C(X) → R:
RM :=αkξkKR=° f supx) I fdξ,	R?s={∞ o⅛eLwpis≤.α	⑻
llfl∣Lip≤ι
This norm is the Kantorovich-Rubinstein norm (KR norm), which extends the Wasserstein-I
distance to M(X); it holds that kμ 一 VkKR = Wι(μ, V) for μ,ν ∈ P(X). Then, its inf-convolution
with an arbitrary function inherits the Lipschitz property held by R1:
____________________________________________________	∙-v
Proposition 6 (Pasch-Hausdorff). Let J : M(X) → R be afunction, and define J = J ㊉ Ri. Then
∙-v
J is α-Lipschitz w.r.t. the distance induced by the KR norm, and hence the Wasserstein-1 distance
when restricted to P(X).
∙-v
Due to Proposition 3, we now obtain a transformed loss function J that automatically satisfies (D1).
This function is a generalization of the Pasch-Hausdorff envelope (see Chapter 9 in Rockafeller &
Wets (1998)), also known as Lipschitz regularization or the McShane-Whitney extension (McShane,
1934; Whitney, 1934; Kirszbraun, 1934; Hiriart-Urruty, 1980).
∙-v
The convex conjugate computation in (8) shows that J can be minimized in practice by imposing
Lipschitz constraints on discriminators. Indeed, by (4),
inf (J ㊉ α∣∣∙kκR)(μ) = inf sup Ex 〜μ[2(x)] — J?(夕)一χ{∣3∣Lip ≤ α}	(9)
6
Published as a conference paper at ICLR 2020
=inf sup	J(μ, φ).	(10)
μ W： kWkLip≤α
∙-v
Farnia & Tse (2018) consider this loss J in the special case of an f -GAN with J (μ) = Df(μ, μo);
∙-v
they showed that minimizing J corresponds to training a f -GAN normally but constraining the
discriminator to be α-Lipschitz. We show that this technique is in fact generic for any J: minimizing
the transformed loss can be achieved by training the GAN as normal, but imposing a Lipschitz
constraint on the discriminator.
Our analysis therefore justifies the use of Lipschitz constraints, such as spectral normalization (Miy-
ato et al., 2018) and weight clipping (Arjovsky & Bottou, 2017), for general GAN losses. However,
Theorem 1 also suggests that applying only Lipschitz constraints may not be enough to stabilize
GANs, as (D1) alone does not ensure that the GAN objective is smooth.
5	Enforcing (D2) with discriminator smoothness
(D2) demands that the optimal discriminator Φμ is smooth:
(D2) X → VΦμ(χ) is βι-Lipschitz for all μ ∈ P(X), i.e., kVΦμ(χ) - VΦμ(y)∣∣2 ≤ βι∣∣χ - y∣∣2.
Intuitively, this says that for a fixed generator μ, the optimal discriminator Φμ should not provide
gradients that change too much spatially.
Although the Wasserstein GAN loss (D1), we see that it, along with the minimax GAN and the
non-saturating GAN, do not satisfy (D2):
Proposition 7. The Wasserstein, minimax, and non-saturating GAN losses do not satisfy (D2) for
some μo.
We now construct a loss that by definition satisfies (D2). Let S be the class of 1-smooth functions,
that is, for which kVf (x) - Vf (y)k2 ≤ kx - yk2, and consider the integral probability metric
(IPM) (Muller, 1997) w.r.t. S, defined by
IPMS(μ, ν) := sup
f∈S
J f dμ -
fdν.
(11)
The optimal discriminator for the loss IPMS (μ,μo) is the function that maximizes the supremum in
the definition. This function by definition belongs to S and therefore is 1-smooth. Hence, this IPM
loss satisfies (D2) with β1 = 1 by construction.
5.1	From integral probability metric to smooth discriminators
Having identified the IPM-based loss as one that satisfies (D2), we next follow the strategy outlined
in Section 3 to convert it into a regularizer for an arbitrary loss function. To do so, we define a
regularizer R? : M(X) → R and compute its convex conjugate R? : C(X) → R:
R2(ξ)=βιkξks* =β fus∕fdξ,	r⅜) = {∞ ：therwiSe.	(12)
f∈S
The norm is the dual norm to S, which extends the IPM to signed measures; it holds that
IPMS(μ,ν) = kμ 一 ν∣∣s* for μ,ν ∈ P(X). Similar to the situation in the previous section,
inf-convolution preserves the smoothness property of R2 :
Proposition 8. Let J : M(X) → R be a convex, proper, lower SemicontinuousfUnction, and define
∙-v	∙-v
J := J ㊉ R2. Then the optimal discriminatorfor J is βι-smooth.
Applying (4) and (12), we see that we can minimize this transformed loss function by restricting the
family of discriminators to only β1-smooth discriminators:
inf (J ㊉ βιk∙ks* )(μ) = infsupEx〜μ[2(x)] — J?(夕)一χ{夕 ∈ βιS}	(13)
μ	μ w
=inf sup J(μ,夕).	(14)
μ w∈βιS
In practice, we can enforce this by applying spectral normalization (Miyato et al., 2018) and using a
Lipschitz, smooth activation function such as ELU (Clevert et al., 2016) or sigmoid.
7
Published as a conference paper at ICLR 2020
Proposition 9. Let f : Rd → R be a neural network consisting of k layers whose linear transfor-
mations have spectral norm 1 and whose activation functions are 1-Lipschitz and 1-smooth. Then f
is k-smooth.
6	Enforcing (D3) with gradient penalties
(D3) is the following smoothness condition:
(D3) μ → VΦμ(x) is β2 -Lipschitzfor any X ∈ X, i.e., kVΦμ(x) — VΦν (x)k2 ≤ β2W1(μ,ν).
(D3) requires that the gradients of the optimal discriminator do not change too rapidly in response
to changes in μ. Indeed, if the discriminator,s gradients are too sensitive to changes in the generator,
the generator may not be able to accurately follow those gradients as it updates itself using a finite
step size. In finite-dimensional optimization ofa function f : Rd → R, this condition is analogous
to f having a Lipschitz gradient.
We now present an equivalent characterization of (D3) that is easier to check in practice. We define
the Bregman divergence of a convex function J : M(X) → R by
Dj(ν,μ):
J(ν) —
J(μ) - /
Φμ(x) d(ν - μ),
(15)
where Φμ is the optimal discriminator for J at μ. Then, (D3) is characterized in terms of the
Bregman divergence and the KR norm as follows:
Proposition 10. Let J : M(X) → R be a convex function. Then J satisfies (D3) if and only if
Dj(ν,μ) ≤ β2 ∣∣μ - VkKR forall μ,ν ∈ M(X).
It is straightforward to compute the Bregman divergence corresponding to several popular GANs:
DDjs(- || μo) (V, μ) = DKL ( 2 V + 1 μ0 Il 2μ + 1 μO) + 1 DKL(V || μ),	(16)
dDkl( 2 , + 2 μo || μo)(ν,μ) = DKL( 1 V + 2 μ0 ll 1μ + 2μO)，	(17)
D 2 MMD2(∙,μo)(V,μ) = 1 MMD2(V,μ).	(18)
The first two Bregman divergences are not bounded above by ∣∣μ 一 v∣∣Kr for reasons similar to those
discussed in Section 4, and hence:
Proposition 11. The minimax and non-saturating GAN losses do not satisfy (D3)for some μo.
Even so, the Bregman divergence for the non-saturating loss is always less than that of the minimax
GAN, suggesting that the non-saturating loss should be stable in more situations than the minimax
GAN. On the other hand, the MMD-based loss (Li et al., 2015) does satisfy (D3) when its kernel is
the Gaussian kernel K(χ,y) = e-n||x-y||2:
Proposition 12. The MMD loss with Gaussian kernel satisfies (D3) with β2 = 2π for all μo.
6.1	From maximum mean discrepancy to gradient penalties
Having identified the MMD-based loss as one that satisfies (D3), we next follow the strategy outlined
in Section 3 to convert it into a regularizer for an arbitrary loss function. To do so, we define the
regularizer R3 : M(X) → R and compute its convex conjugate R? : C(X) → R:
R3(ξ) := 4∏∏ kξ∣H,	r‰) =京 ll^kH∙	(19)
The norm is the norm of a reproducing kernel Hilbert space norm (RKHS) H with Gaussian
kernel; this norm extends the MMD to signed measures, as it holds that MMD(μ, V) = ∣∣μ 一 ^∣h
for μ, V ∈ P(X). Here, ξ = R K(x, ∙) ξ(dx) ∈ H denotes the mean embedding of a signed measure
ξ ∈ M(X); We also adopt the convention that ∣∣^∣∣h = ∞ if 夕 ∈ H. Similar to the situation in the
previous sections, inf-convolution preserves the smoothness property of R3 :
Proposition 13 (Moreau-Yosida regularization). Suppose J : M(X) → R is convex, and define
J := J ㊉ R3. Then J is convex, and D j(v, μ) ≤ 导 I∣μ - V∣∣Kr.
8
Published as a conference paper at ICLR 2020
By Proposition 10, this transformed loss function satisfies (D3), having inherited the regularity prop-
erties of the squared MMD. This transformed function is a generalization of Moreau-Yosida regu-
larization or the Moreau envelope (see Chapter 1 in Rockafeller & Wets (1998)). It is well-known
that in the case of a function f : Rn → R, this regularization results in a function with Lipschitz
gradients, so it is unsurprising that this property carries over to the infinite-dimensional case.
Applying (4) and (19), we see that the transformed loss function can be minimized as a GAN by
implementing an RKHS squared norm penalty on the discriminator:
inf (J ㊉ 4∏2 || ∙ ||H )(μ) = infsup Ex 〜“s(X)]- j*3 - β |w|H.	QO)
μ	μ φ	一
Computationally, the RKHS norm is difficult to evaluate. We propose taking advantage of the fol-
lowing infinite series representation of ||f ||2H in terms of the derivatives off (Fasshauer & Ye, 2011;
Novak et al., 2018):
Proposition 14. Let H be an RKHS with the Gaussian kernel K(x,y) = e-n||x-y||2. Then for
f∈H,
∞
IlfllH = X (4∏)-k	X	Qd--7 % …dxd f llL2(Rd)	(21)
k=0	kι++kd = k Ili=I i!
=llfllL2 (Rd) + 4∏ ||Vf llL2(Rd) + ⅛ llV2f llL2(Rd) + other terms.	(22)
In an ideal world, we would use this expression as a penalty on the discriminator to enforce (D3). Of
course, as an infinite series, this formulation is computationally impractical. However, the first two
terms are very close to common GAN techniques like gradient penalties (Gulrajani et al., 2017) and
penalizing the output of the discriminator (Karras et al., 2018). We therefore interpret these common
practices as partially applying the penalty given by the RKHS norm squared, approximately enforc-
ing (D3). We view the choice of only using the leading terms as a disadvantageous but practical
necessity.
Interestingly, according to our analysis, gradient penalties and spectral normalization are not inter-
changeable, even though both techniques were designed to constrain the Lipschitz constant of the
discriminator. Instead, our analysis suggests that they serve different purposes: gradient penalties
enforce the variational smoothness (D3), while spectral normalization enforces Lipschitz continuity
(D1). This demystifies the puzzling observation of Miyato (2018) that GANs using only spectral
normalization with a WGAN loss do not seem to train well; it also explains why using both spectral
normalization and a gradient penalty is a reasonable strategy. It also motivates the use of gradient
penalties applied to losses other than the Wasserstein loss (Fedus et al., 2018).
7 Verifying the theoretical learning rate
In this section, we empirically test the theoretical learning rate given by Theorem 1 and Proposition 1
as well as our regularization scheme (7) based on inf-convolutions. We approximately implement
our composite regularization scheme (7) on a trivial base loss of J(μ) = χ{μ = μo} by alternating
stochastic gradient steps on
inf sup Ex〜μ[2(x)] — Ex〜μo[2(x)]一
μ φ
β Ex/"2 + 4∏ "V""2],
(23)
where μ is a random interpolate between samples from μ and μo, as used in Gulrajani et al. (2017).
The regularization term is a truncation of the series for the squared RKHS norm (22) and approx-
imately enforces (D3). The discriminator is a 7-layer convolutional neural network with spectral
normalization1 and ELU activations, an architecture that enforces (D1) and (D2). We include a final
scalar multiplication by α so that by Proposition 9, β1 = 7α. We take two discriminator steps for
every generator step, to better approximate our assumption ofan optimal discriminator.
1Whereas Miyato et al. (2018) divide each layer by the spectral norm of the convolutional kernel, we divide
by the spectral norm of the convolutional operator itself, computed using the same power iteration algorithm
applied to the operator. This is so that the layers are truly 1-Lipschitz, which is critical for our theory.
9
Published as a conference paper at ICLR 2020
500
400
C 300
200
100
Figure 1: FID of simple particle generators with various learning rates. The horizontal axis shows
the ratio γ∕γo between the actual learning rate Y and the theoretical learning rate γo suggested by
Theorem 1 and Proposition 1. The vertical axis shows the FID after 100,000 SGD iterations.
10-3	100	103	106	109
Y/Y0
For the generator, we use an extremely simple particle-based generator which satisfies (G1) and
(G2), in order to minimize the number of confounding factors in our experiment. Let ω be the
discrete uniform distribution on Z = {1, . . . , N}. For an N × d matrix θ and z ∈ Z, define
fθ : Z → Rd so that fθ (Z) is the zth row of θ. The particle generator μθ = fe#3 satisfies (G1) with
A = √⅛, since
1n	1
Ez[kfθ(Z)- fθ0(z)k2] = NN Ekθz - θZk2 ≤√Nkθ -θ0kF,	(24)
and it satisfies (G2) with B = 0, since Dθfθ (Z) is constant w.r.t. θ. With this setup, Theorem 1
suggests a theoretical learning rate of
11	N
—	TT~:	—-
L αB + A2(β1 + β2)	7α + β?
(25)
We randomly generated hyperparameter settings for the Lipschitz constant α, the smoothness con-
stant β2, the number of particles N , and the learning rate γ. We trained each model for 100,000
steps on CIFAR-10 and evaluate each model using the FreChet Inception Distance (FID) of Heusel
et al. (2017). We hypothesize that stability is correlated with image quality; Figure 1 plots the FID
for each hyperparameter setting in terms of the ratio of the true learning rate γ and the theoretically
motivated learning rate γ0 . We find that the best FID scores are obtained in the region where γ∕γ0
is between 1 and 1000. For small learning rates γ∕γ0	1, we observe that the convergence is
too slow to make a reasonable progress on the objective, whereas as the learning rate gets larger
γ∕γ0	1, we observe a steady increase in FID, signalling unstable behavior. It also makes sense
that learning rates slightly above the optimal rate produce good results, since our theoretical learning
rate is a conservative lower bound. Note that our intention is to test our theory, not to generate good
images, which is difficult due to our weak choice of generator. Overall, this experiment shows that
our theory and regularization scheme are sensible.
8 Future work
Inexact gradient descent In this paper, we employed several assumptions in order to regard the
GAN algorithm as gradient descent. However, real-world GAN algorithms must be treated as “in-
exact” descent algorithms. As such, future work includes: (i) relaxing the optimal discriminator
assumption (cf. Sanjabi et al. (2018)) or providing a stability result for discrete simultaneous gradi-
ent descent (cf. continuous time analysis in Nagarajan & Kolter (2017); Mescheder et al. (2018)),
(ii) addressing stochastic approximations of gradients (i.e., SGD), and (iii) providing error bounds
for the truncated gradient penalty used in (23).
Generator architectures Another important direction of research is to seek more powerful gen-
erator architectures that satisfy our smoothness assumptions (G1) and (G2). In practice, generators
are often implemented as deep neural networks, and involve some specific architectures such as de-
convolution layers (Radford et al., 2015) and residual blocks (e.g., Gulrajani et al. (2017); Miyato
et al. (2018)). In this paper, we did not provide results on the smoothness of general classes of gen-
erators, since our focus is to analyze stability properties influenced by the choice of loss function J
(and therefore optimal discriminators). However, our conditions (G1) and (G2) shed light on how to
obtain smoothly parameterized neural networks, which is left for future work.
10
Published as a conference paper at ICLR 2020
Acknowledgments
We would like to thank Kohei Hayashi, Katsuhiko Ishiguro, Masanori Koyama, Shin-ichi Maeda,
Takeru Miyato, Masaki Watanabe, and Shoichiro Yamaguchi for helpful discussions.
References
LUigi Ambrosio, Nicola Gigli, and GiUsePPe Savare. Gradient Flows in Metric Spaces and in the
Space of Probability Measures. Birkhauser, second edition, 2008.
Michael Arbel, Dougal Sutherland, Mikolaj Binkowski, and Arthur Gretton. On gradient regular-
izers for MMD GANs. In Advances in Neural Information Processing Systems, pp. 6700-6710,
2018.
Martin Arjovsky and Leon Bottou. Towards principled methods for training generative adversarial
networks. In International Conference on Learning Representations, 2017.
Martin Arjovsky, Soumith Chintala, and Leon Bottou. Wasserstein generative adversarial networks.
In International Conference on Machine Learning, pp. 214-223, 2017.
Heinz H. Bauschke and Patrick L. Combettes. Convex Analysis and Monotone Operator Theory in
Hilbert Spaces. Springer, 2011.
Dimitri P. Bertsekas. Nonlinear Programming. Athena Scientific, 2nd edition, 1999.
Leon Bottou, Martin Arjovsky, David Lopez-Paz, and Maxime Oquab. Geometrical insights for
implicit generative modeling. In Braverman Readings in Machine Learning. Key Ideas from
Inception to Current State, pp. 229-268. Springer, 2018.
Stephen Boyd and Lieven Vandenberghe. Convex optimization. Cambridge university press, 2004.
Andrew Brock, Jeff Donahue, and Karen Simonyan. Large scale GAN training for high fidelity
natural image synthesis. In International Conference on Learning Representations, 2019.
Sebastien Bubeck. Convex optimization: Algorithms and complexity. Foundations and Trends in
Machine Learning, 8(3-4):231-357, 2015.
Casey Chu, Jose Blanchet, and Peter Glynn. Probability functional descent: A unifying perspective
on GANs, variational inference, and reinforcement learning. In International Conference on
Machine Learning, 2019.
Djork-Arne Clevert, Thomas Unterthiner, and Sepp Hochreiter. Fast and accurate deep network
learning by exponential linear units (ELUs). 2016.
Farzan Farnia and David Tse. A convex duality framework for GANs. In Advances in Neural
Information Processing Systems, pp. 5248-5258, 2018.
Gregory E Fasshauer and Qi Ye. Reproducing kernels of generalized Sobolev spaces via a Green
function approach with distributional operators. Numerische Mathematik, 119(3):585-611, 2011.
William Fedus, Mihaela Rosca, Balaji Lakshminarayanan, Andrew M Dai, Shakir Mohamed, and
Ian Goodfellow. Many paths to equilibrium: GANs do not need to decrease a divergence at every
step. In International Conference on Learning Representations, 2018.
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair,
Aaron Courville, and Yoshua Bengio. Generative adversarial nets. In Advances in Neural Infor-
mation Processing Systems, pp. 2672-2680, 2014.
Arthur Gretton, Karsten M. Borgwardt, Malte J. Rasch, Bernhard Scholkopf, and Alexander Smola.
A kernel two-sample test. Journal of Machine Learning Research, 13(1):723-773, 2012.
Paulina Grnarova, Kfir Y Levy, Aurelien Lucchi, Thomas Hofmann, and Andreas Krause. An online
learning approach to generative adversarial networks. In International Conference on Learning
Representations, 2018.
11
Published as a conference paper at ICLR 2020
Ishaan Gulrajani, Faruk Ahmed, Martin Arjovsky, Vincent Dumoulin, and Aaron C Courville. Im-
proved training of Wasserstein GANs. In Advances in Neural Information Processing Systems,
pp. 5767-5777, 2017.
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter.
GANs trained by a two time-scale update rule converge to a local nash equilibrium. In Advances
in Neural Information Processing Systems, 2017.
J-B Hiriart-Urruty. Extension of Lipschitz functions. Journal of Mathematical Analysis and Appli-
cations, 77(2):539-554, 1980.
Tero Karras, Timo Aila, Samuli Laine, and Jaakko Lehtinen. Progressive growing of GANs for im-
proved quality, stability, and variation. In International Conference on Learning Representations,
2018.
M Kirszbraun. Uber die zusammenziehende und Lipschitzsche Transformationen. Fundamenta
Mathematicae, 22(1):77-108, 1934.
Naveen Kodali, Jacob Abernethy, James Hays, and Zsolt Kira. On convergence and stability of
GANs. arXiv preprint arXiv:1705.07215, 2017.
Chun-Liang Li, Wei-Cheng Chang, Yu Cheng, Yiming Yang, and Barnabas Poczos. MMD GAN:
Towards deeper understanding of moment matching network. In Advances in Neural Information
Processing Systems, pp. 2203-2213, 2017a.
Jerry Li, Aleksander Madry, John Peebles, and Ludwig Schmidt. On the limitations of first-order
approximation in GAN dynamics. In International Conference on Machine Learning, 2017b.
Yujia Li, Kevin Swersky, and Rich Zemel. Generative moment matching networks. In International
Conference on Machine Learning, pp. 1718-1727, 2015.
Shuang Liu, Olivier Bousquet, and Kamalika Chaudhuri. Approximation and convergence proper-
ties of generative adversarial learning. In Advances in Neural Information Processing Systems,
pp. 5545-5553, 2017.
Edward James McShane. Extension of range of functions. Bulletin of the American Mathematical
Society, 40(12):837-842, 1934.
Lars Mescheder, Andreas Geiger, and Sebastian Nowozin. Which training methods for GANs do
actually converge? In International Conference on Machine Learning, 2018.
Takeru Miyato. How to combine WGAN and spectral norm? https://github.com/
pfnet-research/sngan_projection/issues/15, 2018. Accessed: 2019-09-24.
Takeru Miyato, Toshiki Kataoka, Masanori Koyama, and Yuichi Yoshida. Spectral normalization
for generative adversarial networks. In International Conference on Learning Representations,
2018.
Alfred Muller. Integral probability metrics and their generating classes of functions. Advances in
Applied Probability, 29(2):429-443, 1997.
Vaishnavh Nagarajan and J. Zico Kolter. Gradient descent GAN optimization is locally stable. In
Advances in Neural Information Processing Systems, 2017.
Erich Novak, Mario Ullrich, Henryk WoZniakowski, and ShUn Zhang. Reproducing kernels of
Sobolev spaces on Rd and applications to embedding constants and tractability. Analysis and
Applications, 16(05):693-715, 2018.
Sebastian Nowozin, Botond Cseke, and Ryota Tomioka. f-GAN: Training generative neural sam-
plers using variational divergence minimization. In Advances in Neural Information Processing
Systems, pp. 271-279, 2016.
Frans A Oliehoek, Rahul Savani, Jose Gallego, Elise van der Pol, and Roderich Groβ. Beyond local
Nash equilibria for adversarial networks. arXiv preprint arXiv:1806.07268, 2018.
12
Published as a conference paper at ICLR 2020
Alec Radford, Luke Metz, and Soumith Chintala. Unsupervised representation learning with deep
convolutional generative adversarial networks. arXiv preprint arXiv:1511.06434, 2015.
R. T. Rockafeller and R. J-B Wets. Variational Analysis, volume 317 of Grundlehren der mathema-
tischen Wissenschaften. Springer-Verlag, Berlin, Heidelberg, 1998.
Walter Rudin. The Principles of Mathematical Analysis. McGraw-Hill New York, 3rd edition, 1964.
Maziar Sanjabi, Jimmy Ba, Meisam Razaviyayn, and Jason D Lee. On the convergence and robust-
ness of training GANs with regularized optimal transport. In Advances in Neural Information
Processing Systems, 2018.
Aaron Sidford. MS&E 213 / CS 269O : Chapter 5 - smooth convex generalizations, 2017. URL
http://www.aaronsidford.com/chap_5_extend_v7.pdf.
Bharath K Sriperumbudur, Kenji Fukumizu, Arthur Gretton, Gert R Lanckriet, and Bernhard
Scholkopf. Kernel choice and Classifiability for rkhs embeddings of probability distributions.
In Advances in neural information processing systems, pp. 1750-1758, 2009.
Thomas Stromberg. The operation ofinfimal convolution. Instytut Matematyczny Polskiej Akademi
Nauk, 1996. URL http://eudml.org/doc/271746.
Thomas Unterthiner, Bernhard Nessler, Calvin Seward, Gunter Klambauer, Martin HeUSeL HUbert
Ramsauer, and Sepp Hochreiter. Coulomb GANs: Provably optimal Nash equilibria via potential
fields. In International Conference on Learning Representations, 2018.
Cedrik Villani. Optimal Transport: Old and New. Springer, 2009.
Hassler Whitney. Analytic extensions of differentiable functions defined in closed sets. Transactions
of the American Mathematical Society, 36(1):63-89, 1934.
Xingyu Zhou. On the Fenchel duality between strong convexity and Lipschitz continuous gradient.
arXiv preprint arXiv:1803.06573, 2018.
A INF-CONVOLUTION IN Rd
To gain intuition on the inf-convolution, we present a finite-dimensional analogue of the techniques
in Section 3. For simplicity of presentation, we will omit any regularity conditions (e.g., lower
semicontinuity). We refer readers to Chapter 12 of Bauschke & Combettes (2011) for a detailed
introduction.
Let J and R be convex functions on Rd. The inf-convolution of J and R is a function J ? R defined
as
(J ㊉ R)(x) := inf J (z) + R(X — z).
z∈Rd
The inf-convolution is often called the epigraphic sum since the epigraph of J ? R coincides with the
Minkowski sum of epigraphs of J and R, as Figure 2 illustrates. The inf-convolution is associative
and commutative operation; that is, it is always true that (Ji ㊉ J2)㊉ J3 = Ji ㊉(J ㊉ J3)=:
Ji ㊉ J ㊉ J3 and Ji ㊉ J = J ㊉ Ji.
There are two important special cases of inf-convolutions: The first one is the Pasch-Hausdorff
envelope Ja, which is the inf-convolution between J and a∣∣∙k2 (α > 0). It is known that Ja
becomes α-Lipschitz. The second important example is the Moreau envelope Jβ = J ㊉ 表∣∣∙k2,
i.e., the inf-convolution with the quadratic regularizer 表∣∣∙∣2. The Moreau envelope Jβ is always
differentiable, and the gradient of Jβ is β-Lipschitz (thus Jβ is β-smooth).
It is worth noting that the set of minimizers does not change after these two operations. More
generally, we have the following result:
Proposition 15. Let J, R : Rd → R be proper and lower semicontinuous functions with min J >
一∞ and min R = 0. Suppose R(0) = 0 and R(X) ≥ ψ(∣∣x∣∣2) for some increasing function
ψ : R≥o → R. Then, min J ㊉ R = min J and arg min J ㊉ R = arg min J.
13
Published as a conference paper at ICLR 2020
Figure 2: Illustration of inf-convolutions and their convex conjugates in R. Top row: Generally,
inf-convolutions inherit the regularity of their parent functions. In this example, J1(x) = |x| is
1-Lipschitz but not smooth, while J2(x) = x2/2 is 1-smooth but not Lipschitz. The inf-convolution
Ji ㊉ J2 is the well-known HUber function, which is both I-LiPschitz and 1-smooth. Bottom row:
Convex conjugates of the functions in the top row. The conjugate of J ㊉ J2 is given as the sum of
conjugates J?(Z) = χ{∣z∣ ≤ 1} and J?(Z) = z2∕2.
To sum up, given a function J, we can always construct a regularized alternative Jαβ that is α-
Lipschitz and β-smooth and has the same minimizers as J.
The next question is how to implement the inf-convolution in GAN-like optimization problems. For
this, it is convenient to consider the convex conjugate. Recall that the Fenchel-Moreau theorem
says that there is a duality between a convex function J and its convex conjugate J? as J(x) =
supz∈Rd hx, Zi - J?(Z) and J?(Z) = supx∈Rd hx, Zi - J (x). The important property is that the
convex conjugate of the inf-convolution is the sum of convex conjugates, that is, we always have
(J ㊉ R)?(z) = J?(z) + R?(z).
This property can be useful for implementing the regularized objective Jαβ as follows. First, we can
check that the convex conjugates of the norm and the squared norm are given as (∣∣∙∣∣ 2)? = χ{∣∣∙∣∣ ≤
1} and (2∣∣∙k2)? = ɪ|卜|，. Hence, we have
Ja(x) ：= (J ㊉ ɑ∣∙∣2 ㊉ ɪI"。(x) = sup hx,zi- J?(z) - β- ∣z∣2,
2β	z: kzk2≤α	2
which means that minimizing Jαβ can be recast in min-max problem with the norm clipping and
`2 -regularization on the dual variable Z .
B Common GAN losses
For completeness and clarity, we explicitly write out the expressions for the losses listed in Table 1.
For more detailed computations of optimal discriminators, see Chu et al. (2019); for more details on
the convex duality interpretation, see Farnia & Tse (2018).
Minimax GAN Goodfellow et al. (2014) originally proposed the minimax GAN and showed that
the corresponding loss function for the minimax GAN is the Jensen-Shannon divergence, defined
as
J(M)= Djs(μ Il μO) = 2Dkl(μ Il 1 μ + 2μO) + 2Dkl(μo Il 1 μ + 1 μO),
14
Published as a conference paper at ICLR 2020
where μo ∈ P(X) is a fixed probability measure (usually the empirical measure of the data), and
Dkl (μ || V) is the Kullback-Leibler divergence between μ and V. The optimal discriminator in the
sense of Definition 1 is given as
φ“(X) = Ilog dμd⅛(χ),
where d(；+/。)is the Radon-Nikodym derivative. If μ and μo have densities μ(x) and μo(x), then
dμ	μ(x)
F ； ∖∖x) = / ∖ , 厂P,
d(μ + μo)	μ(x) + μo(x)
so our optimal discriminator matches that of Goodfellow et al. (2014) up to a constant factor and
logarithm. To recover the minimax formulation, the convex duality (4) yields:
inf Djs(μ,μo) = infsupEx〜“[°(x)] - (-2Ex〜“°[log(1 - e2φ(x)+log2)] - 1 log2)
μ	μ φ	*^^^^^^^^^^^^^^{^^^^
(Djs(∙,μo))*3
=inf sup 2Ex〜μ[log(1 - D(x))] + 1Ex〜μ0[log D(x)],
μ D
using the substitution 夕=1 log(1 - D) - 2 log 2.
Non-saturating GAN Goodfellow et al. (2014) also proposed the heuristic non-saturating GAN.
Theorem 2.5 of Arjovsky & Bottou (2017) shows that the loss function minimized is
J(μ) ：= Dkl( 1 μ + 1 μo || μo) = 1 Dkl(μ || μo) - Djs(μ ||μo).
The optimal discriminator is
φμ(x) = - 2log dμd⅛(x).
Wasserstein GAN Arjovsky et al. (2017) proposed the Wasserstein GAN, which minimizes the
Wasserstein-I distance between the input μ and a fixed measure μ0:
J(μ) := W1 (μ, μO)= inf E(x,y)〜π |||x - y ||],
where the infimum is taken over all couplings π, probability distributions over X × X whose
marginals are μ and μo respectively. The optimal discriminator Φ* is called the Kantorovich poten-
tial in the optimal transport literature (Villani, 2009). The convex duality (4) recover the Wasserstein
GAN:
infW1(μ,μo) = infsupEx〜“3(x)] -(Ex〜“°3(x)] + χ{∣3∣Lip ≤ 1})
μ	μ φ	∣^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
(Wl(∙,μ°))?(w)
=inf sup Ex〜μ[2(x)] - Ex〜μ° [2(x)],
μ llwl∣Lip≤1
an expression of Kantorovich-Rubinstein duality. The Lipschitz constraint on the discriminator is
typically enforced by spectral normalization (Miyato et al., 2018), less frequently by weight clipping
(Arjovsky et al., 2017), or heuristically by gradient penalties (Gulrajani et al., 2017) (although this
work shows that gradient penalties may serve a different purpose altogether).
Maximum mean discrepancy Given a positive definite kernel K : X × X → R, the maximum
mean discrepancy (MMD, Gretton et al. (2012)) between μ and V is defined by
J(μ):
11
2MMDK (μ,ν ):=2/
K(x,y) (μ - ν)(dx) (μ - ν)(dy).
where (H, ∣∣∙∣∣h) is the reproducing kernel Hilbert space (RKHS) for K. The generative moment-
matching network (GMMN, Li et al. (2015)) and the Coulomb GAN (Unterthiner et al., 2018) use
the squared MMD as the loss function. The optimal discriminator in this case is
Φμ(x)= Ey~μ [K(x, y)] -
Ey~μ0 [K(x, y)],
15
Published as a conference paper at ICLR 2020
which in constrast to other GANs, may be approximated by simple Monte Carlo, rather than an
auxiliary optimization problem.
Note that MMD-GANs (Li et al., 2017a; Arbel et al., 2018) minimize a modified version of the
MMD, the Optimized MMD (Sriperumbudur et al., 2009; Arbel et al., 2018). These MMD-GANs
are adversarial in a way that does not arise from convex duality, so our theory currently does not
apply to these GANs.
Integral probability metrics An integral probability metric (Muller, 1997) is defined by
/
J(μ) := IPMF(μ, μo) := sup
f∈F
f dμ -
∕fdμo,
where F is a class of functions. The optimal discriminator is the function that maximizes the supre-
mum in the definition. The Wasserstein distance may be thought of as an IPM with F containing
all 1-Lipschitz functions. The MMD may be thought of as an IPM with F all functions with RKHS
norm at most 1, but no GANs based on MMD are actually trained this way, as it is difficult to
constrain the discriminator to such functions.
C Optimal discriminators are functional derivatives
Let J : P(X) → R be a convex function. Recall the definition of the optimal discriminator (Defini-
tion 1):
Φ
φμ
∈ arg max
W∈C(X)
/夕 dμ — J?(夕).
This definition can be understood as an infinite dimensional analogue of subgradients. In fact, in
finite-dimensional convex analysis, Z is a subgradient of f : Rd → R if and only if it can be written
as z ∈ arg maxz0 hz0, xi — f?(z0). The calculus of subgradients shares many properties with the
standard calculus of derivatives, such as chain rules (Rockafeller & Wets, 1998). This motivate us
to investigate derivative-like features of optimal discriminators.
We introduce the functional derivative, also known as the von Mises influence function:
Definition 3 (Functional derivative). Let J : P (X) → R be a function ofprobability measures. We
say that a Continuousfunction Φμ : X → R is a functional derivative of J at μ if
J (μ + eξ) = J (μ) + C
/ Φμ dξ + O(C2)
holdsfor any ξ = V — μ with V ∈ P(X).
Under this definition, optimal discriminators are actually functional derivatives.
Proposition 16 (ChU et al. (2019), Theorem 2). Let J : M(X) → R be a proper, lower semicon-
tinuous, and convex function. Ifthere exists a maximizer Φμ of 夕 → /夕 dμ — J ?(夕),then Φμ is a
functional derivative of J at μ in the sense ofDefinition 3.
The following result relates the derivative of the loss function with the derivative of the optimal
discriminator:
Proposition 17 (Chu et al. (2019), Theorem 1). Let J : P(X) → R be continuously differentiable,
in the sense that the functional derivative Φμ exists and (μ, V) → Ex 〜V [Φμ(x)] is continuous. Let
θ → μθ be continuous in the sense that 6(μθ+h 一 μθ) converges to a weak limit as ∣∣hk → 0.
Then, we have
Vθ J (μθ) = Vθ Ex 〜μθ[Φ(x)],
ʌ
where Φ = Φ*g is treated as afunction X → R that is not dependent on θ.
We use this important computational tool in many of our proofs. For the case of the generator model
μθ = fe# ω, an important consequence of Proposition 17 is that
__ ____________ __ ʌ ________________ _____
vθ J (μθ ) = vθEz 〜ω [φ(fθ (Z))] = Ez 〜ω vx=fθ (z)φμ (fθ (Z)) ∙ Dθ fθ (Z)]∙
We use this fact in the proof of Theorem 1.
16
Published as a conference paper at ICLR 2020
D Proofs for Sections 1 and 2
The following result is well known in the dynamical systems and the optimization literature. For the
sake of completeness, we provide its proof.
Proposition 1 (Bertsekas (1999), Proposition 1.2.3). Suppose f : Rp → R is L-smooth and
bounded below. Let Xk+ι := Xk - LPf(Xk). Then "▽/(Xk)|| → 0 as k → ∞.
Proof. It is known that if f is L-smooth, then
f(y) ≤ f(x) + hVf(χ),y -Xi + LL||y - x||2
holds for any X, y ∈ Rd (see e.g. Lemma 3.4 in Bubeck (2015)). Then, we have
f(Xk+1)≤ f(Xk) + Wf(Xk ),Xk+1 - Xk i + 2 ∣∣Xk+1 - Xk ||2
≤ f(Xk) - 11Vf(Xk)||2 + ɪ||Vf(Xk)||2
L	2L
=f(Xk) - ɪIlVf(Xk)||2.
2L
Summing this inequality over k, we have
n-1
2L X IlVf(Xk)ll2 ≤ f (xo) - f (Xn),
k=0
from which we conclude that
min
0≤k≤n-1
2L
||Vf(Xk)||2 ≤ 一 (f(xo)-inff(x)).
n
x
□
Next, we move on to prove Theorem 1, which we restate here for readability.
Theorem 1 (Smoothness decomposition for GANs). Let J : M(X) → R be a convex function
whose optimal discriminators Φμ : X → R satisfy the following regularity conditions:
(D1) x → Φμ(x) is α-Lipschitz,
(D2) X → VχΦμ(X) is βι-Lipschitz,
(D3) μ → VχΦ*(x) is β2-Lipschitz w.r.t. the 1 -Wasserstein distance.
Also, let μθ = fe#3 be afamily ofgenerators that satisfies:
(G1) θ → fθ(z) is A-Lipschitz in expectation for Z 〜 ω, i.e., Ez〜ω [kfθι (Z) — fθ2 (z) k2] ≤
Akθ1 - θ2k2, and
(G2) θ → Dθfθ(z) is B-Lipschitz in expectation for Z 〜ω, i.e., Ez〜ω [∣∣Dθι fθι (Z) 一
Dθ2fθ2(Z)k2] ≤Bkθ1 -θ2k2.
Then θ → J(μθ) is L-smooth, with L = αB + A2(βι + β2).
Intuitively, Theorem 1 can be understood as the chain rule. For simplicity, let us consider the smooth-
ness of a composite function D ◦ G, where D and G are functions on R. A sufficient condition for
D◦G to be smooth is that its second derivative is bounded. For this, suppose that (i) D is α-Lipschitz
and β-smooth and (ii) G is A-Lipschitz and B-smooth. By the chain rule, the second derivative is
bounded as (D ◦ G)00 = (D0 ◦ G)G00 + (D00 ◦ G)(G0)2 ≤ αB + A2β, which has the same form as
the consequence of Theorem 1. For GANs, we need somewhat more involved conditions; We need
two types of smoothness (D2) and (D3) for the optimal discriminators. To this end, we utilize the
functional gradient point of view that we explained in Appendix C.
17
Published as a conference paper at ICLR 2020
Proof of Theorem 1. First, using the functional gradient interpretation of the optimal discriminator,
we have
|UiJ(μθι) - Vθ2J(μθ2)||
=∣∣Ez~ω [VΦ"θ1 (fθι(Z)) ∙ Dθ1fθ1 - VΦμ°2 (fθ2(z)) ∙ Dθ2fθ2]∣∣	Proposition 17
= ∣∣Ez~ω[VΦμ.ι (fθι (Z)) ∙ (Dθι fa、- Dθ2 fθ2 )
+ (VΦμ0ι (fθι (Z))-VΦ“°2 (f©、(Z))) ∙ Dθ? fθ?
+ (VΦμ02 (fθι (Z)) — VΦμθ2 (fθ2(z))) ∙ D©? fθ? ] 11
≤ ∣∣Ez~ω [VΦμθ1 (fθι (z)) -(De、fθι- Da? fθ? )]∣∣	(a)
+ ∣∣Ez~ω [(VΦμ.ι (fθι (z)) — VΦμθ2 (f©、(z))) ∙ D©? fθ? ]∣∣	(b)
+ ∣∣Ez~ω [(VΦμθ2 (fθι (Z))-VΦμθ2(fθ2 (Z))) ∙ Dθ2 fθ2 ]∣∣ .	(c)
By assumption, there are bounded non-negative numbers α, β1, β2, A, and B such that
(D10)	α = sup sup ∣∣Φμ(x)k2 ,
μ∈P(X) x~μ
(D20)	sup ∣∣VχιΦμ(xι) — Vχ2Φμ(x2)k2 ≤ β1∣∣x1 — X21∣2
μ∈P(X)
(D30)	sup ∣∣VχΦμι(x) — VxΦμ2(x)k2 ≤ β2W1(μ1,μ2),
x∈X
(G10)	a = Ez~ω sup ∣∣Dθfθ(z)∣∣op, and
©
(G20)	Ez~ω ∣∣Dθιfθι (Z)- Dθ2fθ2(Z)IIoP ≤ B∣∣θ1 — θ2∣∣.
Here, We wrote supx~* f (x) for the essential supremum of f w.r.t. μ. From (D10) and (G20), the
first term (a) is bounded as
∣∣Ez~ω[VΦμθ1 (fθι(z)) ∙ (Dθ1fθ1 — Dθ2fθ2)]∣∣ ≤ αB∣θι — θ2∣.
From (D30), (G10), and the Cauchy-Schwarz inequality, the second term (b) is bounded as
∣∣Ez~ω [(VΦμ.ι (fθι (z)) — VΦμθ2 f (Z))) D θ? fθ? ]∣∣
≤Aβ2W1(μθ1,μθ2)
≤Aβ2Ez~ω kfθι (z) — fθ2(Z)k ≤ A2β2∣θl — θ2k,
where the second inequality holds from the following optimal transport interpretation of W1:
wι(μθι ,μθ2)
inf
γ∈P(X×X):
coupling of μθι and μθ2
/kx - yk dγ ≤ Ez~ω kfθι (Z)- fθ2(Z)k.
Lastly, from (D20), (G10) and the Cauchy-Schwarz inequality, the term (c) is bounded as
∣∣Ez~ω [(VΦμ02 (fθι (Z))-VΦμθ2 (fθ2 (Z))) ∙ Dθ2fθ2]∣∣ ≤ AβlEz~ω kfθι (Z)-fθ2 (Z)k ≤ A2βlkθl-Θ2k.
Combining the above upper bounds for (a)-(c), we conclude that
∣∣VθιJ(μθ1)-Vθ2J(μθ2)∣∣ ≤ (αB + A2(β1 + β2))kθ1 — θ2∣∣.
□
E Proofs for Section 3
In the finite-dimensional case, Proposition 15 says that taking inf-convolution with a “coercive”
regularizer does not change the set of minimizers of the original objective. A similar invariance
holds for GAN objectives, which are defined on infinite-dimensional space of signed measures, for
the regularizers R1 , R2 and R3 introduced in Sections 4 to 6:
18
Published as a conference paper at ICLR 2020
Proposition 2 (Invarianceofminimizers). Let Rι(ξ) := ∣∣ξ∣∣κR, R2(ξ) := ∣∣ξ∣∣s*, and R3(ξ):=
11lfllH be the three regularizer defined by (8), (12), and (19) respectively. Assume that J :
M(X) → R has a unique minimizer at μo with J(μo) = 0, and J(μ) ≥ c∣μ 一 μo∣H for some
∙-v
c > 0. Then the inf-convolution J = J ㊉ Ri ㊉ R2㊉ R3 has a unique minimizer at μo with
∙-v
J (μo) = 0.
Proof. In the following, We endow M(X) with the Gaussian RKHS norm ∣∣ ∙ ∣∣h, and for conve-
nience k ∙ k will refer to this norm if not otherwise specified. To show the result, we apply Lemma 1
three times, first on R3 and Ri, and then again on R3 ㊉ Ri and R?, and then finally on R3 ㊉ Ri ㊉ R2
∙-v
and J(∙ + μo). The result follows from noting that J(μ) = [R3 ㊉ Ri ㊉ R2㊉ J(∙ + μo)](μ — μo).
In order to apply the lemma, it suffices to show that R3 is uniformly continuous on bounded sets and
coercive, and that there exist constants ci and c2 such that Ri(ξ) ≥ ci ∣ξ∣ and R2(ξ) ≥ c2 ∣ξ∣. R3
is uniformly continuous on bounded sets: suppose ∣∣ξ∣ < C and ∣∣ξ0k < C; then ∣R3(ξ) — R3(ξ0)| =
12 kξk2 - 2 kξ0k2∣ = |i hξ-ξ0,ξ + ξ0i∣ ≤ C ∣∣ξ-ξ0k by the Cauchy-Schwarz and triangle inequality.
R3 is also coercive, as R3(ξ) = ⅛∣∣ξ∣∣2 → ∞ when ∣∣ξ∣ → ∞. Ri satisfies Ri(ξ) ≥ ci∣ξ∣ by
Lemma 7. R2 satisfies R2(ξ) ≥ c2]∣ξ∣∣ by Lemma 5.	□
Recall that a function F is said to be coercive if F(ξ) → ∞ when ∣ξ∣ → ∞.
Lemma 1. Suppose F : M(X) → R has a unique minimizer at 0 with F(0) = 0, and is uniformly
continuous on bounded sets and coercive. Suppose G : M(X) → R has a unique minimizer at 0
with G(0) = 0, and G(∙) ≥ c∣∙ ∣∣ for some c > 0. Then the inf-convolution F ㊉ G has a unique
minimizer at 0 with (F ㊉ G)(0) = 0, and is uniformly continuous on bounded sets, coercive, and
real-valued.
Proof. From Theorem 2.3 of StrOmberg (1996), inf F ㊉ G = 0, and 0 ∈ arg min F ㊉ G. To show
that 0 is the unique minimizer, let ξ ∈ arg min F ㊉ G. From the definition of inf-convolution, for
every n there exists an ξn ∈ M(X) that satisfies
lim F(ξn) + G(ξ — ξn) = (F ㊉ G)(ξ) = 0∙
n→∞
Since F and G are non-negative, F(ξn) → 0 and G(ξ 一 ξn) → 0. By our assumption that G(∙) ≥
c∣∙ ∣∣, the latter limit implies that ∣ξ 一 ξn∣ → 0, which implies that F(ξn) → F(ξ) by continuity
of F. Comparing our two expressions for the limit of F(ξn), we find that F(ξ) = 0, which implies
that ξ = 0, since F has a unique minimizer at 0. Hence arg min F ㊉ G = {0}.
From Theorem 2.10 of StrOmberg (1996), F ㊉ G is uniformly continuous on bounded sets and
real-valued. To show that F ㊉ G is coercive, we show the equivalent condition its sublevel sets are
bounded (see Proposition 11.11 of Bauschke & Combettes (2011)). That is, we show that for all
a > 0, there exists a constant b such that if (F ㊉ G)(ξ) ≤ a, then ∣∣ξ∣ ≤ b. Let a > 0, and let
ξ ∈ M(X) be such that (F ㊉ G)(ξ) ≤ a. Let e > 0; from the definition of inf-convolution, there
∙-v
exists a ξ ∈ M(X) such that
∙-v	∙-v
F(S) + G(ξ 一 ξ0 ≤ (F ㊉ G)(S) + E ≤ a + e∙
Because F and G are non-negative, we have that
∙-v	∙-v
F(ξ) ≤ a + e, G(ξ 一 ξ) ≤ a + e∙
Using the fact that F is coercive and hence its sublevel sets are bounded, let b0 be such that if
F(ν) ≤ a + e, then ∣∣ν∣ ≤ b0. By the triangle inequality and our assumption that G(∙) ≥ c∣∙ ∣∣,
∙-v	∙-v
∣ξ∣ ≤ ∣ξ∣ + kξ-ξk≤ b0 +
∙-v
G(ξ - ξ)
c
≤ b0 +
a+E
c
Because this constant is independent of ξ, this shows that F ㊉ G is coercive.
□
19
Published as a conference paper at ICLR 2020
F Proofs for Section 4
Proposition 3. (D1) holds if and only if J is α-Lipschitz w.r.t. the Wasserstein-1 distance.
Proof. First, we check the forward implication:
| J(μ) - J(V)| ≤ αWι(μ, V)	⇒ SuP ∣∣VχΦμ(x)∣∣2 ≤ α.
X〜μ
From the duality between L∞- and L1-norms, we have
SuP ∣∣VχΦμ(x)k2 = kVχΦμ (∙)kL∞(μ; Rd)= SuP / VΦμ(x) ∙ V(X)dμ(x).	(26)
X 〜μ	kvkLl(μ; Rd) = IJ
Below, We will abbreviate |卜||二1(*；Rd) as ∣∣∙∣∣li. We utilize the fact that the optimal discriminator
Φμ is the functional gradient of J in the sense of Definition 3. For any t ≥ 0, let μt = (id + tv)#M
be the law of X + tv(x) with X 〜μ. Then, μt converges weakly to μ = μo as t → 0 since
Wι(μt, μ) ≤ t∣∣v∣∣Li(μ) → 0. Applying Proposition 17 to J and μt, we have
dtJ (μt)
t=0
d
F	Φμ(x + tv(x)) dμ(x)
dt
t=0
∕vφ"3 ∙V(X)加
In particular, the right-hand side of (26) is bounded from above as
SuP / VΦμ(x) ∙ V(X) dμ(x)
kvkLl(μ)=1 J
sup	-dJ (μt)
kvkLl(μ) = 1 dt
t=0
J(Mt)- J(μ)
sup lim
kvkLl(μ) = 1 t→0
t
αW1(μt,μ)
≤ sup lim-----------------
kvkLl(μ) = 1 t→0	t
/	α αtkvkL1(μ)
≤	sup lim-----------
kvkLl(μ) = 1 t→0	t
= α,
which proves the first half of the statement.
For the converse, we borrow some techniques from the optimal transport theory. Let p > 1, and let
Wp(μ, V) denote the Wasserstein-p distance between μ and V. Suppose that μt : [0,1] → P(X)
is an Pp(X)-absolutely continuous curve, that is, every μt has a finite p-moment and there exists
v ∈ L1 ([0,1]) such that Wp(μs,μt) ≤ R： v(r) dr holds for any 0 ≤ S ≤ t ≤ 1. Then, the limit
∣μ0∣Wp (t) := limh→o ∣h∣-1Wp(μt+h,μt) exists for almost all t ∈ [0,1] (see Ambrosio et al. (2008),
Theorem 1.1.2). Such ∣μ0∣Wp is called the metric derivative of μt.
Lemma2(Ambrosioetal. (2008), Theorem8.3.1). Letμt : [0,1] → P(X) beanPp(X1-absolutely
continuous curve, and let ∣μ0∣Wp ∈ L1 ([0,1]) be its metric derivative. Then, there exists a vector
field V : (X, t) 7→ Vt (X) ∈ Rd such that
Vt ∈ Lp(μt; X),	IIVtk ≤ ∣μ0∣Wp(t)
for almost all t ∈ [0, 1], and
1d	1
J dt夕(x,t)μt(dx)dt = - J hvt(x), VX夕(x,t))μt(dx)dt
holdsfor any CyIindriCaIfUnCtion 夕(x, t).
20
Published as a conference paper at ICLR 2020
Given P > 1, let μt be a Pp(X)-absolutely continuous curve such that μo = μ and μι = ν. Then
IJ(M)- J(V)| dtJ(Mt) dt
Vt ∙ VΦμt dμt dt
≤ / l∣∣Vtl∣LP(μt)加虫“,以(“I dt
≤ / llvtllLP(μt) dt ∙ SUp kvφμ kLq(μ)
0o	μ
≤ / |〃t|Wp dt ∙ SUp kvφμkLq(μ),
0o	μ
where ∣μt∣ is the metric derivative. The existence of Vt and the bound ∣∣vt∣∣LP(μt) ≤ ∣μt Wp is due
to Lemma 2. Taking the infimum over all possible such curves, we find that
IJ(μ) - J(V)I ≤ Wp(μ,ν) ∙ SUpkvφμkLq(μ) ∙
μ
To conclude, We consider the limit P → 1. Using the fact that q → ∣∣f |匕⑷ is increasing in q, We
have
IJ(μ) - J(ν)∣ ≤ Wp(μ, ν) ∙ sup ∣∣VΦμ∣∣L∞(μ) ≤ αWp(μ,ν)∙
μ
Then
IJ(μ) - J(ν)1 ≤ inf αWp (μ,ν)
p>1
= α inf inf IIx - yIILp (π)
π∈Π(μ,ν) p>1
= α inf	IIx - yIIL1(π)
π∈Π(μ,ν)
=αWι(μ, ν)∙
□
Proposition 4. The minimax and non-saturating GAN losses do not satisfy (D1)for some μo.
Proposition 5. The Wasserstein GAN loss satisfies (D1) with α = 1 for any μo.
Proof for Proposition 4 and Proposition 5. The counterexample for Proposition 4 is a slight simpli-
fication of Example 1 of Arjovsky et al. (2017). Let δx denote the distribution that outputs x ∈ R
With probability 1. Then, We have
Djs(δχ II So)	= *2	x =	0	Dkl(2δχ+2δo	II δo)	= ∞	x =	0	and W1(δχ,δ0)	=同
0	x =	0,	0	x =	0,
Therefore, for J(μ) = Djs(μ II δo), the inequality IJ(δχ) 一 J(δo)I ≤ αWι(δχ, δo) cannot hold for
sufficiently small x 6= 0, because the left-hand side equals log 2 While the right-hand side equals
αIxI. For J(μ) = Dkl( 11 μ + 11 δo II δo), the inequality will not hold for any x = 0.
Next, we verify Proposition 5. For J(μ) = Wι(μ,μo), we have J(μ) 一 J(ν) = Wι(μ,μo) 一
Wι(ν, μo) ≤ Wι(μ, V) by the triangle inequality (see e.g., Section 6 in Villani (2009)). Reversing
the roles of μ and V, we can conclude that IJ(μ) 一 J(ν)I ≤ Wι(μ, ν). The result follows from
Proposition 3.	口
___ ʃ—"
Proposition 6 (Pasch-Hausdorff). Let J : M(X) → R beafunCtion, and define J := J ㊉ Ri. Then
∙-v
J is α-Lipschitz w.r.t. the distance induced by the KR norm, and hence the Wasserstein-1 distance
when restricted to P(X).
21
Published as a conference paper at ICLR 2020
Proof. Observe that by the triangle inequality,
∙-v	∙-v
J(μ) — J(V) = sup inf J(μ) + αWι(μ, μ) — J(V) — αWι(ν, V)
V μ
≤ SuPαWι(μ, V) — αWι(ν, V)
V
≤ SuPaWι(μ, V)
V
=αWι(μ, V).
Interchanging the roles of μ and V completes the proof.	□
Lemma 3. The convex conjugate of μ → ɑ∣∣μ∣∣κR is g^ven as 夕 → χ{k 夕 ∣∣Lip ≤ α}.
Proof. The convex conjugate is SuP h/fdμ — α∣∣μ∣∣κR]=	sup f f dμ — α sup g qdμ∖ μ U	∣∣g∣∣Lip≤ι/	」 sup f f dμ — sup g q dμ μ	∣∣g∣∣Lip≤α√	」 suph∣∣g∣inp ≤α∕fd" -Z qdμi ∣∣g∣inf≤asuph∕fdμ - / qdμi inf χ{f = q} l∣g∣∣Lip≤α X{llf||Lip ≤ α},
where Sion's minimax theorem ensures that we can SWaP the inf and the sup.	□
G Proofs for Section 5
Proposition 7. The Wasserstein, minimax, and non-saturating GAN losses do not satisfy (D2) for
some μo.
Proof. First, we prove the statement for the Wasserstein GAN. Consider J(μ) = Wι(μ, δo) evalu-
ated at μ = 21 δ-ι + 2 δι, a mixture of spikes at ±1. The optimal discriminator of J at this mixture
is the Kantorovich potential that transfers μ to δo, which is Φμ(x) = |x|. The gradient of this
Kantorovich potential is discontinuous at 0, and hence not Lipschitz.
For the minimax GAN J(μ) = Djs(μ || μo), let μ and μo be probability distributions on R
whose densities are p(χ) H exp(一∣x∣∕2) and po(χ) H exp(一∣x∣), respectively (i.e., Laplace
distributions). Then, the optimal discriminator at μ is given as Φμ(x) = 21 log 卓他^^⑺ =
—1 log(1 + 2exp(一∣x∣∕2)). By elementary calculations, we can see that this function is not differ-
entiable at x = 0, which implies that the minimax GAN does not satisfy (D2). For the non-saturating
GAN, we obtain a similar result by swapping the role of μ and μo.	□
Proposition 8. Let J : M(X) → R be a convex, proper, lower Semicontinuousfunction, and define
∙-v	∙-v
J := J ㊉ R2. Then the optimal discriminatorfor J is βι-smooth.
∙-v
Proof. J is convex, proper, lower semicontinuous. Hence
∙-v
J(μ)
(J ㊉ λ∣∣∙∣∣F* )(μ)
SuP
ψ
/ φdμ 一 j?(夕)一χ{λP ∈F}.
Then by the envelope theorem, δμ is the 夕 that maximizes the right-hand side, and hence λ J ∈
F.	□
22
Published as a conference paper at ICLR 2020
Lemma 4. The convex conjugate of μ → βι ∣∣μ∣∣s* is 夕 — χ{φ ∈ βιS}.
Proof. The proof of Lemma 4 is nearly identical to the proof of Lemma 3.	□
Proposition 9. Let f : Rd → R be a neural network consisting of k layers whose linear transfor-
mations have SpeCtraI norm 1 and whose activation functions are 1 -Lipschitz and 1 -smooth. Then f
is k-smooth.
Proof. In this section, let '(f) and s(f) denote the Lipschitz constant of f and Vf respectively.
This inequality holds
s(f ◦ g) ≤ s(f )'(g)2 + 4(f)s(g),	(27)
since
lld(f og)(x) - d(f og)(y)∖∖ = ∖∖df (g(χ))dg(x) — df (g(y))⅛⅛)∣∣
=∖∖df (g(X))dg(X)- df (g(y))dg(x) + df (g(y))dg(x) - df (g(y))⅛⅛)∖∖
≤ ∖∖df (g(x)) - df (g(y))∖∖ ∖∖dg(χ)∖∖ + ∖∖df (g(y))∖∖ ∖∖dg(X)- dg(y)∖∖
≤ s(f )∖∖g(χ) - g(y)∖∖`(g) + '(f )s(g)∖∖χ - y∖∖
≤ (s(f),(g)2 + 0(f)s(g))∖∖x-y∖∖.
Let σ be an elementwise activation function with '(σ) = s(σ) = 1, and let A be a linear layer with
spectral norm 1. Then '(A) = 1 and s(A) = 0, so
'(σ o A) ≤ '(σ) '(A) = 1
s(σ o A) ≤ s(σ)'(A)2 + '(σ)s(A) = 1.
We note that We can use the same value of s(σ) whether We consider σ : R → R or elementwise as
σ : Rd → Rd, since for an elementwise σ, we have
∖∖dσ(x) - dσ(y)∖∖2 = ∖∖ diagσ0(x) - diagσ0(y)∖∖2
=∖∖ diag(σ0(x) - σ0(y))∖∖2
=max ∖σ0(xi) - σ0(yi)∖
i
≤ maxs(σ)∖xi - yi∖
i
=s(σ)∖∖χ — y∖∖∞
≤ s(σ)∖∖χ - y∖∖2.
We apply the inequality (27) recursively for all k layers to obtain that the entire network is k-
smooth.	□
Lemma 5. Let H be anRKHS with the Gaussian kernel. Then ∖∖∕^∖∖h ≤ 笔∖∖μ∖∖s*.
Proof. It follows from dfχ) = hf, dK∂x~〉that, for f ∈ H,
kVf(x)-
d Vf(y)k2 = X i=1	∂f(x) ∂Xi	∂f (y) I 2 ∂yi I		
d ≤ X If IH		∂K(x, ∙) 		 ∂Xi	∂K(y, ∙) ∂yi	2 H
d =IfkH X《 i=1		'∂2K(x, X) 、∂xi∂Xi	-2∂2K(x,y) ∂xi∂yi	
≤ Ilf kH ∙ T(x,y) + γ(%x)),
where X and y denote copies of X and y, and
+ ∂2 K (y,y)
∂yi∂y
d
r(x,y) = X
i=1
∂2K(x, X)	∂2K(x, y)
__
∂xi∂xi	∂xi∂Xi
23
Published as a conference paper at ICLR 2020
From (30), We find that for a Gaussian kernel,
Γ(x,y) = σ-4 eχp(~kx2σyk ) kx - yk2,
and thus,
kVf(X)-Vf(y)k ≤ 号IlfEkx-yk.
σ2
This implies that
MkH = sup Z fdμ ≤ sup Z fdμ = X22 ∣∣4∣∣s*.
f ∈H, kf kH≤1 J	kf∣∣s ≤ 岑 J	σ
□
H Proofs for Section 6
Lemma 6. The convex conjugate of μ → 2∣∣M∣∣kr is f → =Ilf IlLip.
Proof. This proof is generalized from the finite-dimensional case (Boyd & Vandenberghe, 2004).
We can bound the convex conjugate from above by
sup
μ
[/f dμ - 2∣∣m∣∣kr]
≤ sup [∣∣f∣∣Lip∣∣Μ∣∣KR - 2 I∣μ∣∣κκ]
≤ sup
z∈R
[llf I∣Lipz- 2 z2]
IlfI∣Lip ∙
||f||Lip
λ IlfIILip
一∙—：—
2 λ2
2λ Ilf IlLip.
If f is constant, then we may choose μ = 0 to see that
sup [/f dμ- 2∣∣m∣∣Kr] ≥ 0 = 2λIlfIlLip,
and We are done.
Otherwise, for f (x) = f (y), let μ%y be the signed measure given by
aχ,y
Ilf IILip
λ(f(χ)- f(y))
(δx - δy ).
Note that
and
llμx,y llKR =	sup / ；
l∣g∣∣Lip≤ι J
IlfllLip
gdμx,y
λ(f(χ) - f(y))
IIfIILip
λ(f(χ) - f(y))
Jf dμχ,y
Ilf IILip
λ(f (χ) - f(y))
sup
UgULiP≤ι
• d(x,y)
(g(χ) - g(y))
(f(χ)-f(y)) = ɪ Ilf IlLip.
24
Published as a conference paper at ICLR 2020
Then
sup h f dμ- - λUmUKr] ≥ sup h f fdμx,y - λ ||Mx,y "Kr]
μ LJ	2	f	f(χ)=f(y) "	2	」
=sup h 11IfIlLip- λ(11IfIlLiP J(x,y)))2]
f	(x)6=f	(y) λ p 2 λ pf (x)- f (y)
=KlfllLip - 2 (v llfllLip ∣T77∣ 一)
λ	2 λ IIf IILip
=2λ llf "Lip，
□
Proposition 10. Let J : M(X) → R be a convex function. Then J satisfies (D3) if and only if
Dj(ν,μ) ≤ β2 kμ - VkKR forall μ,ν ∈ M(X).
Proof. Recall the definition of the Bregman divergence:
Dj(V,μ) := J(v) - J(μ) - / Φμ(x) d(V - μ).
Proposition 10 claims that the optimal discriminator Φμ is β2-smooth as a function of μ if and only
if
∀μ, V ∈ M(X) J(V) - J(μ) - Z φμ(X) d(V - μ) ≤ ~^ kμ - vI∣Kr∙
(28)
This proof is generalized from the finite-dimensional case (Zhou, 2018; Sidford, 2017). Suppose
that kVΦμ(χ) - VΦν(x)k2 ≤ β2kμ - V∣∣kr holds for all x. Let μt (0 ≤ t ≤ 1) be defined as a
mixture between μt = (1 - t)μ + tV so that
μ0 = μ, μ1 = v, and kμt - μs kKR = lt - s| ∙ kμ - VIlKR∙
Then, we have
IDJ(V' M)I
d
dtJ(μt)dt -	φμ d(v - μ)
φμt d(v - μ)dt - / φμ d(v - μ)
=/ Z (φμt - φμ) d(V - μ) dt
≤ Z kφμt - φμkLip kμ - VkKR dt
≤	β2 kμt - μkKR kμ - V kKR dt
0
≤	tβ2 kμ - V k2KR dt
0
=^22 kμ - v∣Kr∙
Since the choice ofμ and V is arbitrary, we have proved (28) by assuming (D2).
Next, we move on to prove the converse. Before proceeding, note that the Bregman divergence
DJ (V, μ) is always non-negative. In fact, for any μ,V ∈ M(X), we have
J φμ d(V - μ) = ] φμ dν - J?(Φμ)-
`---------{----------} I
≤J(ν)
/ Φμ dμ - J*(Φμ)
^^{^^™
=J (μ)
}
25
Published as a conference paper at ICLR 2020
≤ J(V) - J(μ),
which implies Dj(ν, μ) ≥ 0.
Choose ξ ∈ M(X) arbitrarily. If ξ = μ, the inequality ∣∣VΦμ - VΦξ∣∣2 ≤ β2∣∣ξ - μkκR is trivial,
so We assume ξ = μ below. By the non-negativity of the Bregman divergence, We have
0 ≤ Dj(ν,μ)
=J(V) - J(μ) + J φμ d(V - μ)
≤ J (ξ) + / φξ d(V - ξ) + ^22 llξ - v||Kr - J (μ) + / φμ d(V - μ)
=J (ξ) - J (μ) - / φμ d(ξ - μ) + / [φξ - φμ] d(V - ξ) + ^2 llξ - V ||KR
(29)
Since the above inequality holds for all V ∈ M(X), the last expression is still non-negative if we
take the infimum over all V . In particular,
inf、Z[φξ - φμ] d(V - ξ) + β US-v11Kr
ν∈M(X)	2
=-SUp	八φμ - φξ] d(V - ξ) - β llξ - V||KR
ν∈M(X)	2
=-SUp	Z[φμ - φξ ] dZ - Φ ||Z ||KR
ζ∈M(X)	2
=-2β2 kφμ - φξ kLip，
using Lemma 6 for the last equality.
Continuing from (29), we have
0 ≤ J (ξ) - J (μ) - Z φμ d(ξ - μ) - 2β^ kφμ - φξ kLip .
Swapping the roles of μ and ξ, we obtain a similar inequality. Adding both sides of thus obtained
two inequalities, we obtain
0 ≤ /[φξ - φμ] d(ξ - μ) - W kφμ - φξkLip ∙
Finally, we have
llφμ- φξIlLip ≤ β /[φξ- φμ] d(ξ - μ) ≤ β llφμ- φξl∣Lip llξ - μ∣κR,
and hence we have the desired result:
llφμ - φξ kLip ≤ β2kξ - μ∣∣KR∙
□
Lemma 7. Let K(x, y) = exp(- Ux-y|| ). Then MMDK(μ, V) ≤ £∣∣μ — ν∣∣Kr.
Proof. First, we note that
MMDK (μ, V)
/ K(x,y)(μ - V)(dx)(μ - V)(dy)
≤ SUp
x6=x0
J(K(Xy) - K(X0,y)) (μ - ν)(dy)
d(x, x0)
]“μ - ν||KR
≤ SUp
x6=x0,y6=y0
K(x, y) - K(x, y0) - K(x0, y) + K(x0, y0)
d(x, x0) d(y, y0)
]llμ - v"Kr∙
26
Published as a conference paper at ICLR 2020
Next, we show that
C =	SU	K(χ, y) - K(χ, y0) - K(χ0, y) + K(χ0, y0) = 1
χ=χθ,y=yθ	d(x,x0) d(y,y0)	σ2.
Because K is differentiable, it suffices to check that the operator norm of ∂xi ∂yj K (x, y) is bounded.
To see this, note that
Lip(K(x, •) — K(x0, •))
C = SupO	限—X|
=	IlVyK(X,y) ― VyK(XIy)I∣2
=χ=upy	F-^
≤ sup IIVxVyK(X, y)IIop,
x,y
where we obtained by the last equality by applying the vector-valued mean value theorem (Rudin,
1964) to t 7→ VyK((1 — t)X + tX0, y), thereby obtaining
IIVyK(X,y) — VyK(X0, y)II2 ≤ II∂tVyK((1 — t)X+tX0,y)II2
=I∣(x0 — X)∙ VxVyK((1 — t)x + tx0,y)∣∣2
≤ IIX0 — XII2IIVxVyK((1 —t)X + tX0, y)IIop.
Now
dXi dyjK (x,y) = dXi dyj exp (一* X(Xk - yk产)
=dχi eχp (-2σ2 X(Xk- yk)2) ∙- σ (Xj- yj)	(30)
=eχp (― 2σ2 X(Xk- yk )2)[ σ4(Xi - yi)(Xj- yj)- σ δji .
This is the symmetric matrix
σ2 exp(-∣∣X2σy∣∣)h B(X - y)(X - y)T - I i.
By inspection, We see that X — y is an eigenvector with eigenvalue 表 exp(- llx-yl1 )(σ2 ||x -y∣∣2 一
1), and the other eigenvectors are orthogonal to X — y with eigenvalues —a exp(- llx-yl1 ).
Setting Z = j⅛r and taking the absolute value of the eigenvalues, we see the maximum operator
norm over all X, y is equal to
max
(
SUp —ee z ∣2z — 11, sup —ee Z O = —..
z≥0 σ2	z≥0 σ2	σ2
Therefore
C≤
1
σ2.
It is not strictly necessary for the proof to show equality. However, to show equality, let u be a unit
vector, and set X0 = y0 = 0, and X = y = tu. Then
K(tu, tu) — K(tu, 0) — K(0, tu) + K(0, 0)
C ≥ sup ----------------------------------------
t6=0	d(tu, 0) d(tu, 0)
2 - 2exρ(- 2tσ2 )
SUp-------72--------
t6=0	t2
≥ lim 2 - 2exp( 一袅)
t→0	t2
=lim -2exp(-2σ2) ∙ -2σ2
t—→o	2t
1
—
σ2
27
Published as a conference paper at ICLR 2020
where We used I'HOpital's rule to evaluate the limit.	口
Proposition 11. The minimax and non-saturating GAN losses do not satisfy (D3)for some μo.
Proof. For the minimax loss, the Bregman divergence is:
DDJSeI μo)(V μ) = ∣ h1 log ¼μ⅛ dμ0+ 2log jμ⅛ dνi
- Z h 2 log I~~μ01 dμo+2 log I—μ ι dμi
J L2	2μo + 2μ	2	2μo+ 2μ 」
μ
-J 2logFd(ν-μ)
=1 Z log μ0 + μ dμo+ 1 [ h log I~~ν~ι— log	： i dν + 1 log 1
2 7 μo +V 2JL	2 μo + 2 v	μo + μ-∣	2	2
=1 Z log μ0 + μ d(μο + V) + 1 Z log VdV
2 J	μo + v	2 J	μ
=Dkl(1V + 1 μo || 2μ + 2μO) + 2DKL(V || μ),
and for the non-saturating loss, the Bregman divergence is
DDkl(2, +1 μο 11 μο)(V, μ) = / log 2μ0μ+ 2 V 认1V + 1 μο)
一Z log 2 μ0 + 2 μ d(1 μ + 2 μο)
J	μο
+ Z 1log μ0 d(V - μ)
2 2	μο + μ
1/1	μο + U , 1 Λ 1μο + 2V 只：1
=2Jlog E dμ0 + 2 Jlog -μο+μ-dV - 2log2
=Dkl (2V + 2 μο || 2 μ + 1 μO) .
Choosing V to be not absolutely continuous w.r.t. 2μ + 1 μo makes the Bregman divergence ∞,
which is sufficient to show that the Bregman divergence is not bounded by ∣∣μ 一 v∣∣Kr.	口
Proposition 12. The MMD loss with Gaussian kernel satisfies (D3) with β2 = 2π for all μo.
| | x — y || 2
Proof. We work with the Gaussian kernel K(x, y) = e " and USe Proposition 10:
D 2 MMD2(∙,μo)(v,μ) = 2 / K (x,y)(V — μo)(dX)(V — μo)(dy)
一 1 / K(x,y)(μ - μo)(dx)(μ - μo)(dy)
一 /(Κ(χ, y) μ(dy) 一 K(χ, y) μo(dy)) (v 一 μ)(dχ)
=2 / K(χ,y)(V — μ)(dX)(V — μ)(dy)
=1mmd2 (μ, V)
≤ 2σ2 llμ 一 v||Kr，
where the last line is from Lemma 7. The result follows with σ = (2π)-1/2.
The result actually applies more generally for the MMD loss with a differentiable kernel K that
satisfies β2 := supχ,y ∣∣VχVyK(χ,y)k2 < ∞.	口
28
Published as a conference paper at ICLR 2020
Proposition 13 (Moreau-Yosida regularization). Suppose J : M(X) → R is convex, and define
J := J ㊉ R3. Then J is convex, and DJ(V,μ) ≤ 号 ∣∣μ — V∣∣Kr.
Proof. We work on the more general case of K(x, y) = (2πσ2)-d/2 exp(— kx-yk ), and define
~	CL	C
J(μ) = inf J (μ) + F MMDK (μ,μ)
μ	2
for c = σ2(2πσ2)d/2.
Let μ* be the unique minimizer of the infimum, which exists because the function is a strongly
convex. By the envelope theorem, we compute that
d^J(μ + eχ)∣ 0 = d^"f^ ∣∣μ + eχ — μ*∣∣H∣ Q
ae	∣e=o ae 2	∣e=o
=~r^τf(∣∣μ — μ*∣∣H + 2ehμ - μ ,χiH + e2∣∣x∣∣H)I
at 2	Ie=O
=cLhμ — μ*,χ)H
cL
/(μ — μ*) dχ,
X T	-，	.、
so 砧=CL(μ — μ ).
Then
∙-v	∙-v
d j(v, μ) = J(V) — J(μ) —
∙-v
/ Jd(V-μ)
=inf J(V) + ^2^∣∣ν — ν∣∣H — [j(μ*)+ ɪ∣∣μ — μ*∣∣H] —CLhμ - μ ,ν 一 μiH
≤ J(μ*)+ ɪ∣∣v — μ*∣∣H — [j(μ*)+ ɪ∣∣μ — μ*∣∣H] —CLhμ — μ*, v — μiH
=ɪ ∣∣μ - v∣∣H
≤ ɪ ∙ (2πσ2)-d/2 ∙ g∣∣μ — V∣∣kr
2	σ2
=2 ∣∣μ - v∣∣Kr ,
where We used Lemma 7 for the second-to-last line. The proposition follows for σ = (2π)-1/2.
Regarding this choice of σ, it will turn out that in the general case, the dual penalty includes a numer-
ically unfavorable factor of (2πσ2)-d/2, dependent on the dimension of the problem. In practical
applications, such as image generation, d can be quite large, making the accurate computation of
(2πσ2)-d/2 completely infeasible. For numerical stability, We propose choosing the critical param-
eter σ = (2π)-1/2, which corresponds to the dimension-free kernel K(x, y) = e-π∣lx-yll .	□
Lemma 8. Let H be an RKHS with a continuous kernel K on a compact domain X. The convex
conjugate of μ→ 2 ∣∣μ∣∣H is f → 存 ∣∣f∣∣H + χ{f ∈ H}.
29
Published as a conference paper at ICLR 2020
Proof. First we show an upper bound for f ∈ H:
sup h/ fdμ - 2l∣μ∣lH]=
sup
μ
≤ sup
μ
hhf,μiH - 2llμMH]
h||fMhUmUh - 2加息]
≤ SUp h||f ||Hz - λz2i
z∈R	2
= IIfIlH ∙≡-λ ∙≡
	
2	λ2
xr||f ||H-
2λ
To derive a lower bound for general f ∈ C(X), we use the Mercer decomposition of the positive
definite kernel K ,
∞
K(x, y) =	γiφi(x)φi(y)
i=1
where γi ≥ 0 are eigenvalues and {φi}i∞=1 is a complete orthonormal sequence of L2 (X; dx). It is
well-known that the corresponding RKHS is given by
H=
∞
g ∈ L2(X, dx) | X
i=1
(g, φi)2L2 (X)
γi
<∞ ,
and the norm of g ∈ H by
∞
kgk2H = X
j=1
γi
Let f ∈ C(X) ⊂ L2 (X, dx) be an arbitrary function. We replace the supremum of the conjugate
function
sup h/fdμ - 2 l∣μ∣lHi
(31)
by μ ∈ M (X) that has a square-integrable Radon-Nykodim derivative with respect to the LebesgUe
measure dx, and then we have a lower bound. We use μ(χ) for the Radon-Nykodim derivative with
slight abuse of notation.
Suppose f (x) = P∞=1 ajφj (x) and μ(χ) = P∞=1 bjφj (x) are the expansion. Note that, since the
kernel embedding is given by
Z∞
K (χ,y)μ(y) dy = EYj bj φj (X),
j=1
the above maximization is reduced to
∞λ
SUpE aj- bj- χYj b2.
bj j=1
This is maximized when bj = aj /(λγj), and the maximum value is
1 XX a2
2λ 工 Yj
j=1 j
(32)
If f ∈ H, this value is finite, and the lower bound of the conjugate given by is 21λkfkH, WhiChis
the same as the upper bound. If f ∈/ H, the value (32) is infinite, and the conjugate function takes
+∞.
□
30
Published as a conference paper at ICLR 2020
Proposition 14. Let H be an RKHS with the Gaussian kernel K(x,y) = e-n||x-y||2. Then for
f∈H,
∞
IlfllH = X (4∏)-k	X	Qd--7 % …dkd fllL2(Rd)	(21)
k=0	kι+--+kd = k Ili=I i!
=llfML2 (Rd) + 41∏ ||Vf llL2(Rd)+ 16∏2 llV2f llL2(Rd)+ other terms.	(22)
Proof. We consider the more general case of K(x, y) = (2nG2)-d/2eT|x-y||2/2b2, where We have
∞
IlfllH = X (1 σ2)k X	Qd--7 l∣dkl …∂kd f IlL2(Rd)
k=0	kι+--+kd = k IIi=I i'
=llf llL2(Rd) +1 σ2llvf llL2(Rd) +1 σ4lv2 fllL2(Rd) + Otherterms.
Novak et al. (2018) prove this result for σ = -. We sketch the proof for the general case here. We
use the Fourier transform convention that
ʌ
f(k)
(2π)-d/2 /
Rd
f (x) e-ik∙x dx,
f(x)
(2π)-d/2 /
Rd
f(k) eik∙x dk.
Consider the inner product
hf,gi=
Rd
eσ2llkll2/2 f(k) g^(k) dk,
defined for functions llf ll < ∞. Expanding the exponential in Taylor series, this inner product
gives the equation for the norm in the proposition. By use of the Fourier inversion formula, it can be
shown that hf, Kxi = f (x), where
Kx(y) = (2nb2)-d/2eT|x-y||2/2b2,
so this is an RKHS with the Gaussian kernel.
□
31