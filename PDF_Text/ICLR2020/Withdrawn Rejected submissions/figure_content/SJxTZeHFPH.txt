Figure 1: Metrics to capture how model calibration changes over training epochs in a ResNet-50network trained on CIFAR-10.
Figure 2: Top row: reliability plots using 25 confidence bins. Bottom row: % of samples in eachbin, computed over the training set at epochs 100, 200, 300 and 350.
Figure 3: Metrics to compare the calibrations of several ResNet-50 networks trained on CIFAR-10,using either cross-entropy loss, or focal loss with γ set to 1, 2 or 3.
Figure 4: (a): g(p, γ) vs p and (b-d): histogram of the gradient norms of the last linear layer for bothcross entropy and focal loss.
Figure 5: (a): Norm of logits (b): Norm of weights.
Figure 6: (a): Confidence of mis-classifications (b): Decision boundary of linear classifier trainedusing cross entropy (c): Decision boundary of linear classifier trained using focal lossH Focal Loss Minimises Regularised B regman DivergenceIn this section, we show that just like Cross Entropy minimizes an upper bound on the KL-Divergencebetween the true distribution p and the predicted distribution q, focal loss minimizes a regularized KLdivergence between p and q. We use FLγ(p, q) and CE(p, q) to denote the focal loss with parameter17Under review as a conference paper at ICLR 2020γ and cross entropy between p and q respectively and K to denote the number of classes.
Figure 7: Optimal q for various values of P and Y18Under review as a conference paper at ICLR 2020Cross EntropyBrier ScoreMMCEFocal LossCross EntropyBrier ScoreMMCEFocal LossActual Label： CatPredicted Label： CatConfidence (Pre T)： 0.9999Confidence (Post T)： 0.9880Actual Label： ShipPredicted Label: ShipConfidence (Pre T)： 0.9999Confidence (Post T)： 0.9919Actual Label: Airplane
Figure 8: Qualitative results showing the performance of Cross Entropy, Brier Score, MMCE andFocal Loss (sample-wise γ 5,3) for a ResNet-50 trained on CIFAR-10. The first row of images havebeen correctly classified by networks trained on all four loss functions and the second row of imageshave all been incorrectly classified. For each image, we present the actual label, the predicted labeland the confidence of the prediction both before and after temperature scaling.
