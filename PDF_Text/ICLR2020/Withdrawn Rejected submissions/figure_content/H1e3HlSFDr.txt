Figure 1: a). For VAE, the green circle denotes the prior distribution. All the latent distributionsfrom both safe and dangerous states map into a compact region near each others, which has nocapability to distinguish the safe and dangerous stateb). For CRM, there are two latent space. Wehope all the dangerous state maps to the white space after inference, while normal state maps to thegreen space after inference. The figure shows when the trajectories drive into a dangerous situation,the latent distribution will move close to white latent space from green latent space. Our method isable to separate the safe and dangerous latent space.
Figure 2: Overview of the data flow of Conditional Representation Model for both training andinference stages.1). Training Stage: During interaction with the environment, the agent collects bothdangerous and safe states. Through the encoder qφ , where φ are the hyperparameters of the network(more details on the neural network architecture can be found in Appendix B),we expected all thedangerous state maps to the arbitrary prior distribution p(z|S = 1), and all the safe state maps to theanother arbitrary prior distribution p(z|S = 0), contributing to the first term of the objective functionmin Dkl (qφ (z∣x)∣pθ (z∣c)). To verify the inferred distribution carrying effective information, wesample from inferred latent distribution qφ(z|x) then use a decoder to reconstruct the original databased on the samples, forming the second term of the objective function ∣X0 - X∣2 . 2). InferenceStage: The agent uses encoder to infer latent information and formulates safety cost by Wassersteindistance. Finally,an CMDP reinforcement learning algorithm is employed to update the policy withsafety cost and reward.
Figure 3: The curve of safety cost.X-axis indicates the value of Wasserstein distance and Y-axisindicates the value of safety cost. The red dot indicates the threshold of safe Wasserstein distance,under which the state is regarded as potentially dangerous.
Figure 4: The figure depicts the bird’s-eye view of the double-lane four-exit roundabout with anintersection network in two different traffic situations.. The number denotes the index of differentexits/entrances. The ego vehicle is in blue, while other vehicles are green and yellow, indicating ifvehicles are in the range of the radar. Congested traffic: around 24-30 vehicles are in the roundaboutat the same time. Regular traffic: around 12-15 vehicles are in the roundabout at the same time.
Figure 5: Training of CRM. X-axis indicates the training steps in thousand and Y-axis indicates theloss of CRM. The shadowed region shows the 1-SD confidence interval over 5 random seeds.
Figure 6: Success rate of agents trained by SSAC with and without CRM during training. X-axisindicates the training steps in thousand and Y-axis indicates the success rate. The shadowed regionshows the 1-SD confidence interval over 5 random seeds.
Figure 7: Success rate of agents trained by SSAC with CRM under different d. X-axis indicates thetraining steps in thousand and Y-axis indicates the success rate. The shadowed region shows the 1-SDconfidence interval over 5 random seeds.
