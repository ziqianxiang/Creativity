Figure 1: (a) Two 4x4 Sudokus: The cells in each row, column, and any of the four 2x2 boxesinvolving the corner cells have non-repeating digits. (b) Two overlapping Sudokus, with a mixtureof two digits in each cell: one from 1 to 4 and the other from 5 to 8. In Multi-MNIST-Sudoku, thedigits of two overlapping hand written Sudokus (b) have to be de-mixed (as done by DRNets in (c)).
Figure 2: Deep Reasoning Networks (DRNets) perform end-to-end deep reasoning by encoding alatent space of the input data that captures prior knowledge constraints and is used by a generativedecoder to generate the targeted output. (a) Prior knowledge includes prototypes of digits, whichare used to pre-train and build the decoder’s generative module, and Sudoku’s rules, which helpDRNet reason about the overlapping digits. (b) Reasoning modules batch data points involved in thesame constraints (cells in rows, columns, blocks of a Sudoku) together, enforce that the structure ofthe latent space satisfies prior knowledge, and dynamically adjust the weights of constraints basedon their satisfiability. (c) The overall objective combines responses from the generative decoder(thinking fast) and the reasoning modules (thinking slow).
Figure 3:	The reduction flow of Deep Reasoning Networks.
Figure 4:	Examples of continuous relaxations: ei,j , Pi , Qi , PM denote binary variables, the discretedistribution over digits 1 to 4, the discrete distribution over digits 5 to 8, and the discrete distributionover values 1 to M .
Figure 5: Left: The latent space of DRNets for Multi-MNIST-Sudoku. Right: Accuracy comparison.
Figure 6: The latent sPace of DRNets for Crystal-Structure-Phase-MaPPing. M denotes the numberof Possible Phases. (For Al-Li-Fe, M = 159; For Bi-Cu-V, M = 100.)Crystal-Structure-Phase-Mapping concerns inferring crystal structures from a set of X-ray diffrac-tion measurements (XRDs) of a given chemical system, satisfying thermodynamic constraints. Crystalstructure Phase maPPing is a very challenging task, a major bottleneck in high-throughPut materialsdiscovery: Each X-ray measurement may involve several mixed crystal structures; each chemicalsystem includes hundreds of Possible crystal structures; for each crystal structure Pattern, we onlyhave a theoretical (idealized) model of Pure crystal Phases; the thermodynamic rules are also comPlex;and the crystal Patterns are difficult for human exPerts to interPret. Herein, we illustrate DRNetfor crystal structure Phase maPPing for two chemical systems: (1) a ternary Al-Li-Fe oxide system(Le Bras et al., 2014), which is theoretically based, synthetically generated, with ground truth solu-tions, and (2) a ternary Bi-Cu-V oxide system, which is a more challenging real exPeriment-basedsystem, more noisy and uncertain. For each system, each inPut data Point is the XRD of a mixtureof crystal structures. Additionally, the inPut includes the composition graph sPecifying elementalcomPositions and the constraint graph of the data Points. We also collected a library of Possiblecrystal structures from the International Centre for Diffraction Data (ICDD) database. Each crystal7Under review as a conference paper at ICLR 2020structure (also named phase) is given as a list of diffraction peak location-amplitude pairs, (referredto as stick pattern), representing the ideal phase patterns measured in a perfect condition (see Fig.6).
Figure 7: Left: Comparison of phase concentration and reconstruction loss for different methodsin Al-Li-Fe oxide system. Note that, 6 pure phases (out of 159 possible candidates) appear in thesystem and result in 15 different mixtures. Each dot represents an XRD measurement whose sizeis proportional to the estimated phase concentration. DRNet’s phase concentration closely matchthe ground truth in contrast to IAFD’s and NMF-k’s. The heatmap on the right shows that DRNetsreconstruct the XRD measurements much better than other methods with respect to the L1 loss.
Figure 8: Examples of continuous relaxations: ei,j , Pi, Qi, PM , Nc, Nl, Kj , λh, Bi denote binaryvariables, the discrete distribution over digits 1 to 4, the discrete distribution over digits 5 to 8, thediscrete distribution over values 1 to M , the number of clauses, the number of literals, the numberof literals in the j -th clause, the weights of entropy terms, and the Bernoulli distribution for the i-thliteral. ”leaky_relu” is the leaky ReLU.
Figure 9: Accuracy comparison. We show ”test time + training time” for supervised baselines andthe generalization mode of DRNet, and ”solving time” for the optimization mode of DRNets.
Figure 10: Deep reasoning networks (DRNets) for crystal-structure-phase-mapping. (a) Priorknowledge includes the ICDD stick patterns of possible pure phases, which are used to build the GMMgenerative module in the decoder, and the thermodynamic rules that help DRNets reason about themixture of XRD patterns. (b) reasoning modules batch data points involved in a connected componentof the constraint graph (a path in the composition graph) together, enforce that the structure of thelatent space satisfies prior knowledge, and dynamically adjust the weights of constraints based ontheir satisfiability. (c) The overall objective combines responses from the generative decoder and thereasoning modules.
Figure 11: The composition graph of the Al-Fe-Li oxide system. The red path is a sampled path inthe composition graph.
Figure 12: Some examples of stick patterns and their corresponding Gaussian Mixture Models. Thehorizontal axis denotes the Q values, and the vertical axis denotes the diffraction intensity.
Figure 13: DRNetS' solution for the Bi-Cu-V oxide system. a. The de-mixed crystal phases for the 353XRD measurements of the Bi-Cu-V oxide system (each plot includes the signal for the recognized phase andthe corresponding ICDD stick pattern). b. DRNets’ phase concentration maps for the corresponding phaseson the left of the map. Dot sizes are proportional to their estimated phase concentrations and heatmap denotesestimated shifting (alloying). c. DRNets’ crystal phase map for the Bi-Cu-V-O system in the composition graph;the phase fields are labeled with corresponding crystal phases.
Figure 14: Comparison of the activation map and the heatmap of L1 reconstruction loss fordifferent methods for the Bi-Cu-V oxide system: Each row denotes the activation of the differentphases for the the different methods; Though we do not have ground truth for the Bi-Cu-V oxide sys-tem, the solution generated by DRNets satisfies all thermodynamic rules with excellent reconstructionperformance; The heatmap on the right shows that DRNets reconstruct the XRD measurements muchbetter than other methods with respect to the (log scale) L1 reconstruction under physical constraintsof decomposed phases; In addition, materials science experts thoroughly checked DRNets’ solutionof Bi-Cu-V oxide system, approved it, and subsequently discovered a new material that is importantfor solar fuels technology.
Figure 15: A standard 9-by-9 Sudoku puzzle: a partially filled Soduku has to be completed as avalid Sudoku.
