Figure 1: Examples of crystal unit cells. Each example shows the unit cell of a crystal. Different colorsrepresent different atomic species. A red, green, and blue line represent the 3 axes of the crystal. Note that theyvary in length and angle. Additionally, some unit cells have just one or two atoms while others have nearly 100.
Figure 2: Network Architecture. We encode and decode a 30 × 30 × 30 voxel grid representing 10 A on eachside. Each voxel contains the value of the density. The output of the decoder is passed into a 3-D U-Net Ciqeket al. (2016). We train the two models in parallel. In the schematic, we show the crystal represented as a repeatedunit cell rather than a single unit cell. The black arrows indicate deterministic transformations. From the ciffile, the species matrix is constructed. From this, the density matrix is computed.
Figure 3: Single unit cell accuracy. (A) We show the voxel wise reconstruction error (plotted with mean squareerror) during training. (B) For random molecules in the test set, we plot the number of true atoms and thenumber of recovered atoms after segmentation. (C) For the reconstructed atoms, we plot the predicted atomicnumber versus the atomic number of the nearest true atom. (D) We compute the distance from each true atom tothe nearest predicted atom and vice-versa (orange and blue, respectively). (E) For three different crystals weplot the predicted versus reconstructed density at each voxel. We also show 2-D slices through the target andprediction, along with the 3-D reconstructions. For plotting, the density on each figure is normalized between 0and 1 though is not decoded as such.
Figure 4: Species reconstruction and latent space interpolation. (A) For five different randomly selectedcrystal unit cells we show the target and our reconstruction. Atoms are colored using default atomic colors,atoms with similar atomic number do not necessarily have similar colors. (B) We show the reconstruction oflatent space interpolation between two molecules for 3 random sets of targets. For a video, see the Appendix.
Figure 5: Decode random latent space vectors. (A) We look at the spacing between nearest atoms from randomdraws from the latent space compared to those from real crystal structures. In blue we show the distribution ofrandom reconstructions. In red we show the distribution of true inter-atomic spacing. (B) For 5 different randomlatent space vectors, we show the reconstructed density field and the resulting segmentation. Notice that in somecases small amounts of density are predicted but are not segmented into an atom (for example, in columns 3 and4).
Figure S6: Accuracy of Model. (A) For each position in 3-D space, we plot the predicted and target density for4 different random crystals from the test set. The red dashed line is an identity line. (B) For each of the panelsin (A), we show 4 different z-slices through the true and predicted density fields. (C) We show the full 3-Dreconstruction of the prediction and the true density field.
Figure S7: Random Decoded Samples. We randomlJ7ample the latent space Z 〜N(0,1). We show a seriesof examples (from three different views) of different complexity. Note that while symmetry is not preserved,various geometric motifs are.
Figure S8:	Repeating unit cell accuracy. (A) For each position in 3-D space, we compute the differencebetween the truth and the reconstruction. We show different percentile bands of the reconstruction error betweenthe target and predicted density, plotted using the mean square error (MSE). (B) For the species matrix fromU-Net we ask what the error of top-1 predictions is between our predictions and the ground truth. (C) For oursegmented matrices, we ask the distance from the nearest segmented atom to the ground truth. We show thedistance errors by percentile for both the nearest true atom to each predicted atom and vice-versa (orange andblue, respectively). (D) After segmenting the reconstructed density maps we show the predicted and true numberof atoms. (E) We plot the predicted nearest atom species versus the true species of the closest correspondingatom, as long as the distance is less than 0.5 A. We find 65.4% are correctly predicted.
Figure S9:	Interpolation between two molecules. In (A) we show the interpolation between two crystal densitymaps. We show three equally spaced intermediates the corresponding segmentation. In (B), we show the sameinterpolation but highlight different two dimensional slices (y-axis). Along the x-axis we label the fraction of theway between the two latent space vectors.
