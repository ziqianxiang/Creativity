Figure 1: Key limitations of Jin et al. (2019)â€™s approach: a) Since their tree and graph decoders areisolated, the model can generate invalid junction trees which cannot be assembled into any molecule.
Figure 2: Overview of our approach. Each substructure   i is a subgraph of a molecule (e.g., rings).
Figure 3: Illustration of hierarchical graph decoding. Suppose the decoder is visiting the substructureSk. 1) It decides to add a new substructure (topological prediction). 2) It predicts that new substructureSt should be a ring (substructure prediction) 3) It predicts how this new ring should be attached tothe graph (attachment prediction). Finally, the decoder moves to St and repeats the process.
Figure 4: Left: Hierarchical graph encoder. Solid arrows illustrate message passing in each layer.
Figure 6: Illustration of conditional translation. Our model generates different molecules when thetranslation criteria changes.  When g = [1, 1], the model indeed generates a compound with highQED and DRD2 scores. When g = [1, 0], the model predicts another compound inactive to DRD2.
Figure 7: Illustration of AtomG2G decoding process.  Atoms marked with red circles are frontiernodes in the queue    . In each step, the model picks the first node vt from     and predict whether therewill be new atoms attached to vt. If so, it predicts the atom type of new node ut (atom prediction).
Figure 8: Model Ablations: 1) Atom-based decoder; 2) Two-layer encoder; 3) One-layer encoder.
