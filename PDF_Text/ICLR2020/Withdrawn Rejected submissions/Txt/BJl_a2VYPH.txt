Under review as a conference paper at ICLR 2020
Natural Language Adversarial Attack
and Defense in Word Level
Anonymous authors
Paper under double-blind review
Ab stract
Up until very recently, inspired by a mass of researches on adversarial examples
for computer vision, there has been a growing interest in designing adversarial
attacks for Natural Language Processing (NLP) tasks, followed by very few works
of adversarial defenses for NLP. To our knowledge, there exists no defense method
against the successful synonym substitution based attacks that aim to satisfy all
the lexical, grammatical, semantic constraints and thus are hard to perceived by
humans. We contribute to fill this gap and propose a novel adversarial defense
method called Synonym Encoding Method (SEM), which inserts an encoder before
the input layer of the model and then trains the model to eliminate adversarial
perturbations. Extensive experiments demonstrate that SEM can efficiently defend
current best synonym substitution based adversarial attacks with little decay on the
accuracy for benign examples. To better evaluate SEM, we also design a strong
attack method called Improved Genetic Algorithm (IGA) that adopts the genetic
metaheuristic for synonym substitution based attacks. Compared with existing
genetic based adversarial attack, IGA can achieve higher attack success rate while
maintaining the transferability of the adversarial examples.
1	Introduction
Deep Neural Networks (DNNs) have made great success in various machine learning tasks, such
as computer vision (Krizhevsky et al., 2012; He et al., 2016), and Natural Language Processing
(NLP) (Kim, 2014; Lai et al., 2015; Devlin et al., 2018). However, recent studies have discovered
that DNNs are vulnerable to adversarial examples not only for computer vision tasks (Szegedy
et al., 2014) but also for NLP tasks (Papernot et al., 2016), causing a serious threat to their safe
applications. For instance, spammers can evade spam filtering system with adversarial examples of
spam emails while preserving the intended meaning.
In contrast to numerous methods proposed for adversarial attacks (Goodfellow et al., 2015; Nicholas
& David, 2017; Anish et al., 2018) and defenses (Goodfellow et al., 2015; Guo et al., 2018; Song
et al., 2019) in computer vision, there are only a few list of works in the area of NLP, inspired
by the works for images and emerging very recently in the past two years (Zhang et al., 2019).
This is mainly because existing perturbation-based methods for images cannot be directly applied to
texts due to their discrete property in nature. Furthermore, if we want the perturbation to be barely
perceptible by humans, it should satisfy the lexical, grammatical and semantic constraints in texts,
making it even harder to generate the text adversarial examples.
Current attacks in NLP can fall into four categories, namely modifying the characters of a word
(Liang et al., 2017; Ebrahimi et al., 2017), adding or removing words (Liang et al., 2017), replacing
words arbitrarily (Papernot et al., 2016), and substituting words with synonyms (Alzantot et al.,
2018; Ren et al., 2019). The first three categories are easy to be detected and defended by spell
or syntax check (Rodriguez & Rojas-Galeano, 2018; Pruthi et al., 2019). As synonym substitution
aims to satisfy all the lexical, grammatical and semantic constraints, it is hard to be detected by
automatic spell or syntax check as well as human investigation. To our knowledge, currently there
is no defense method specifically designed against the synonym substitution based attacks.
In this work, we postulate that the model generalization leads to the existence of adversarial exam-
ples: a generalization that is not strong enough causes the problem that there usually exists some
neighbors x0 of a benign example x in the manifold with a different classification. Based on this
1
Under review as a conference paper at ICLR 2020
hypothesis, we propose a novel defense mechanism called Synonym Encoding Method (SEM) that
encodes all the synonyms to a unique code so as to force all the neighbors of x to have the same
label of x. Specifically, we first cluster the synonyms according to the Euclidean Distance in the
embedding space to construct the encoder. Then we insert the encoder before the input layer of
the deep model without modifying its architecture, and train the model again to defend adversarial
attacks. In this way, we can defend the synonym substitution based adversarial attacks efficiently in
the context of text classification.
Extensive experiments on three popular datasets demonstrate that the proposed SEM can effectively
defend adversarial attacks, while maintaining the efficiency and achieving roughly the same accu-
racy on benign data as the original model does. To our knowledge, SEM is the first proposed method
that can effectively defend the synonym substitution based adversarial attacks.
Besides, to demonstrate the efficacy of SEM, we also propose a genetic based attack method, called
Improved Genetic Algorithm (IGA), which is well-designed and more efficient as compared with the
first proposed genetic based attack algorithm, GA (Alzantot et al., 2018). Experiments show that
IGA can degrade the classification accuracy more significantly with lower word substitution rate
than GA. At the same time IGA keeps the transferability of adversarial examples as GA does.
2	Background and Related Work
Let W denote the word set containing all the legal words. Let x = {w1 , . . . , wi, . . . , wn} denote
an input text, C the corpus that contains all the possible input texts, and Y ∈ NK the output space.
The classifier f : C → Y takes an input x and predicts its label f (x), and let Sm(x, y) denote the
confidence value for the y-th category at the softmax layer. Let Syn(w, σ, k) represent the set of
first k synonyms of w within distance σ, namely
Syn(w, σ, k) = {w10 , . . . , wi0, . . . , wk0 |wi0 ∈ W ∧ kw - w10 kp ≤ ... ≤ kw - wk0 kp < σ},
where kw - w0 kp is the p-norm distance evaluated on the corresponding embedding vectors.
2.1	Natural Language Adversarial Examples
Suppose we have an ideal classifier c : C → Y that could always output the correct label for any
input text x. For a subset of (train or test) texts T ⊆ C and a small constant , we could define the
natural language adversarial examples as follows:
A = {xadv ∈ C | ∃x ∈ T, f (xadv) 6= c(xadv) = c(x) = f(x) and d(x - xadv) < },	(1)
where d(x - xadv ) is a distance metric to evaluate the dissimilarity between the benign example
x = {w1, . . . , wi, . . . , wn} and the adversarial example xadv = {w10 , . . . , wi0, . . . , wn0 }. It is usually
defined as thep-norm distance: d(χ - Xadv) = ||x - Xadv ∣∣p = (Pikwi - WiIlp)P.
2.2	Text Adversarial Attacks
In this subsection, we provide a brief overview of three popular synonym substitution based adver-
sarial attack methods.
Greedy Search Algorithm (GSA). Kuleshov et al. (2018) propose a greedy search algorithm to
substitute words with their synonyms so as to maintain the semantic and syntactic similarity. GSA
first constructs a synonym set Ws for an input text X = {w1, . . . , wi, . . . , wn}:
Ws = {Syn(wi, σ, k)|1 ≤ i ≤ n}.	(2)
Initially, let Xadv = X. Then at each stage for Xadv = {w10 , . . . , wi0, . . . , wn0 }, GSA finds a
word wi ∈ W that satisfies the syntactic constraint and minimizes Sm (X, ytrue) where X =
{w1,..., wi-ι, W0, w0+ι,..., wn}, and updates Xadv = X. Such process iterates until Xadv be-
comes an adversarial example or the word replacement rate reaches a threshold.
Genetic Algorithm (GA). Alzantot et al. (2018) propose a population-based algorithm to replace
words with their synonyms so as to generate semantically and syntactically similar adversarial ex-
amples. There are three operators in GA:
2
Under review as a conference paper at ICLR 2020
•	M utate(x): Randomly choose a word wi in text x that has not been updated and substitute
wi with wi0, one of its synonyms Syn(wi, σ, k) that does not violate the syntax constraint by
the “Google 1 billion words language model"(Chelba et al., 2013) and minimize Sm(X, ytrue)
Where X = {wi,..., Wi-1, W0, Wi+1, ..., Wn} and Sm(X, ytrue) < Sm(x, ytrue)；
•	Sample(P): Randomly sample a text from population P with a probability proportional to
1 - Sm(xi, y
true) where xi ∈ P ;
• Crossover(a, b): Construct a new text c = {w1c, . . . , wic, . . . , wnc }, where wic is randomly
chosen from {wia, wib} based on the input texts a = {w1a, . . . , wia, . . . , wna } and b =
{w1b, . . . , wib, . . . , wnb }.
For a text x, GA first generates an initial population P0 of size m:
P0 = {M utate(x), . . . , M utate(x)}.	(3)
Then at each iteration, GA generates the next generation of population through crossover and muta-
tion operators:
xla+1 = arg min Sm(X^,ytrue),
x∈Pi
childik+1 = Crossover(Sample(Pi), Sample(Pi)),	(4)
Pl+1 = {xla+dv1, M utate(childl1+1), . . . , M utate(childlm+-11)}.
GA terminates when it finds an adversarial example or reaches the maximum number of iteration
limit.
Probability Weighted Word Saliency (PWWS). Ren et al. (2019) propose a new synonym sub-
stitution method called Probability Weighted Word Saliency (PWWS), which considers the word
saliency as well as the classification confidence. Given a text x = {w1, . . . , wl, . . . , wn}, PWWS
first calculates the saliency of each word S(x, wl):
S (x,Wl) = Sm(x,ytrue') - Sm(Xi,y,rue') Where Xi = {wι, . . .,Wl-1, Unk ,Wl+1, . . .,Wn}, (5)
where “unk” means the word is removed. Then PWWS calculates the maximum possible change in
the classification confidence resulted from substituting Word wi With one of its synonyms:
∆Smi (X) =	max	[Sm (X, ytrue)- Sm (Xi , ytrue)] Where Xi = {w1 , . . . , wi , . . . , wn }. (6)
wi0 ∈Syn(wi,σ,k)
Then, PWWS sequentially checks the words in descending order of φ(S(x, Wi))ι ∙ ∆Smm.(x), where
φ(z)i = Pneziezk, and substitutes the current word Wi with its optimal synonym w*:
wi = arg max	[Sm(X, ytrue) - Sm(Xi, ytrue)].	(7)
wi0∈Syn(wi,σ,k)
PWWS terminates when it finds an adversarial example Xadv or it has replaced all the words in X.
2.3 Text Adversarial Defenses
There exist very few works for text adversarial defenses.
•	In the character-level, Pruthi et al. (2019) propose to place a word recognition model in front of
the downstream classifier to defend character-level adversarial attacks by combating adversarial
spelling mistakes.
•	In the word level, for defenses on synonym substitution based attacks, only Alzantot et al. (2018)
and Ren et al. (2019) incorporate the adversarial training strategy proposed in the image do-
main (Goodfellow et al., 2015) with their text attack methods respectively, and demonstrate that
adversarial training can promote the model’s robustness. However, there is no defense method
specifically designed to defend the synonym substitution based adversarial attacks.
3
Under review as a conference paper at ICLR 2020
3 The Proposed Text Defense Method
We first introduce our motivation, then present the proposed text defense method, Synonym Encoding
Method (SEM).
3.1	Motivation
Let X denote the input space, V(x) denote the -neighborhood of data point x ∈ X, where V(x) =
{x0 ∈ X |kx0 - xk < }. As illustrated in Figure 1 (a), we postulate that the generalization of the
model leads to the existence of adversarial examples. More generally, given a data point x ∈ X ,
∃x0 ∈ V(x), f(x0) 6= yt0rue where x0 is an adversarial example of x.
Figure 1: The neighborhood of a data point x in the input space. (a) Traditional training: there exists
some data point x0 that the model has never seen before and yields wrong classification, in other
words, such data point x0 will be an adversarial example. (b) Adding infinite labeled data: this is an
ideal case that the model has seen all the data points to resist adversarial examples. (c) Constructing
a convex outer bound: all data points in this polytope will share the label of x. (d) Mapping neigh-
borhood data points: mapping all neighbors to the center x so as to eliminate adversarial examples.
Ideally, to defend the adversarial attack, we need to train a classifier f which not only guarantees
f(x) = ytrue, but also assures ∀x0 ∈ V(x), f(x0) = yt0rue. Thus, the most effective way is to add
more labeled data to improve the adversarial robustness (Schmidt et al., 2018). Ideally, as illustrated
in Figure 1 (b), if we have infinite labeled data, we can train a model f : ∀x0 ∈ V (x), f (x0) = yt0rue
with high probability so that the model f is robust enough to adversarial examples. Practically,
however, labeling data is very expensive and it is impossible to have infinite labeled data.
Because it is impossible to have enough labeled data to train a robust model, as illustrated in Figure
1 (c), Wong & Kolter (2018) propose to construct a convex outer bound and guarantee that all data
points in this bound share the same label. The goal is to train a model f : ∀x0 ∈ V , f (x0) =
f (x) = ytrue. Specifically, they propose a linear-programming (LP) based upper bound on the
robust loss by adopting a linear relaxation of the ReLU activation and minimize this upper bound
during the training. Then they bound the LP optimal value and calculate the elementwise bounds on
the activation functions based on a backward pass through the network. Although their method does
not need any extra data, it is hard to scale to realistically-sized networks due to its high complexity.
In this work, as illustrated in Figure 1 (d), we propose a novel way to find a mapping m : X → X
where ∀x0 ∈ V (x), m(x0) = x. In this way, we force the classification to be more smooth and we
do not need any extra data to train the model or modify the architecture of the model. All we need
to do is to insert the mapping before the input layer and train the model on the original training set.
Now the problem turns into how to locate the neighbors of data point x. For image tasks, it is hard
to find all images in the neighborhood of x in the input space, and there could be infinite number
of neighbors. For NLP tasks, however, utilizing the property that words in sentences are discrete
tokens, we can easily find almost all neighbors of an input text. Based on this insight, we propose a
new method called Synonym Encoding Method to locate the neighbors of an input x .
3.2	Synonym Encoding
We assume that the closer the meaning of two sentences is, the closer their distance is in the input
space. Thus, we can suppose that the neighbors of x are its synonymous sentences. To find the
synonymous sentence, we can substitute words in the sentence with their synonyms. To construct
the mapping m, all we need to do is to cluster the synonyms and allocate a unique token for each
cluster, which we call the Synonym Encoding Method (SEM). The details are in Algorithm 1.
4
Under review as a conference paper at ICLR 2020
Algorithm 1 Synonym Encoding Method
Input: W: dictionary of words, n: size of W, σ: distance for synonyms,
k : number of synonyms for each word
Output: E : encoding result
1:	E = {w1 : None, . . . , wn : None}
2:	for each word wi ∈ W do
3:	ifE[wi] = NONE then
4:	if ∃wj0 ∈ Syn(wi, σ, k), E[wj0 ] 6= NONE then
5:	w* — the closest Wj ∈ W where E[wj] = NONE
6:	E[wi] = E[w* ]
7:	else
8:	E[wi] = wi
9:	end if
10:	for each word wj0 in Syn(wi, σ, k) do
11:	ifE[wj0] = NONE then
12:	E [wj0 ] = E[wi]
13:	end if
14:	end for
15:	end if
16:	end for
17:	return E
4 The Improved Genetic based Text Attack
The current synonym substitution based text adversarial attacks (Alzantot et al., 2018; Kuleshov
et al., 2018; Ren et al., 2019) have a constraint that they only substitute words at the same position
once or replace words with the first k synonyms of the word in the original input x. This constraint
can lead to local minimum for adversarial examples, and it is hard to choose a suitable k as different
words may have different number of synonyms.
To address this issue, we propose an Improved Genetic Algorithm (IGA), which allows to substitute
words in the same position more than once based on the current text x0. In this way, IGA can traverse
all synonyms ofa word no matter what value k is. Meanwhile, we can avoid local minimum to some
extent as we allow the substitution of the word by the original word in the current position. In order
to guarantee that the substituted word is still a synonym of the original word, each word in the same
position can be replaced at most λ times.
Differs to the first genetic based text attack algorithm of Alzantot et al. (2018), we change the
structure of the algorithm, including the operators for crossover and mutation. For more details of
IGA, see Appendix A.
5 Experiments
We evaluate SEM with four attacks, GSA (Kuleshov et al., 2018), GA (Alzantot et al., 2018),
PWWS (Ren et al., 2019) and our IGA, on three popular datasets involving three neural network
classification models. The results demonstrate that SEM can significantly improve the robustness of
neural networks and IGA can achieve better attack performance as compared with existing attacks.
And we further provide discussion on the hyper-parameter of SEM in Appendix B.
5.1	Experimental Setup
We first provide an overview of the datasets and classification models used in the experiments.
Datasets. In order to evaluate the efficacy of SEM, we choose three popular datasets: IMDB, AG’s
News, and Yahoo! Answers. IMDB (Potts, 2011) is a large dataset for binary sentiment classifica-
tion, containing 25, 000 highly polarized movie reviews for training and 25, 000 for testing. AG’s
News (Zhang et al., 2015) consists news article pertaining four classes: World, Sports, Business and
5
Under review as a conference paper at ICLR 2020
Sci/Tech. Each class contains 30, 000 training examples and 1, 900 testing examples. Yahoo! An-
swers (Zhang et al., 2015) is a topic classification dataset from the “Yahoo! Answers Comprehensive
Questions and Answers” version 1.0 dataset with 10 categories, such as Society & Culture, Science
& Mathematics, etc. Each class contains 140,000 training samples and 5,000 testing samples.
Models. To better evaluate our method, we adopt several state-of-the-art models for text classifi-
cation, including Convolution Neural Networks (CNNs) and Recurrent Neural Networks (RNNs).
The embedding dimension for all models are 300 (Mikolov et al., 2013). We replicate the CNN’s
architecture from Kim (2014), which contains three convolutional layers with filter size of 3, 4, and
5 respectively, a max-pooling layer and a fully-connected layer. LSTM consists of three LSTM lay-
ers where each layer has 300 LSTM units and a fully-connected layer (Liu et al., 2016). Bi-LSTM
contains a bi-directional LSTM layer whose forward and reverse have 300 LSTM units respectively
and a fully-connected layer.
Baselines. We take the method of adversarial training (Goodfellow et al., 2015) as our baseline.
However, due to the low efficiency of text adversarial attacks, we cannot implement adversarial
training as it is in the image domain. In the experiments, we adopt PWWS, which is quicker than
GA and IGA, to generate 10% adversarial examples of the training set, and re-train the model incor-
porating adversarial examples with the training data.
5.2	Evaluation on Defense Methods
To evaluate the efficiency of the SEM method, we randomly sample 200 correctly classified exam-
ples on different models from each dataset and use the above attack methods to generate adversarial
examples with or without defense. The more effective the defense method is, the smaller the clas-
sification accuracy of the model drops. Table 1 shows the efficacy of various attack and defense
methods.
Table 1: Accuracy of various classification models on the datasets, with and without defenses, un-
der adversarial attacks. For each model (Word-CNN, LSTM, or Bi-LSTM), if we look at each row,
the highest classification accuracy for various defense methods is highlighted in bold to indicate
the best defense efficacy; if we look at each column, the lowest classification accuracy under var-
ious adversarial attacks is highlighted in Underline to indicate the best attack efficacy. NT: Normal
Training, AT: Adversarial Training.
Dataset Attack WOrd-CNN网_______LSlw)_______Bi-LSlw)
		NT	AT	SEM	NT	Ar	SEM	NT	AT	SEM
	No Attack	88.7	89.1	86.8	87.3	89.6	86.8	88.2	90.3	87.6
	GSA	13.3	16.9	66.4	8.3	21.1	72.2	7.9	20.8	73.1
IMDB	PWWS	4.4	5.3	71.1	2.2	3.6	77.3	1.8	3.2	76.1
	GA	7.1	10.7	71.8	2.6	9.0	77.0	1.8	7.2	71.6
	IGA	0.9	2.7	65.1	0.9	1.8	71.2	0.9	2.7	69.3
	No Attack	91.7	92.2	88.7	91.8	92.1	90.9	91.7	92.2	88.7
AG’s News	GSA	33.0	37.8	63.9	45.9	56.7	83.2	33.0	37.8	63.9
	PWWS	30.7	41.5	67.6	50.0	55.7	85.0	30.7	41.5	67.6
	GA	24.1	40.6	77.9	43.8	57.3	86.4	24.1	40.6	77.9
	IGA	21.5	35.5	70.3	40.0	55.3	81.8	21.5	35.5	70.3
	No Attack	68.4	69.3	65.8	71.6	71.7	69.0	72.3	72.8	70.2
Yahoo! Answers	GSA	19.6	20.8	49.4	27.6	30.5	48.6	24.6	30.9	53.4
	PWWS	10.3	12.5	52.6	21.1	22.9	54.9	17.3	20.0	57.2
	GA	13.7	16.6	59.2	15.8	17.9	66.2	13.0	16.0	63.2
	IGA	8.9	10.0	51.4	10.5	15.1	53.3	12.4	13.5	55.7
For each network model, we look at each row to find the best defense resUlt Under the setting of no
attack, or GSA, PWWS, GA, and IGA attacks:
6
Under review as a conference paper at ICLR 2020
•	Under the setting of no attack, adversarial training (AT) could improve the classification accuracy
of the models on all datasets, as adversarial training (AT) is also the way to augment the training
data. Our defense method SEM reaches an accuracy closing to normal training (NT).
•	Under the four attacks, however, the classification accuracy with normal training (NT) and ad-
versarial training (AT) drops significantly. For normal training (NT), the accuracy degrades more
than 75%, 42% and 40% on the three datasets respectively. And adversarial training (AT) cannot
defend these attacks effectively, especially for PWWS and IGA on IMDB and Yahoo! Answers,
where AT only improves the accuracy a little (smaller than 5%). By contrast, SEM can remark-
ably improve the robustness of the deep models for all the four attacks.
5.3	Defense for Transferability
In the image domain, the transferability of adversarial attack refers to its ability to decrease the
accuracy of models using adversarial examples generated based on other models (Szegedy et al.,
2014; Goodfellow et al., 2015). Papernot et al. (2016) find that the adversarial examples in NLP
also exhibite a good transferability. Therefore, a good defense method not only could defend the
adversarial attacks but also resists the transferability of adversarial examples.
To evaluate the ability of preventing the transferability of adversarial examples, we generate adver-
sarial examples on each model under normal training, and test them on other models with or without
defense on Yahoo! Answers. The results are shown in Table 2. Almost on all models with adversar-
ial examples generated by other models, SEM could yield the highest classification accuracy.
Table 2: Accuracy of various classification models for adversarial examples generated on other mod-
els on Yahoo! Answers for evaluating the transferability. * indicates that the adversarial examples
are generated based on this model.
Attack	Word-CNN(%)			LSTM(%)			Bi-LSTM(%)		
	NT	AT	SEM	NT	AT	SEM	NT	AT	SEM
GSA	19.6*	52.7	57.5	52.6	58.4	61.8	52.7	57.5	59.6
PWWS	10.3*	54.4	57.2	46.5	57.7	61.4	53.1	57.9	56.8
GA	13.7*	49.9	55.2	43.0	66.0	65.6	56.4	65.5	67.4
IGA	8.9*	53.7	56.5	46.5	56.6	58.6	53.1	56.8	57.2
GSA	47.2	52.7	55.9	27.6*	60.9	62.1	53.8	61.9	62.8
PWWS	43.7	54.7	56.5	21.1*	59.9	61.8	50.6	59.2	61.4
GA	41.0	48.5	54.8	15.8*	57.4	57.5	43.4	58.2	60.9
IGA	47.8	53.0	55.2	10.5*	53.4	58.3	53.5	59.0	61.1
GSA	43.7	53.4	54.3	52.9	57.7	58.7	24.6*	60.4	61.1
PWWS	41.7	48.5	49.7	41.2	58.0	60.4	17.3*	60.1	58.6
GA	36.9	45.7	49.0	43.0	58.8	60.7	13.0*	58.2	60.0
IGA	44.8	50.6	52.3	45.1	57.4	58.7	12.4*	60.1	61.1
5.4	Evaluation on attack methods (IGA vs. GA)
For text attacks, we compare the proposed IGA with GA from various aspects, including attack
efficacy, transferability and human evaluation.
Attack Efficacy. As shown in Table 1, looking at each column, we see that under normal training
(NT) and adversarial training (AT), IGA can always achieve the lowest classification accuracy, which
corresponds to the highest attack success rate, on all models and datasets among the four attacks.
Under the third column of SEM defense, though IGA may not be the best among all attacks, IGA
always outperforms GA.
Besides, as depicted in Table 3, IGA can yield lower word substitution rate than GA on most models.
Note that for SEM, GA can yield lower word substitution rate, because GA may not replace the
word as most words cannot bring any benefit for the first replacement. This indicates that GA stops
7
Under review as a conference paper at ICLR 2020
at local minimum while IGA continues to substitute words and gain a lower classification accuracy,
as demonstrated in Table 1.
Table 3: The word substitution rate for GA and IGA on different models.
Dataset Attack	Word-CNN%__________LSTM(%)_________Bi-LSTM(%)
	NT		AT	SEM	NT	AT	SEM	I NT	AT	SEM
IMDB	GA	9.3	9.3	4.3	10.0	10.6	4.0	6.3	8.0	3.1
	IGA	6.4	7.8	6.3	5.3	6.9	5.7	5.6	6.6	7.5
AG’s	GA	10.3	17.7	6.6	18.3	21.2	9.8	12.0	21.4	8.5
News	IGA	12.1	11.4	6.3	14.4	12.0	9.6	13.5	11.6	4.6
Yahoo!	GA	12.4	9.5	4.7	12.5	15.8	8.1	13.9	15.3	4.7
Answers	IGA	6.4	7.1	3.7	7.9	8.2	4.5	3.6	8.2	5.1
Transferability. As shown in Table 2, the adversarial examples generated by IGA maintain roughly
the same transferability as those generated by GA. For instance, ifwe generate adversarial examples
on Word-CNN (column 2, NT), GA can achieve better transferability on LSTM with NT (column 5)
while IGA can achieve better transferability on LSTM with AT and SEM (column 6, 7).
Human Evaluation. To further verify that the perturbations
in the adversarial examples generayed by IGA are hard for
humans to perceive, we also perform a human evaluation on
IMDB with 35 volunteers. We first randomly choose 100 be-
nign examples that can be classified correctly and generate ad-
versarial examples by GA and IGA on the three models so
that we have a total of 700 examples. Then we randomly split
them into 7 groups where each group contains 100 examples.
We ask every five volunteers to classify one group indepen-
dently. The accuracy of human evaluation on benign examples
is 93.7%.
Figure 2: Classification accuracy
by human evaluation.
As shown in Figure 2, the classification accuracy of human on
adversarial examples generated by IGA is slightly higher than those generated by GA, and is slightly
closer to the accuracy of human on benign examples.
Summary. IGA can achieve the highest attack success rate when compared with previous synonyms
substitution based adversarial attacks and yield lower word replacement rate than GA. Besides, the
adversarial examples generated by IGA maintains the same transferability as GA does and are a
little bit harder for humans to distinguish. Several generated adversarial examples by GA and IGA
are listed in Appendix C.
6	Conclusion
Synonym substitution based adversarial attacks are currently the best text attack methods, as they
are hard to be checked by automatic spell or syntax check as well as human investigation. In this
work, we propose a novel defense method called Synonym Encoding Method (SEM), which encodes
the synonyms of each word to defend adversarial attacks for text classification task. Extensive
experiments show that SEM can defend adversarial attacks efficiently and degrade the transferability
of adversarial examples, at the same time SEM maintains the classification accuracy on benign data.
To our knowledge, this is the first and efficient text defense method in word level for state-of-the-art
synonym substitution based attacks.
In addition, we propose a new text attack method called Improved Genetic Attack (IGA), which in
most cases can achieve much higher attack success rate as compared with existing attacks, at the
same time IGA could maintain the transferability of adversarial examples.
8
Under review as a conference paper at ICLR 2020
References
Moustafa Alzantot, Yash Sharma, Ahmed Elgohary, Bo-Jhang Ho, Mani B. Srivastava, and Kai-Wei
Chang. Generating Natural Language Adversarial Examples. In Empirical Methods in Natural
Language Processing (EMNLP), pp. 2890-2896, 2018.
Athalye Anish, Carlini Nicholas, and Wagner David. Obfuscated Gradients Give a False Sense
of Security: Circumventing Defenses to Adversarial Examples. International Conference on
Machine Learning (ICML), 2018.
Ciprian Chelba, Tomas Mikolov, Mike Schuster, Qi Ge, Thorsten Brants, Phillipp Koehn, and Tony
Robinson. One Billion Word Benchmark for Measuring Progress in Statistical Language Model-
ing. arXiv Preprint arXiv:1312.3005, 2013.
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of Deep
Bidirectional Transformers for Language Understanding. North American Chapter of the Associ-
ation for Computational Linguistics: Human Language Technologies (NAACL-HLT), 2018.
Javid Ebrahimi, Anyi Rao, Daniel Lowd, and Dejing Dou. Hotflip: White-box Adversarial Examples
for Text Classification. Annual Meeting of the Association for Computational Linguistics (ACL),
2017.
Ian Goodfellow, Jonathon Shlens, and Christian Szegedy. Explaining and Harnessing Adversarial
Examples. International Conference on Learning Representations (ICLR), 2015.
Chuan Guo, Mayank Rana, Moustapha Cisse, and Maaten Laurens. Countering Adversarial Images
using Input Transformations. International Conference on Learning Representations (ICLR),
2018.
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep Residual Learning for Image
Recognition. Computer Vision and Pattern Recognition (CVPR), 2016.
Yoon Kim. Convolutional Neural Networks for Sentence Classification. Empirical Methods in
Natural Language Processing (EMNLP), 2014.
Alex Krizhevsky, Ilya Sutskever, and Geoffrey Hinton. ImageNet Classification with Deep Convo-
lutional Neural Networks. Neural Information Processing Systems (NeurIPS), 2012.
Volodymyr Kuleshov, Shantanu Thakoor, Tingfung Lau, and Stefano Ermon. Adversarial Ex-
amples for Natural Nanguage Classification Problems. OpenReview submission OpenRe-
view:r1QZ3zbAZ., 2018.
Siwei Lai, Liheng Xu, Kang Liu, and Jun Zhao. Recurrent Convolutional Neural Networks for Text
Classification. In AAAI Conference on Artificial Intelligence (AAAI), 2015.
Bin Liang, Hongcheng Li, Miaoqiang Su, Pan Bian, Xirong Li, and Wenchang Shi. Deep Text
Classification Can be Fooled. International Joint Conference on Artificial Intelligence (IJCAI),
2017.
Pengfei Liu, Xipeng Qiu, and Xuanjing Huang. Recurrent Neural Network for Text Classification
with Multi-task Learning. International Joint Conference on Artificial Intelligence (IJCAI), 2016.
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean. Efficient Estimation of Word Repre-
sentations in Vector Space. International Conference on Learning Representations (ICLR), 2013.
Carlini Nicholas and Wagner David. Towards Evaluating the Robustness of Neural Networks. IEEE
Symposium on Security and Privacy, 2017.
Nicolas Papernot, Patrick McDaniel, Ananthram Swami, and Richard Harang. Crafting Adversarial
Input Sequences for Recurrent Neural Networks. In IEEE Military Communications Conference
(MILCOM), pp. 49-54. IEEE, 2016.
Christopher Potts. On the Negativity of egation. Proceedings of Semantics and Linguistic Theory
(SALT), 2011.
9
Under review as a conference paper at ICLR 2020
Danish Pruthi, Bhuwan Dhingra, and Zachary C Lipton. Combating Adversarial Misspellings with
Robust Word Recognition. Association for Computational Linguistics (ACL), 2019.
Shuhuai Ren, Yihe Deng, Kun He, and Wanxiang Che. Generating Natural Language Adversarial
Examples through Probability Weighted Word Saliency. Association for Computational Linguis-
tics (ACL), 2019.
Nestor Rodriguez and Sergio Rojas-Galeano. Shielding Googles Language Toxicity Model against
Adversarial Attacks. arXiv preprint arXiv:1801.01828, 2018.
Ludwig Schmidt, Shibani Santurkar, Dimitris Tsipras, Kunal Talwar, and Aleksander Mdry. Ad-
versarially Robust Generalization Requires More Data. Neural Information Processing Systems
(NeurIPS), 2018.
Chuanbiao Song, Kun He, Liwei Wang, and John Hopcorft. Improving the Generalization of Adver-
sarial Training with Domain Adaptation. International Conference on Learning Representations
(ICLR), 2019.
Christian Szegedy, Wojciech Zaremba, Ilya Sutskever, Joan Bruna, Dumitru Erhan, Ian Goodfellow,
and Rob Fergus. Intriguing Properties of Neural Networks. International Conference on Learning
Representations (ICLR), 2014.
Eric Wong and Zico Kolter. Provable Defenses via the Convex Outer Adversarial Polytope. Inter-
national Conference on Machine Learning (ICML), 2018.
Wei Emma Zhang, Quan Z. Sheng, and Ahoud Abdulrahmn F. Alhazmi. Generating Textual Adver-
sarial Examples for Deep Learning Models: A Survey. CoRR, abs/1901.06796, 2019.
Xiang Zhang, Junbo Zhao, and Yann LeCun. Character-level Convolutional Networks for Text
Classification. Neural Information Processing Systems (NeurIPS), 2015.
10
Under review as a conference paper at ICLR 2020
A Details of IGA
Here we introduce our Improved Genetic Algorithm (IGA) in details and show how IGA differs from
the first proposed generic attack method, GA (Alzantot et al., 2018). Regard a text as a chromosome,
there are two operators in IGA:
•	Crossover(a,b): For two texts a and b where a = {w1a, . . . , wia-1, wia, wia+1 , . . . , wna} and
b = {w1b, . . . , wib-1, wib, wib+1, . . . , wnb }, randomly choose a crossover point i from 1 to n, and
generate a new text c = {w1a, . . . , wia-1, wia, wib+1, . . . , wnb }.
•	M utate(x, wi): For a text x = {w1 , . . . , wi-1 , wi, wi+1 , . . . , wn} and a position i, replace wi
with Wi where Wi ∈ Syn(w,σ, k) to get a new text X = {wι,..., wi-ι, Wi, wi+ι,..., wn} that
minimizes Sm(X, ytrue).
The details of IGA are described in Algorithm 2.
Algorithm 2 The Improved Genetic Algorithm
Input: x: input text, ytrue : true label for x, M : maximum number of iterations
Output: xadv : adversarial example
1	: for each word Wi ∈ x do
2	P0 - MUtate(X,Wi)
3	: end for
4	: for g = 1 → M do
5	:	Xadv = arg minxi ∈P g Sm(Xi, y true)
6	: if f (Xadv ) 6= ytrue then
7	:	return Xadv
8	: end if
9	Pg — Xadv
10	: for i = 2 → |Pg-1 | do
11	:	Randomly sample parent1 , parent2 from Pg-
12	:	child = Crossover(parent1, parent2)
13	:	Randomly choose a word W in child
14	Pg — MUtate(Child,ιW)
15	: end for
16	: end for
17	: return Xadv
1
Compared with GA, IGA has the following differences:
•	I nitialization: GA initializes the first population randomly, while IGA initializes the first pop-
ulation by replacing each word by its optimal synonym, so our population is more diversified.
•	M utation: Different from GA, IGA allows to replace the word that has been replaced before so
that we can avoid local minimum.
•	Crossover : To better simulate the reproduction and biological crossover, we randomly cut the
text from two parents and concat two fragments into a new text rather than randomly choose a
word of each position from the two parents.
The selection of the next generation is similar to GA, greedily choose one offspring, and then gener-
ate other offsprings by Mutate(Crossover(∙, ∙)) on two randomly chosen parents. BUt as Mutate
and Crossover are different, IGA has very different offsprings.
B Hyper-parameter study on SEM
To explore how hyper-parameter of SEM inflUences the efficacy, we try different ranging from 0
to 1.2 for three models on IMDB with or withoUt adversarial attacks. The resUlts are illUstrated in
FigUre 3.
On benign data, as shown in FigUre 3(a), the classification accUracy of the models decreases a little
when increases. BecaUse a bigger indicates that we need less words to train the model, which
11
Under review as a conference paper at ICLR 2020
could degrade the efficacy of the models. Nevertheless, the classification accuracy does not decrease
much as SEM could maintain the semantic invariance of the original text after encoding.
Then we show the defense efficacy of SEM on the three models when changing the value of , as
shown in Figure 3(b)-(d). When = 0 where SEM could not take any impact, we see that the
accuracy is the lowest under all attacks. When increases, SEM starts to defend the attacks, the
accuracy increases rapidly and reach the peak when = 0.5. Then the accuracy decays slowly ifwe
continue to increase . Thus, we choose = 0.5 to be a good trade-off on the accuracy of benign
examples and adversarial examples.
(a) Models under no attack
(b) Word-CNN under attacks
(c) LSTM under attacks
Figure 3: The classification accuracy for various ranging from 0 to 1.2 for three models on IMDB.
(d) Bi-LSTM under attacks
C Adversarial Examples Generated by GA and IGA
To show the generated adversarial examples, we randomly pick some benign examples from IMDB
and generate adversarial examples by GA and IGA respectively on several models. The examples
are shown in Table 5 to Table 6. We see that IGA substitutes less words than GA on these models
under normal training.
12
Under review as a conference paper at ICLR 2020
Table 4: The adversarial examples generated by GA and IGA on IMDB using Word-CNN model.
	Confidence(%)	Prediction	Text
Original	97.9	1	I enjoyed this film which I thought was well written and acted , there was plenty of humour and a provoking story- line, a warm and enjoyable experience with an emotional ending.
	99.7	0	I am sorry but this is the worst film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make an- other. This is the least scary film I have ever watched and laughed all the way through to the end.
	95.8	1	This is a unique masterpiece made by the best director ever lived in the ussr. He knows the art of film making and can use it very well. If you find this movie, buy or copy it!
GA	50.6	0	I cared this film which I thought was well written and acted, there was plenty of humour and a igniting story- line, a tepid and enjoyable experience with an emotional ending.
	92.7	1	I am sorry but this is the harshest film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make another. This is the least scary film I have ever watched and laughed all the way through to the end.
	59.0	0	This is a sole masterpiece made by the nicest director per- manently lived in the ussr. He knows the art of film mak- ing and can use it much well. If you find this movie, buy or copy it!
IGA	88.3	0	I enjoyed this film which I think was well written and acted, there was plenty of humour and a causing story- line, a lukewarm and enjoyable experience with an emo- tional ending.
	70.8	1	I am sorry but this is the hardest film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make another. This is the least scary film I have ever watched and laughed all the way through to the end.
	54.8	0	This is a sole masterpiece made by the best director per- manently lived in the ussr. He knows the art of film mak- ing and can use it very well. If you find this movie, buy or copy it!
13
Under review as a conference paper at ICLR 2020
Table 5: The adversarial examples generated by GA and IGA on IMDB using LSTM model.
	Confidence(%)	Prediction	Text
Original	99.9	1	I enjoyed this film which I thought was well written and acted , there was plenty of humour and a provoking story- line, a warm and enjoyable experience with an emotional ending.
	97.2	0	I am sorry but this is the worst film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make an- other. This is the least scary film I have ever watched and laughed all the way through to the end.
	99.7	1	This is a unique masterpiece made by the best director ever lived in the ussr. He knows the art of film making and can use it very well. If you find this movie, buy or copy it!
GA	88.2	0	I enjoyed this film which I thought was well written and proceeded, there was plenty of humorous and a igniting storyline, a tepid and enjoyable experience with an emo- tional terminate.
	99.9	1	I am sorry but this is the hardest film I have ever seen in my life. I cannot believe that after making the first one in the series they were able to get a budget to make another. This is the least terrifying film I have ever watched and laughed all the way through to the end.
	68.9	0	This is a unique masterpiece made by the best superin- tendent ever lived in the ussr. He knows the art of film making and can use it supremely alright. If you find this movie, buy or copy it!
IGA	72.1	0	I enjoyed this film which I thought was well written and acted, there was plenty of humour and a provoking story- line, a lukewarm and agreeable experience with an emo- tional ending.
	99.8	1	I am sorry but this is the hardest film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make another. This is the least scary film I have ever watched and laughed all the way through to the end.
	86.2	0	This is a sole masterpiece made by the best director ever lived in the ussr. He knows the art of film making and can use it very well. If you find this movie, buy or copy it!
14
Under review as a conference paper at ICLR 2020
Table 6: The adversarial examples generated by GA and IGA on IMDB using Bi-LSTM model.
	Confidence(%)	Prediction	Text
Original	99.6	1	I enjoyed this film which I thought was well written and acted , there was plenty of humour and a provoking story- line, a warm and enjoyable experience with an emotional ending.
	97.0	0	I am sorry but this is the worst film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make an- other. This is the least scary film I have ever watched and laughed all the way through to the end.
	95.3	1	This is a unique masterpiece made by the best director ever lived in the ussr. He knows the art of film making and can use it very well. If you find this movie, buy or copy it!
GA	98.2	0	I enjoyed this film which I thought was well written and proceeded, there was plenty of humorous and a igniting storyline, a tepid and enjoyable experiment with an emo- tional terminate.
	78.8	1	I am sorry but this is the hardest film I have ever seen in my life. I cannot believe that after making the first one in the series, they were able to get a budget to make another. This is the least scary film I have ever watched and laughed all the way through to the end.
	98.8	0	This is a unique masterpiece made by the best superin- tendent ever lived in the ussr. He knows the art of film making and can use it supremely alright. If you find this movie buy or copy it!
IGA	81.2	0	I enjoyed this film which I thought was alright written and acted, there was plenty of humour and a arousing storyline, a lukewarm and enjoyable experiment with an emotional ending.
	78.8	1	I am sorry but this is the hardest film I have ever seen in my life. I cannot believe that after making the first one in the series they were able to get a budget to make another. This is the least scary film I have ever watched and laughed all the way through to the end.
	98.9	0	This is a sole masterpiece made by the best director ever lived in the ussr. He knows the art of film making and can use it very alright. If you find this movie buy or copy it!
15