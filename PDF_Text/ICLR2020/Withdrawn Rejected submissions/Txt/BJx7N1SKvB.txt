Under review as a conference paper at ICLR 2020
A Random Matrix Perspective on Mixtures of
Nonlinearities in High Dimensions
Anonymous authors
Paper under double-blind review
Ab stract
One of the distinguishing characteristics of modern deep learning systems is that
they typically employ neural network architectures that utilize enormous numbers
of parameters, often in the millions and sometimes even in the billions. While
this paradigm has inspired significant research on the properties of large networks,
relatively little work has been devoted to the fact that these networks are often used
to model large complex datasets, which may themselves contain millions or even
billions of constraints. In this work, we focus on this high-dimensional regime in
which both the dataset size and the number of features tend to infinity. We analyze
the performance of a simple regression model trained on the random features
F = f(WX + B) for a random weight matrix W and random bias vector B,
obtaining an exact formula for the asymptotic training error on a noisy autoencoding
task. The role of the bias can be understood as parameterizing a distribution over
activation functions, and our analysis directly generalizes to such distributions,
even those not expressible with a traditional additive bias. Intriguingly, we find
that a mixture of nonlinearities can outperform the best single nonlinearity on the
noisy autoecndoing task, suggesting that mixtures of nonlinearities might be useful
for approximate kernel methods or neural network architecture design.
1	Introduction
It is undeniable that in recent years deep learning systems have found widespread success in their
applications to a diverse and ever-expanding set of domains. The foundational results on many tasks
such as image recognition (Krizhevsky et al., 2012), speech recognition (Hinton et al., 2012), and
machine translation (Wu et al., 2016), have begun to make their way into higher-level products that
people interact with and rely upon in their daily lives. Whether these products generate a medical
diagnosis, a navigation decision, or some other important output, it is crucial to understand the
inner-workings of the deep learning algorithms that generate them.
Unfortunately, our theoretical understanding of these deep learning algorithms continues to lag behind
their impressive practical successes. One main challenge in building a fuller understanding stems
from the fact that deep neural networks are complex nonlinear functions that employ millions or
even billions (Shazeer et al., 2017) of parameters. Traditional wisdom would suggest that to this
parameter complexity corresponds to an optimization difficulty. Recent work, however, suggests that
as the width of a network’s hidden layers becomes large, the loss function simplifies and a theoretical
analysis becomes tractable (Jacot et al., 2018; Mei et al., 2018; Chizat & Bach, 2018a; Mei et al.,
2019; Rotskoff et al., 2019; Rotskoff & Vanden-Eijnden, 2018). In some scenarios, the simplification
is such that throughout training the parameters of the model stay within an infinitesimal radius of
their initial (random) values, implying that much about neural network training can be understood by
studying the random initialization (Jacot et al., 2018; Chizat & Bach, 2018b; Lee et al., 2019).
Another main challenge in building a rich understanding of deep learning systems stems from the fact
that they are often trained on very large, complex datasets: even if the models themselves are very
large, they may not be large in comparison to the number of constraints they are designed to satisfy.
Indeed, many important phenomena may become apparent only by examining the high-dimensional
regime in which the dataset size and width are both large and of the same order.
In this work, we focus on the high-dimensional regime and analyze the performance of a regression
model trained on the random features F = f(WX + B) for a random weight matrix W and random
1
Under review as a conference paper at ICLR 2020
bias vector B. We obtain an exact formula for the training error on a noisy autoencoding task in the
limit that the width and dataset size both go to infinity. The result is determined by the resolvent of
the kernel matrix FtF, whose properties we analyze via the resolvent method from random matrix
theory. Our analysis also provides an exact formula for the eigenvalue density of the kernel matrix,
which may be of independent interest since it provides a characterization for how spectral properties
of the data covariance matrix propagate through neural network layers at initialization.
1.1	Our contributions
The main contribution of our work is an exact characterization of the training error of a ridge-
regularized random feature regression model on a noisy autoencoder task in the high-dimensional
regime. This is one of the first non-trivial models to be solved exactly in the joint limit of large data
and large width and provides an interesting testing ground in which to analyze this regime. Some of
our additional contributions include,
•	An exact characterization of the spectral density of the randm feature matrix F = f (WX +
B), extending prior results of Pennington & Worah (2017) to non-Gaussian data distributions
and to non-zero bias distributions.
•	One interpretation of the random additive bias is that it induces a distribution of activation
functions parameterized by B, i.e. f(Z; B) := f(Z + B). Our analysis trivially extends to
any distribution of activation functions f (∙ ; B) parameterized by B.
•	We show that there exists a non-trivial distribution over activation functions that outperforms
the best possible single activation function on a noisy autoencoding task.
•	Our method of proof introduces a surrogate “linearization" of F, Flin, that possesses the
same spectral information as F. Flin and its properties are likely to be of further interest
and utility in analyzing neural networks in high dimensions.
1.2	Related Work
Neural networks have been studied from the perspective of high-dimensional statistics in a number
of recent works. Most prior work has focused on the bias-free case. Pennington & Worah (2017)
studied the spectrum of the activation matrix f(WX) for iid Gaussian data and derived an analytic
expression for the training error of a ridge-regularized random feature model trained on pure noise. It
is natural to consider incorporating biases by appending a constant feature 1 to X . Unfortunately,
this leads to biases that are the same order as the weights, and so the effect disappears in the large
dataset limit. Moreover, this modification on the data violates the assumptions of Pennington &
Worah (2017). Hastie et al. (2019) study ridgeless interpolation in high-dimensional interpolation
for linear features as well as nonlinear random features of iid Gaussian data. Louart et al. (2018)
derived a deterministic equivalent for the resolvent of the kernel matrix FtF which allowed for a
characterization of the asymptotic training and test performance of linear ridge regression of random
feature models.
Other work has investigated learning dynamics and generalization in the high-dimensional
regime (Liao & Couillet, 2018a; Lampinen & Ganguli, 2018; Advani & Ganguli, 2016; Advani &
Saxe, 2017) as well as the spectra of more complicated objects such as the Hessian (Pennington &
Bahri, 2017) and Fisher information matrix (Pennington & Worah, 2018). From the mathematical
perspective, random matrix theory provides natural tools (Silverstein & Bai, 1995a) for analyzing
the behavior of neural networks in the high-dimensional regime. Liao & Couillet (2018b) examined
spectra for data drawn from Gaussian mixture models; see also (El Karoui, 2010) on the spectra of
random kernel matrices.
2	Preliminaries
Consider a dataset X ∈ Rn0×m and the random feature matrix,
F =f(WX;B),
generated by a single hidden-layer network with iid Gaussian weights W ∈ Rn1×n0 (Wak 〜
N(0, σW2 /n0)), activation function f, and biases B = b1mT ∈ Rn1 ×m (for b ∈ Rn1). We regard
2
Under review as a conference paper at ICLR 2020
the second argument of f as parametrizing (continuously or discretely) an ensemble of activation
functions. We refer to B (or b) as the bias, in reference to the important special case f(WX +
B) (additive bias). In general, however, we only assume the parameters ba are such that the
measure nγ Pa δba converges in distribution to some limiting distribution μB, effecting an arbitrary
distribution over activation functions.
We assume that E|f(N;b)∣k for N ~ N(0,σ) is finite for all 1 ≤ k ≤ 3, σ > 0, and b ∈
SUPPOrt(μB). When μB is a single Dirac mass at location bo, the activation function can be written
as f(WX; B) = f(WX; b0) = g(WX) for some single-argument function g (for an additive bias,
g(WX) = f(WX + b0)). When this is the case, we say the model has a single activation function,
as oPPosed to a mixture or distribution of activation functions.
The quantity of interest for the investigations below is the kernel matrix	FtF, and in particular its
resolvent,
G(Z)= (n1 FtF -ZI)-1 .	(1)
As we review in Sec. 4, the oPtimal regression coefficients of a linear model on the random features
F is a simPle function of this resolvent.
The high-dimensional regime that we study is the one in which the dataset size m, feature dimension-
ality n0 , and hidden layer width n1 all go to infinity at the same rate. In Particular, as is standard in
the random matrix literature, we assume that we can Parameterize the limit in terms of the dataset
size m in such a way that there exist two Positive constants,
φ ：= iim no(m)
m→∞ m
and
Ψ := lim no(m).
m→∞ n1 (m)
(2)
Note that the resolvent is a random matrix, but as m grows large, its normalized trace becomes a
deterministic quantity. In the limit that m → ∞, this quantity is known as the Stieltjes transform1,
m(Z) :
lim
m→∞
(3)
Together with an auxiliary transform m(z), defined below, these deterministic quantities completely
characterize the asymPtotic training error of kernel ridge regression on a noisy autoencoder task in
this high-dimensional regime.
The Stieltjes transform frequently arises in random matrix methods as a way to encode the spectra
of matrices. In particular, if λi are the eigenvalues of n^ Ft F and the empirical distribution of
eigenvalues converges in distribution to some deterministic limiting density as m → ∞,
m
一^X δλi → μ(λ)dλ,
mi
i=1
(4)
then (with appropriate technical assumptions), the limiting spectral density itself can be recovered
from the Stieltjes transform m(Z) via the inversion formula,
m(λ - i) -m(λ + i)
μ(λ) = lim-----------ʒ------------.	⑸
→0+	2πi
The Stieltjes transform then substitutes convergence in distribution for pointwise convergence for all
Z such that =Z > 0.
2.1 Methods for computing the Stieltjes transform
We briefly review two standard methods for computing the Stieltjes transform m(Z), the resolvent
method and the moments method.
The resolvent method is an approach for computing the Stieltes transform based on the application of
the Schur complement formula to the resolvent itself (or to a closely-related block matrix). Intuitively,
as the matrix size becomes large, the minors of the matrix are similar in distribution to the larger
matrix, and, moreover, the Cauchy interlacing theorem guarantees that their Stieltjes transforms are
1The distinction between the Stieltjes transform m(z) and the dataset size m should be clear from context.
3
Under review as a conference paper at ICLR 2020
Figure 1: We get excellent agreement of theory and simulation for spectral densities for any bias
distribution. We set φ = 1.5, ψ = 0.8, σX = σW = 1, and f = ReLU. Simulations are performed
on matrices of size m = 214. Left Gaussian distribution over the biases with distribution N(0, 1).
Right Bernoulli distribution over biases with distribution p = 0.5.
close as well. This allows for the derivation of a self-consistent equation (SCE) in which the Stieltjes
transform appears on the left-hand side as the trace of the resolvent, and on the right-hand side as the
trace of one of its minors.
The moments method is more combinatorial in nature and involves expanding the resolvent for large
z and computing the traces of each term,
m(z) = lim -1 tr G(Z) = - lim XX ［皿FtFY .	(6)
m→∞ m	m→∞	nk	zk+1
k=0 1
The traces themselves are expended out as
tr(F tF )k = X Fa1α1 FaIa2 …Fak αι ,	(7)
where the sum runs over matrix indices a1, . . . , ak, α1, . . . αk. The essence of the moment method
involves analyzing the asymptotic contribution of each term in the sum based on its combinatorial
type and the details of F, and resumming the results to obtain m(z).
We refer the reader to (Erdos & Yau, 2017; Tao, 2012) for more details about these methods and
additional background on random matrix theory.
3 Result for Stieltjes transform
3.1	Main theorem
We make the following assumptions on the data matrix X and bias vector b:
1.	n1o Pa XaaXae = δaβ吸 + O (1/匹)for all a and β
2.	the empirical eigenvalue distribution of WXtX converges in distribution to a measure μχ
3.	n1 Pn=I δba → μB in distribution.
Theorem 1. Define σz = σwσχ and resolvent G(Z) = (n1 FtF 一 ZI) . Then under the above
assumptions and for all z such that =z > 0, the transforms
mmtr G(Z) and mmtr (n10XtXtr G(Z)) ,	(8)
converge in probability to the unique solution, m(2) and m(∕), ofthe Eqn. (9) that map C+ to C+:
1S
m(Z) = ES" I") +S")J	and m(Z) = ES" K +S")J ⑼
where,
C0(Z) = -Z + EB〜μB n' W~, CI(Z)= EB〜μB	ŋʌ ,	(10)
D(B)	D(B)
4
Under review as a conference paper at ICLR 2020
loɪ^o-ɪmzv
X4_SU8P -ejti8ds
.MNIST1
Figure 2: Empirical spectral densities agree with our predictions for varied data distributions and
shape parameters. Top left: One class from CIFAR (airplane), mean subtracted. Top right: Classes
{0, 8} from MNIST, mean subtracted. Bottom left: Gaussian input data, varying the NN parameter
settings and activation function. Bottom right: Input data with a bimodal spectrum. All plots used
f = ReLU, φ = 1.5, ψ = 0.8 and σW = σB = 1, except for the indicated modified parameter.
Empirical densities were smoothed using a Gaussian KDE.
2	3	4	5	6
eigenvalues
ψ
D(B):=1 + ψ (Z(B)m(z) + (η(B) - Z(B)) m(z)) ,	(11)
φ
and where η(B) and Z(B) are the Gaussian expectations
η(B) := EN〜N(0,σz) V(N; B)2] and Z(B) ：= EN〜N(o,σz) [σz f(N； B)]2.	(12)
The proof is quite involved and is presented in the supplementary material. The basic idea is to derive
a multivariate Gaussian random matrix model with the same correlation structure as F , then derive a
self-consistent equation (SCE) using the resolvent method for this linearized version of F , Flin.
Remark 1. The self-consistent equations consist of two coupled equations involving the Stieltjes
transform m(z) and an auxiliary object rn(z), (Cf (Paul & Silverstein, 2009, Eq. (2))), which we
will see in Cor. 1 essentially measures the autoencoding capacity of the network.
Remark 2. Note that the self-consistent equations contain an expectation over the limiting spectral
density of the input data. While the assumptions on the data matrix X in Thm. 1 are quite general,
they may not be optimal. See Sec. 3.3, where we show strong agreement with empirical data from
MNIST and CIFAR-10 and for a range of synthetic distributions. This suggests that the theorem may
hold for even more general data distributions.
3.2 Alternate representation and limiting results
When the data distribution is iid Gaussian, the expectations in Eqn. (9) can be expressed in closed
form, though one must be careful to choose the correct branch of the resulting function. For simplicity
and future reference, we focus on the setting where 0 < φ ≤ ψ ≤ 1, in which case we have the
5
Under review as a conference paper at ICLR 2020
Figure 3: Comparisons of simulated ridge regression error and our theoretical prediction. We use
ReLU with σχ = σw = σp = 1 for all plots and vary the shape parameters φ and ψ. For simulations
we use m = 213 throughout. Note we also normalize the activation function so that Eb [η(b)] = 1.
(a): Our predictions for ridge regression with random labels are solid lines. Simulated losses are the
red stars. (b) Autoencoder error. (c) Noisy autoencoder error with o& = 0.2.
coupled algebraic equations,
m(z)
m(z)
Cl - (Co + Cι)φ +，。2 + 2(C0 - Cι)Cιφ + (C。+ C。2。2
2CoCι
1 — C°m(z)
C.
(13)
(14)
When μB in Eqn. (10) is trivial, i.e. a single Dirac mass, then the result should reduce to the single
activation function case with F = f (WX), which was studied in (Pennington & Worah, 2017).
Indeed, writing η = EB [η(B)] and Z = EB [Z(b)] for such a distribution, and eliminating rh(z) from
Eqns. (13) and (14), we find that m(z) satisfies the following quartic polynomial:
0 = (z2Z 2ψ2)m(z)4 + (2zZ 2ψ(ψ — φ)m(z)3 + (Z 2(ψ — φ)2 + zZφψ + zηφ2ψ)m(z)2
+ (Zφ(ψ — φ) + φ2(zφ + η(ψ — φ))m(z) + φ3	()
which agrees with the result in (Pennington & Worah, 2017) upon identifying m(z) = —(1 —
φ∕ψ"z — φ∕ψG(Z).
3.3 Spectral density estimates
The self-consistent equations in Thm. 1 can be solved numerically by iterating Eqn. (9) until con-
vergence, using numerical integration. By utilizing the Stieltjes inversion formula, Eqn. (5), we
can extract predictions for the limiting eigenvalue density of ^^FtF. The results show close agree-
ment with empirical spectral simulations from several interesting practical datasets and synthetic
distributions, see Figs. 1 and 2.
4	Ridge-regularized noisy autoencoder
We consider the problem of kernel ridge regression with random features given by F = f(WX; B)
and noisy regression targets given by Y = AX + for some A ∈ Rn2×n0 and independent Gaussian
noise e ∈ Rn2×m such that e4〜N(0, σ2). As is common in the literature of high-dimensional
statistics, we assume an isotropic prior on A such that AtA → 窘σAI as m,no,n → ∞. Note that
when σA = 0, we have the pure memorization setting studied by Pennington & Worah (2017).
Corollary 1. Let WS be the minimizerfor regularized training loss
L(W2)=嬴 l∣Y — W2F Il2 + 就 γ∣∣W2∣l2,	(16)
with random features F = f(WX; B). Then the asymptotic training error converges in probability
as
Etrain =氤 || Y - W2 F ||2 → Y2	(σA m(—Y) + b2Y2m(—γ)) .	(17)
In particular, we see that the derivative of the Stieltjes transform m0(—γ) measures the capacity
to learn noisy labels, whereas m0(—γ) measures pure autoencoding capacity. See Fig. 3 for a
comparison between these theoretical predictions and simulation.
6
Under review as a conference paper at ICLR 2020
Proof. The optimal weights for the regularized loss are given by
WS = n11 YG(Y)Ft for G(Y )=(+ FtF + YI )-1,
resulting in training error
Etram = n⅛ ||Y -* F Il2 = γ2 康 tr (Y tYG(γ)2)
=y2 σA 嬴tr (X tχG(Y)2) + γ2σ2 mtr (G(Y)2)
=Y2σAdγ (m(-Y)) + Y2σ2/(m(-Y))
=-Y2(σAm0(-Y) + σlm,(-Y)) .	□
Remark 3. As in (Pennington & Worah, 2017), there is a scaling homogeneity in the Etrain: an
increase in the regularization constant Y can be compensated by a decrease in scale of W2, which, in
turn, can be compensated by increasing the scale of F, which is equivalent to increasing η(b) and
ζ (b). Owing to this homogeneity, we are free to choose a normalization of the activation function for
which Eb〜μB [η(b)] = L
4.1	Nonlinear mixtures can outperform single nonlinearities
The bias term in our random feature model can be viewed as one way of defining a distribution over
activation functions. The choice of distribution, in general, affects the performance of the model on a
given task - as quantified by the expectations in Eqn. (10). A key benefit of our model and analytical
approach is that it permits nontrivial distributions of nonlinear activation functions.
In this section, we build on our results for the training loss on noisy autoencoder tasks to examine the
benefits of utilizing nonlinear mixtures. The goal here is not to identify “good" mixtures, since this
will clearly be a dataset- and architecture-dependent question, nor is it to identify a large performance
gap. Instead, we merely seek to demonstrate a proof-of-principle, namely that there exist non-trivial
distributions over nonlinearities that can provably outperform the best possible single nonlinearity.
For this analysis, we consider the simplest possible nontrivial distribution over activation functions: a
Bernoulli mixture of two different functions. To each of these functions we associate two constants,
η and ζ , which derive from Eqn. (12) but have no B-dependence since each function is a single
nonlinearity. Concretely, let
η = EN 〜N (0,σz) [f (N)2]	and Z = EN〜N(。。)[σzf0(N)]2.	(18)
For the two functions themselves, we utilize (i) a "pure linear" activation function with η = 1, i.e. the
identity function and (ii) a "pure nonlinear" (Hastie et al., 2019) activation function with η = 1 and
ζ = 0. (The particular purely nonlinear function in (ii) is irrelevant, as our theory predicts and our
experiments confirm; see Fig. 4(a)). To be precise, We define for P 〜Bernoulli(p),
fp(x) := gxζ=0(x) iiff pp == 10 ,	(19)
Where gζ=0 is any function With η = 1 and ζ = 0 (see, e.g., the functions in Fig. (3) of (Pennington
& Worah, 2017)).
The task of computing Etrain for fp is cumbersome but purely algebraic. To see hoW to proceed,
notice that the expectations in Eqn. (10) are simple for fp :
0z(Z)	z+ 1 + ψ∕φm(z) , ℃)	1 + ψ∕φm(z)
(20)
Plugging these equations into Eqns. (13) and (14), collecting terms and simplifying yields a set of
coupled polynomial equations for m(z) and m(z). Taking the total derivative of these equations with
respect to Z yields two additional equations which can be solved to express m0(z) and m0(z) in terms
of m(z) and m(z). Combining these results produces a polynomial system whose solution2 encodes
Etrain through Eqn. (17). Fig. 4(a) shows the result of this calculation in solid lines for various values
of Y, while the 1σ error bars show empirical simulations with finite networks. The red stars in the
figure show that for many values of Y, the optimal mixture percentage is intermediate, i.e. 0 < p < 1.
2Special care must be taken in selecting the correct root of this equation, in accordance with the condition
that m(z)〜-1/z for large |z|.
7
Under review as a conference paper at ICLR 2020
Figure 4: Performance on ridge-regularized noisy autoencoder with σe = 1, φ = 1/2, and ψ = 1/2.
(a) Theoretical predictions for training error (solid lines) and 1σ error bars for empirical simulations
of finite networks (n0 = 192, nι = 384, m = 384) for various values of ridge regularization constant
Y as the activation function varies. In the left panel, a single activation function f is used. In the right
panel, the non-linearity is fp, a Bernoulli(p)-mixture of a purely linear (Z = 1) and purely non-linear
(Z = 0) function. Each simulation uses a randomly-chosen non-linearity having the specified values
of Z, demonstrating that Etrain depends on the non-linearity solely through this constant. Red and blue
stars denote minima. (b) Training error as a function of Y for the optimal f and fp, as determined
in (a). The bottom panel shows the difference in training error, demonstrating that the optimal
Bernoulli(p) -mixture of non-linearities has smaller training error than the best single non-linearity.
The question is, does a non-trivial mixture actually outperform a single nonlinearity? First, we must
understand the performance of the optimal single nonlinearity. We note that owing to the homogeneity
of the the training loss in η, Z, and Y, we can assume without loss of generality that η = 1. Therefore
the entire effect of the nonlinearity should be encoded in the single constant Z . In Fig. 4(a), we plot
our theoretical prediction for Etrain in solid lines and empirical simulations for finite networks as 1σ
error bars. The activation function used for each simulation is chosen randomly, conditional on the
value of Z. So the good agreement in the left panel of Fig. 4(a) demonstrates not just the correctness
of our theoretical result but also the fact that Etrain depends on the activation function solely through
the constant Z. The blue stars in this figure indicate that the optimal single nonlinearity is neither
purely linear (Z = 1), nor purely nonlinear (Z = 0), but rather something in between.
For this particular problem setup, the performance of the optimal single nonlinearity and the optimal
Bernoulli mixture are rather close, as indicated by the top panel of Fig. 4(b). However, owing to
our precise analytical formulation, we can evaluate the training loss to high precision and observe
that there is indeed a difference in performance between the two models, as shown in the bottom
panel of Fig. 4(b). This result establishes that there are some problems for which even the best single
nonlinearity is outperformed by a mixture of nonlinearities.
5	Conclusions
In this work we studied the feature matrix F = f(WX; B) where W is a random matrix with iid
Gaussian entries. Under mild assumptions on X and B, we obtained an exact analytic formula,
Eqn. (9), that characterizes the Stieltjes transform of the spectral density of F . The result allowed us
to describe the exact training loss of a ridge-regularized noisy autoencoder in the high-dimensional,
large-dataset limit, providing one of the first closed-form solutions to a non-trivial model in this
limit. We found excellent agreement between the asymptotic predictions of Eqn. (9) and a variety of
finite-dimensional empirical simulations.
We also advanced the interpretation of the bias B as one particular way of parameterizing a distri-
bution of activation functions. Indeed, our derivations proceed completely unchanged whether this
distribution is of the traditional additive form f (∙ + B) or the more general f (∙; B). By examining
the latter, we showed that there are configurations in which a non-trivial distribution over activation
functions provably outperforms the best possible single activation function. This opens the door
to future investigations regarding optimal methods for parameterizing distributions over activation
functions for approximate kernel methods, and suggests the possibility that mixtures of nonlinearities
could be a useful design consideration when constructing neural network architectures.
8
Under review as a conference paper at ICLR 2020
References
Madhu Advani and Surya Ganguli. Statistical mechanics of optimal convex inference in high
dimensions. Phys. Rev. X, 6:031034, Aug 2016. doi: 10.1103/PhysRevX.6.031034. URL
https://link.aps.org/doi/10.1103/PhysRevX.6.031034.
Madhu S Advani and Andrew M Saxe. High-dimensional dynamics of generalization error in neural
networks. arXiv preprint arXiv:1710.03667, 2017.
Zhidong Bai and Wang Zhou. Large sample covariance matrices without independence structures in
columns. Statistica Sinica,pp. 425-442, 2008.
Marwa Banna, Florence Merlevede, and Magda Peligrad. On the limiting spectral distribution for a
large class of symmetric random matrices with correlated entries. Stochastic Processes and their
Applications, 125(7):2700-2726, 2015.
Lenaic Chizat and Francis Bach. On the global convergence of gradient descent for over-parameterized
models using optimal transport. In Advances in neural information processing systems, pp. 3036-
3046, 2018a.
Lenaic Chizat and Francis Bach. A note on lazy training in supervised differentiable programming.
arXiv preprint arXiv:1812.07956, 2018b.
Noureddine El Karoui. The spectrum of kernel random matrices. The Annals of Statistics, 38, 01
2010. doi: 10.1214/08-AOS648.
Laszl6 Erdos and Horng-Tzer Yau. A dynamical approach to random matrix theory. Courant Lecture
Notes in Mathematics, 28, 2017.
Trevor Hastie, Andrea Montanari, Saharon Rosset, and Ryan J Tibshirani. Surprises in high-
dimensional ridgeless least squares interpolation. arXiv preprint arXiv:1903.08560, 2019.
Geoffrey Hinton, Li Deng, Dong Yu, George E. Dahl, Abdel-rahman Mohamed, Navdeep Jaitly,
Andrew Senior, Vincent Vanhoucke, Patrick Nguyen, Tara N Sainath, et al. Deep neural networks
for acoustic modeling in speech recognition: The shared views of four research groups. IEEE
Signal Processing Magazine, 29(6):82-97, 2012.
Arthur Jacot, Franck Gabriel, and Clement Hongler. Neural tangent kernel: Convergence and
generalization in neural networks. In Proceedings of the 32Nd International Conference on Neural
Information Processing Systems, NIPS’18, pp. 8580-8589, USA, 2018. Curran Associates Inc.
URL http://dl.acm.org/citation.cfm?id=3327757.3327948.
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton. Imagenet classification with deep convolu-
tional neural networks. In Advances in neural information processing systems, pp. 1097-1105,
2012.
Andrew K Lampinen and Surya Ganguli. An analytic theory of generalization dynamics and transfer
learning in deep linear networks. arXiv preprint arXiv:1809.10374, 2018.
Jaehoon Lee, Lechao Xiao, Samuel S Schoenholz, Yasaman Bahri, Jascha Sohl-Dickstein, and Jeffrey
Pennington. Wide neural networks of any depth evolve as linear models under gradient descent.
arXiv preprint arXiv:1902.06720, 2019.
Zhenyu Liao and Romain Couillet. The dynamics of learning: A random matrix approach. In 35th
International Conference on Machine Learning, PMLR, 2018a.
Zhenyu Liao and Romain Couillet. On the Spectrum of Random Features Maps of High Dimensional
Data. In International Conference on Machine Learning (ICML 2018), Stockholm, Sweden, July
2018b. URL https://hal.archives-ouvertes.fr/hal-01954933. 13 pages (with
Supplementary Material), 10 figure, ICML 2018.
Cosme Louart, Zhenyu Liao, Romain Couillet, et al. A random matrix approach to neural networks.
The Annals of Applied Probability, 28(2):1190-1248, 2018.
9
Under review as a conference paper at ICLR 2020
Song Mei, Andrea Montanari, and Phan-Minh Nguyen. A mean field view of the landscape of two-
layer neural networks. Proceedings ofthe National Academy of Sciences, 115(33):E7665-E7671,
2018.
Song Mei, Theodor Misiakiewicz, and Andrea Montanari. Mean-field theory of two-layers neural
networks: dimension-free bounds and kernel limit. arXiv preprint arXiv:1902.06015, 2019.
Debashis Paul and Jack W Silverstein. No eigenvalues outside the support of the limiting empirical
spectral distribution of a separable covariance matrix. Journal of Multivariate Analysis, 100(1):
37-57, 2009.
Jeffrey Pennington and Yasaman Bahri. Geometry of neural network loss surfaces via random matrix
theory. In International Conference on Machine Learning, pp. 2798-2806, 2017.
Jeffrey Pennington and Pratik Worah. Nonlinear random matrix theory for deep learning. In Advances
in Neural Information Processing Systems, pp. 2637-2646, 2017.
Jeffrey Pennington and Pratik Worah. The spectrum of the fisher information matrix ofa single-hidden-
layer neural network. In Advances in Neural Information Processing Systems, pp. 5410-5419,
2018.
Grant Rotskoff, Samy Jelassi, Joan Bruna, and Eric Vanden-Eijnden. Global convergence of neuron
birth-death dynamics. arXiv preprint arXiv:1902.01843, 2019.
Grant M Rotskoff and Eric Vanden-Eijnden. Neural networks as interacting particle systems:
Asymptotic convexity of the loss landscape and universal scaling of the approximation error. arXiv
preprint arXiv:1805.00915, 2018.
N. Shazeer, A. Mirhoseini, K. Maziarz, A. Davis, Q. Le, G. Hinton, and J. Dean. Outrageously
large neural language models using sparsely gated mixtures of experts. ICLR, 2017. URL
http://arxiv.org/abs/1701.06538.
Jack W. Silverstein and Z. D. Bai. On the empirical distribution of eigenvalues of a class of large
dimensional random matrices, 1995a.
Jack W Silverstein and ZD Bai. On the empirical distribution of eigenvalues of a class of large
dimensional random matrices. Journal of Multivariate analysis, 54(2):175-192, 1995b.
Terence Tao. Topics in random matrix theory, volume 132. American Mathematical Society
Providence, RI, 2012.
Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V. Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, et al. Google’s neural machine translation sys-
tem: Bridging the gap between human and machine translation. arXiv preprint arXiv:1609.08144,
2016.
10
Under review as a conference paper at ICLR 2020
Supplemental Material:
A Random Matrix Perspective on Mixtures of Nonlinearities in High Dimensions
The main goal of the supplementary material is to prove Thm. 1. This is achieved in three steps. The
first step is to note that the limiting Stieltjes for the kernel matrix FtF is equivalent to a multivariate
a multivariate Gaussian random matrix model with an identical correlation structure. This was proven
in great generality in Banna et al. (2015) (see Theorem 5.). Similar results for covariance matrices
have been previously studied Bai & Zhou (2008), but since F does not have identically distributed
rows (or columns) they are inadequate for our case. Specifically, Theorem 5 from Banna et al. (2015),
implies that the two Stieltjes transforms have the same limit for all z such that =z > 0 almost surely.
The second step is to derive the leading order correlation structure (or kernel) for F (Lem. 1), and
specify a multivariate Gaussian model with the same structure (Subsec. A.1). We refer to this
Gaussian model as a linearized model, since it removes the nonlinearity f from the random part of
our random matrix ensemble. Without loss of generality, we may assume that EFaα = 0 for all a and
α. This is because EFaα only depends on a (as we demonstrate in Sec. A), so we can center F using
a rank-1 matrix—a transform that has no effect on the limiting Stieltjes transform as it represents an
O(1/m) change in the spectrum (see for more detail Bai & Zhou (2008)).
The third a final step of the proof is a derivation of a self-consistent equation specifying the limiting
Stieltjes transform of the Gaussian model. We do this using the resolvent method (see Erdos & Yau
(2017) for an introduction). While the application of this method to multivariate Gaussian covariance
matrices is standard, we note the form of the SCE is new and that we include the derivation here for
completeness.
At the end of the supplementary material, we include some additional figures.
A CORRELATION STRUCTURE OF F
To begin we derive an asymptotic form for correlation structure of F. For simplicity of presentation,
We derive the results for f (∙, B) ≡ f (∙ + B), but the argument generalizes directly. We recall that
W is an n1 × n0 random matrix with mean 0 and variance σw2 /n0 iid Gaussian entries. Define
cαβ := Pk XkαXkβ /n0. The data matrix X and bias vector B are deterministic, so all expectations
are over W (and can be thought of as conditional on X and B). Moreover, X and B satisfy the
folloWing assumptions:
•	Cαβ = δαβσW + O(1/√n0) for all a and β;
•	The empirical spectral distribution of *XtX converges in distribution to some measure
μx;
•	nl Pn= 1 δba → μB in distribution, or equivalently 言 Pn= 1 g(ba) → EB〜*bg(B) for
bounded, continuous functions g .
Observe that
n0	n0
Zaα := X Wak Xkα and Zbβ := X Wbk Xkβ	(21)
k=1	k=1
are jointly Gaussian. Moreover,
EZaα = 0 and EZaαZbβ = σW2 cαβ1 (a = b) .	(22)
Note in particular, that Zaα and Zbβ are independent if a 6= b. For convenience, We normalize cαβ
and define Cαβ := cαβ/σX and εα := Cαα - 1.
In order to specify the correlations, We employ transforms of the activation function f. The transforms
are Gaussian integrals of f at different locations and scales:
ξk(x) := EσXk σWk f(k) (σXσWN + x),	(23)
ηi,j (x) := EσXi+j σWi+j f (i) (σX σW N + x)f(j) (σXσWN + x),	(24)
and
γi,j (x) := EσXi+j σWi+j f (i) (σX σW N + x)f(j)(σXσWN0 + x) = ξi(x)ξj(x).	(25)
11
Under review as a conference paper at ICLR 2020
Remark 4. For simplicity, while writing f(i) we assume differentiability off up to ith order. However,
this assumption can be relaxed, as since the derivatives are only used to take a Gaussian expectation,
they can be expressed using Stein’s lemma. For example, ξ1(x) = ENf(σXσWN +x). Thus, similar
results should hold for rectified linear units for example, regardless of their lack of differentiability at
0.
Lemma 1. To leading order the correlation structure of F is
(0	if a = b
EFaαFbβ = η00(ba)	ifα = β anda = b .	(26)
lγιι(ba)cαβ if α = β and a = b
Proof of Lem. 1. Before we prove Lem. 1, we state a simple lemma that is easy to show using Taylor
expansion.
Lemma 2. Suppose ε is a small constant and that N 〜N (0,1) ,then
ENf (σχσw√1+7N + b) = ξo(b) + ξ2(b)ε + O(ε2),	(27)
Enf (σχσw√1 + εN + b)2 = η00(b) + (η11(b) + η02(b)) ε + O(ε2),	(28)
and
EN (σχσw√1 + ε) f0 (σχσw√1+ εN + b) = ξι(b) +	ε + O(ε2).	(29)
Recall ξ0(x) = 0 by assumption. Using the observation in Eqn. (21), we repeatedly rewrite the
expectations in FtF as we can reduce the expectation over W to an expectation over at most two
correlated Gaussian random variables. Let N and N0 denote independent, standard Gaussian random
variables. Using Lem. 2, we see
Ef(Zaa) = Ef (σw √CαɑN + ba) = ξ2(2b^ εα + O(εα).	(30)
Again, using Lem. 2, we get
Ef(Zaα)2 = η00(ba) + (η11(ba) + η02(ba)) εα + O(ε2α).	(31)
For the covariance calculation, We define ραβ := cαβ/√caa and recall that ρaβ is order 1∕√m.
Thus,
Ef(Zaa)f (Zaβ) = Ef (σw√cO∑N0 + ba)f (σwPaβN0 + σwqcββ - paβN + b0)	(32)
=(En0f (σw√cO∑N0 + ba)) (ENf (σw qββ-pθβN + b0))	(33)
+ (ENO σW Pαβ N 0f (σW √caa N 0 + ba)) (EN f 0 卜W J cββ - P.β N + ba)) ∙
(34)
For the first term, We get
ξo(ba)2 + ξ0(ba)ξ2(ba) fα+fβ + O(m-1) = O(m-1).	(35)
For the second term, We have
Caβ (l- ε0+εβ + O(m-1)) (ξι(ba)+ &(ba) + &(ba)εα + O(m-1))	(36)
× (ξι(ba) + ξl(ba)+ ξ3(ba)εβ + O(m-1))	(37)
=γ1,1(ba Icae + O(m-1).	(38)
Thus, to second order We have
Ef(Zaa)f(Zaβ) = γ1,1(ba)ccaβ + O(n0-1).	(39)
□
12
Under review as a conference paper at ICLR 2020
A.1 Linearized model
Define
Flin := CΘ1∑+ (V2 -C2)1/2 Θ2,	(40)
where: Θ1 and Θ2 are n1 × m matrices that have iid Gaussian entries with mean 0 and variance
1/n1; 2) V and C are n1 × n1 diagonal matrices with entries
Va2 =	η00(ba)	≡	η(ba)	and	Ca2	= γ11(ba)	≡	ζ(ba),	(41)
for a bias vector b; 3) Σ is a matrix square root of nɪ-XtX.
A simple calculation shows that the entries of the matrix Flin match the first and second mixed
moments of F given in Lem. 1. However, unlike F, Flin is linear in the random matrices Θ1 and Θ2 ;
in this sense, it is a linearization of F.
B DERIVATION OF SELF-CONSISTENT EQUATION FOR FLIN
Theorem 2. Let mm(z) be the Stieltjes transform of ^^FIInFIIn i.e. *trG(z). Then with Probabil-
ity 1, as n1 → ∞, for all z such that =z > 0, mn1 (z) → m(z), where m(z) is the solution of the
coupled equations
1S
m(Z)=	ES~Mp(°)[co(z)	+ sci(z)]	and	m(Z)=	ES~Mp(φ)	[co(z)	+ sci(z)∖	(42)
with
CO(Z) := -Z + EBfB n' j V~ɪ ， CI(Z) := EBfB	r] ,	(43)
D(B)	D(B)
ψ
D(B):=1 + ψ(Z(B)m(Z) + (η(B) - Z(B)) m(Z)) .	(44)
φ
We want to study the eigenvalues of * FlintFlin. Note without loss of generality it is sufficient to
consdier diagonal Σ, since we can diagonalize Σ using some orthogonal matrices O and O0 as it
is the square root of a positive definite matrix. Moreover, these orthogonal matrices, when applied
to either Θ1 or Θ2 do not change their distributions. Thus, diagonalizing Σ, so that ∑αα = √zλχ,
where λαX are the eigenvalues of XtX/n0, results in an equivalent matrix ensemble in distribution
(see Silverstein & Bai (1995b) for more detail). With this simplification, Flin has independent entries
given by
Faa=Caθaa qλX + pVτ-C2 ®a。.	空)
To make the derivation easier, we can partly linearize the problem by studying the matrix
H:
t
-ZI	Flint
Flin	-I
By the Schur complement formula, one easily finds
1	t	1m
mm(Z) ：= — Tr(Flin Flin∕nι - zI) = — EGaa(Z)
mm
a=1
n1+m
and Zmm(Z) := — Tr(FlinFlint/nι - ZI) = — X Gaa(Z),
n1	n1
a=n1 +1
where G is the inverse of H . Again by the Schur complement formula
1 	= Gaa	n1 Z X Flin FlinG(a) -Z -	aa ba m+a,m+b a,b=1
and G1-= Gaa	m -1 - X FalianFaliβnG(aaβ) a,β=1
(46)
(47)
(48)
(49)
(50)
13
Under review as a conference paper at ICLR 2020
for α ∈ {1, . . . , m} and a ∈ {m + 1
G(α) is independent of Θ11α, . . . , Θ
these variables that
n1
,..
n1α
. , m + n1} and G(a) is the inverse of the minor H(a). Since
and Θ21α , . . . , Θ2n1α, we see by taking the expectation over
E X FaliαnFbliαnG(mα+)a,m+b
a,b=1
n1
n X (λXZea) + ηSa)-Zea)) Gm+ a,m+a.	(51)
1 a=1
Moreover, standard concentration inequalities and the Ward identity (see Erdos & Yau (2017)) show
n1
X Flin FlinG(α)
FaαFbα m+a,m+b
a,b=1
n1
-E X FaliαnFbliαnG(mα+)a,m+b
(52)
≤ C ( m2 XlGm+a,m+b I
a,b
a,b=1	l
∖ 1/2	1 1	=G(a)	∖ 1/2
≤ C 与 X	m+a'm+a	≤ O(1∕√m)	(53)
m2	=z
with high probability. Similar bounds are easily obtained for Pam,β=1 Falian Faliβn G(aaβ).
We may also replace G(a) with G at the expense of another small error that can be bounded using the
Cauchy interlacing theorem: llG(ma+) a,m+a - Gm+a,m+a ll ≤ O(1/m). Using this control over these
sums, we see
n1
G- = -z - X Faa FbSGaa)
Gaa
a,b=1
n1
=-Z - n ^X (λXZ(ba) + η(ba) - Zea)) Gm+a,m+a + O(I/√m)
1 a=1
(54)
(55)
and
m
G- = -1 - X Faia Fae Gae
Gaa
a,β=1
1 二一................... ._
=-1 - n ^X (λɑ Zea) + η(ba) - Zea)) Gaa + O(1/√m) .
(56)
(57)
Finally, we invert Eqn. (56), multiply by λaXZ(ba) + η(ba) - Z(ba), and average over a to find
1 n1
—X (λa Z(ba ) + η(ba) - Z (ba)) Gm+a,m+a
n1 a=1
(58)
n1
--X
n1 a=1
n1
--X
n1 a=1
λαXζ(ba) + η(ba) - ζ(ba)
1 + φ (Z(ba)m(z) + (η(ba)- Z(ba))
λαXZ(ba) + η(ba) - Z(ba)
mm(z)) + O(1∕√m)
(59)
-EB~N (0,σ2)
1 + φ (Z(ba)m(z) + (η(ba) - Z(ba)mm(z))
λαXZ(B) + η(B) - Z(B)
+ o(i∕√m)
(60)
1 + φ (Z(B)m(z) + (η(B) - Z(B))mm(z))
+ o(1),
(61)
where mm(z) = * Pa λχGαα, where We Taylor expanded in the second step, and where We used
our assumption on B.
We can now invert Eqn. (54) and average over α to find
mm(z) -→ ES~μχ
-Z + EB~N (0,σ2)
1
SZ(B)+η(B)-Z(B)
1+ φ (Z(B)mσ(z) + (η(B)-Z(B))m(z))
(62)
14
Under review as a conference paper at ICLR 2020
Similarly,
mm(z) -→ ES〜μχ
-Z + EB 〜N (0,σ2)
S
SZ(B)+η(B)-Z(B)
1+φ (Z(B)m(z)+(η(B)-Z(B)m(z))
(63)
Note that the integral over S here is an integral over the limiting distribution of the data μχ, which
we assume
J X δλX → μX
α
(64)
in distribution. In the case of iid Gaussian data, this is exactly given by the Marchenko-Pastur
distribution.
C Additional figures
Figure 5: Comparison of right singular vectors of X and F for MNIST (left) and CIFAR10 (right).
Entry ij shows Xi ∙ j. Although our theoretical results do not give predictions for how the singular
vectors change, We found interesting behavior, with very little change to the largest singular vectors
(which are nearly isolated in the spectrum), but more mixing of singular vectors in the dense part of
the distribution.



W2 10^3	10β IO1 IO2 IO3
Regularization parameter
10"a IO-2 10^1	10° IO1 IO2 IO3 IO4 IO_3 IO'2 10^l IO0 IO1 IO2 IO3 IO4
Regularization parameter	Regularization parameter
Figure 6: Comparisons of simulated ridge regression error and our theoretical prediction. Here We
vary the activation function by changing the slope α in leaky ReLU. In particular a = -1 is a linear
function, α = 0 is regular ReLU, and α = 1 is the a scaled absolute value function. We normalize all
functions so that Eb [η(b)] = 1. We get excellent agreement with theory from only a single sample.
15