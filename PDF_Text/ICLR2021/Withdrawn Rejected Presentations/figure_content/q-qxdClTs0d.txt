Figure 1:	The causalgraph in OOD predic-tion: P (Y |Xc ) is invariantacross domains. The spu-rious correlation P(Y |Xs)may vary. A directed (bidi-rected) edge is a causal re-lationship (correlation).
Figure 2: Test aCCuraCy of IRM, IRM with balanCed Classes in eaCh domain, and ERM on CM-NIST+: when the Λ spuriousness is strong (ρ ≥ 0.8), the performanCe of IRM drops dramatiCallybeCause, in this situation, the spurious feature representation F (X) = E satisfies the IRM Con-Straint. The naive solution, balancing classes in each domain cannot mitigate this problem of IRM.
Figure 3: We visualize the differences between CMNIST and CMNIST+ (ρ = 0.9) in terms ofP(C|Y = 1, E). Each large triangle represents the space of P (C|Y, E). Each small triangle showsthe values of P(C = c|Y = 1, E = e), c ∈ {R, G, B}, e ∈ {1, 2, 3}.
Figure 4: Accuracy of IRM trained on datasets between CMNIST and CMNIST+ and tested on thetest sets of CMNIST and CMNIST+ (wplus increases): As the training set becomes more similar toCMNIST+, the performance of IRM gradually drops, on the test sets of CMNIST and CMNIST+.
Figure 5: We visualize CMNIST+ with ρ ∈ [0.5, 0.9] in terms of P(C|Y = 1, E). Each largetriangle represents the space of P (C|Y, E). Each small triangle shows the values of P(C = c|Y =1, E = e), c ∈ {R, G, B}, e ∈ {1, 2, 3}.
