Figure 1: Illustration of our approach. (A,B) In the example, cell types are jointly represented bytwo phenotypic features, indexed with labels i and j respectively. If only some combinations ofthe two features are observed, one obtains a partial contingency table (B) instead of a complete one(A). (C) We seek linear projections of the data that separate the cell types in a factorized mannercorresponding to the two features. Here u, v, and W are aligned with Feature 1, Feature 2, and theinteraction of both features, with the projected coordinates y, z, and S respectively.
Figure 2: Quantitative comparison between FLDA and other models. (A) Illustration of data syn-thesis. See Appendix D for implementation details. Color bar indicates the expression values ofthe ten generated genes. (B) Normalized overall SNR metric of each analysis. The SNR values arenormalized with respect to that of LDA. (C) Overall modularity score for each analysis. Error barsin (B,C) denote standard errors each calculated from 10 repeated simulations.
Figure 3: FLDA on the dataset of T4/T5 neurons. (A) T4/T5 neuronal types and their dendriticand axonal phenotypes. (B) T4/T5 neurons can be organized in a complete contingency table. Herei indicates the dendritic location and j indicates the axonal termination. (C) SNR metric of eachdiscriminant axis. (D) Projection of the data into the three-dimensional space consisting of thediscriminant axis for the feature i (FLDi) and the first and second discriminant axes for the featurej (FLDjI and FLDj2). (E-G) Projection of the data into the two-dimensional space made of FLDiand FLDjI (E), FLDjI and FLDj2 (F), or FLDj2 and FLDj3 (the third discriminant axis for thefeature j) (G). Different cell types are indicated by different colors as in (A) and (D).
Figure 4: Critical genes extracted from the sparse algorithm. (A) Weight vector of the 20 genesselected for the dendritic phenotype (FLDi). The weight value is indicated in the color bar with colorindicating direction (red: positive and green: negative) and saturation indicating magnitude. (B)Expression patterns of the 20 genes from (A) in eight types of T4/T5 neurons. Dot size indicates thepercentage of cells in which the gene was expressed, and color represents average scaled expression.
Figure 5: Representative plots (at σ = 0.6) ofEV and MI metrics for FLDA and other models. (A,B)EV (A) and MI (B) metrics of FLDA. FLDi and FLDj indicate the factorized linear discriminantsfor features i and j. (C,D) EV (C) and MI (D) metrics of 2LDAs. LDi and LDj indicate the lineardiscriminant components for features i and j. (E,F) EV (E) and MI (F) metrics of LDA. LDι andLD2 indicate the first two linear discriminant components. (G,H) EV (G) and MI (H) metrics ofCCA. CCA1 and CCA2 indicate the first two canonical correlation axes. (I,J) EV (I) and MI (J)metrics of PCA. PCi and PC2 indicate the first two principal components. EVi and EVj are theexplained variance of features i and j along an axis, and MIi and MIj indicate the mutual informbetween an axis and features i and j respectively. Values of EV and MI metrics are also indicatedby the color bars on the right side.
Figure 6: Additional plots for FLDA on the dataset of T4/T5 neurons. (A,B) Projection of the orig-inal gene expression data into the two-dimensional space made of the first and second (FLDij 1 andFLDij2) (A) or the second and third (FLDij2 and FLDij3) (B) discriminant axes for the compo-nent that depends on the combination of both features i and j. Different cell types are indicated indifferent colors as in (B).
Figure 7: Additional plots for critical genes extracted from the sparse algorithm. (A) Weight vectorof the 20 genes selected for the interaction of both dendritic and axonal features (FLDij 1). Theweight value is indicated in the color bar with color indicating direction (red: positive and green:negative) and saturation indicating magnitude. (B) Expression patterns of the 20 genes from (A)in eight types of T4/T5 neurons. Dot size indicates the percentage of cells in which the gene wasexpressed, and color represents average scaled expression.
Figure 8: Evaluation of the effect of incorrect phenotype annotation on the dataset of T4/T5 neu-rons. (A,B) Normalized overall SNR metric (A) and overall modularity score (B) of FLDA afterswitching labels of T4a type with another neuronal type. (C,D) Normalized overall SNR metric (C)and overall modularity score (D) of FLDA after merging the axonal phenotypic level a with anotherphenotypic level (b/c/d). (E,F) Normalized overall SNR metric (E) and overall modularity score (F)OfFLDA after splitting each axonal phenotypic level into two. Metrics under the original annotationare colored in green, and the values are indicated by the dashed lines. Here the SNR values arenormalized with respect to that of the original annotation.
