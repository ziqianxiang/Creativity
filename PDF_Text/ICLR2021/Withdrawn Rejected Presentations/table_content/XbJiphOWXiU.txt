Table 1: Average Hypothesis Prediction scores, broken down by triplet (pretrained) and non-triplet(not seen in pretraining)	Method	Overall	Triplet Accuracy	Non-triplet AccuracyColorSwitch	Fixed Policy	86.6%	91.1%	82.1%	Finetuned Policy	77.5%	79.7%	75.4%Pushblock	Fixed Policy	86.9%	87.9%	85.9%	Finetuned Policy	85.6%	86.3%	84.8%Crafting	Fixed Policy	77.3%	92.8%	61.8%	Finetuned Policy	90.7%	98.4%	83.0%Cartpole	Fixed Policy	84.2%	92.0%	76.3%	Finetuned Policy	92.5%	93.4%	91.6%In Crafting and Cartpole on the other hand, to do well on the unseen templates, the policy also needsto be fine-tuned. This tells us that when we do have to generalize to unseen hypotheses (especiallynon-triplet hypotheses), adapting the policy as well as the prediction network is necessary. Recall7Under review as a conference paper at ICLR 2021Timesteps	le7	Timesteps	le7	Timesteps	le7Figure 5: Hypothesis accuracies with intrinsic pretraining versus triplet pretraining (purple).
Table 2:	Pretraining HyperparametersParameterValueAlgorithmTimesteps per batchClip paramEntropy coeffNumber of parallel processesOptimizer epochs per iterationOptimizer step sizeOptimizer batch sizeDiscount γGAE λlearning rate scheduleOptimizerPast Frame Window SizePPO Schulman et al. (2017)20480.20.1
Table 3:	Finetuning HyperparametersParameterValueAlgorithmTimesteps per batchEntropy coeffNumber of parallel processesOptimizer epochs per iterationOptimizer step sizeOptimizer batch sizeDiscount γGAE λlearning rate scheduleOptimizerPast Frame Window SizePPO Schulman et al. (2017)20480.184
Table 4: Prediction HyperparametersParameter	ValueTimesteps per batch	2048Optimizer step size	1e-3Optimizer batch size	128learning rate schedule	constantOptimizer	ADAM Kingma & Ba (2014)Memory Burn-in	100000Memory Size	200Alternate Training Window	1000000019Under review as a conference paper at ICLR 2021D Network DetailsAlthough other works such as Chaplot et al. (2018) have investigated language-conditioned RL(usually in the form of instruction following), our hypothesis conditioned problem proved to bechallenging, and required some novelty in network architectures. Figure 7 shows our networkdiagrams.
Table 5: Policy Network HyperparametersParameter	ValueSeq2Vec Model	Bag-of-WordsWord Embedding Size	32Hidden Size	32MLP Num Hidden Layers	2Number of MLP Modules	16Transfer Layer	tanhTable 6: MLP Baseline Policy Network HyperparametersParameter	ValueSeq2Vec Model	Bag-of-WordsWord Embedding Size	32Hidden Size	32MLP Num Hidden Layers	2Transfer Layer	tanhTable 7:	Transformer Network HyperparametersParameter ValueWord Embedding Size 32Hidden Size	32Transfer Layer	ReLU
Table 6: MLP Baseline Policy Network HyperparametersParameter	ValueSeq2Vec Model	Bag-of-WordsWord Embedding Size	32Hidden Size	32MLP Num Hidden Layers	2Transfer Layer	tanhTable 7:	Transformer Network HyperparametersParameter ValueWord Embedding Size 32Hidden Size	32Transfer Layer	ReLUTransformer N	3Table 8:	Baseline Prediction Network HyperparametersParameter	ValueSeq2Vec Model	LSTMLSTM Num Layers	1Word Embedding Size	32Hidden Size	32MLP Num Hidden Layers	2
Table 7:	Transformer Network HyperparametersParameter ValueWord Embedding Size 32Hidden Size	32Transfer Layer	ReLUTransformer N	3Table 8:	Baseline Prediction Network HyperparametersParameter	ValueSeq2Vec Model	LSTMLSTM Num Layers	1Word Embedding Size	32Hidden Size	32MLP Num Hidden Layers	2Transfer Layer	tanh21Under review as a conference paper at ICLR 2021E Test-time hypothesesTo examine whether the hypothesis prediction networks are overfit to the very specific hypothesesthe networks were trained on, we conduct a simple experiment and we test on different hypotheses.
Table 8:	Baseline Prediction Network HyperparametersParameter	ValueSeq2Vec Model	LSTMLSTM Num Layers	1Word Embedding Size	32Hidden Size	32MLP Num Hidden Layers	2Transfer Layer	tanh21Under review as a conference paper at ICLR 2021E Test-time hypothesesTo examine whether the hypothesis prediction networks are overfit to the very specific hypothesesthe networks were trained on, we conduct a simple experiment and we test on different hypotheses.
Table 9: Average Hypothesis Prediction scores on new templates	Method	Hypothesis AccuracyColorSwitch	Fixed Policy FinetUned Policy	81.49% 71%Pushblock	Fixed Policy Finetuned Policy	89% 84.87%Crafting	Fixed Policy Finetuned Policy	58.22% 90.3%Cartpole	Fixed Policy Finetuned Policy	78.97% 81.3%F	Crosstab Performance AnalysisIn this section, we further break down the results in the main paper by specific templates, entitiesmentioned (e.g. colors) and whether the given template was true or false. We do this analysis only forFixed and Finetune as the baselines fail fairly uniformly and the analysis would be less interesting.
Table 10:	Colorswitch T/F CrosstabsTrue/False	Fixed Acc	Finetune AccTrue	0.941558	0.835376False	0.788904	0.721134Table 11:	Pushblock T/F CrosstabsTrue/False	Fixed Acc	Finetune AccTrue	0.969079	0.959164False	0.760620	0.746091does not substatially change the value. The exception is Cartpole, but this is actually because unlikethe other environments, there are really two distinct hypothesis effects which are not equivalent: windversus gravity. In the hypotheses which mention left or right, the agent is actually testing hypothesesabout which way the wind is blowing (left of right) whereas the half and double hypotheses aretesting the gravity. We see that the agent performs better on wind hypotheses than on gravity, but thedirection or gravity effect does not substantially effect the result. This is likely due to the fact thatwhen the pole of the cartpole is level, the effect of gravity is less obvious. If you read the originalcartpole code, you can see this. So these are harder because it requires the agent to have the pole inthe less stable, non-centered position. Whereas for wind, the effect of a wind force is immediate andmore obvious to the agent (there is now an opposing force the agent must act against to keep the poleupright).
Table 11:	Pushblock T/F CrosstabsTrue/False	Fixed Acc	Finetune AccTrue	0.969079	0.959164False	0.760620	0.746091does not substatially change the value. The exception is Cartpole, but this is actually because unlikethe other environments, there are really two distinct hypothesis effects which are not equivalent: windversus gravity. In the hypotheses which mention left or right, the agent is actually testing hypothesesabout which way the wind is blowing (left of right) whereas the half and double hypotheses aretesting the gravity. We see that the agent performs better on wind hypotheses than on gravity, but thedirection or gravity effect does not substantially effect the result. This is likely due to the fact thatwhen the pole of the cartpole is level, the effect of gravity is less obvious. If you read the originalcartpole code, you can see this. So these are harder because it requires the agent to have the pole inthe less stable, non-centered position. Whereas for wind, the effect of a wind force is immediate andmore obvious to the agent (there is now an opposing force the agent must act against to keep the poleupright).
Table 12:	Crafting T/F CrosstabsTrue/False Fixed Acc Finetune AccTrue	0.819272	0.897819False	0.730525	0.913886Table 13:	Cartpole T/F CrosstabsTrue/False Fixed Acc Finetune AccTrue	0.876085	0.894504False	0.822460	0.850877Table 14: Colorswitch Elements CrosstabsElement	Fixed Acc	Finetune Accblue	0.860603	0.817654black	0.874475	0.711046red	0.868067	0.699999green	0.857772	0.883432on	0.863618	0.779900off	0.859275	0.772164Table 15: Pushblock Elements CrosstabsElement	Fixed Acc	Finetune Accleft	0.881174	0.860691bottom	0.869612	0.866311
Table 13:	Cartpole T/F CrosstabsTrue/False Fixed Acc Finetune AccTrue	0.876085	0.894504False	0.822460	0.850877Table 14: Colorswitch Elements CrosstabsElement	Fixed Acc	Finetune Accblue	0.860603	0.817654black	0.874475	0.711046red	0.868067	0.699999green	0.857772	0.883432on	0.863618	0.779900off	0.859275	0.772164Table 15: Pushblock Elements CrosstabsElement	Fixed Acc	Finetune Accleft	0.881174	0.860691bottom	0.869612	0.866311right	0.833578	0.830409top	0.874413	0.853540Table 16: Crafting Elements CrosstabsElement	Fixed Acc	Finetune Acc
Table 14: Colorswitch Elements CrosstabsElement	Fixed Acc	Finetune Accblue	0.860603	0.817654black	0.874475	0.711046red	0.868067	0.699999green	0.857772	0.883432on	0.863618	0.779900off	0.859275	0.772164Table 15: Pushblock Elements CrosstabsElement	Fixed Acc	Finetune Accleft	0.881174	0.860691bottom	0.869612	0.866311right	0.833578	0.830409top	0.874413	0.853540Table 16: Crafting Elements CrosstabsElement	Fixed Acc	Finetune Accpickaxe	0.749928	0.885686craft	0.774918	0.905880torch	0.790433	0.931534stick	0.790664	0.927625
Table 15: Pushblock Elements CrosstabsElement	Fixed Acc	Finetune Accleft	0.881174	0.860691bottom	0.869612	0.866311right	0.833578	0.830409top	0.874413	0.853540Table 16: Crafting Elements CrosstabsElement	Fixed Acc	Finetune Accpickaxe	0.749928	0.885686craft	0.774918	0.905880torch	0.790433	0.931534stick	0.790664	0.927625coal	0.766912	0.884030bed	0.759223	0.880414iron	0.783844	0.890114wood	0.808903	0.93903224Under review as a conference paper at ICLR 2021Table 17: Cartpole Elements CrosstabsElement Fixed Acc Finetune Acc
Table 16: Crafting Elements CrosstabsElement	Fixed Acc	Finetune Accpickaxe	0.749928	0.885686craft	0.774918	0.905880torch	0.790433	0.931534stick	0.790664	0.927625coal	0.766912	0.884030bed	0.759223	0.880414iron	0.783844	0.890114wood	0.808903	0.93903224Under review as a conference paper at ICLR 2021Table 17: Cartpole Elements CrosstabsElement Fixed Acc Finetune Accblue	0.856136	0.882224black	0.844531	0.868902red	0.855209	0.898623green	0.841047	0.840754left	0.865710	0.876526right	0.873185	0.901369
Table 17: Cartpole Elements CrosstabsElement Fixed Acc Finetune Accblue	0.856136	0.882224black	0.844531	0.868902red	0.855209	0.898623green	0.841047	0.840754left	0.865710	0.876526right	0.873185	0.901369half	0.824625	0.846780double	0.839608	0.846751Table 18: Colorswitch Template CrosstabsTemplate	Fixed Acc	Finetune Accno password just make the COLOR switch be ON_OFF_SWITCHSTATE to open the door	0.805164	0.715492the COLOR switch is ON_OFF_SWITCHSTATE then the door is open	0.909462	0.809612COLOR controls the door and it opens when it is ON_OFF_SWITCHSTATE	0.757894	0.636947those who want to open the door must first switch the COLOR switch ON_OFF_SWITCHSTATE	0.738385	0.784663COLOR switch ON_OFF_SWITCHSTATE equals open door	0.771802	0.654603if the COLOR switch is ON_OFF_SWITCHSTATE the door is passable	0.909699	0.809354if the COLOR switch turns ON_OFF_SWITCHSTATE the door opens	0.845888	0.808421the COLOR switch is ON_OFF_SWITCHSTATE the door is passable	0.909085	0.806334
Table 18: Colorswitch Template CrosstabsTemplate	Fixed Acc	Finetune Accno password just make the COLOR switch be ON_OFF_SWITCHSTATE to open the door	0.805164	0.715492the COLOR switch is ON_OFF_SWITCHSTATE then the door is open	0.909462	0.809612COLOR controls the door and it opens when it is ON_OFF_SWITCHSTATE	0.757894	0.636947those who want to open the door must first switch the COLOR switch ON_OFF_SWITCHSTATE	0.738385	0.784663COLOR switch ON_OFF_SWITCHSTATE equals open door	0.771802	0.654603if the COLOR switch is ON_OFF_SWITCHSTATE the door is passable	0.909699	0.809354if the COLOR switch turns ON_OFF_SWITCHSTATE the door opens	0.845888	0.808421the COLOR switch is ON_OFF_SWITCHSTATE the door is passable	0.909085	0.806334when the COLOR switch is in the ON_OFF_SWITCHSTATE position the door is passable	0.909311	0.798914the COLOR switch is ON_OFF_SWITCHSTATE and we see the door is open	0.910084	0.808421ON_OFF_SWITCHSTATE is the correct position of the COLOR switch and it opens the door	0.786958	0.617625if the COLOR switch is ON_OFF_SWITCHSTATE the door will open	0.911169	0.813248when we see the COLOR switch is ON_OFF_SWITCHSTATE the door must be open	0.860697	0.792323if you see COLOR switch then the door is open	0.847181	0.761045when the COLOR switch is in the ON_OFF_SWITCHSTATE position then the door is open	0.908866	0.805041the COLOR switch is what controls the door	0.865501	0.790601when the COLOR switch is in the ON_OFF_SWITCHSTATE position the door will open	0.911304	0.801073when the COLOR switch is in the ON_OFF_SWITCHSTATE position and we see the door is open	0.909594	0.800795
Table 19: Pushblock Template CrosstabsTemplate	Fixed Acc	Finetune Accdoor can only open with pushblock being PUSHBLOCK_POSITION	0.820393	0.856789the pushblock is at the PUSHBLOCK_POSITION then the door is open	0.869955	0.859727PUSHBLOCK_POSITION is the correct position for the pushblock to open the door	0.872479	0.843071the pushblock is at the PUSHBLOCK_POSITION the door is passable	0.872433	0.863410if the pushblock is PUSHBLOCK_POSITION it means the door is open	0.876048	0.850846whenever the pushblock is in the PUSHBLOCK_POSITION the door will open	0.874485	0.860658if the pushblock is at the PUSHBLOCK_POSITION the door is passable	0.874790	0.859502PUSHBLOCK_POSITION pushblock opens the door	0.878205	0.858935the pushblock is at the PUSHBLOCK_POSITION and we see the door is open	0.870191	0.860378door opens when PUSHBLOCK_POSITION is where the pushblock is	0.857907	0.853671if the door is open it must be that the pushblock is at the PUSHBLOCK_POSITION	0.868565	0.840094if the pushblock is at the PUSHBLOCK_POSITION then the door is open	0.877208	0.854677whenever the pushblock is in the PUSHBLOCK_POSITION the door is passable	0.870555	0.866253open door means pushblock PUSHBLOCK_POSITION	0.835129	0.857000if the pushblock is at the PUSHBLOCK_POSITION and we see the door is open	0.871365	0.855871the door can only be opened when the pushblock is PUSHBLOCK_POSITION	0.871308	0.855845pushblock PUSHBLOCK_POSITION means door open	0.839570	0.861030whenever the pushblock is in the PUSHBLOCK_POSITION then the door is open	0.878206	0.858112
Table 20: Crafting Template CrosstabsTemplate	Fixed Acc	Finetune Accyou are at LOCATION and have in your inventory CRAFTING_ITEM and		you do CRAFTING_ACTION then CREATED_ITEM is made	0.980752	0.992622if you want to make a CREATED_ITEM then go to LOCATION with		CRAFTING_ITEM and do CRAFTING_ACTION	0.618157	0.751656CREATED_ITEM when CRAFTING_ITEM at LOCATION and do CRAFTING_ACTION	0.621186	0.833183you are at LOCATION and have in your inventory CRAFTING_ITEM then you CRAFTING_ACTION		so CREATED_ITEM is created and put in your inventory when you are at LOCATION and you have CRAFTING_ITEM then you	0.909046	0.994463CRAFTING_ACTION then CREATED_ITEM is made	0.882973	0.990093when you are at LOCATION and you have CRAFTING_ITEM and you		do CRAFTING_ACTION then CREATED_ITEM is made	0.988334	0.992137if you do CRAFTING_ACTION at LOCATION with CRAFTING_ITEM you make CREATED_ITEM you are at LOCATION and have in your inventory CRAFTING_ITEM and you do CRAFTING_ACTION	0.702412	0.981659you now have CREATED_ITEM in your inventory whenever you have a CRAFTING_ITEM and are at LOCATION then you CRAFTING_ACTION	0.903610	0.993235you now have CREATED_ITEM in your inventory	0.920456	0.991195CRAFTING_ITEM plus LOCATION plus CRAFTING_ACTION equals CREATED_ITEM CREATED_ITEM can be created by doing CRAFTING_ACTION at LOCATION when	0.493720	0.596603CRAFTING_ITEM is in inventory you are at LOCATION and have in your inventory CRAFTING_ITEM	0.431615	0.546072then you CRAFTING_ACTION then CREATED_ITEM is created you are at LOCATION and have in your inventory CRAFTING_ITEM	0.980229	0.991235and you do CRAFTING_ACTION then CREATED_ITEM is created	0.957643	0.993386CRAFTING_ACTION at LOCATION creates CREATED_ITEM but only if you have a CRAFTING_ITEM	0.571485	0.913526
Table 21: Crafting Template Crosstabs (Continued)Template	Fixed Acc	Finetune Accwhenever you have a CRAFTING_ITEM and are at LOCATION and you do CRAFTING_ACTION and this creates CREATED_ITEM	0.838137	0.994172whenever you have a CRAFTING_ITEM and are at LOCATION and you do CRAFTING_ACTION then CREATED_ITEM is created	0.891907	0.914471you are at LOCATION and have in your inventory CRAFTING_ITEM and you do CRAFTING_ACTION and this creates CREATED_ITEM	0.937222	0.990594you are at LOCATION and have in your inventory CRAFTING_ITEM then you CRAFTING_ACTION you now have CREATED_ITEM in your inventory	0.885896	0.989596having CRAFTING_ITEM in your inventory being at LOCATION and doing CRAFTING_ACTION creates CREATED_ITEM	0.487408	0.817408create a CREATED_ITEM by being at LOCATION with CRAFTING_ITEM and doing CRAFTING_ACTION	0.545770	0.919413when you are at LOCATION and you have CRAFTING_ITEM and you do CRAFTING_ACTION so CREATED_ITEM is created and put in your inventory	0.956038	0.991977whoever does CRAFTING_ACTION at LOCATION with CRAFTING_ITEM gets CREATED_ITEM	0.483942	0.566790when you are at LOCATION and you have CRAFTING_ITEM then you CRAFTING_ACTION so CREATED_ITEM is created and put in your inventory	0.973726	0.996132you have CRAFTING_ITEM and go to LOCATION and CRAFTING_ACTION and CREATED_ITEM will be created	0.703044	0.914437CRAFTING_ITEM in inventory at LOCATION makes CREATED_ITEM if you do CRAFTING_ACTION	0.545541	0.897572you are at LOCATION and have in your inventory CRAFTING_ITEM and you do CRAFTING_ACTION so CREATED_ITEM is created and put in your inventory	0.898226	0.919370LOCATION plus CRAFTING_ACTION creates a CREATED_ITEM	0.541849	0.873599when you are at LOCATION and you have CRAFTING_ITEM and you do CRAFTING_ACTION you now have CREATED_ITEM in your inventory	0.972194	0.994262when you are at LOCATION and you have CRAFTING_ITEM then you CRAFTING_ACTION and this creates CREATED_ITEM	0.941614	0.994693CREATED_ITEM can be made with CRAFTING_ITEM when you do CRAFTING_ACTION at LOCATION	0.578862	0.687136whenever you have a CRAFTING_ITEM and are at LOCATION and you do CRAFTING_ACTION then CREATED_ITEM is made	0.891969	0.993853whenever you have a CRAFTING_ITEM and are at LOCATION then you CRAFTING_ACTION then CREATED_ITEM is made	0.933055	0.989965
