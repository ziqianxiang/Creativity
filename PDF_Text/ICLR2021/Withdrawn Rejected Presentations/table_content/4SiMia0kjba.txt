Table 1: R50/R90 losses on the electricity and traffic datasets in the univariate group, where denotes theresults obtained from Li et al. (2019).
Table 2: R50 losses on the retail and ride-hailing datasets. Percentages in brackets are loss reductions betweenCausalTrans and the Second best result. ◊ denotes results from Li et al.(2019)._________________________________	ConvTrans	Seq2Seq	MQRNN	DeepAR	DMVST	ST-MGCN	TFT	CausalTransRetail	0.4290	0.4110	0.3790	0.386	0.403	0.395	0.3540	0.352(-0.6%)Ride-hailing (1d, city A, Demand)	0.573	0.550	0.495	0.499	0.524	0.482	0.450	0.434(-3.7%)Ride-hailing (1d, city A, Supply)	0.482	0.453	0.428	0.422	0.443	0.421	0.415	0.393(-5.3%)Ride-hailing (1d, city B, Demand)	0.470	0.455	0.405	0.400	0.422	0.404	0.370	0.361(-2.5%)Ride-hailing (1d, city B, Supply)	0.426	0.404	0.388	0.384	0.388	0.378	0.357	0.341(-4.5%)Ride-hailing (7d, city A, Demand)	0.756	0.717	0.653	0.663	0.664	0.677	0.689	0.613(-6.2%)Ride-hailing (7d, city A, Supply)	0.612	0.569	0.516	0.519	0.536	0.575	0.583	0.468(-9.3%)Ride-hailing (7d, city B, Demand)	0.693	0.627	0.574	0.571	0.590	0.588	0.576	0.539(-5.6%)Ride-hailing (7d, city B, Supply)	0.568	0.519	0.499	0.501	0.503	0.525	0.528	0.454(-9.0%)Traffic. Traffic contains hourly univariate occupancy rate of 963 San Francisco bay area freeways, where thelook-back rolling window and prediction step are the same as Electricity.
Table 3: R90 losses on the retail and ride-hailing datasets. Percentages in brackets are loss reductions betweenCausalTrans and the Second best result. ◊ denotes results from Li et al.(2019)._________________________________	ConvTrans	Seq2Seq	MQRNN	DeepAR	DMVST	ST-MGCN	TFT	CausalTransRetail	0.192	0.157	0.152。	0.156	0.156	0.155	0.147。	0.143(-2.8%)Ride-hailing (1d, city A, Demand)	0.238	0.208	0.205	0.205	0.208	0.195	0.192	0.164(-14.6%)Ride-hailing (1d, city A, Supply)	0.212	0.177	0.164	0.162	0.173	0.165	0.160	0.142(-11.3%)Ride-hailing (1d, city B, Demand)	0.208	0.176	0.159	0.158	0.170	0.157	0.155	0.145(-6.5%)Ride-hailing (1d, city B, Supply)	0.205	0.197	0.157	0.188	0.169	0.151	0.149	0.139(-6.7%)Ride-hailing (7d, city A, Demand)	0.324	0.306	0.276	0.289	0.286	0.280	0.297	0.244(-11.6%)Ride-hailing (7d, city A, Supply)	0.259	0.233	0.207	0.204	0.237	0.248	0.237	0.173(-15.2%)Ride-hailing (7d, city B, Demand)	0.288	0.269	0.241	0.240	0.252	0.255	0.238	0.216(-9.3%)Ride-hailing (7d, city B, Supply)	0.214	0.184	0.177	0.179	0.168	0.197	0.204	0.153(-8.9%)4.3	Results and DiscussionWe adapt the quantile loss as optimization function, and compare various results by q-risk R50/R90 atquantile point 50%/90%. More detailed descriptions of probabilistic forecasting are provided in subsection3.2.
Table 4: Optimal hyperparameters on Ride-hailing dataset.
Table 5: Ablation analysis (R50 losses) of various components in CausalTrans. Each value represents theR50 loss that eliminates a specific component, and percentages in brackets are loss variations. For Trafficdata set, PoissonOutput and SpatialFusion are positive components. For Ride-hailing data set,each component reflects different importance varying on different tasks. For PoissonOutput, forecastingdemand and supply are not significantly different, but longer predict step leads to a bigger loss increment. Lackof PoissonOutput increases 2% loss on average. The most essential component C.A.(DML) improvescollaborative supply forecasting more than demand. Long-term prediction depends on C.A.(DML) as wellas the causal covariates. C.A.(Uplift) is similar to C.A.(DML), but the simpler C.A.(Uplift)means less importance. FastAttention (-0.2% on average) and SpatialFusion (+0.3% on average)are proposed for reducing time complexity significantly without harming loss.
Table 6: Ablation analysis (R50 losses) of various cluster number K in SpatialFusion. Each valuerepresents the R50 loss on a specific K, and percentages in brackets are loss variations. Roughly speaking,seven-day prediction needs bigger K than one-day. We conclude that the longer prediction range needs moreheterogeneous patterns. Optimal K on various Ride-hailing subdatasets are shown in Table 4.
