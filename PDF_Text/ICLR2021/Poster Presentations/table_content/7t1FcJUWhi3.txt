Table 1: Extrapolation accuracy (± 95% confidence interval, bold means p < 0.05 significant)Image transformation groups {Grot, Gvertical-flip, Gcolor} Task: Predict digit & which transformations of GD was applied to image							Sequences {G1,2, . . . , Gn-1,n} Tasks depend on I (see Appendix G)			MNIST {3,4} images				MNIST all images			Sequence Tasks			I	VGG	+G-inv	+CGreg	VGG	+G-inv	+CGreg	I	Transformer	Best FF+G-inv	FF+CGreg0	96.06±0.63	15.96±2.17	94.49±01.49	89.35±0.52	15.64±1.55	90.89±0.93	0	100.00±0.00	23.38±1.88	95.70±03.05color	15.06±6.70	50.05±2.17	94.16±06.43	4.51±1.36	47.61±0.45	88.69±2.11	{(i,i+2k)}i,k	0.85±0.37	0.97±0.60	71.85±26.61rot,vflip	54.87±0.90	32.05±1.16	95.78±07.11	25.91±0.95	44.41±3.28	62.68±6.02	{(i,j)}j>i≥2	12.15±16.05	10.68±1.49	42.08±18.99rot,col,vflip	49.52±2.37	97.19±1.02	94.89±07.49	11.27±0.34	68.46±2.83	64.99±2.76	{(Kj)}j>i≥1	20.26±32.08	100.00±0.00	100.00±00.00Training data: The training data is sampled via the SCM equations using an economical datageneration process. We decompose the transformation TUI,UD into a transformation TUD ∈ GDfollowed by another transformation TU0 |UD ∈ GI to obtain X = TU0 |UD ◦ TUD ◦ X(hid). Thisdecomposition is made possible from our assumption that GI is a normal subgroup of GD∪I (Theo-rem 2). Under the assumption of economic sampling of the training data, in all our experiments wesimply set TU0 |UD = Tidentity ∈ GI, whereas TUD is randomly sampled from GD . Finally, followingEquation (3), the label Y is a combination of the original label of X(hid) and the transformation TUD .
Table 2: (MNIST-34.) Validation and Extrapolation test accuracies (%) with 95% confidence intervalsfor different CG-regularization strength λ in Equation (11). λ is chosen only based on the validationaccuracy: maximum λ with validation accuracy within 5% of the best validation accuracy (boldvalues indicate the performance of this choice of λ).
Table 3: (MNIST.) Validation and Extrapolation test accuracies (%) with 95% confidence intervalsfor different CG-regularization strength λ in Equation (11). λ is chosen only based on the validationaccuracy: maximum λ with validation accuracy within 5% of the best validation accuracy (boldvalues indicate the performance of this choice of λ).
Table 4: Sequence tasks. The first column defines the target Y for a given sequence (Xi)i1=01. Thesecond column denotes GI , the group of transformations to which Y is invariant. Recall that GI isconstructed as the join of a subset of 120 transposition groups.
Table 5: (Sequence tasks) Extrapolation test accuracies (%) with 95% confidence intervals for allthe models (bold means p < 0.05 significant). The standard sequence models cannot extrapolatewhen I= 0 whereas the forced G-invariant models cannot unlearn the invariances and fail whenI ( {1, . . . , m}.
Table 6: (Sequence Tasks) Validation and Extrapolation test accuracies (%) with 95% confidenceintervals for different CG-regularization strength λ in Equation (11). λ is chosen only based on thevalidation accuracy: maximum λ with validation accuracy within 5% of the best validation accuracy(bold values indicate the performance of this choice of λ).
