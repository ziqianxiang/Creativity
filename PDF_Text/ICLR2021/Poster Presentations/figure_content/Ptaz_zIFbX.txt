Figure 1: Demonstration of intuitive planning on a diffusive transition task on a 1D ring track.
Figure 2: Demonstration of our method in a 2D 50 × 50 environment with periodic boundaryconditions. A: Transition matrix P(xt+1 = (i0, j0)|xt = (i, j)) starting from a randomly chosenstate ((8, 10); red star) with drift velocity 10 units southward and Gaussian diffusion (red arrow); B:Usage of the eigenbasis (Eq. 4) and our analysis (Eq. 7) for predicting the distribution over futurestates given the transition structure given in A, showing successive changes to state occupancy; C:Application of our model to translation-only transition structures (drift velocity v = (3, 3)); (D-E):Ground-truth shortest distance to state (8, 20) (red star; D) as a function of the starting location, anddistance estimated under the intuitive planning framework (E) using plain diffusion; F: Estimateddistance measure (E) v.s. the corresponding ground-truth distance (D) over all pairs of states; G:Examples of 2D Fourier modes (real parts shown, see Appendix Fig. 7 for the top 100 eigenvectors).
Figure 3: Application to spatial navigation in grid worlds. A: The 10 × 10 windy grid worldtask environment, with toroidal boundary conditions and a constant external force causing two unitsof displacement southward acting on every state (white arrow: wind; blue arrow: one-step actionrightward; green arrow: actual displacement, G: goal state); B: Estimated SR (using Eq. 2 and Eq. 7)under diffusion plus the wind effect (color indicates the strength of future probabilities of occupyingthe target states); C: Path following the diffusion SR plus the wind effect; D: Updated diffusionSR plus wind given the insertion of a barrier (dark blocks); E: Path following the updated SR; F:Navigation in the task space (S0 , yellow) with boundaries (magenta) embedded in a pseudo statespace (Sp , blue), utilising the Fourier modes computed from Sp ; G: Navigation in S0 with insertedlocal obstacles (black); H: Path integration error over timesteps under different levels of diffusion.
Figure 4: Neural network implementation of the proposed grid cell model for reinforcementlearning. A: Schematic illustration of the gc-DQN agent. B: Evaluation of gc-DQN and the baselineDQN agents in the CartPole task (Barto et al. [3]). The evaluations are computed given 5 randomseeds. See Appendix. E for details of the implementation.
Figure 5: Generated grid-like patterns given our model. A: 6 input Fourier modes with the samewavelength (complex phases shown); B: Simulated grid cell firing given a real rat trajectory (grayline) using coincidence detection and baseline modulation given the 6 Fourier modes inputs in A,each spike is represented by a colored scatter with the color indicates the corresponding "theta" phaseat the spiking time; C: Simulated grid cell firing fields given multiple runs in the same direction(black arrow) showing theta phase precession.
Figure 6:	Application of Fourier shift theorem for predicting changes in eigenvalues. We showthe ground-truth (blue) and predicted (red) phase shifts of the eigenvalues of transition matricesgiven arbitrary drift velocity for: A: plain translation (5 units rightward); (B): diffusion with one-steptranslations (5 states rightward + diffusion). The horizontal and vertical axes represent the indices ofthe eigenvalues and the corresponding phase changes (in radians) respectively.
Figure 7:	Phase plots of 100 chosen low-frequency Fourier basis vectors with different frequenciesand wavevectors.
Figure 8: Constructed place cell and grid cell firing fields from Fourier modes. A: Place cellsfiring fields constructed from coincidence detection of selected input Fourier modes (bottom plotshows a place field restricted to a small subset of the toroidal state space); B: Grid cell firing fieldswith various spacings and orientations constructed from principal Fourier modes (Fig. 7).
Figure 9: Generalisation of flexible planning on transitive inference task. Given {xi }i2=590 suchthat xi > xi+1 for all i (and x259 > x0 for ensuring the circulant structure). The bar plot shows thatwe can correctly infer transitive relations between the chosen state x129 (red star) and nearby targetstates via computing the difference between the discounted future occupancy of the target state underthe action-dependent SRs (Eq. 2) corresponding to the "smaller" (left) and "greater" (right) actions.
