Figure 1: A selective classifier (y, c) makes a prediction y(x) on a point X if its confidence c(x) inthat prediction is larger than or equal to some threshold τ . We assume the data comprises differentgroups each with their own data distribution, and that these group identities are not available tothe selective classifier. In this figure, we show a classifier with low accuracy on a particular group(red), but high overall accuracy (blue). Left: The margin distributions overall (blue) and on the redgroup. The margin is defined as ^(x) on correct predictions (y(x) = y) and -c(x) otherwise. For athreshold τ, the selective classifier is thus incorrect on points with margin ≤ -τ; abstains on pointswith margin between -τ and τ ; and is correct on points with margin ≥ τ . Right: By varying τ ,we can plot the accuracy-coverage curve, where the coverage is the proportion of predicted points.
Figure 2: Accuracy (top) and coverage (bottom) for each group, as a function of the average cover-age. Each average coverage corresponds to a threshold τ . The red lines represent the worst group.
Figure 3: SR selective classifiers (solid line) substantially underperform their group-agnostic ref-erences (dotted line) on the worst group, which are in turn far behind the best-case Robin Hoodreferences (dashed line). By construction, these share the same average accuracy-coverage curves(blue line). Similar results for MC-dropout are in Figure 7.
Figure 4: Margin distributions on average (top) and on the worst group (bottom). Positive (negative)margins correspond to correct (incorrect) predictions, and we abstain on points with margins closestto zero first. The worst groups have disproportionately many confident but incorrect examples.
Figure 5: When applied to group DRO models, which have more similar accuracies across groupsthan standard models, SR selective classifiers improve average and worst-group accuracies. At lowcoverages, accuracy estimates are noisy as only a few predictions are made.
Figure 6: Density of margins for the average (top) and the worst-group (bottom) distributions overmargins for the group DRO model. Positive (negative) margins correspond to correct (incorrect)predictions, and we abstain on margins closest to zero first. Unlike the selective classifiers trainedwith ERM, we see similar average and worst-group distributions for group DRO.
Figure 7: Selective accuracy (top) and coverage (bottom) for each group, as a function of the averagecoverage for the MC-dropout selective classifier. Each average coverage corresponds to a thresholdτ . The red lines represent the worst group.
Figure 8: Selective accuracy (top) and coverage (bottom) for each group as a function of the averagecoverage for the softmax response selective classifier with model optimized with group DRO. Eachaverage coverage corresponds to a specific threshold τ. The red lines represent the worst group (i.e.
Figure 9: Simulation results on margin distributions that are mixtures of two Gaussians, whereWe vary the mean and the variance of the worst-group margin distributions. For parameters corre-sponding to the blue and orange regions, the worst group outperforms and underperforms the group-agnostic reference, respectively. We do not consider parameters in the white region to maintain thatthey yield full-coverage accuracies that are worse than the other group. We shade parameters thatsatisfy the necessary condition in Proposition 3.
Figure 10: Simulation results on margin distributions that are mixtures of two Gaussians, where wevary the mean and the variance of the worst-group margin distribution, and keep the other group'smargin distribution fixed with mean and variance 1. We compute the difference in worst-group accu-racy with respect to the group-agnostic reference, taking the worst-case difference across thresholds:maxτ AFWg(T) - AFWg(T).
Figure 11: Simulation results on margin distributions that are mixtures of two Gaussians, where wevary the means of the two margin distributions, keeping their variances fixed at 1. We compute thedifference in worst-group accuracy with respect to the group-agnostic reference, taking the worst-case difference across thresholds: max「AFwg(T) - AFwg(T).
