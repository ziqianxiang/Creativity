Figure 1: Left: Visualization of calculating our stochastic logits FH (x) from (5). The input image xis replicated H times and parallel Langevin updates with a ConvNet EBM are performed on eachreplicate to generate {Xh}H=「Purified samples are sent in parallel to our naturally-trained classifiernetwork f (x) and the resulting logits {f (Xh)}H=ι are averaged to produce FH(x). The logits FH(x)give an approximation of our true classifier logits F (x) in (4) that can be made arbitrarily precise byincreasing H. Right: Graphical diagram of the Langevin dynamics (3) that we use for T (x). Imagesare iteratively updated with a gradient from a naturally-trained EBM (1) and Gaussian noise Zk .
Figure 2: Comparison of long-run and short-run samples over model updates for our improvedmethod of convergent learning. The model is updated in a non-convergent learning phase with theAdam optimizer for the first 50,000 batches. The majority of short-run synthesis realism is learnedduring this phase, but the long-run samples are very unrealistic. The second learning phase usesSGD with a low learning rate. Short-run synthesis changes very little, but the long-run distributiongradually aligns with the short-run distribution.
Figure 3: The histograms display different realizations of the logits FH (x) for the correct class andthe second most probable class for images x1 (left) and x2 (right) over different choices of H. In bothcases, F (x) (dashed vertical lines) gives correct classification. However, the overlap between thelogit histograms of FH(x1) indicate a high probability of misclassification even for largeH, whileFH(x2) gives correct prediction even for small H because the histograms are well-separated. TheEOT defense formulation (4) is essential for securing borderline images such as x1.
Figure 4: Accuracy on natural images and adversarial images from a BPDA+EOT attack (10) forEBM defense with different number of Langevin steps, and images sampled from the EBM. Left:Defense with a convergent EBM. Using approximately 1500 Langevin steps yields a good balanceof natural and robust accuracy. Right: Defense with non-convergent EBM. Oversaturated long-runimages prevent non-convergent EBM defense from achieving high natural or robust accuracy.
Figure 5: Accuracy across perturbation ε for l∞ and l2 attacks against our defense, standard AT(Madry et al., 2018) and Semi-supervised AT (Carmon et al., 2019).
Figure 6: Effect of number of attack steps N and number of EOT replicates Hadv and Hdef.
Figure 7: Energy U(x; θ) of natural, adversarial, and noise images.
Figure 8: Left: Maximal Lyapunov exponent for different values of η. The value η = 1 whichcorresponds to our training and defense sampling dynamics is just above the transition from theordered region where the maximal exponent is 0to the chaotic region that where the maximal exponentis positive. Right: Appearance of steady-state samples for different values of η . Oversaturated imagesappear for low values of η, while noisy images appear for high η . Realistic synthesis is achieved in asmall window around η = 1 where gradient and noise forces are evenly balanced.
Figure 9: FID scores of samples from a convergent and non-convergent EBM that are initialized fromtraining data. The FID of the convergent model remains reasonably low because the steady-state of theconvergent model is aligned with the data distribution. The FID of the non-convergent model quicklyincreases because the oversaturated steady-state of the non-convergent model differs significantlyfrom the data distribution. Maintaining a sampling distribution close to the data distribution isessential for achieving high prediction accuracy of a natural classifier on transformed states.
Figure 10: Left: Approximate steady-state samples of the IGEM and JEM models. Both exhibitoversaturation from non-convergent learning that can interfere with defense capabilities. Right:Comparison of running time for Langevin sampling with a batch of 100 images. The small scale andfast sampling of our EBM are important for the computational feasibility of our defense.
