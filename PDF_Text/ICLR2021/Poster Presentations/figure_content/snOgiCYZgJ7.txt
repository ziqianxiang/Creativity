Figure 1: Hierarchical encoding. Panel (A)shows the minimum free energy structure (forillustration purpose only) which is represented asa graph. In panel (B), the original molecule is de-composed by grouping structurally adjacent nu-cleotides into subgraphs, giving rise to a higher-order junction tree representation.
Figure 2: Hierarchical decoding of a structuredRNA, involving three types of predictions, thatare on the topological level, node level, and nu-cleotide level. These three types of prediction areinterleaved into the procedures of decoding thejunction tree structure of RNA and the nucleotidesegments.
Figure 3: RNAs generated with structural constraints from HierVAE on a random axis in the latentspace (step size: 1e-4), for short (top), medium-length (middle), and long (bottom) RNAs. The Freeenergy (FE) and its deviation (DEV) from the MFE are given for each structure.
Figure S1: A nested RNA secondarystructure can be represented by: (A) dot-bracket annotation, where base-pairs cor-responding to matching parentheses, or(B) a molecular planar graph with twotypes of edges, corresponding to consec-utive nucleotides (backbone) and base-pairing interactions, or (C) a junctiontree where node are labeled as stems (S),hairpins (H), internal loops (I), or multi-loops (M), and edges correspond to theconnections between these elements. Allthree forms are equivalent.
Figure S2: This figure contains information of the unlabeled RNA dataset. (A) The number ofhypernodes appears to grow linearly with the length of RNA, and (B) the junction tree height alsogrows as the length increases but on a more moderate scale. (C) and (D) have shown bar-plots of thenumber of hypernodes and tree height, indicating that the junction tree of RNA can take on significantdepth hence contributing to the diversity and complexity of RNA secondary structures represented inthis dataset.
Figure S3:	A comparison of generated RNAs (left) to their corresponding MFE structures (right).
Figure S4:	Neighborhood visualization of tRNA-Cys6which is marked by the red bounding box in thecenter and the walk in the latent space takes place on two random orthogonal axes. Note that actualsecondary structure of tRNA-Cys plotted in the figure is different compared to the one depositedonline due to the prediction of RNAfold.
Figure S5:	Neighborhood visualization of a 5S ribosomal RNA8which is marked by the red boundingbox in the center and the walk in the latent space takes place on two random orthogonal axes. Notethat actual secondary structure of this 5S ribosomal RNA plotted in the figure is different comparedto the one deposited online due to the prediction of RNAfold.
Figure S6:	An example of searching novel structured RNAs with higher chance of binding to HuR.
