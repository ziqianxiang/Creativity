Figure 1: Differences between autoregressive and flow posteriors, based on discrete or continuouslatents. A The sequential autoregressive (top), and parallel flow-like sampling procedure (bottom).
Figure 2:	Correlated approximate posteriors in a single-channel (neuron) model. A Factorised gen-erative model. B Correlated approximate posterior, with an autoregressive temporal structure, butwithout correlations between cells. C Example observed fluorescence trace and average reconstruc-tions (top), inferred rates (middle) and inferred spiking (bottom), for the true posterior (dark gray),then models with factorised posteriors trained using VAE (red) and supervised (purple) procedures,and finally our new discrete flow trained using VAE (blue). D The true marginal probability of therebeing a spike in simulated data, against inferred probability. The optimal is unity (dark-gray). EThe number of inferred spikes, given only one spike in the underlying data. F The time course ofthe VAE objective under the different models, and the highest possible value for the objective, esti-mated using importance sampling. G The time required for a single iteration of the algorithm, forthe different variants in F.
Figure 3:	Correlated approximate posteriors to estimate the connectivity between multiple neurons.
