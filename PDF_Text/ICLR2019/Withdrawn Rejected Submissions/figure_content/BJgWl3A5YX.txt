Figure 1: Left: conventional RL optimizes the controller. Right: this work aims to jointly optimizeboth the controller and the body. Components to be optimized shown in shaded boxes.
Figure 2: Ant model(d) An evolved Ant Body(a) Unevolved Ant body (b) Ant body schematicify i’s configuration to be more similar to j ’s, affecting three types of parameters: neural networkweights, learner hyper-parameters, and body configuration parameters. Neural network parametersand body configuration parameters are set to the target j’s configuration. Each hyper-parameter istaken either from the evolving agent i or from the target j depending on a (possibly-biased) coin-flip. The inheritance procedure is given in Algorithm 2. Mutation: After inheritance, parametersundergo mutation, which modifies each parameter p by a factor fp following a uniform distributionfp -U (1 - m, 1 + m). After mutation, body parameters are capped at their individual upper andlower bounds (see Algorithm 4 in the Appendix for full details).
Figure 3: Ant body configuration parametersFigure 4: Selection of initial bodies for the body-improving populationscale the child node, illustrated in Figure 3. Edges have a “reflection” parameter to facilitate bodysymmetry; when enabled, the body of the child node is created twice: once in its specified positionand orientation, and a second time reflected across the parent’s Z-Y plane. No control systems arespecified by the genotype, instead all the actuators are made available to the RL algoithm as itsactions. The genotype constructed for our ant consists of three nodes and three edges connected asshown in Figure 2c. The root node specifies the spherical torso, with two edges connected to an“upper leg” node, one for the upper segment of the rear legs, and one for the front legs. The lowersegments of the ant’s legs are all specified by the same “lower leg” node. The full physical structureof the body is determined by 25 parameters in these nodes and edges (detailed in the Appendix).
Figure 4: Selection of initial bodies for the body-improving populationscale the child node, illustrated in Figure 3. Edges have a “reflection” parameter to facilitate bodysymmetry; when enabled, the body of the child node is created twice: once in its specified positionand orientation, and a second time reflected across the parent’s Z-Y plane. No control systems arespecified by the genotype, instead all the actuators are made available to the RL algoithm as itsactions. The genotype constructed for our ant consists of three nodes and three edges connected asshown in Figure 2c. The root node specifies the spherical torso, with two edges connected to an“upper leg” node, one for the upper segment of the rear legs, and one for the front legs. The lowersegments of the ant’s legs are all specified by the same “lower leg” node. The full physical structureof the body is determined by 25 parameters in these nodes and edges (detailed in the Appendix).
Figure 5: Elos progression and evolution of two body parameters during training. Vertical barsrepresents 10 hours/2e9 steps of training.
Figure 6: Shapley analysis of importance of evolved body parameters.
Figure 7: Selection of initial bodies for the body-improving population7.1 Body-improving Genotype InitializationThe initial body-improving agent population is generated by sampling body configurations aroundthe body-fixed configuration. Specifically, a random genotype is generated by uniformly sampling avalue for each mutable parameter within the mutable parameter’s lower and upper bounds. Examplesof an initial population of bodies is show in Figure 7.
