Figure 1: (Left) The reaction product prediction problem: Given the reactants and reagents, predictthe structure of the product. (Right) The reaction mechanism prediction problem: Given the reactantsand reagents, predict how the reaction occurred to form the products.
Figure 2: This figure shows the sequence of actions in transforming the reactants in box 1 to theproducts in box 9. The sequence of actions will result in a sequence of pairs of atoms, betweenwhich bonds will alternately be removed and created, creating a series of intermediate products. Ateach step the model sees the current intermediate product graph (shown in the boxes) as well as theprevious action, if applicable, shown by the grey circle. It uses this to decide on the next action.
Figure 4: An example of the paths sug-gested by Electro-Lite on one of theUSPTO test examples. Its first choice inthis instance is correct.
Figure 3: Example of how we turn a SMILES reaction string into an ordered electron path, for whichwe can train Electro on. This consists of a series of steps: (1) Identify bonds that change bycomparing bond triples (source node, end node, bond type) between the reactants and products. (2)Join up the bond changes so that one of the atoms in consecutive bond changes overlap (for reactionswhich do not have linear electron flow topology, such as multi-step reactions, this will not be possibleand so we discard these reactions). (3) Order the path (ie assign a direction). A gain of charge (oranalogously the gain of hydrogen as H+ ions without changing charge, such as in the example shown)indicates that the electrons have arrived at this atom; and vice-versa for the start of the path. Whendetails about both ends of the path are missing from the SMILES string we fall back to using anelement’s electronegativity to estimate the direction of our path, with more electronegative atomsattracting electrons towards them and so being at the end of the path. (4) The extracted electronpath deterministically determines a series of intermediate molecules which can be used for trainingElectro. Paths that do not consist of alternative add and removal steps and do not result in the finalrecorded product do not exhibit LEF topology and so can be discarded. An interesting observationis that our approximate reaction mechanism extraction scheme implicitly fills in missing reagents,which are caused by noisy training data — in this example, which is a Grignard- or Barbier-typereaction, the test example is missing a metal reagent (e.g. Mg or Zn). Nevertheless, our model isrobust enough to predict the intended product correctly (Effland et al., 1981).
Figure 5: (Left) Nucleophilic substitutions SN 2-reactions, (right) Suzuki-coupling (note that inthe “real” mechanism of the Suzuki coupling, the reaction would proceed via oxidative insertion,transmetallation and reductive elimination at a Palladium catalyst. As these details are not containedin training data, we treat Palladium implicitly as a reagent). In both cases, our model has correctlypicked up the trend that halides lower in the period table usually react preferably (I > Br > Cl).
Figure 6: This example shows how symmetry can affect the evaluation of electron paths. In thisexample, although one electron path is given in the USPTO dataset, the initial N that reacts could beeither 15 or 12, with no difference in the final product. This is why judging purely based on electronpath accuracy can sometimes be misleading.
Figure 7: Visualization of how node embeddings and graph embeddings are formed. Node embed-dings are d-dimensional vectors, one for each node. They are obtained using Gated Graph NeuralNetworks (Li et al., 2016). These networks consist of a series of iterative steps where the embeddingsfor each node are updated using the node,s previous embedding and a message from its neighbors.
Figure 8: Predicted mechanism of our model on reactant molecules. Green arrow shows preferredmechanism, whereas pink shows the model’s second preferred choice. Here, the first-choice predictionis incorrect, but chemically reasonable, as the Weinreb amide is typically used together in reactionswith Magnesium species. The second-choice prediction is correct.
Figure 9: Additional typical selectivity examples: Here, the expected product is shown on the right.
Figure 10: Four examples of the paths predicted by the Electro-Lite. (These reactions have beentaken from the USPTO dataset and have not been seen by the model in training).
