Training GANs with Optimism
Constantinos Daskalakis* *
MIT, EECS
costis@mit.edu
Andrew Ilyas*
MIT, EECS
ailyas@mit.edu
Vasilis Syrgkanis*
Microsoft Research
vasy@microsoft.com
Haoyang Zeng*
MIT, EECS
haoyangz@mit.edu
Ab stract
We address the issue of limit cycling behavior in training Generative Adversarial
Networks and propose the use of Optimistic Mirror Decent (OMD) for training
Wasserstein GANs. Recent theoretical results have shown that optimistic mirror
decent (OMD) can enjoy faster regret rates in the context of zero-sum games.
WGANs is exactly a context of solving a zero-sum game with simultaneous no-
regret dynamics. Moreover, we show that optimistic mirror decent addresses the
limit cycling problem in training WGANs. We formally show that in the case of
bi-linear zero-sum games the last iterate of OMD dynamics converges to an equi-
librium, in contrast to GD dynamics which are bound to cycle. We also portray the
huge qualitative difference between GD and OMD dynamics with toy examples,
even when GD is modified with many adaptations proposed in the recent litera-
ture, such as gradient penalty or momentum. We apply OMD WGAN training to
a bioinformatics problem of generating DNA sequences. We observe that mod-
els trained with OMD achieve consistently smaller KL divergence with respect to
the true underlying distribution, than models trained with GD variants. Finally,
we introduce a new algorithm, Optimistic Adam, which is an optimistic variant
of Adam. We apply it to WGAN training on CIFAR10 and observe improved
performance in terms of inception score as compared to Adam.
1	Introduction
Generative Adversarial Networks (GANs) (Goodfellow et al., 2014) have proven a very successful
approach for fitting generative models in complex structured spaces, such as distributions over im-
ages. GANs frame the question of fitting a generative model from a data set of samples from some
distribution as a zero-sum game between a Generator (G) and a discriminator (D). The Generator is
represented as a deep neural network which takes as input random noise and outputs a sample in the
same space of the sampled data set, trying to approximate a sample from the underlying distribution
of data. The discriminator, also modeled as a deep neural network is attempting to discriminate be-
tween a true sample and a sample generated by the generator. The hope is that at the equilibrium of
this zero-sum game the generator will learn to generate samples in a manner that is indistinguishable
from the true samples and hence has essentially learned the underlying data distribution.
Despite their success at generating visually appealing samples when applied to image generation
tasks, GANs are very finicky to train. One particular problem, raised for instance in a recent survey
as a major issue (Goodfellow, 2017) is the instability of the training process. Typically training of
GANs is achieved by solving the zero-sum game via running simultaneously a variant of a Stochastic
Gradient Descent algorithm for both players (potentially training the discriminator more frequently
than the generator).
1Code for our models is available at https://github.com/vsyrgkanis/optimistic_GAN
training
* These authors contribute equally to this work.
1
The latter amounts essentially to solving the zero-sum game via running no-regret dynamics for
each player. However, it is known from results in game theory, that no-regret dynamics in zero-
sum games can very often lead to limit oscillatory behavior, rather than converge to an equilibrium.
Even in convex-concave zero-sum games it is only the average of the weights of the two players that
constitutes an equilibrium and not the last-iterate. In fact recent theoretical results of Mertikopoulos
et al. (2017) show the strong result that no variant of GD that falls in the large class of Follow-the-
Regularized-Leader (FTRL) algorithms can converge to an equilibrium in terms of the last-iterate
and are bound to converge to limit cycles around the equilibrium.
Averaging the weights of neural nets is a prohibitive approach in particular because the zero-sum
game that is defined by training one deep net against another is not a convex-concave zero-sum
game. Thus it seems essential to identify training algorithms that make the last iterate of the training
be very close to the equilibrium, rather than only the average.
Contributions. In this paper we propose training GANs, and in particular Wasserstein GANs
Arjovsky et al. (2017), via a variant of gradient descent known as Optimistic Mirror Descent. Op-
timistic Mirror Descent (OMD) takes advantage of the fact that the opponent in a zero-sum game
is also training via a similar algorithm and uses the predictability of the strategy of the opponent
to achieve faster regret rates. It has been shown in the recent literature that Optimistic Mirror De-
scent and its generalization of Optimistic Follow-the-Regularized-Leader (OFTRL), achieve faster
convergence rates than gradient descent in convex-concave zero-sum games (Rakhlin & Sridharan,
2013a;b) and even in general normal form games (Syrgkanis et al., 2015). Hence, even from the per-
spective of faster training, OMD should be preferred over GD due to its better worst-case guarantees
and since it is a very small change over GD.
Moreover, we prove the surprising theoretical result that for a large class of zero-sum games (namely
bi-linear games), OMD actually converges to an equilibrium in terms of the last iterate. Hence, we
give strong theoretical evidence that OMD can help in achieving the long sought-after stability and
last-iterate convergence required for GAN training. The latter theoretical result is of independent
interest, since solving zero-sum games via no-regret dynamics has found applications in many areas
of machine learning, such as boosting (Freund & Schapire, 1996). Avoiding limit cycles in such
approaches could help improve the performance of the resulting solutions.
We complement our theoretical result with toy simulations that portray exactly the large qualitative
difference between OMD as opposed to GD (and its many variants, including gradient penalty,
momentum, adaptive step size etc.). We show that even in a simple distribution learning setting
where the generator simply needs to learn the mean of a multi-variate distribution, GD leads to limit
cycles, while OMD converges pointwise.
Moreover, we give a more complex application to the problem of learning to generate distributions
of DNA sequences of the same cellular function. DNA sequences that carry out the same func-
tion in the genome, such as binding to a specific transcription factor, follow the same nucleotide
distribution. Characterizing the DNA distribution of different cellular functions is essential for un-
derstanding the functional landscape of the human genome and predicting the clinical consequence
of DNA mutations (Zeng et al., 2015; 2016; Zeng & Gifford, 2017). We perform a simulation study
where we generate samples of DNA sequences from a known distribution. Subsequently we train
a GAN to attempt to learn this underlying distribution. We show that OMD achieves consistently
better performance than GD variants in terms of the Kullback-Leibler (KL) divergence between the
distribution learned by the Generator and the true distribution.
Finally, we apply optimism to training GANs for images and introduce the Optimistic Adam algo-
rithm. We show that it achieves better performance than Adam, in terms of inception score, when
trained on CIFAR10.
2	Preliminaries: WGANs and Optimistic Mirror Descent
We consider the problem of learning a generative model of a distribution of data points Q ∈ ∆(X).
Our goal is given a set of samples from D, to learn an approximation to the distribution Q in the
form of a deep neural network Gθ(∙), with weight parameters θ, that takes as input random noise
2
z ∈ F (from some simple distribution F) and outputs a sample Gθ(z) ∈ X. We will focus on
addressing this problem via a Generative Adversarial Network (GAN) training strategy.
The GAN training strategy defines as a zero-sum game between a generator deep neural network
Gθ(∙) and a discriminator neural network Dw (∙). The generator takes as input random noise Z 〜F,
and outputs a sample Gθ(z) ∈ X. A discriminator takes as input a sample x (either drawn from the
true distribution Q or from the generator) and attempts to classify it as real or fake. The goal of the
generator is to fool the discriminator.
In the original GAN training strategy Goodfellow et al. (2014), the discriminator of the zero sum
game was formulated as a classifier, i.e. Dw(x) ∈ [0, 1] with a multinomial logistic loss. The latter
boils down to the following expected zero-sum game (ignoring sampling noise).
inf sup Eχ~Q [log(Dw (x))] + Ez~F [log(1 - Dw (Gθ(z)))]	(1)
θw
If the discriminator is very powerful and learns to accurately classify all samples, then the problem
of the generator amounts to minimizing the Jensen-Shannon divergence between the true distribution
and the generators distribution. However, if the discriminator is very powerful, then in practice the
latter leads to vainishing gradients for the generator and inability to train in a stable manner.
The latter problem lead to the formulation of Wasserstein GANs (WGANs) Arjovsky et al. (2017),
where the discriminator rather than being treated as a classifier (equiv. approximating the JS diver-
gence) is instead trying to approximate the Wasserstein-1 or earth-mover metric between the true
distribution and the distribution of the generator. In this case, the function Dw(x) is not constrained
to being a probability in [0, 1] but rather is an arbitrary 1-Lipschitz function of x. This reasoning
leads to the following zero-sum game:
inf sup Ex~q [Dw (x)] - Ez~f [Dw(Gθ (z))]	(2)
θw
If the function space of the discriminator covers all 1-Lipschitz functions of x, then the quantity
SuPw Eχ~D [Dw(x)] - Ez~f [Dw(Gθ(z))] that the generator is trying to minimize corresponds to
the earth-mover distance between the true distribution Q and the distribution of the generator. Given
the success of WGANs we will focus on WGANs in this paper.
2.1	Gradient Descent vs Optimistic Mirror Descent
The standard approach to training WGANs is to train simultaneously the parameters of both net-
works via stochastic gradient descent. We begin by presenting the most basic version of adversarial
training via stochastic gradient descent and then comment on the multiple variants that have been
proposed in the literature in the following section, where we compare their performance with our
proposed algorithm for a simple example.
Let us start how training a GAN with gradient descent would look like in the absence of sampling
error, i.e. if we had access to the true distribution Q. For simplicity of notation, let:
L(θ, w) = Eχ~Q [Dw(x)] - Ez-F [Dw(Gθ(z))]
(3)
denote the loss in the expected zero-sum game of WGAN, as defined in Equation (2), i.e.
infθ supw L(θ, w). The classic WGAN approach is to solve this game by running gradient de-
scent (GD) for each player, i.e. for t ∈ {1,...,T - 1}: with Vw,t = Vw L(θt, wt) and
Vθ,t = VθL(θt, wt)
wt+ι = wt + η ∙ Vw,t	(4)
θt+ι = θt - η ∙ Vθ,t
If the loss function L(θ, w) was convex in θ and concave w, θ and w lie in some bounded convex
set and the step size η is chosen of the order 方,then standard results in game theory and no-regret
learning (see e.g. Freund & Schapire (1999)) imply that the pair (θ, W) of average parameters, i.e.
W = 1 PT=I Wt and θ= T1 PT=I θt is an ^-equilibrium of the zero-sum game, for E = O (√T).
However, no guarantees are known beyond the convex-concave setting and, more importantly for the
paper, even in convex-concave games, no guarantees are known for the last-iterate pair (θT , WT ).
Rakhlin and Sridharan (Rakhlin & Sridharan, 2013a) proposed an alternative algorithm for solving
zero-sum games in a decentralized manner, namely Optimistic Mirror Descent (OMD), that achieves
3
faster convergence rates to equilibrium of E = O (T) for the average of parameters. The algorithm
essentially uses the last iterations gradient as a predictor for the next iteration’s gradient. This
follows from the intuition that if the opponent in the game is using a stable (or regularized) algorithm,
then the gradients between the two iterations will not change much. Later Syrgkanis et al. (2015)
showed that this intuition extends to show faster convergence of each individual player’s regret in
general normal form games.
Given these favorable properties of OMD when learning in games, we propose replacing GD with
OMD when training WGANs. The update rule of a OMD is a small adaptation to GD. OMD is
parameterized by a predictor of the next iteration’s gradient which could either be simply last itera-
tion’s gradient or an average ofa window of last gradient or a discounted average of past gradients.
In the case where the predictor is simply the last iteration gradient, then the update rule for OMD
boils down to the following simple form:
wt+1 = Wt + 2η ∙ Vw,t - η ∙ Vw,t-1
θt+ι = θt - 2η ∙ Vθ.t + n ∙ Vθ,t-ι
(5)
The simple modification in the GD update rule, is inherently different than any of the existing adap-
tations used in GAN training, such as Nesterov’s momentum, or gradient penalty.
General OMD and intuition. The intuition behind OMD can be more easily understood when
GD is viewed through the lens of the Follow-the-Regularized-Leader formulation. In particular,
it is well known that GD is equivalent to the Follow-the-Regularized-Leader algorithm with an `2
regularizer (see e.g. Shalev-Shwartz (2012)), i.e.:
t
wt+1 =argmaxη	hw, Vw,τ i - kwk22
τ=1
t
θt+1 =argmθinηXhθ,Vθ,τi + kθk22
τ=1
(6)
It is known that if the learner knew in advance the gradient at the next iteration, then by adding that
to the above optimization would lead to constant regret that comes solely from the regularization
term1. OMD essentially augments FTRL by adding a predictor Mt+1 of the next iterations gradient,
i.e.:
wt+1 = arg max η
w
, Vw,τ i + hw, Mw,t+1 i - kwk22
(7)
θt+1 = arg min η Xhθ, Vθ,τ i + hθ, Mθ,t+1i	+ kθk22
For an arbitrary set of predictors, the latter boils down to the following set of update rules:
wt+1 = Wt + η ∙ (VW,t + Mw,t+1 - Mw,t)
Θt+1 = θt- η∙ (Vθ,t + Mθ,t+1 - Mθ,t)
(8)
In the theoretical part of the paper we will focus on the case where the predictor is simply the last
iteration gradient, leading to update rules in Equation (5). In the experimental section we will also
explore performance of other alternatives for predictors.
2.2	Stochastic Gradient Descent and Stochastic Optimistic Mirror Descent
In practice we don’t really have access to the true distribution Q and hence we replace Q with an
empirical distribution Qn over samples {x1, . . . , xn} and Fn of random noise samples {z1, . . . , zn},
leading to empirical loss for the zero-sum game of:
Ln(θ,w)= Ex 〜Qn [Dw (x)] - Ez 〜FnDW (G θ (z))]	⑼
Even in this setting it might be impractical to compute the gradient of the expected loss with respect
to Qn or Fn, e.g. Ex〜Qn [VwDw(x)].
1The latter is a consequence of the be-the-leader lemma Kalai & Vempala (2005); Rigollet (2015)
4
However, GD and OMD still leads to small loss if we replace gradients with unbiased estimators
of them. Hence, we can replace expectation with respect to Qn or Fn , by simply evaluating the
gradients at a single sample or on a small batch of B samples. Hence, we can replace the gradients
at each iteration with the variants:
Vw,t = |B| X (VwDwt (Xi)- VwDwt (Gθt (Zi)))
—
,t
|B| X vθ(Dwt (Gθt (Zi)))
|B| i∈B
(10)
Replacing Vw,t and Vθ,t with the above estimates in Equation (4) and (5), leads to Stochastic
Gradient Descent (SGD) and Stochastic Optimistic Mirror Decent (SOMD) correspondingly.
3	An Illustrative Example: Learning the Mean of a Distribution
We consider the following very simple WGAN example: The data are generated by a multivariate
normal distribution, i.e. Q , N (v, I) for some v ∈ Rd. The goal is for the generator to learn
the unknown parameter v. In Appendix C we also consider a more complex example where the
generator is trying to learn a co-variance matrix.
We consider a WGAN, where the discriminator is a linear function and the generator is a simple
additive displacement of the input noise Z, which is drawn from F , N (0, I), i.e:
Dw(x) = hw, xi
Gθ (Z) = Z + θ
(11)
The goal of the generator is to figure out the true distribution, i.e. to converge to θ = v. The WGAN
loss then takes the simple form:
L(θ, W)= Ex〜N(V,I) [hw, x)] — Ez〜N(0,I) [hw,z + θi]	(12)
We first consider the case where we optimize the true expectations above rather than assuming that
we only get samples of x and samples of Z. Due to linearity of expectation, the expected zero-sum
game takes the form:
inf sup hw, v - θi	(13)
θw
We see here that the unique equilibrium of the above game is for the generator to choose θ = v and
for the discriminator to choose w = 0. For this simple zero sum game, we have Vw,t = v - θt and
Vθ,t = -wt. Hence, the GD dynamics take the form:
wt+1 =wt + η(v - θt)
θt+1 =θt + ηwt
while the OMD dynamics take the form:
wt+ι =Wt + 2η ∙ (V — θt) — n ∙ (v — θt-i)
θt+ι =θt + 2η ∙ Wt — η ∙ wt-i
(GD Dynamics for Learning Means)
(OMD Dynamics for Learning Means)
We simulated simultaneous training in this zero-sum game under the GD and under OMD dynamics
and we find that GD dynamics always lead to a limit cycle irrespective of the step size or other
modifications. In Figure 1 we present the behavior of the GD vs OMD dynamics in this game for
v = (3, 4). We see that even though GD dynamics leads to a limit cycle (whose average does indeed
equal to the true vector), the OMD dynamics converge to v in terms of the last iterate. In Figure 2
we see that the stability of OMD even carries over to the case of Stochastic Gradients, as long as the
batch size is of decent size.
In the appendix we also portray the behavior of the GD dynamics even when we add gradient penalty
(Gulrajani et al., 2017) to the game loss (instead of weight clipping), adding Nesterov momentum to
the GD update rule (Nesterov, 1983) or when we train the discriminator multiple times in between a
train iteration of the generator. We see that even though these modifications do improve the stability
5
(a) GD dynamics.
(b) OMD dynamics.
Figure 1: Training GAN with GD converges to a limit cycle that oscilates around the equilibrium (we applied
weight-clipping at 10 for the discriminator). On the contrary training with OMD converges to equilibrium in
terms of last-iterate convergence.
(a) Stochastic OMD dynamics with mini-batch of 50.
(b) Stochastic OMD dynamics with mini-batch of 200.
Figure 2: Robustness of last-iterate convergence of OMD to stochastic gradients.
of the GD dynamics, in the sense that they narrow the band of the limit cycle, they still lead to a
non-vanishing limit cycle, unlike OMD.
In the next section, we will in fact prove formally that for a large class of zero-sum games including
the one presented in this section, OMD dynamics converge to equilibrium in the sense of last-iterate
convergence, as opposed to average-iterate convergence.
4	Last-Iterate Convergence of Optimistic Adversarial Training
In this section, we show that Optimistic Mirror Descent exhibits final-iterate, rather than only
average-iterate convergence to min-max solutions for bilinear functions. More precisely, we con-
sider the problem minx maxy xTAy, for some matrix A, where x and y are unconstrained. In
Appendix D, we also show that our convergence result appropriately extends to the general case,
where the bi-linear game also contains terms that are linear in the players’ individual strategies,
i.e. games of the form:
inf sup (XT Ay + bτX + cτy + d) .	(14)
xy
In the simpler minx maxy XTAy problem, Optimistic Mirror Descent takes the following form, for
all t ≥ 1:
Xt = Xt-1 - 2ηAyt-1 + ηAyt-2	(15)
yt = yt-1 + 2ηATXt-1 - ηATXt-2	(16)
Initialization: For the above iteration to be meaningful we need to specify X0, X-1, y0, y-1. We
choose any x0 ∈ R(A), and y0 ∈ R(Aτ), and set x-1 = 2x0 and y-1 = 2y0, where R(∙)
represents the column space of A. In particular, our initialization means that the first step taken by
the dynamics gives X1 = X0 and y1 = y0 .
We will analyze Optimistic Mirror Descent under the assumption λ∞ ≤ 1, where λ∞ =
max{∣∣ A||, || Aτ ||} and || ∙ || denotes spectral norm of matrices. We can always enforce that λ∞ ≤ 1
by appropriately scaling A. Scaling A by some positive factor clearly does not change the min-max
solutions (x*, y*), only scales the optimal value x*τAy* by the same factor.
We remark that the set of equilibrium solutions of this minimax problem are pairs (X, y) such that
X is in the null space of Aτ and y is in the null space of A. In this section we rigorously show
that Optimistic Mirror Descent converges to the set of such min-max solutions. This is interesting
in light of the fact that Gradient Descent actually diverges, even in the special case where A is the
identity matrix, as per the following proposition whose proof is provided in Appendix D.3.
6
Proposition 1. Gradient descent applied to the problem minx maxy xTy diverges starting from any
initialization x0 , y0 such that x0 , y0 6= 0.
Next, we state our main result of this section, whose proof can be found in Appendix D, where we
also state its appropriate generalization to the general case (14).
Theorem 1 (Last Iterate Convergence of OMD). Consider the dynamics of Eq. (15) and (16) and
any initialization 1 x-ι = xo ∈ R(A), and 2y-ι = yo ∈ R(AT). Let also
Y =II(AAT ) + ∣∣,
where for a matrix X we denote by X+ its generalized inverse and by ||X || its spectral norm.
Suppose that ∣∣Ak ≡ λ∞ ≤ 1 and that η is a small enough constant satisfying η < 1∕(3γ2). Letting
∆t = AT xt 22 + ||Ayt||22, the OMD dynamics satisfy the following:
1
Z = X ≥ (Γ+^F M
∀t ≥ 3 ： ∆t ≤ (ι — γ2) ∆t-ι + 16η3∆o.
In particular, ∆t → O(ηγ2∆0), as t → +∞, and for large enough t, the last iterate of OMD is
within O(√η ∙ Yʌ/ʌθ) distanCefrom the space OfequiUbriumpoints ofthe game, where ʌ/ʌθ is the
distance of the initial point (x0, y0)from the equilibrium space, and where both distances are taken
with respect to the norm xTAATx + yTATAy.
5	Experimental Results for Generating DNA Sequences
We take our theoretical intuition to practice, applying OMD to the problem of generating DNA
sequences from an observed distribution of sequences. DNA sequences that carry out the same
function can be viewed as samples from some distribution. For many important cellular functions,
this distribution can be well modeled by a position-weight matrix (PWM) that specifies the proba-
bility of different nucleotides occuring at each position (Stormo, 2000). Thus, training GANs from
DNA sequences sampled from a PWM distribution serves as a practically motivated problem where
we know the ground truth and can thus quantify the performance of different training methods in
terms of the KL divergence between the trained generator distribution and the true distribution.
In our experiments, we generated 40,000 DNA sequences of six nucleotides according to a given
position weight matrix. A random 10% of the sequences were held out as the validation set. Each
sequence was then embedded into a 4 × 6 matrix by encoding each of the four nucleotides with an
one-hot vector. On this dataset, we trained WGANs with different variants of OMD and SGD and
evaluated their performance in terms of the KL divergence between the empirical distribution of the
WGAN-generated samples and the true distribution described by the position weight matrix. Both
the discriminator and generator of the WGAN used in this analysis were chosen to be convolutional
neural networks (CNN), given the recent success of CNNs in modeling DNA-protein binding (Zeng
et al., 2016; Alipanahi et al., 2015). The detailed structure of the chosen CNNs can be found in
Appendix E.
To account for the impact of learning rate and training epochs, we explored two different ways
of model selection when comparing different optimization strategies: (1) using the iteration and
learning rate that yields the lowest discriminator loss on the held out test set. This is inspired by
the observation in Arjovsky et al. (2017) that the discriminator loss negatively correlates with the
quality of the generated samples. (2) using the model obtained after the last epoch of the training.
To account for the stochastic nature of the initialization and optimizers, we trained 50 independent
models for each learning rate and optimizer, and compared the optimizer strategies by the resulting
distribution of KL divergences across 50 runs.
For GD, we used variants of Equation (4) to examine the effect of using momentum and an adaptive
step size. Specifically, we considered momentum, Nesterov momentum and Adagrad. The specific
form of all these modifications is given for reference in Appendix A.
7
For OMD we used the general predictor version of Equation (10) with a fixed step size and with the
following variants of the next iteration predictor Mt+i： (v1) Last iteration gradient: Mt+ι = Vft,
(v2) Running average of past gradients: Mt+i = t Pt=i Vfi, (v3) Hyperbolic discounted average
of past gradients: Mt+1 = λMt + (1 - λ)Vft, λ ∈ (0, 1). We explored two training schemes: (1)
training the discriminator 5 times for each generator training as suggest in Arjovsky et al. (2017).
(2) training the discriminator once for each generator training. The latter is inline with the intuition
behind the use of optimism: optimism hinges on the fact that the gradient at the next iteration is very
predictable since it is coming from another regularized algorithm, and ifwe train the other algorithm
multiple times, then the gradient is not that predictable and the benefits of optimism are lost.
SOMD-ver3-ratiol
SOMD-verl-ratiol
SOMD-ver2-ratiol
SGD_adagrad
SOMD-verl
SGDjadam
SOMD-ver3
SGD-vanilla
OPtimAdam
S0MD-ver2
OPtimAdam_ratiol
SGDjesterov
SGD-momentum
0-0
-EEZH
♦ I——[~□~~∣ ♦
ι——∣~z∏-
I---1 I μ
0.5	1-0	1-5	2.0	2.5	3-0	3.5	4.0
KL Divergence
=3-Z
"SOM> vα-r⅛<l
2	3	«	5
(b) WGAN at the last epoch
(a) WGAN with the lowest validation discriminator loss
Figure 3: KL divergence of WGAN trained with different optimization strategies. Methods are ordered by the
median KL divergence. Methods in (a) are named by the category and version of the method. “ratio 1” denotes
training the discriminator once for every generator training. Otherwise, we performed 5 iterations. For (b)
where we don’t combine the models trained with different learning rates, the learning rate is appended at the
end of the method name. For momentum and Nesterov momentum, we used γ = 0.9. For Adagrad, we used
the default = 1e-8.
For all afore-described algorithms, we experimented with their stochastic variants. Figure 3 shows
the KL divergence between the WGAN-generated samples and the true distribution. When evaluated
by the epoch and learning rate that yields the lowest discriminator loss on the validation set, WGAN
trained with Stochastic OMD (SOMD) achieves lower KL divergence than the competing SGD
variants. Evaluated by the last epoch, the best performance across different learning rates is achieved
by optimistic Adam (see Section 6). We note that in both metrics, SOMD with 1:1 generator-
discriminator training ratio yields better KL divergence than the alternative training scheme (1:5
ratio), which validates the intuition behind the use of optimism.
6 Generating Images from CIFAR 1 0 with Optimistic Adam
In this section we applying optimistic WGAN training to generating images, after training on CI-
FAR10. Given the success of Adam on training image WGANs we will use an optimistic version
of the Adam algorithm, rather than vanilla OMD. We denote the latter by Optimistic Adam. Opti-
mistic Adam could be of independent interest even beyond training WGANs. We present Optimistic
Adam for (G) but the analog is also used for training (D). We trained on CIFAR10 images with
Algorithm 1 Optimistic ADAM, proposed algorithm for training WGANs on images.
Parameters: stepsize η, exponential decay rates for moment estimates βi, β2 ∈ [0, 1), stochastic
loss as a function of weights `t(θ), initial parameters θ0
for each iteration t ∈ {1, . . . , T } do
Compute stochastic gradient: Vθ,t = Vθ't(θ)
Update biased estimate of first moment: mt = β1mt-1 + (1 — βι) ∙Vθ,t
Update biased estimate of second moment: Vt = β2vt-1 + (1 — β2) ∙ Vjt
Compute bias corrected first moment: mt = mt∕(1 — βt)
Compute bias corrected second moment: Vt = vt∕(1 — β2)
Perform optimistic gradient step: θt
θt-i-2η ∙ √fe + η
m t-i
√^t-1+e

Return θT
Optimistic Adam with the hyper-parameters matched to Gulrajani et al. (2017), and we observe that
8
it outperforms Adam in terms of inception score (see Figure 14), a standard metric of quality of
WGANs (Gulrajani et al., 2017; Salimans et al., 2016). In particular we see that optimistic Adam
achieves high numbers of inception scores after very few epochs of training. We observe that for
Optimistic Adam, training the discriminator once after one iteration of the generator training, which
matches the intuition behind the use of optimism, outperforms the 1:5 generator-discriminator train-
ing scheme. We see that vanilla Adam performs poorly when the discriminator is trained only once
in between iterations of the generator training. Moreover, even if we use vanilla Adam and train 5
times (D) in between a training of (G), as proposed by Arjovsky et al. (2017), then performance is
again worse than Optimistic Adam with a 1:1 ratio of training. The same learning rate 0.0001 and
betas (β1 = 0.5, β2 = 0.9) as in Appendix B of Gulrajani et al. (2017) were used for all the methods
compared. We also matched other hyper-parameters such as gradient penalty coefficient λ and batch
size. For a larger sample of images see Appendix G.
D
20	40
60	80	100
Epoch
(a) Inception score on CIFAR10, when training with Adam and Optimistic
Adam. “ratio1” means we performed 1 iteration of training of (D) in be-
tween 1 iteration of (G). Otherwise we performed 5 iterations. We further
test (averaging over 35 trials) the two top-performing optimizers, Adam
(ratio 5) and Optimistic Adam with ratio 1, in Appendix H.
(b) Sample of images from Gen-
erator of Epoch 94, which had
the highest inception score.
Figure 4:	Comparison of Adam and Optimistic Adam on CIFAR10.
References
Babak Alipanahi, Andrew Delong, Matthew T Weirauch, and Brendan J Frey. Predicting the se-
quence specificities of dna-and rna-binding proteins by deep learning. Nature biotechnology, 33
(8):831-838,2015.
Martin Arjovsky, SoUmith Chintala, and Leon Bottou. Wasserstein gan. arXiv preprint
arXiv:1701.07875, 2017.
Yoav Freund and Robert E. Schapire. Game theory, on-line prediction and boosting. In Proceedings
of the Ninth Annual Conference on Computational Learning Theory, COLT ’96, pp. 325-332,
New York, NY, USA, 1996. ACM. ISBN 0-89791-811-8. doi: 10.1145/238061.238163. URL
http://doi.acm.org/10.1145/238061.238163.
Yoav Freund and Robert E. Schapire. Adaptive game playing using multiplicative weights. Games
and Economic Behavior, 29(1):79 - 103, 1999. ISSN 0899-8256. doi: https://doi.org/10.1006/
game.1999.0738. URL http://www.sciencedirect.com/science/article/pii/
S0899825699907388.
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair,
Aaron Courville, and Yoshua Bengio. Generative adversarial nets. In Z. Ghahramani, M. Welling,
C. Cortes, N. D. Lawrence, and K. Q. Weinberger (eds.), Advances in Neural Information Pro-
cessing Systems 27, pp. 2672-2680. Curran Associates, Inc., 2014. URL http://papers.
nips.cc/paper/5423-generative-adversarial-nets.pdf.
Ian J. Goodfellow. NIPS 2016 tutorial: Generative adversarial networks. CoRR, abs/1701.00160,
2017. URL http://arxiv.org/abs/1701.00160.
9
Ishaan Gulrajani, Faruk Ahmed, Martin Arjovsky, Vincent Dumoulin, and Aaron C. Courville. Im-
proved training of wasserstein gans. CoRR, abs/1704.00028, 2017. URL http://arxiv.
org/abs/1704.00028.
Adam Kalai and Santosh Vempala. Efficient algorithms for online decision problems. Journal
of Computer and System Sciences,71(3):291 - 307,2005. ISSN 0022-0000. doi: https://doi.
org/10.1016/j.jcss.2004.10.016. URL http://www.sciencedirect.com/science/
article/pii/S0022000004001394. Learning Theory 2003.
Panayotis Mertikopoulos, Christos Papadimitriou, and Georgios Piliouras. Cycles in adversarial
regularized learning. arXiv preprint arXiv:1709.02738, 2017.
Yurii Nesterov. A method of solving a convex programming problem with convergence rate o (1/k2).
In Soviet Mathematics Doklady, volume 27, pp. 372-376, 1983.
Alexander Rakhlin and Karthik Sridharan. Online learning with predictable sequences. In COLT,
pp. 993-1019, 2013a.
Alexander Rakhlin and Karthik Sridharan. Optimization, learning, and games with predictable se-
quences. In Proceedings of the 26th International Conference on Neural Information Process-
ing Systems - Volume 2, NIPS’13, pp. 3066-3074, USA, 2013b. Curran Associates Inc. URL
http://dl.acm.org/citation.cfm?id=2999792.2999954.
Philippe Rigollet. Mit 18.657: Mathematics of machine learning, lecture 16. 2015.
Tim Salimans, Ian Goodfellow, Wojciech Zaremba, Vicki Cheung, Alec Radford, and Xi Chen.
Improved techniques for training gans. In Advances in Neural Information Processing Systems,
pp. 2234-2242, 2016.
Shai Shalev-Shwartz. Online learning and online convex optimization. Found. Trends Mach. Learn.,
4(2):107-194, February 2012. ISSN 1935-8237. doi: 10.1561/2200000018. URL http://dx.
doi.org/10.1561/2200000018.
Gary D Stormo. Dna binding sites: representation and discovery. Bioinformatics, 16(1):16-23,
2000.
Vasilis Syrgkanis, Alekh Agarwal, Haipeng Luo, and Robert E Schapire. Fast convergence of regu-
larized learning in games. In Advances in Neural Information Processing Systems, pp. 2989-2997,
2015.
Haoyang Zeng and David K Gifford. Predicting the impact of non-coding variants on dna methyla-
tion. Nucleic Acids Research, 2017.
Haoyang Zeng, Tatsunori Hashimoto, Daniel D Kang, and David K Gifford. Gerv: a statistical
method for generative evaluation of regulatory variants for transcription factor binding. Bioinfor-
matics, 32(4):490-496, 2015.
Haoyang Zeng, Matthew D Edwards, Ge Liu, and David K Gifford. Convolutional neural network
architectures for predicting dna-protein binding. Bioinformatics, 32(12):i121-i127, 2016.
10
A Variants of GD Training
For ease of reference we briefly describe the exact form of update rules for several modifications of
GD training that we have used in our experimental results.
Adagrad:		_ 	η				η		
	ηw,t =	qpi=ι vw,i+E	ηθ,t =	qρ= %+E	(17)
	Wt+1 =	二 Wt + ηw,t ∙ VW,t	θt+1 =	θt - ηθ,t ∙ Vθ,t	
Momentum:	vw,t+1 = Wt+1 =	二 Y ∙ vw,t + η ∙ Vw,t Wt + vw,t+1	vθ,t+1 θt+1	=Y ∙ vθ,t + η ∙ Vθ,t = θt 一 vθ,t+1	(18)
Nesterov momentum:
Wahead = Wt + Y ∙ Vw,t
vw,t+1 = Y ∙ vw,t + η ∙ RWL(θt, wahead)
Wt+1 = Wt + vw,t+1
θahead = θt - Y ∙ Vθ,t
Vθ,t+1 = Y ∙ Vθ,t + η ∙ VθL(θahead, Wt)	(19)
θt+1 = θt - vθ,t+1
B	Persistence of Limit Cycles in GD Training
In Figure 5 we portray example Gradient Descent dynamics in the illustrative example described in
Section 3 under multiple adaptations proposed in the literature. We observe that oscillations persist
in all such modified GD dynamics, though alleviated by some. We briefly describe the modifications
in detail first.
Gradient penalty. The Wasserstein GAN is based on the idea that the discriminator is approximat-
ing all 1-Lipschitz functions of the data. Hence, when training the discriminator we need to make
sure that the function Dw (x) has a bounded gradient with respect to x. One approach to achieving
this is weight-clipping, i.e. clipping the weights to lie in some interval. However, the latter might
introduce extra instability during training. Gulrajani et al. (2017) introduce an alternative approach
by adding a penalty to the loss function of the zero-sum game that is essentially the `2 norm of the
gradient of Dw (x) with respect to x. In particular they propose the following regularized WGAN
loss:
Lλ(θ, W) = Ex 〜Q [Dw (X)] - Ez 〜F [Dw (Gθ (Z))] - λEX 〜Qeh(IlVxDw(X)Il- 1)2 i
where Qe is the distribution of the random vector EX + (1 — E)G(Z) when X 〜 Q and Z 〜 F. The
expectations in the latter can also be replaced with sample estimates in stochastic variants of the
training algorithms.
For our simple example, VxDw(X) = W. Hence, we get the gradient penalty modified WGAN:
Lλ(θ, W) = hW,v - θi - λ (IWI - 1)2	(20)
Hence, the gradient of the modified loss function with respect to θ remains unchanged, but the
gradient with respect to W becomes:
Vwt = v - θt - 2λWt
IWt I2 - 1
IWt I2
(21)
Momentum. GD with momentum was defined in Equation (18). For the case of the simple illus-
trative example, these dynamics boil down to:
mw,t+ι =Y ∙ mw,t + η ∙ (v 一 θt)	mθ,t+ι =Y ∙ mθ,t 一 η ∙ Wt
Wt+1 =Wt + mw,t+1
θt+1 =θt 一 mθ,t+1
(22)
11
Nesterov momentum. GD with Nesterov’s momentum was defined in Equation (19). For the
illustrative example, we see that Nesterov’s momentum is identical to momentum in the absence of
gradient penalty. The reason being that the function is bi-linear. However, with a gradient penalty,
Nesterov’s momentum boils down to the following update rule.
Wt =Wt + Y ∙ mw,t
mw,t+ι =Y ∙ mw,t + η ∙ (v - θt) - 2η ∙ λWt kw∣tk2∣--1	mθ,t+ι =Y ∙ mw,t - η ∙ Wt (23)
kWtk2
Wt+1 =Wt + mw,t+1	θt+1 =θt - mθ,t+1
Asymmetric training. Another approach to reducing cycling is to train the discriminator more
frequently than the generator. Observe that if we could exactly solve the supremum problem of
the discriminator after every iteration of the generator, then the generator would be simply solving a
convex minimization problem and GD should converge point-wise. The latter approach could lead to
slow convergence given the finiteness of samples in the case of stochastic training. Hence, we cannot
really afford completely solving the discriminators problem. However, training the discriminator for
multiple iterations, brings the problem faced by the generator closer to convex minimization rather
than solving an equilibrium problem. Hence, asymmetric training could help with cycling. We
observe below that asymmetric training is the most effective modification in reducing the range of
the cycles and hence making the last-iterate be close to the equilibrium. However, it does not really
eliminate the cycles, rather it simply makes their range smaller.
12
(a) GD dynamics with a gradient penalty added to the loss. η = 0.1 and λ = 0.1.
(b) GD dynamics with momentum. η = 0.1 and γ = 0.5.
(c) GD dynamics with momentum and gradient penalty. η = .1, γ = 0.2 and λ = 0.1.
(d) GD dynamics with momentum and gradient penalty, training generator every 15 training iterations of the
discriminator. η = .1, γ = 0.2 and λ = 0.1.
(e) GD dynamics with Nesterov momentum and gradient penalty, training generator every 15 training iterations
of the discriminator. η = .1, γ = 0.2 and λ = 0.1.
Figure 5:	Persistence of limit cycles in multiple variants of GD training.
13
C Another Example: Learning a Co-Variance Matrix
We demonstrate the benefits of using OMD over GD in another simple illustrative example. In this
case, the example is does not boil down to a bi-linear game and therefore, the simulation results
portray that the theoretical results we provided for bi-linear games, carry over qualitatively beyond
the linear case.
Consider the case where the data distribution is a mean zero multi-variate normal with an unknown
Co-Variance matrix, i.e., X 〜 N(0, Σ). We will consider the case where the discriminator is the set
of all quadratic functions:
DW (x) = X Wij xi xj = xTWx	(24)
ij
The generator is a linear function of the random input noise Z 〜 N(0, I), of the form:
GV (z) = Vz	(25)
The parameters W and V are both d × d matrices. The WGAN game loss associated with these
functions is then:
L(V, W) = Ex〜N(0,∑) [xTWx] — Ez〜N(0,I) [zTVTWVz]	(26)
Expanding the latter we get:
L(V,W ) =Ex 〜N (0,Σ)
W W WijXiXj	- Ez〜N(0,I)
ij
=Ex 〜N (0,Σ)
Σ Wijχixj	- Ez〜N(0,I)
ij
Wij	Vikzk	Vjmzm
ij	k
WijVikVjmzkzm
ijkm
m
E WijEx〜N(0,Σ) [χiχj] - Wj WijVikVmEz〜N(0,I) [zkzm]
ij	ijkm
XWijΣij - X WijVikVjm1{k=m}
ij	ijkm
X WijΣij - X WijVikVjk
ij
ijk
=	Wij Σij -	VikVjk
Given that the covariance matrix is symmetric positive definite, we can write it as Σ = UUT. Then
the loss simplifies to:
L(V,W) =	Wij	Σij	-	VikVjk	=	Wij(UikUjk	-VikVjk)
(27)
The equilibrium of this game is for the generator to choose Vik = Uik for all i, k, and for the
discriminator to pick Wij = 0. For instance, in the case ofa single dimension we have L(V, W) =
W ∙ (σ2 - V2), where σ2 is the variance of the Gaussian. Hence, the equilibrium is for the generator
to pick V = σ and the discriminator to pick W = 0.
Dynamics without sampling noise. For the mean GD dynamics the update rules are as follows:
Witj =Witj-1 + η Σij -XVitk-1Vjtk-1
k	(28)
吗=KjT + η X (Wit-1 + Wk-1) Vk-I
k
14
We can write the latter updates in a simpler matrix form:
Wt =Wt-1 + η (∑ - Vt-IV-1)
Vt =Vt-1 + η(Wt-1 + WtT-1)Vt-1
Similarly the OMD dynamics are:
Wt=Wt-I + 2η (ς - Vt-IV-J - η (ς - Vt-2V-2)
Vt =Vt-1 + 2η(Wt-1 + WtT-1)Vt-1 - η(Wt-2 + WtT-2)Vt-2
(GD for Covariance)
(OMD for Covariance)
Due to the non-convexity of the generators problem and because there might be multiple optimal
solutions (e.g. if Σ is not strictly positive definite), it is helpful in this setting to also help dynamics
by adding `2 regularization to the loss of the game. The latter simply adds an extra 2λWt at each
gradient term VwL(Vt, Wt) for the discriminator and a 2λVt at each gradient term VvL(Vt, Wt)
for the generator. In Figures 7 and 6 we give the weights and the implied covariance matrix ΣG =
VVT of the generator’s distribution for each of the dynamics for an example setting of the step-size
and regularization parameters and for two and three dimensional gaussians respectively. We again
see how OMD can stabilize the dynamics to converge pointwise.
Stochastic dynamics. In Figure 8 and 9 we also portray the instability of GD and the robustness
of the stability of OMD under stochastic dynamics. In the case of stochastic dynamics the gradients
are replaced with unbiased estimates or with averages of unbiased estimates over a small minibatch.
In the case of a mini-batch of one, the unbiased estimates of the gradients in this setting take the
following form:
T	TT
VW,t = xtxt - Vtztzt Vt
V V,t = -(Wt + Wtr Ntztzl
(Stochastic Gradients)
where xt , zt are samples drawn from the true distribution and from the random noise distribution
respectively. Hence, the stochastic dynamics simply follow by replacing gradients with unbiased
estimates:
Wt =Wt-I + nV W,t-1
Vt =vt-ι - nVv,t-1
TTT-	TTT-	ʃʌ
Wt =Wt-1 + 2nVW,t-1 - nVW,t-2
τ r τ r	C J	. J
Vt =Vt-1 - 2nVv,t-1 + nVv,t-2
(SGD for Covariance)
(SOMD for Covariance)
15
Figure 6: Stability of OMD vs GD in the co-variance learning problem for a two-dimensional gaussian (d = 2).
Weight clipping in [-1, 1] was applied in both dynamics.
Discriminator Weights	Generator Weights	Generator Sigma
Figure 7: Stability of OMD vs GD in the co-variance learning problem for a three-dimensional gaussian (d
3). Weight clipping in [-1, 1] was applied in both dynamics.
16
(a) Stochastic GD dynamics with mini-batch size 50. η = 0.02, T = 1000, λ = 0.1.
(b) True Distribution (c) Iterate T - 50	(d) Iterate T - 35
(e) Iterate T - 20
(f) Iterate T
(g) Comparison of true distribution and distribution of generator at various points closer to the end of training.
Figure 8:	Stochastic GD dynamics for covariance learning of a two-dimensional gaussian (d = 2). Weight
clipping in [-1, 1] was applied to the discriminator weights.
(f) Iterate T
(b) True Distribution (c) Iterate T - 50	(d) Iterate T - 35	(e) Iterate T - 20
(a) Stochastic OMD dynamics with mini-batch size 50. η = 0.02, T = 1000, λ
(g) Comparison of true distribution and distribution of generator at various points closer to the end of training.
Figure 9:	Stability of OMD with stochastic gradients for covariance learning of a two-dimensional gaussian
(d = 2). Weight clipping in [-1, 1] was applied to the discriminator weights.
17
D Last Iterate Convergence of OMD in B ilinear Case
The goal of this section is to show that Optimistic Mirror Descent exhibits last iterate convergence
to min-max solutions for bilinear functions. In Section D.1, we provide the proof of Theorem 1, that
OMD exhibits last iterate convergence to min-max solutions of the following min-max problem
min max xT Ay,	(29)
xy
where A is an abitrary matrix and x and y are unconstrained. In Section D.2, we state the appropriate
extension of our theorem to the general case:
inf sup (XT Ay + bτ X + cτy + d) .	(30)
xy
D.1 Proof of Theorem 1
As stated in Section 4, for the min-max problem (29) Optimistic Mirror Descent takes the following
form, for all t ≥ 1:
Xt = Xt-1 - 2ηAyt-1 + ηAyt-2	(31)
yt = yt-1 + 2ηATXt-1 - ηATXt-2	(32)
where for the above iterations to be meaningful we need to specify X0, X-1, y0, y-1.
As stated in Section 4 we allow any initialization X0 ∈ R(A), and y0 ∈ R(AT), and set X-1 = 2X0
and y-ι = 2yo, where R(∙) represents column space. In particular, our initialization means that the
first step taken by the dynamics gives X1 = X0 and y1 = y0 .
Before giving our proof of Theorem 1, we need some further notation. For all i ∈ N, we set:
Mi = Aj(AτA)k,Ni = (AT)j (AAT)k
∆it = ||NiAyt||22 + MiATXt22
where k ∈ Z andj ∈ {0, 1} are such that: i = 2k + j.
With this notation,	∆t0	=	ATXt22	+ ||Ayt||22,	∆t1	=	AATXt22	+	ATAyt22,	∆t2	=
AT AAT Xt 22 + AAT Ayt 22, etc.
We also use the notation hu, viX = uTXXTv, for vectors u, v ∈ Rd and square d × d matrices
X. We similarly define the norm notation ∣∣u∣∣χ =，hu, UiX. Given our notation, We have the
following claim, shown in Appendix D.3.
Claim 1. For all matrices Aand vectors u, v of the appropriate dimensions:
hAu, AviAMiT =	hu, viAT NiT+1;	hAT u,	AT viAT NiT	=	hu,	viAMiT+1;	hu,AviAMiT	=	hv,ATuiATN
With our notation in place, we show (through iterated expansion of the update rule), the following
lemma, proved in Appendix D.3:
Lemma 2. For the dynamics of Eq. (31) and (32) and any initialization 2 x-ι = xo ∈ R(A), and
1 y-ι = yo ∈ R(Aτ) we have thefollowingfor all i,t ∈ N such that i ≥ 0 and t ≥ 2:
∆it -	∆it-1	=	4η2∆it+-11	-	5η2∆it+-12	-	2η3	hXt-2,	Ayt-4iAMT	-	hyt-2, ATXt-4iAT NT	.
i+1	i+1
We are ready to prove Theorem 1. Its proof is implied by the following stronger theorem, and
Corollary 7.
Theorem 3. Consider the dynamics ofEq. (31) and (32) and any initialization 2x-ι = xo ∈ R(A),
and 2 y-ι = yo ∈ R(Aτ) .Let
γ = max 仙 AAT ) + ∣∣,∣∣(Aτ A)+∣∣),
18
where for a matrix X we denote by X+ its generalized inverse and by ||X || its spectral norm.
Suppose that max{||A||, ||AT ||} ≡ λ∞ ≤ 1 and η is a small enough constant satisfying η <
1∕(3γ2). Then, for all i ∈ N:
∆i1 = ∆i0 ,	(33)
∆i2 ≤ (1 + η)2∆i0,	(34)
and, for all i, t ∈ N such that t ≥ 3, the following condition holds:
H(i,t): ∆t ≤(1- Yŋ ∆t-ι + 16η3∆0.	(35)
Proof. Eq. (33) holds trivially as under our initialization x1 = x0 and y1 = y0 . Eq. (34) is also easy
to show by noticing the following. Given our initialization:
x2 = x0 - ηAy0
y2 = y0 + ηAx0
Hence (using j = i mod 2):
MiATx2 = MiATx0 - ηMi AT Ay0	(36)
⇒ ||MiATx2∣∣2 ≤ ∣∣MiAτχ0∣∣2 + η∣∣MiAτAy0∣∣2	(37)
=∣∣MiAτ xo∣∣2 + η∣∣ Aj (At )1-j NiAy0∣∣2	(38)
≤ ∣∣MiAτxo∣∣2 + ηλ∞∣∣NiAyo∣∣2	(39)
≤ ∣∣MiAτx0∣∣2 + η∣∣NiAy0∣∣2	(40)
Similarly:
∣∣NiAy2∣∣2 ≤ ∣∣NiAy0∣∣2 + η∣∣MiAτx0∣∣2	(41)
It follows from (40) and (41) that
∆i2 ≤ (1 + η)2∆i0.
We use induction on t to prove (35). We start our proof by showing the inductive step, and postpone
establishing the basis of our induction to the end of this proof. For the inductive step, we assume
that H(i, τ) holds for all i ≥ 0 and 1 ≤ τ < t, for some t > 3. Assuming this, we show next
that H(i, t) holds for all i. To do this, we make use of a few lemmas, whose proofs are given in
Appendix D.3.
Lemma 4. Under the conditions of the theorem, for all i ≥ 0, t ≥ 2:
∆ti - ∆it-1 ≤ 4η2∆it+-11 - 5η2∆it+-12 + η3(∆it+-12 + ∆it+-14).
Lemma 5. Under the conditions of the theorem, for all i, t ≥ 0: ∆it+1 ≤ ∆it.
Lemma 6. Under the conditions of the theorem, for all i ≥ 0, t ≥ 0:
δ ≥ Y2 &
19
Given these lemmas, we show our inductive step. So for t ≥ 4:
∆t - ∆t-1 ≤	4η2∆t+1 - 5η2∆i+2 + η3(∆t+2 + ∆t-4)	(42)
≤	-η2∆t+1 + η3(∆i+2 + ∆t-4) + 80η5∆0	(43)
≤	-Bη2∆i:+ η3(∆t+2 + ∆t-4) + 80η5∆0	(44)
≤	-Bη2∆i-1 + η3(∆0-2 + ∆0-4) + 80η5∆0	(45)
≤	-Bη2∆i-1 + (2η3∆0 + 2η3γ2i6η3∆0) +	80η5∆0	(46)
≤ -Bη2∆i-1 +(2〃3(1 + η)2 + 32η3YIη3 + 80η5) ∆0	(47)
≤ - Y2η2∆i-1 + (2η3(1 + η)2 + 11η3 + 80η5) ∆0	(48)
≤-二2 η2∆i-1 + 16η3 ∆0	(49)
Y2
≤- 3 η2N-ι + 16η3 ∆0	(50)
Y 2
where for the first inequality we used Lemma 4, for the second inequality we used that ∆t-1 ≤
△t+2 + 16η3∆0 (which is implied by the induction hypothesis), for the third inequality we used
Lemma 6, for the fourth inequality we used Lemma 5, for the fifth inequality we applied the in-
duction hypothesis iteratively, for the sixth inequality we used Eq. (34), for the seventh and eighth
inequality we used that η is small enough, and for the last inequality we used Lemma 5. Hence:
∆t ≤ (1 -三)∆t-1 + 16η3∆0.
This completes the proof of our inductive step.
It remains to show the basis of the induction, namely that H(i, 3) holds for all i ∈ N. From Lemma 4
we have:
∆3 - ∆2 ≤ 4η2∆2+1 - 5η2∆1+1 + η3(∆1+1 + ∆-l11)	(51)
≤ 4η2∆2+1 - 5η2∆i+1 + 5η3 ∆j+1	(52)
=-η2∆2+1 +5η2(∆2+1 - ∆i+1) + 5η3∆i+1	(53)
≤ -η2∆2+1 + 5η3(2 + η)∆j+1 + 5η3∆j+1	(54)
=-η2∆2+1 + 5η3(3 + η)∆j+1	(55)
≤ -η2∆2+1 + 15η3(1 + η∕3)∆0	(56)
2
≤ -η2∆2-1 + 15η3(1 + η∕3)∆0	(57)
Y2
2
≤ -η2∆2 + 15η3(1 + η∕3)∆0,	(58)
Y2
where for the second equality we used that 0.5x-1 = x0 = xι and 0.5y-ι = yo = yι (which follow
from our initialization), for the third inequality we used that (34), for the fourth inequality we used
Lemma 5, for the fifth inequality we used Lemma 6, and for the last inequality we used Lemma 5.
Hence, for small enough η, we have:
∆3 ≤ (1 - ") ∆2 + 16η3∆0.
□
20
Corollary 7. Under the conditions of Theorem 3, ∆t0 ≡ AT xt 22 + ||Ayt||22 → O(ηγ2∆00) as
t → +∞. In particular, for large enough t, the last iterate of OMD is within O (√η ∙ γp∆0)
distance from the space of equilibrium points of the game, where ∕∆0 is the distance of the initial
point (x0, y0) from the equilibrium space, and where both distances are taken with respect to the
norm pxTAATx + yτATAy.
Proof of Corollary 7: It follows from (33), (34) and (35) that:
2 t-2	∞	2 t
∆0 ≤ (T)	(1 + η)2∆0 + i6χ(i- 'η)η3∆0
γ	t=0	γ
=(1- γ2)t-2 (1 + η)2∆0 + O (ηγ2∆0),
which shows the first part of our claim. For the second part of our claim recall that the solutions
to (29) are all pairs (x, y) such that X is in the null space of AT and y is in the null space of A. 口
D.2 General Bilinear Case
Theorem 8. Consider OMD for the min-max problem (30):
inf sup xTAy + bTx + cTy + d .
xy
Under the same conditions as Corollary 7 and whenever (30) is finite, OMD exhibits last iterate
convergence in the same sense as in Corollary 7. In particular, for large enough t, the last iterate of
OMD is within O (√ ∙ γp∆0) distance from the space of equilibrium points of the game, where
√z∆0 is the distance of the point (xo + (AT )+c, yo + A+ b) from the equilibrium space, and where
both distances are taken with respect to the norm xTAATx + yT AT Ay. Whenever (30) is infinite
or undefined, the OMD dynamics travels to infinity and we characterize its motion.
Proof of Theorem 8: Trivially, we need only consider functions of the form xTAy + bTx + cTy. We
consider the following decompositions of band c:
b = b1 + b2	where b1 ∈ R(A), b2 ∈ N (AT)
c = c1 + c2	where c1 ∈ R(AT), c2 ∈ N(A)
Given the above we can also define b3 and c3 as follows:
Ac3 = b1	feasible since b1 ∈ R(A)
ATb3 = c1	feasible since c1 ∈ R(AT)
Then, we can make the following variable substition:
αt = xt + ηtb2 + b3
βt = yt -ηtc2 + c3
so that:
ATαt = ATxt +ηtATb2 + ATb3
= ATxt + c1 since b2 ∈ N (AT)
Aβt = Ayt - ηtAc2 + Ac3
= Ayt + b1 since c2 ∈ N(A)
We also state the OMD dynamics for xt and yt for problem (30):
xt = xt-1 - 2η(Ayt-1 + b) + η(Ayt-2 + b)
= xt-1 - 2ηAyt-1 +ηAyt-2 -ηb
yt = yt-1 + 2η (AT xt-1 + c) -η (AT xt-2 + c)
= yt-1 + 2ηATxt-1 -ηATxt-2 +ηc
21
Note that given this update step:
xt+1 = xt - 2ηAyt + ηAyt-1 - ηb
xt+1 = xt - ηb2 - 2ηAyt + ηAyt-1 - ηAc3
xt+1 = xt - ηb2 - 2ηA(yt + c3) + ηA(yt-1 + c3)
xt+1 = xt - ηb2 - 2ηA(yt - ηc2t + c3) + ηA(yt-1 - ηc2(t - 1) + c3)
xt+1 + ηb2(t + 1)	= xt +	ηb2t	- 2ηA(yt - ηc2t + c3) + ηA(yt-1 - ηc2(t - 1)	+ c3)
xt+1 + ηb2 (t + 1) + b3	= xt +	ηb2t	+ b3 - 2ηA(yt - ηc2t + c3) + ηA(yt-1 - ηc2 (t	- 1) +	c3)
αt+1 = αt - 2ηAβt + ηAβt-1
Analogously:
βt+1 = βt + 2ηAT αt - ηAT αt-1
Note that these are precisely the dynamics for which we proved convergence in Theorem 1. Thus,
by invoking Theorem 3 and Corollary 7 on the sequence (αt, βt) and then substituting back (xt, yt),
we have that for all large enough t:
xt = -ηb2t - b3 + x(t)
yt = ηc2t - c3 + y (t)
such that ||ATcχ(t)∣∣2, ∣∣A6y(t)∣∣2 ∈ O (√η ∙ γq∆0),
where ∆00 = ||AT (x0 + b3)||22 + ||A(y0 + c3)||22.
In particular, this shows that, whenever (30) is finite (i.e. b2 = c2 = 0), OMD exhibits last iterate
convergence. For large enough t, the last iterate of OMD is within O (√ξ ∙ Y p∆0) distance from
the space of equilibrium points of the game, where a∕∆0 is the distance of (χ0 + b3 ,yo + c3) from
the equilibrium space in the norm √zXTAATX+yTATAy. Whenever (30) is infinite or undefined,
the OMD dynamics travels to infinity linearly, with fluctuations around the divergence specified as
above.	□
D.3 Omitted Proofs
Proof of Proposition 1: To show this, we consider the `2 distance of the solution at time t. First,
recall the GD update step in the special case of f(x, y) = xTy:
xt = xt-1 -ηyt-1
yt = yt-1 +ηxt-1
Then, note that the squared `2 distance of the running iterate (xt, yt) to the unique equilibrium
solution (0, 0) is given by d(t) := ||xt||22 + ||yt||22, which we can calculate:
||xt||22 = ||xt-1||22 - 2ηxtT-1yt-1 +η 2||yt-1||22
llyt-ιll2 = llyt-ιll2 + 2ηyT-ιxt-ι + η2Mχt-ιll2
.∙. d(t) = d(t - 1) + η2d(t 一 1)
= (1 +η 2 )d(t - 1)
This indicates that for any value of η > 0, the running iterate of GD diverges from the equilibrium.
□
Proof of Claim 1: For our first claim, observe that:
hAu, AviAMT = uT AT AMiT MiATAv
i
= uTATA(ATA)k(Aj)TAj(ATA)kATAv
= uTAT(AAT)kA(Aj)TAjAT(AAT)kAv
= uT AT [(AAT)k A(Aj)T][Aj AT (AAT)k]Av
= uTATNiT+1Ni+1Av
= hu, viATNiT+1
22
Our second claim, hAτu, AtV)ATNT = hu, V)AMT , is proven analogously.
、i	"i+1
For our third claim:
(u,Av)am t = ut AMT MjAT Av
i
=ut A(At A)k (At A)j (At A)kAτ Av
if j=0:
=ut A(At A)k (At A)k At Av
=ut A[At (AAt )k ][(AAt )k A]v
=ut A[At NT ][NA]v
=hv,AT U)AT N T
i
otherwise:
u
U
U
,T A(AT A)k AT A(AT A)k AT Av
攵 A[(At A)k At A][(At A)k At A],
`t A[At (AAt )k A][At (AAt )k A]
Iv
Iv
UT A[At NT ][NiA]v
hv,AT U)AT NT
□
ProofofLemma 2: First, We note the following scaled update rule:
MjATxt = Mi (ATxt-I — 2ηAτAyt-i + ηAτAyt-2)
NiAyt = Ni (Ayt-I + 2ηAATxt-I — ηAATxt-2)
Then, taking the norm of both sides, and using the statements of Claim 1:
Ilxt Il Amt = Uxt-IllAMT + 4η2 Uyt-IllATNTI + η2 llyt-2 IIATNTI — 4ηhxt-1, Ayt-I)AMT
+ 2ηhxt-i, Ayt-2〉AMT — 4η2 hyt-i, yt-2)atNʃ,
i	i+1
llyt llAτ Nt = llyt-1llAτ Nt + 4η2 llxt-1"AMTI + η2 llxt-2M AMTI + 4ηhyt-1, AT xt-I)AT Nt
+ 2ηhyt-1,AT xt-2)AT Nτ — 4η2(xt-1,xt-2)AMTI
ʌ △； = llxtMAMT + llyt"ATNτ
△t-1 + 4η2∆i-1 + η2Δi-2 + 2η( hxt-1, Ayt-2) AMτ — hyt-1, Axt-2> ATNτ )
―4η2(hxt-i,xt-2)AMT I + hyt-1,yt-2)ATNTI)
Expanding the first pair of inner products above and using Claim 1 again:
hxt-1,Ayt-2)AM T — hyt-1,AT xt-2)AT NT = hxt-2 — 2ηAyt-2 + ηAyt-3,Ayt-2) AM T
ii	i
—hyt-2 + 2ηATxt-2 — ηATxt-3, ATxt-2)ATNT
i
=—2η(llyt-2llAτ NTI + llxt-2UAMTI) + η((xt-2,xt-3)AMTI + hyt-2,yt-3 )AT NTI)
Then, multiplying by 2η and substituting into the previous derivation yields:
△t — δ⅛-1 =仞2勺-1 — 3力勺-2 + 2η2 (<xt-2,xt-3) AMTI + hyt-2,yt-3) ATNTI)
—4η2(hxt-1, xt-2)AMT+ 1 + hyt-1, yt-2)ATNTI)
23
Now, consider the following inner product:
hxt-2,xt-1iAMTI + {yt-2,yt-1iAτNT 1 = hxt-2, xt-2 — 2ηAVt-2 + ηAyt-3iAMT+1
+ hyt-2, yt-2 + 2ηAτxt-2 - ηAτxt-3〉ATNTI
=A-2 + η (hxt-2, Ayt-3〉AMT I - hyt-2, ATxt-3iATNT 1)
Once again, we multiply by -4η2 and substitute:
△t - Nt-I =仞2勺-1 - 7η2Δt-2 + 2η2 (hxt-2,xt-3i AMTI + hyt-2,yt-3iAτNTI)
+ 4η3(hyt-2, ATxt-3iATNTI - hxt-2, Ayt-3〉AMTI)
Now, we use the update step for time t - 2. For all t ≥ 1, this is well-defined, since x-1 and y-1
are defined. To ensure that this step is sound for t = 0 requires we define the following, where X+
denotes the generalized inverse:
x-2 = 4x0 + L(AT )+y0
η
y-2 = 4yo ——A+xo
η
We define these such that: Atx-2 = 4Atx0 + y0 and Ay-2 = 4Ayo - x0 (since x° ∈ R(A) and
yo ∈ R(AT), and thus the following equalities hold:
x0 = x-1 - 2ηAy-1 + ηAy-2
yo = y-i + 2ηAτx-1 - ηAτx-2
This allows us to use the following expansion freely for all t ≥ 2:
xt-2 = xt-3 - 2ηAyt-3 + ηAyt-4	=⇒ xt-3 一 2ηAyt-3 = xt-2 一 ηAyt-4
yt-2 = yt-3 + 2ηAτxt-3 - ηAτxt-4	=⇒ yt-3 + 2ηAτxt-3 = yy-2 + ηAτxt-4
We can gather the inner product terms and use this update rule to get our final desired result:
△t - Nt-1 =仞2勺-1 - %2勺+2 + 2η2(hxt-2, xt-3 - 2ηAyt-3)AMTI + hyt-2,yt-3 + 2ηATXt-3〉ATNTI)
=仞2勺-1 - 5力勺-2 - 2η3(hxt-2, Ayt-4〉AMT 1 - hyt-2, ATXt-4〉ATNT J
□
ProofofLemma 4: To prove this, first consider the following trivial inequality:
I I yt-2 - AT xt-4 I I AT NTl + ∣∣xt-2 + Ayt-4∣∣AMT 1
=llyt-2∣∣ATNTI - 2hyt-2, ATXt-4〉ATNT 1 + 1 1 ATxt-4llATNTl
+ llxt-2l1AMTI +2hxt-2,Ayt-4〉AMTI + llAyt-4||AMTI
≥0
Rearranging:
2hyt-2, ATXt-4〉ATNT 1 - 2hxt-2, Ayt-4〉AMT 1 ≤ A-2 + (| l ATXt-4∣ ^tNTl + llAyt-4llAMTI
≤ A-2 + λ∞ (llxt-4 11Amt 1 + llyt-4llAf NTI)
≤ A-2 + (λ∞∆t+4)
≤ N-2 + ∆t-4
24
Now, we can apply this bound to the result of Lemma 2:
ʌt - ʌt-l =仞2α-]-5n2夕-2 - 2η3(hXt-2, Ayt-4iAMTι - hyt-2, ATxt-4iAτNTI)
≤ 4η2∆t-1 - 5η2∆t-2 + η3(∆t-2 + △及4)
Which is what we sought out to prove.
□
ProofofLemma 5: Suppose j = i mod 2 and k = (i - j)/2. Notice the following identities:
Mi = Aj(ATA)k, Ni = (AT)j (AAT)k
Mi+1 = (AT)jA(ATA)k, Ni+ι = AjAT (AAT)k
Now:
△t+1 = l∣Ni+ιAyt∣∣2 + ∣ I Mi+1AT Xt I I 2
=∣ I Aj AT (AAT )k Ayt I I 2 + ∣ ∣ (AT)j A(AT A)k AT χt I ∣ 2
≤ λ∞ (∣ ∣ (AT)j (AAT)kAyt ∣ ∣ 2 + ∣ IAj(ATA)kATXt I ∣ 2)
≤ λ∞ (llNiAyt∣∣2 + ∣ I MiATXt I I 2)
≤ ʌt,
where for the last inequality we used that λ∞ ≤ 1.
□
ProofofLemma 6: Given our initialization, X0 ∈ R(A). This implies Xt ∈ R(A), V t, due to the
update step of the dynamics. Recalling key properties of the matrix pseudoinverse, this implies:
Xt ≡ AA+Xt = AAT(AAT)+Xt, for all t. Similarly, given our initialization, yt ∈ R(AT), for
all t, which implies yt ≡ AT (AT )+yt = AT A(AT A)+yt, for all t. Letting Q = (AAT)+ and
P = (ATA)+, we get the following (where j = i mod 2 and k = (i - j)/2):
ʌi =∣ ∣ MiAT Xt ∣ ∣ 2 + ∣∣NiAyt ∣∣2
=I I MiAT AAT QXt I I 2 + ∣ I NiAAT APyt ∣ ∣ 2
=I I Mi+2AT QXt I I 2 + ∣∣Ni+2APyt∣∣2
=I i Aj (AT A)k+1AT (AAT )+Xt i i 2 + ∣ ∣ (AT )j (AAT )k+ιA(AT A)+yt ∣ ∣ 2
=I ∣ Aj (AT A)+AT (AAT )k+ιXt ∣ ∣ 2 + ∣ ∣ (AT )j (AAT )+A(AT A)k+ιyt ∣ ∣ 2
=(I I (AT A)+Mi+2AT Xt I I 2 +∣ I (AAT )+Ni+2Ayt I I 2 if j =0
―[I ∣ (AAT )+Mi+2AT Xt ∣ I 2 +∣ I (AT A)+Ni+2Ayt ∣ I 2 if j = 1
≤ max(∣∣Q∣∣, ∣∣P∣∣)2 ∙ ʌ了2,
where for the fourth and fifth equality we used the following key property of pseudo-inverses: A+ =
(AT A)+AT = AT (AAT)+.	□
25
E DNA-Generation WGAN Architecture
Operation	Kernel Output Shape BatchNorm? Nonlinearity
Length of DNA sequence: L = 6
Gradient penalty: λ = 1e-4
Batch size: 512
G(z) :
z	-	50	-	-
Fully connected	-	128	no	tanh
Fully connected	-	16 X L2	yes	tanh
Reshape	-	16 × 1 × LL	-	-
Upsampling by 2	-	16× 1 ×L	-	-
Convolution D(x) :	[1 × 3] × 4	4×1×L	no	tanh
x	-	4×1×L	-	-
Convolution	[1 × 3] × 16	16× 1 ×L	no	tanh
Fully connected	-	32	no	tanh
Fully connected	-	1	no	linear
F CIFAR 1 0 WGAN Architecture
Operation	Kernel	Output Shape	BatchNorm?	Nonlinearity
Gradient penalty: λ = 10				
Batch size: 64				
G(z) :				
z	-	100	-	-
Fully connected	-	1024	no	LeakyReLU
Fully connected	-	8192	yes	LeakyReLU
Reshape	-	128× 8×8	-	-
TransposedConv	[5 × 5] × 128	128× 16× 16	yes	LeakyReLU
Convolution	[5 × 5] × 64	64 × 16 × 16	yes	LeakyReLU
TransposedConv	[5 × 5] × 64	64 × 32 × 32	yes	LeakyReLU
Convolution	[5 × 5] × 3	3 × 32 × 32	no	tanh
D(x) :				
x	-	3 × 32 × 32	-	-
Convolution	[5 × 5] × 64	64 × 32 × 32	no	LeakyReLU
Convolution	[5 × 5] × 128	128× 14× 14	no	LeakyReLU
Convolution	[5 × 5] × 128	128× 7× 7	no	LeakyReLU
Fully connected	-	1024	no	LeakyReLU
Fully connected	-	1	no	linear
26
G CIFAR 1 0 Generator Image Samples
(a) Sample of images from Generator of Epoch 94, which had the highest inception score.
Figure 10: Samples of images from Generator trained via Optimistic Adam on CIFAR10.
G. 1 Comparison of Early Epoch Images of Optimistic Adam vs Adam
Below we give samples of images from an early epoch 19 Generator trained via Optimistic Adam
with 1:1 training ratio, Adam with 1:1 and Adam with 5:1 ratio on CIFAR10. We see that Optimistic
Adam has already achieved visually appealing results unlike the latter two vanilla Adam based
versions.
27
Figure 11: Sample of images from Generator of Epoch 19 trained via Optimistic Adam and 1:1 training ratio.
Figure 12: Sample of images from Generator of Epoch 19 trained via Adam and 1:1 training ratio.
28
Figure 13: Sample of images from Generator of Epoch 19 trained via Adam and 5:1 training ratio.
29
H CIFAR 1 0 Adam vs. Optimistic Adam Comparison
epoch
Figure 14: The inception scores across epochs for GANs trained with Optimistic Adam (ratio 1) and Adam (ra-
tio 5) on CIFAR10 (the two top-performing optimizers found in Section 6, with 10%-90% confidence intervals.
The GANs were trained for 30 epochs and results gathered across 35 runs.
30