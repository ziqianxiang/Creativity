Figure 1: Left: representation of a transform coding model as a generative Bayesian model, and acorresponding variational inference model. Nodes represent random variables or parameters, andarrows indicate conditional dependence between them. Right: diagram showing the operationalstructure of the compression model. Arrows indicate the flow of data, and boxes represent transfor-mations of the data. Boxes labeled U | Q represent either addition of uniform noise applied duringtraining (producing vectors labeled with a tilde), or quantization and arithmetic coding/decodingduring testing (producing vectors labeled with a hat).
Figure 2: Left: an image from the Kodak dataset. Middle left: visualization of a subset of the latentrepresentation y of that image, learned by our factorized-prior model. Note that there is clearlyvisible structure around edges and textured regions, indicating that a dependency structure existsin the marginal which is not represented in the factorized prior. Middle right: standard deviationsσ of the latents as predicted by the model augmented with a hyperprior. Right: latents y dividedelementwise by their standard deviation. Note how this reduces the apparent structure, indicatingthat the structure is captured by the new prior.
Figure 3: As in figure 1, but extended with a hyperprior.
Figure 4: Network architecture of the hyperprior model. The left side shows an image autoen-coder architecture, the right side corresponds to the autoencoder implementing the hyperprior. Thefactorized-prior model uses the identical architecture for the analysis and synthesis transforms gaand gs. Q represents quantization, and AE, AD represent arithmetic encoder and arithmetic decoder,respectively. Convolution parameters are denoted as: number of filters × kernel support height ×kernel support width / down- or upsampling stride, where ↑ indicates upsampling and ] downsam-pling. N and M were chosen dependent on λ, with N = 128 and M = 192 for the 5 lower values,and N = 192 and M = 320 for the 3 higher values.
Figure 5: Rate-distortion curves aggregated over the Kodak dataset. The top plot shows peak Signal-2552to-noise ratios as a function of bit rate (10 log 10 2d5-, With d representing mean squared error), thebottom plot shows MS-SSIM values converted to decibels (-10 log10(1 - d), where d is the MS-SSIM value in the range between zero and one). We observe that matching the training loss tothe metric used for evaluation is crucial to optimize performance. Our hyperprior model trainedon squared error outperforms all other ANN-based methods in terms of PSNR, and approximatesHEVC performance. In terms of MS-SSIM, the hyperprior model consistently outperforms con-ventional codecs as well as Rippel and Bourdev (2017), the current state-of-the-art model for thatmetric. Note that the PSNR plot aggregates curves over equal values of λ, and the MS-SSIM plotaggregates over equal rates (with interpolation), in order to provide a fair comparison to both state-of-the-art methods. Refer to figures 11 and 12 in the appendix for full-page RD curves that includea wider range of compression methods.
Figure 6: The visual artifacts generated at low bit rates depend on the training loss. The top figure(0.1864 bpp, PSNR=27.99, MS-SSIM=0.9803) was generated by the hyperprior model using anMS-SSIM loss, while the bottom figure (0.1932 bpp, PSNR=32.26, MS-SSIM=0.9713) was trainedusing squared loss.
Figure 7: Amount of side in-formation (encoding Z) as afunction of total bit rate (en-coding y and Z), for the hy-perprior model optimized forsquared error, averaged overthe Kodak set, and normal-ized per pixel. Only a smallfraction of the total bit rate isUsed for encoding Z.
Figure 8: A fit of the non-parametric model p (with K = 3) to a Gaussian mixture distribution. Grayplots illustrate convergence of the model. The non-parametric model is able to produce a good fit tothe ground truth density.
Figure 9: Fitting the density model described in the previous section to a uniform distribution, withand without convolving the model with a uniform density. Gray plots illustrate convergence of themodel. While p itself assumes smoothness and thus fails to find an adequate fit to the uniform withits steep edges, the augmented model fits almost perfectly.
Figure 10: Rate-distortion curves for factorized-prior models only differing in their transform Ca-pacity (number of filters at each transform layer N ). Note that performance gains with increasednumber of filters stagnates as a λ-dependent saturation point is reached. For example, moving from64 to 128 filters makes a significant difference at 0.5 bpp, while moving from 128 to 192 only yieldsa negligible gain, and there is no benefit in going up to 256.
Figure 11: Rate-distortion curves for PSNR covering a wide range of conventional and ANN-basedcompression methods. We see that our hyperprior model (blue squares) outperforms most conven-tional codecs (JPEG, JPEG 2000, and WebP) as well as all ANN-based methods by a wide margin.
Figure 12: Rate-distortion curves for MS-SSIM covering a wide range of conventional and ANN-based compression methods. When trained on MS-SSIM, our hyperprior model outperforms Rippeland Bourdev (2017), the current state of the art, consistently across all bit rates. Note that even whentrained using squared loss, our hyperprior model (blue squares) yields higher MS-SSIM scores thanall of the conventional methods.
Figure 13: Rate-distortion curves for PSNR covering a wide range of conventional and ANN-basedcompression methods. Results are qualitatively similar to the results on Kodak.
Figure 14: Rate-distortion curves for MS-SSIM covering a wide range of conventional and ANN-based compression methods. Results are qualitatively similar to the results on Kodak.
Figure 15: Results for Kodak image 01: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 16: Results for Kodak image 02: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 17: Results for Kodak image 03: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 18: Results for Kodak image 04: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 19: Results for Kodak image 05: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 20: Results for Kodak image 06: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 21: Results for Kodak image 07: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 22: Results for Kodak image 08: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 23: Results for Kodak image 09: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 24: Results for Kodak image 10: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 25: Results for Kodak image 11: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 26: Results for Kodak image 12: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 27: Results for Kodak image 13: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 28: Results for Kodak image 14: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 29: Results for Kodak image 15: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 30: Results for Kodak image 16: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 31: Results for Kodak image 17: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 32: Results for Kodak image 18: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 33: Results for Kodak image 19: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 34: Results for Kodak image 20: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 35: Results for Kodak image 21: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 36: Results for Kodak image 22: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 37: Results for Kodak image 23: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
Figure 38: Results for Kodak image 24: PSNR and MS-SSIM rate-distortion curves (top), andexample reconstructions for the hyperprior model optimized for squared error (bottom left) andMS-SSIM (bottom right). Images correspond to third rate-distortion point from the left of the bluecurves (square and disc markers, respectively). Best viewed on a computer screen.
