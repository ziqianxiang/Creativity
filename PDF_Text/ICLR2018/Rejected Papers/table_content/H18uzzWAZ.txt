Table 1: k-NN MOA assignment metrics for TVN only, TVN + WDN, and TVN + CORAL, whereWDN is regularized by either early stopping or a regularization term with weights. The last columnshows the standard errors estimated by the bootstrap method described in Section 3.3.2. Thesemetrics suggest that WDN with early stopping yields embeddings containing stronger biologicalsignal than TVN or TVN + CORAL. Here the λ = 40, 80, 160 are the WDN transformation afterconverging, when a regularization term λ = λM = λb is added.
Table 2: Batch (domain) classification accuracy after transformations for controls using either logis-tic regression (LR) or a random forest (RF) with 3 folds. We only use controls here because othertreatments have no replicates across batches in our dataset. We compare TVN only, TVN + WDN(with early stopping), and TVN + CORAL. We also show the results for WDN with λ = 40, 80, 160for λ = λM = λb. The ‘trivial transformation’ (send all embeddings to a point) is provided forreference. If all nuisance information is removed, the batch accuracy would drop that of the trivialtransformation. The table below shows that WDN removes some of the nuisance variation, at leastfrom the controls.
Table 3: We show the silhouette index for TVN only, TVN + WDN, and TVN + CORAL, as dis-cussed in Section 3.2.2. Here WDN refers to the the result using early stopping, and λ = 40, 80, 160refers to the result when using a regularization with λ = λM = λb . Both WDN and CORAL ap-pear to increase the cohesion, as measured by this index. The estimated error denoted by ± wasdetermined by the bootstrapping procedure described in Section 3.3.2	TVN only	WDN	CORAL	λ = 40	λ = 80	λ = 160	土Silhouette index	0.5042-	0.5126	0.5099	0.5088	0.5115	0.5093	0.00194.1	Future WorkOne possible modification we considered would be to replace the form of the cost function by thefollowing, which would more closely resemble finding the Wasserstein barycenter:NX W(νi,Adj(νj)).	(13)i,j=1The difference is that instead of comparing the pairwise transformed distributions, we instead com-pare the transformed distributions to the original distributions. One advantage for this approach isthat it avoids the ‘shrinking to a point’ problem, and therefore does not require a regularization termor early stopping to converge to a meaningful solution. However, we did not find better performancefor the new form of the cost function (eq. 13) for our specific dataset.
