Figure 1: Schematic of how different conformers of two enantiomers (panel A) separate in a learnedlatent space (panel B) under a 2D (achiral) graph model, E(3)- and SE(3)-invariant 3D models, andChIRo, which is invariant to rotations of internal molecular bonds (InterRoto-invariance).
Figure 2: Geometric visualization of how ChIRo learns chiral representations with InterRoto-invariance. Given two enantiomers with three coupled torsions ψa , ψb, and ψc involving a chiralcarbon center, rotating the shared carbon-carbon bond by R ∈ [0, 2π) rotates each torsion together,forming three periodic sinusoids (solid RGB curves). Learning phase shifts φi for each torsionproduces shifted waves (dashed RGB curves) that differ between enantiomers. A weighted sum ofthe shifted sinusoids results in different degrees of wave interference between enantiomers, yieldingdifferent amplitudes of the net waves. These amplitudes, visualized here as the different radii (r)of the circles formed by plotting the summed sines against the summed cosines, are invariant to therotation of the internal carbon-carbon bond. See appendices A.1, A.2 for further details.
Figure 3: Visualization of how conformers of two enantiomers in the contrastive learning test setcluster in the learned latent space for ChIRo, SchNet, DimeNet++, and SphereNet (top row) usingthe original OMEGA-generated conformers; (middle row) upon reflecting the conformers, whichadds points with inverted chirality (opposite color); and (bottom row) upon rotating internal bondsinvolving the chiral center. Unlike SchNet, DimeNet++, and even the SE(3)-invariant SphereNet,ChIRo maintains perfect separation between stereoisomers across these conformer transformations.
Figure 4: Architecture of ChIRo18Published as a conference paper at ICLR 2022Table 5: Hyperparameters optimized for ChIRo on each task. Parameters for chiral message passingare shown, although chiral message passing is omitted in the default version of ChIRo.
Figure 5: Histogram of the number of conformers per stereoisomer in the contrastive learningdataset.
Figure 6: Histogram of the number of stereoisomers per 2D graph in the contrastive learning dataset.
Figure 7: Histogram of the number of conformers per enantiomer in the R/S classification dataset.
Figure 8:	Data extraction, filtering, and generation steps for the l / d classification task.
Figure 9:	Data generation and filtering steps for the ranking enantiomers by docking scores task.
Figure 10:	Histogram of the number of conformers per enantiomer in the docking dataset.
Figure 11:	Distribution of the differences in (best) docking scores between pairs of enantiomers inthe docking dataset.
Figure 12: Ranking accuracy of the predicted conformer-averaged docking scores when evaluatedon subsections of the test set in which the ground truth difference in best docking scores betweenenantiomers is (upper left) greater than or equal to the specified margin, (upper right) less than orequal to the specified margin, or (bottom) equal to the specified margin. Error bars for the modelsrepresent standard deviations in ranking accuracy across three random training/inference trials. Errorbars for the random baseline correspond to the standard deviation of a binomial distribution B(p =0.5, N), where N is the number of enantiomer pairs in the subset.
Figure 13: Distribution of the fraction of conformers per enantiomer predicted to have the same classlabel for the l/d classification task across the test sets in each of the five folds, for both SphereNetand ChIRo when trained on all conformers in the training set (top row) or on a single conformer perenantiomer (bottom row). Note that for the l/d classification task, there are exactly five conformersper enantiomer in the test splits of each fold.
Figure 14: Confusion matrices indicating SphereNet’s (mis)classification of conformers of threepairs of enantiomers in the l/d classification task’s test set (of the first fold) whose highlightedbonds are each rotated in increments of 12。(left and center) or 30。(right). These three pairsof enantiomers were specifically chosen for this confusion analysis because SphereNet correctlyclassifies all of their original (non-rotated) conformers.
