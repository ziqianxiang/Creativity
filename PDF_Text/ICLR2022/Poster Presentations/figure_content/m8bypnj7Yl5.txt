Figure 1: Overview of the proposed method. [Left] The hypersolver is trained to approximate residuals givena distribution of control inputs and states. [Right] The pre-trained hypersolver model is then used to accelerateand improve the accuracy of numerical solutions used during optimization of control policies, leading to higher-quality controllers.
Figure 2: Mean local residuals of the spring-mass system of (17) as a function of control inputs at different stepsizes . HyperEuler (see Appendix A.1 for its explicit formulation) improves on the local residuals comparedto the baseline Euler and even compared to higher-order ODE solvers at larger step sizes.
Figure 4: Generalization outside of the training region (red rectangle) in the state space of an inverted pendu-lum model With different hypersolver activation functions. Architectures containing activation functions Withperiodic components achieve better extrapolation properties compared to the others.
Figure 3: Mean Absolute Error (MAE) along tra-jectories With different pre-training techniques on thespring-mass system of (17). [Top] Stochastic explo-ration performs better on average i.e. u ∈ [-100, 100].
Figure 5: Direct optimal control of the inverted pendulum in phase space. While the controller optimized Withthe Euler solver fails to control the system for some trajectories, the one obtained With HyperEuler improvesthe performance While introducing a minimal overhead With results comparable to higher-order solvers.
Figure 6: Model Predictive Control With constrained inputs on the cart-pole model. MPC With the Midpointsolver iterating on the partial dynamic model successfully swings up the pole but fails to reach the targetposition. Multi-stage Hypersolver With the Midpoint base solver has knoWledge restricted to the inaccuratesystem, yet it manages to obtain a similar control performance compared to controllers With access to thenominal dynamics While also needing less control effort and absolute energy infloW compared to its base solver.
Figure 7: [Left] Local residual distribution for the quadcopter model for = 0.02 s. [Center] Trajectoriesof controlled quadcopters with MPC whose receding horizon controller is optimized by solving the ODE withdifferent methods. [Right] Final positions error distribution. The proposed approach with HyperEuler achieveslower average error compared to other baseline solvers while requiring a low overhead compared to higher-order solvers due to a smaller number of dynamics function evaluations.
Figure 8: Displacement variables σt and σ, of the discretized Timoshenko beam as a function of position X ofthe finite elements and time t. The controller optimized with HyperEuler manages to stabilize the beam whilethe baseline solvers Euler and Midpoint fail, yet requiring less than a third in terms of runtime compared toRK4.
Figure 9:	Generalization with different hypersolver activation functions (HyperEuler models are marked with”HE”) on the inverted pendulum. [Left] Generalization for the controller space outside of the training region(red area). The architecture with Snake can to generalize better compared to other hypersolvers. [Right]Generalization for different time steps outside of the training step = 0.1 s (red line). HyperEuler is able toimprove the baseline Euler solver performance even for unseen .
Figure 10:	Controlled trajectories of the inverted pendulum with controllers optimized via different solvers.
Figure 11: One step Mean Absolute Error (MAE) for multi-stage hypersolvers and different solvers as wellas correction schemes in the ablation study. Multi-stage Hypersolver (MS) with joint training and Midpointbase solver iterating on an inaccurate vector field agnostic of friction forces outperforms the Midpoint solverwith full knowledge of the vector field.
Figure 12: Symmetric Mean Absolute Percentage Error (SMAPE) propagation along controlled trajectoriesof the cart-pole system. The Multi-stage Hypersolver With knoWledge limited to the inaccurate model managesto outperform the Euler solver iterating on the accurate dynamics in terms of positions and angular positions.
Figure 13: Mean Absolute Error (MAE) propagation on velocities vt , vr and displacements σt , σr for thefinite elements of the discretized Timoshenko beam along controlled trajectories. While solutions from Eulerand Midpoint quickly diverge due to the system’s stiffness, HyperEuler manages not only to contain errors buteven outperform the fourth-order RK4 whilst requiring a fraction of the number of vector field evaluations.
