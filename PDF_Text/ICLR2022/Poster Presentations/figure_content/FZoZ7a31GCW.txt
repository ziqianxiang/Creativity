Figure 1: Draupnir as a graphical model. For notation and information on variables andtheir dimensions see Tables 1 and 2 in Appendix A.1 and A.2. Random variables are shownas ellipses, while deterministic quantities are shown as rounded boxes and observed randomvariables are shown as shaded ellipses. Parameters of priors and other given quantities areshown without boxes. The model contains three plates, respectively corresponding to thenumber of dimensions of the leaf sequence-specific latent vector Zk,: (nZ =30), the numberof leaf sequences (nS) and the alignment length (nL). “cat” indicates the concatenationof two vectors. α are the hyperparameters and σn, σf , λ are the parameters of the TOUprocesses. Σh,:,: is the covariance matrix that is used to sample component h of the nSlatent vectors from a multivariate Gaussian distribution (with mean 0(nS)). T(S,S) is thepatristic distance matrix containing the distances between the leaf sequences. Yk,: is theinput vector for the GRU that produces the likelihood parameters for leaf sequence k, Sk,: .
Figure 2: Results for the β-lactamase family with 32 leaves. Left: t-SNE projection of thelatent representations of the ancestral and leaf nodes. Right: The phylogenetic tree. Bothplots are coloured according to clade membership.
Figure 3: Comparison of the average percentage identity (y-axis) between predicted and trueancestral sequences for Draupnir (MAP and marginal) and ASR methods for data sets withdifferent number of leaves (x-axis; experimental data sets are indicated with an asterisk).
Figure 5: BLOSUM embedding ablation study for the 800 leaves data set. For every 100training epochs, the average percent identity and standard deviation are plotted for all leaves(training set) or ancestors (test set), respectively. The results obtained with the BLOSUMembedding are shown in dark green (MAP) and light green (marginal, see Equation 3). Theresults without the BLOSUM embeddings are shown in pink (MAP) and purple (marginal).
Figure 7: Bottom: t-SNE projections of the latent representations for the SRC-Kinase SH3domain with 100 leaves, obtained from a standard VAE (left) and Draupnir-marginal (centerand right), colored by clade. Note that only the latter model can be used to infer the latentrepresentations of the ancestral sequences. Top: the corresponding tree.
Figure 8: Architectures and dimensions of the neural networks used in Draupnir. Left:Architecture of the bidirectional GRUθ (red) and NN(θ2). Right: Architecture of NN(θ1). “fc”indicates a fully connected layer.
Figure 9: DI values for all position pairs of the WB40 data set obtained from the leafsequences (upper left) and sequences sampled at the root node (other plots) using theMAP, Marginal and Variational methods. We sampled 125 root sequences, which is equalto the number of leaves. The correlation coefficients between the DIs of the leaves and thesampled sequences are 0.05 (MAP), 0.66 (Marginal) and 0.79 (Variational).
Figure 10: Comparison of the Euclidean distances between the latent representations of theleaves (y-axis) and the corresponding branch lengths in the phylogenetic tree (x-axis). Weuse the same color scheme as in Figure 2. We traverse the tree in level order and assign thecolour of the clade of the first leaf. (Left) The standard VAE. The correlation coefficientis 0.79; the Spearman correlation coefficient is 0.85. (Right) Draupnir. The correlationcoefficient is 0.91; the Spearman correlation coefficient is 0.94.
