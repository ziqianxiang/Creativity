Figure 1: Anatomical and functional whole-brain datasets available in C. elegans. a. The connectome-constrained generative model produces a prior distribution of voltage dynamics and fluorescence traces givenchemosensory stimulus. Observed data is highlighted in color and r is the upsampling factor from the acquisitionrate to the simulation rate. b. The inference network generates a posterior distribution of voltage dynamicsgiven observed fluorescence traces and chemosensory stimuli. c. The connectome of C.elegans nervous system,with chemical connections in blue and electrical connections in orange [30]. Neurons recorded in the functionalimaging dataset [32] are colored green. d. Labeled whole-brain calcium imaging of 170 neurons in the head ofthe worm while a panel of chemosensory stimuli were presented [32]. Deterministic multicolor labels allow forthe identification of all neurons. e. Sample fluorescence activity traces of three measured neurons, with stimulusdelivery marked by the colored bars. Note the significant trial-to-trial variability in neural activity.
Figure 2: LVM predictive performance across neuron types. a. Violin plots comparing the distribution ofcorrelation coefficients between predicted and measured neuron activity for the 9 LVM variants. Neurons aredivided into sensory, inter, and motor neurons. b. Measured traces and predictions made by the 9 models forthree selected neurons: sensory neuron BAG, interneuron AVA, and motor neuron DB02.
Figure 3: Schematic of the connectome-constrained latent variable model (CC-LVM). Sensory inputs arefed through a biophyiscally realistic ConneCtome-Constrained network to generate the voltage prior PÎ¸ (v|o).
Figure 4:	Worm holdout evaluation: Violin plots comparing the distribution of correlation coeffi-cients between predicted and measured neuron activity for the 9 LVM variants. Neurons are dividedinto sensory, inter, and motor neurons.
Figure 5:	Scatter plot for predictive performance of worm holdout v.s. neuron holdout. Eachpoint represents one neuron. Our best model connectome count2 achieves highest correlation, whichindicates highest consistency for neurons which gets better performance in both evaluations.
Figure 6:	LVM predictive performance across neuron types for neuron holdout evaluation.
Figure 7: LVM predictive performance across neuron types for worm holdout evaluation. Mea-sured traces and predictions made by the 9 LVMs for 15 neurons including sensory neurons, interneu-rons and motor neurons.
Figure 8: Neuron holdout evaluated on connectome count2 : CC-LVM predicted traces and thecorresponding voltage latent space across all recorded neurons (part 1).
Figure 9: Neuron holdout evaluated on connectome count2 : CC-LVM predicted traces and thecorresponding voltage latent space across all recorded neurons (part 2).
Figure 10: Neuron holdout evaluated on connectome count2 : CC-LVM predicted traces and thecorresponding voltage latent space across all recorded neurons (part 3).
Figure 11: A train worm evaluated on worm holdout using connectome count2 constraint:CC-LVM predicted traces and the corresponding voltage latent space across all neurons includingunmeasured neurons (part 1).
Figure 12: A train worm evaluated on worm holdout using connectome count2 constraint:CC-LVM predicted traces and the corresponding voltage latent space across all neurons includingunmeasured neurons (part 2).
Figure 13: A train worm evaluated on worm holdout using connectome count2 constraint:CC-LVM predicted traces and the corresponding voltage latent space across all neurons includingunmeasured neurons (part 3).
Figure 14: A train worm evaluated on worm holdout using connectome count2 constraint:CC-LVM predicted traces and the corresponding voltage latent space across all neurons includingunmeasured neurons (part 4).
Figure 15: A train worm evaluated on worm holdout using connectome count2 constraint:CC-LVM predicted traces and the corresponding voltage latent space across all neurons includingunmeasured neurons (part 5).
Figure 16: A hold-out (test) worm evaluated on worm holdout using connectome count2 con-straint: CC-LVM predicted traces and the corresponding voltage latent space across all neuronsincluding unmeasured neurons (part 1).
Figure 17: A hold-out (test) worm evaluated on worm holdout using connectome count2 con-straint: CC-LVM predicted traces and the corresponding voltage latent space across all neuronsincluding unmeasured neurons (part 2).
Figure 18: A hold-out (test) worm evaluated on worm holdout using connectome count2 con-straint: CC-LVM predicted traces and the corresponding voltage latent space across all neuronsincluding unmeasured neurons (part 3).
Figure 19: A hold-out (test) worm evaluated on worm holdout using connectome count2 con-straint: CC-LVM predicted traces and the corresponding voltage latent space across all neuronsincluding unmeasured neurons (part 4).
Figure 20: A hold-out (test) worm evaluated on worm holdout using connectome count2 con-straint: CC-LVM predicted traces and the corresponding voltage latent space across all neuronsincluding unmeasured neurons (part 5).
