Figure 1: Survival Clustering.
Figure 2: Summary of the VaDeSC.
Figure 3: Generative model.
Figure 4: Cluster-specific KaPlan-Meier (KM) curves (top) and t-SNE visualisation of latent rep-resentations (bottom), coloured according to survival times (yellow and blue correspond to higherand lower survival times, respectively), learnt by different models (b-e) from one replicate of thesurvMNIST dataset. Panel (a) shows KM curves of the ground truth clusters. Plots were generatedusing 10,000 data points randomly sampled from the training set; similar results were observed onthe test set.
Figure 5: Cluster-specific KaPlan-Meier curves and corresponding centroid CT images, computedby averaging all samples assigned to each cluster by (a) DSM and (b) VaDeSC on the NSCLC data.
Figure 6: CT images generated by (i) samplinglatent representations from the Gaussian mix-ture learnt by VaDeSC and (ii) decoding rep-resentations using the decoder network.
Figure 7: Survival time, in days, measuredfrom the enrolment in the study for a fewsubjects from an observational cohort ofhigh-grade glioma patients. Here, × corre-sponds to death (the event of interest), and• denotes censoring.
Figure 8: Comparison of the generative assumptions made by the models related to the VaDeSC:(a) survival cluster analysis (SCA; Chapfuwa et al. (2020)), (b) deep survival machines (DSM; Nag-pal et al. (2021a)), (c) and profile regression for survival data (PR; Liverani et al. (2020)). For thesake of brevity, the censoring indicator δ, model parameters and hyperparameters were omitted.
Figure 9: Visualisation of one repliCate of the synthetiC data. t-SNE plot (on the left) is based onthe explanatory variables only. Kaplan-Meier Curves (on the right) are plotted separately for eaChCluster. Different Colours Correspond to different Clusters. As Can be seen, Clusters are determinedby both differenCes in (a) Covariate and (b) survival distributions.
Figure 10: Visualisation of one replicate of the survMNIST dataset. Generally, survMNIST tends tohave more disparate survival distributions across clusters than the synthetic data (cf. Figure 9).
Figure 11: A full resolution Lung1 image averaged across 11 CT slices (a) before and (b) aftercropping, normalisation, and histogram equalisation. Panels (c)-(j) depict augmentations applied toimages during neural network training.
Figure 12: Cluster-specific Kaplan-Meier (KM) curves (top) and t-SNE visualisation of latent rep-resentations (bottom), coloured according to survival times (yellow and blue correspond to higherand lower survival times, respectively), learnt by different models (b-e) from one replicate of thesynthetic dataset. Panel (a) shows KM curves of the ground truth clusters. Plots were generatedusing 10,000 data points randomly sampled from the training set, similar results were observed onthe test set.
Figure 13: Performance of the VaDeSC on the synthetic data (see Appendix E.1) at varying percent-ages of censored data points (10-90%): (a) clustering accuracy, (b) concordance index, (c) relativeabsolute error (RAE) evaluated on non-censored and (d) censored data. Averages and standard de-viations are reported across 5 independent simulations, evaluation was performed on test data. Forreference, we report performance of the unsupervised clustering model VaDE and of DSM andWeibull AFT models for survival analysis.
Figure 14: Average test set (a) CI and (b) RAE on synthetic data with K = 3 clusters achieved byVaDeSC models with different numbers of mixture components. Error bars correspond to standarddeviations across 5 independent simulations. The CI plot (left) exhibits a pronounced ‘elbow’ at thetrue number of clusters.
Figure 15:	Average test set (a) CI and (b) RAE on survMNIST with K = 5 clusters achieved byVaDeSC models with different numbers of mixture components. Error bars correspond to standarddeviations across 10 independent simulations. The CI plot (left) appears to saturate at the truenumber of clusters, although the ‘elbow’ is not quite as sharp as for the synthetic data (cf. Figure 14).
Figure 16:	Reconstructions of survMNIST digits. Original digits are shown in the top row, theirreconstructions by VaDeSC — in the bottom row.
Figure 17:	survMNIST samples generated by VaDeSC. In this simulation, the true clustering is givenby {{7}, {0, 9}, {2, 4, 6}, {8}, {1, 3, 5}}. Cluster 1 appears to align with {0, 9}; cluster 2 — with{7}; cluster 4 — with {2, 4, 6}; cluster 5 — with {1, 3, 5}.
Figure 18: Visualisation of (a) the t-SNE decomposition of the Hemodialysis data in the embeddedspace and (b) the Kaplan-Meier curves for the two clusters discovered by VaDeSC. The two clustershave substantially different survival distributions.
Figure 19: Cluster-wise β parametersof the Weibull distributions discoveredon the Hemodialysis dataset.
Figure 20: The most important predictors for VaDeSC cluster assignments, according to the averageShapley values (see Appendix I). The survival time was not included into this plot, although itwas ranked among the most important features. The two clusters are characterised by disparatedistributions of the considered clinical variables, where the high-risk cluster shows lower values ofalbumin, dialysis dose, and ultrafiltration in agreement with previous studies.
Figure 21: A random selection of CT images assigned by (a) DSM and (b) VaDeSC to each cluster(denoted by colour) with the corresponding centroid images, computed across all samples. Thecolours correspond to the same clusters as in Figure 5. Clusters discovered by VaDeSC are stronglycorrelated with the tumour location; DSM does not appear to discover such association.
Figure 22: An extended version of Figure 6. CT images generated by (i) sampling latent represen-tations from the Gaussian mixture learnt by VaDeSC and (ii) decoding the representations using thedecoder network. The colours correspond to the same clusters as in Figure 5.
Figure 23: CT images generated by training the VaDeSC model 20 times using different train-testsplits. For each trained model, we (i) select the learnt means of the Gaussian mixture and (ii) decodethem using the decoder network. Each column corresponds to a different seed of the train-test splitused to train the model. Each row corresponds to a different cluster. For each seed, we order therows according to the median survival within the cluster, hence the upper rows are associated withhigher survival time. We observe a clear association with tumour location, consistent across mostexperiments.
