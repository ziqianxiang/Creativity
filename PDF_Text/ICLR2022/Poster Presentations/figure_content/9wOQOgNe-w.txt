Figure 1: Overview of differentiable DAG sampling.
Figure 2: Differentiable DAG sampling in Python4Published as a conference paper at ICLR 20224	Variational DAG Learning from Observational DataStructural Equation Model (SEM). Weassume that the data follow a SEM i.e. Xi = K(Xpa*(力气)where Ei are independent noises and fi is the ground-truth causal mechanism which deterministicallytransforms the parent causes xpa*(i)and noise Ei in the consequence value Xi. We assume that allvariables are observed. We aim at learning both the true parents pa* (i) for each node i describingthe direct cause-consequence relationship, and the true causal mechanisms f*. Alternatively, a SEMcan equivalently be written in a matrix form. Indeed, one can use the DAG adjacency matrix A*as a mask before applying the causal mechanism fi* i.e. Xi = fi* (Ai* ◦ X, Ei). Similar maskingformulations of a SEM have been used in previous works (Brouillard et al., 2020; Ng et al., 2019).
Figure 3: Sampling time of DP-DAG using Gumbel-Sinkhorn orGumbel-Top-k.
Figure 4: DAG sampling time of DP-DAG using Gumbel-Sinkhorn or Gumbel-Top-k parametrizationfor permutation sampling. The Gumbel-Top-k parametrization is significantly faster for sampling.
Figure 5:	DAG structure learning results for different graph types and sizes for all differentiableVI-DP-DAG, GraN-DAG and Masked-DAG with SHD scores with different thresholds from sparserto denser graphs (Lower is better).
Figure 6:	Relative confidence scores of perturbed graphs A* obtained by randomly moving edgesfrom the ground-truth DAG adjacency matrix A*. Fig. 6a-6c show the results for models witharchitecture similar to VI-DP-DAG. Fig. 6d-6f show the results for modelsslower than VI-DP-DAG, the CAM algorithm is at least more than ×900 slower than VI-DP-DAGsince it did not finish in less than 2 days, and the DAG pruning post-processing is around ×23 slowerthan VI-DP-DAG.
Figure 7:	Causal mechanisms results on all datasets with MSE score (Lower is better) on a testset i.e. ||X - X||2 where Xi = fi,θ(Ai ◦ X). We vary the threshold t to compute the adjacencymatrix A from the edge probabilities Aij = 1pφ(Uj∣∏)>t OfVI-DP-DAG. For indication, the MSEof GraN-DAG, Masked-DAG and GT-DAG are plotted with straight lines.
