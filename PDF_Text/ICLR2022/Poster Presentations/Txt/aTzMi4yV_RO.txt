Published as a conference paper at ICLR 2022
Do Not Escape From the Manifold: Discover-
ing the Local Coordinates on the Latent Space
of GANs
JaeWoong Choi； Junho Lee； Changyeon Yoon, Jung Ho Park,
Geonho Hwang, Myungjoo Kang
Seoul National University
{chjw1475,joon2003,shinypond,jhpark009,hgh2134,mkang}@snu.ac.kr
Ab stract
The discovery of the disentanglement properties of the latent space in GANs mo-
tivated a lot of research to find the semantically meaningful directions on it. In
this paper, we suggest that the disentanglement property is closely related to the
geometry of the latent space. In this regard, we propose an unsupervised method
for finding the semantic-factorizing directions on the intermediate latent space of
GANs based on the local geometry. Intuitively, our proposed method, called Lo-
cal Basis, finds the principal variation of the latent space in the neighborhood of
the base latent variable. Experimental results show that the local principal vari-
ation corresponds to the semantic factorization and traversing along it provides
strong robustness to image traversal. Moreover, we suggest an explanation for
the limited success in finding the global traversal directions in the latent space,
especially W -space of StyleGAN2. We show that W-space is warped globally by
comparing the local geometry, discovered from Local Basis, through the metric
on Grassmannian Manifold. The global warpage implies that the latent space is
not well-aligned globally and therefore the global traversal directions are bound
to show limited success on it.
1 Introduction
Generative Adversarial Networks (GANs, Goodfellow et al. (2014)), such as ProGAN (Karras et al.,
2018), BigGAN (Brock et al., 2018), and StyleGANs (Karras et al., 2019; 2020b;a), have shown
tremendous performance in generating high-resolution photo-realistic images that are often indistin-
guishable from natural images. However, despite several recent efforts (Goetschalckx et al., 2019;
Jahanian et al., 2019; Plumerault et al., 2020; Shen et al., 2020) to investigate the disentanglement
properties (Bengio et al., 2013) of the latent space in GANs, it is still challenging to find meaningful
traversal directions in the latent space corresponding to the semantic variation of an image.
The previous approaches to find the semantic-factorizing directions are categorized into local and
global methods. The local methods (e.g. Ramesh et al. (2018), Latent Mapper in StyleCLIP (Patash-
nik et al., 2021), and attribute-conditioned normalizing flow in StyleFlow (Abdal et al., 2021))
suggest a sample-wise traversal direction. By contrast, the global methods, such as GANSpace
(Harkonen et al., 2020) and SeFa (Shen & Zhou, 2021), propose a global direction for the particular
semantics (e.g. glasses, age, and gender) that works on the entire latent space. Throughout this pa-
per, we refer to these global methods as the global basis. These global methods showed promising
results. However, these methods are successful on the limited area, and the image quality is sensi-
tive to the perturbation intensity. In fact, if a latent space does not satisfy the global disentanglement
property itself, all global methods are bound to show a limited performance on it. Nevertheless, to
the best of our knowledge, the global disentanglement property of a latent space has not been inves-
tigated except for the empirical observation of generated samples. In this regard, we need a local
method that describes the local disentanglement property and an evaluation scheme for the global
disentanglement property from the collected local information.
* Equal contribution
1
Published as a conference paper at ICLR 2022
In this paper, we suggest that the semantic property of the latent space in GANs (i.e. disentangle-
ment of semantics and image collapse) is closely related to its geometry, because of the sample-wise
optimization nature of GANs. In this respect, we propose an unsupervised method to find a traver-
sal direction based on the local structure of the intermediate latent space W, called Local Basis (Fig
1a). We approximate W with its submanifold representing its local principal variation, discovered in
terms of the tangent space TwW. Local Basis is defined as an ordered basis of TwW corresponding
to the approximating submanifold. Moreover, we show that Local Basis is obtained from the simple
closed-form algorithm, that is the singular vectors of the Jacobian matrix of the subnetwork. The ge-
ometric interpretation of Local Basis provides an evaluation scheme for the global disentanglement
property through the global warpage of the latent manifold. Our contributions are as follows:
1.	We propose Local Basis, a set of traversal directions that can reliably traverse without
escaping from the latent space to prevent image collapse. The latent traversal along Local
Basis corresponds to the local coordinate mesh of local-geometry-describing submanifold.
2.	We show that Local Basis leads to stable variation and better semantic factorization than
global approaches. This result verifies our hypothesis on the close relationship between the
semantic and geometric properties of the latent space in GANs.
3.	We propose Iterative Curve-Traversal method, which is a way to trace the latent space in
the curved trajectory. The trajectory of the images with this method shows a more stable
variation compared to the linear traversal.
4.	We introduce the metrics on the Grassmannian manifold to analyze the global geometry of
the latent space through Local Basis. Quantitative analysis demonstrates that the W-space
of StyleGAN2 is still globally warped. This result provides an explanation for the limited
success of the global basis and proves the importance of local approaches.
2	Related Work
Style-based Generators. In recent years, GANs equipped with style-based generators (Karras
et al., 2019; 2020b) have shown state-of-the-art performance in high-fidelity image synthesis. The
style-based generator consists of two parts: a mapping network and a synthesis network. The map-
ping network encodes the isotropic Gaussian noise z ∈ Z to an intermediate latent vector w ∈ W .
The synthesis network takes w and generates an image while controlling the style of the image
through w. Here, W-space is well known for providing a better disentanglement property compared
to Z (Karras et al., 2019). However, there is still a lack of understanding about the effect of latent
perturbation in a specific direction on the output image.
Latent Traversal for Image Manipulation. The impressive success of GANs in producing high-
quality images has led to various attempts to understand their latent space. Early approaches (Rad-
ford et al., 2016; Upchurch et al., 2017) show that vector arithmetic on the latent space for the se-
mantics holds, and StyleGAN (Karras et al., 2019) shows that mixing two latent codes can achieve
style transfer. Some studies have investigated the supervised learning of latent directions while as-
suming access to the semantic attributes of images (Goetschalckx et al., 2019; Jahanian et al., 2019;
Shen et al., 2020; Yang et al., 2021; Abdal et al., 2021). In contrast to these supervised methods,
some recent studies have suggested novel approaches that do not use the prior knowledge of training
dataset, such as the labels of human facial attributes. In Voynov & Babenko (2020), an unsupervised
optimization method is proposed to jointly learn a candidate matrix and a corresponding reconstruc-
tor, which identifies the semantic direction in the matrix. GANSPace (Harkonen et al., 2020) finds
a global basis for W in StyleGAN using a PCA, enabling a fast image manipulation. SeFa (Shen &
Zhou, 2021) focuses on the first weight Parameter right after the latent code, suggesting that it con-
tains essential knowledge of an image variation. SeFa ProPoses singular vectors of the first weight
Parameter as meaningful global latent directions. StyleCLIP (Patashnik et al., 2021) achieves a state-
of-the-art Performance in the text-driven image maniPulation of StyleGAN. StyleCLIP introduces
an additional training to minimize the CLIP loss (Radford et al., 2021).
Jacobian Decomposition. Some works use the Jacobian matrix to analyze the latent sPace of
GAN (Zhu et al., 2021; Wang & Ponce, 2021; Chiu et al., 2020; Ramesh et al., 2018). However,
these methods focus on the Jacobian of the entire model, from the inPut noise z to the outPut image.
Ramesh et al. (2018) suggested the right singular vectors of the Jacobian as local disentangled direc-
2
Published as a conference paper at ICLR 2022
LocalBasis — Global Basis
(a) Concept Diagram of Local Basis
Figure 1: (a) Concept diagram of Local Basis. The global basis reflects the global variation of
latent space. Hence, traversing along the global basis may result in the escape from the latent space
(shaded region). On the other hand, Local Basis closely follows the latent space. (b) Comparison of
Latent Traversal Methods (Global methods: GANSPace (Harkonen et al., 2020) and SeFa (Shen
& Zhou, 2021), Local methods: Ramesh et al. (2018) and Local Basis (Ours))
Image Space X
Intermediate -
Latent Space .
Input Space Z
Ramesh et al.
Directions
SeFa
Dkections
GANSpace
Directions
Local Basis
Directions
(Oun)
(b) Latent Traversal Methods
tions in the Z sPace. Zhu et al. (2021) ProPosed a latent Perturbation vector that can change only a
Particular area of the image. The Perturbation vector is discovered by taking the PrinciPal vector of
the Jacobian to the target area and Projecting it into the null sPace of the Jacobian to the comPlemen-
tary region. On the other hand, our Local Basis utilizes the Jacobian matrix of the Partial network,
from the inPut noise z to the intermediate latent code w, and investigates the black-box intermedi-
ate latent sPace from it. The toP-k Local Basis corresPonds to the best-local-geometry-describing
submanifolds. This intuition leads to exPloiting Local Basis to assess the global geometry of the
intermediate latent sPace.
3	Traversing a curved latent space
In this section, we introduce a method for finding a local-geometry-aware traversal direction in the
intermediate latent sPace W . The traversal direction is refered to as the Local Basis at w ∈ W . In
addition, we evaluate the ProPosed Local Basis by observing how the generated image changes as
we traverse the intermediate latent variable. Throughout this PaPer, we assess Local Basis of the W-
sPace in StyleGAN2 (Karras et al., 2020b). However, our methodology is not limited to StyleGAN2.
See aPPendix for the results on StyleGAN (Karras et al., 2019) and BigGAN (Brock et al., 2018).
3.1	Finding a Local Basis
Given a Pretrained GAN model M : Z → X , from the inPut noise sPace Z to the image sPace
X , we choose the intermediate layer W to discover Local Basis. We refer to the former Part of the
GAN model as the mapping network f : Z → W. The image of the mapping network is denoted as
W = f(Z) ⊂ W. The latter part, a non-linear mapping from W to the image space X, is denoted
by G : W → X . Local Basis at w ∈ W is defined as the basis of the tangent space Tw W. This
basis can be interpreted as a local-geometry-aware linear traversal direction starting from w.
To define the tangent space of the intermediate latent space W properly, we assume that W is a
differentiable manifold. Note that the support of the isotropic Gaussian prior Z = RdZ and the
ambient space W = RdW are already differentiable manifolds. The tangent space at w, denoted by
Tw W, is a vector space consisting of tangent vectors of curves passing through point w. Explicitly,
TwW = { Y(0) | Y ： (-e, e) → W, γ(0) = w, for e > 0}.	(1)
Then, the differentiable mapping network f gives a linear map dfz between the two tangent spaces
一 一. .一 .~.	.,.
TZZ and TwW where W = f (z).
~ . ..
dfz ： TZZ -→ TwW -→ TwW, Y(0) -→ (f ◦ Y)(0)	(2)
We utilize the linear map dfz , called the differential of f at z, to find the basis of Tw W . Based
on the manifold hypothesis in representation learning, we posit that the latent space of the image
3
Published as a conference paper at ICLR 2022
1	∙>♦	♦	1	∙ Γ∙ 11	1∙>∙>∙>♦	1	∙
space X in W is a lower-dimensional manifold embedded in W . In this approach, we estimate
the latent manifold as a lower-dimensional approximation of W describing its principal variations.
The approximation manifold can be obtained by solving the low-rank approximation problem of
dfz . The manifold hypothesis is supported by the empirical distribution of singular values σiz . The
analysis is provided in Fig 9 in the appendix.
The low-rank approximation problem has an analytic solution defined by Singular Value Decompo-
sition (SVD). Because the matrix representation of dfz is a Jacobian matrix (Nzf )(z) ∈ RdW×dZ,
Local Basis is obtained as the following: For the i-th right singular vector uiz ∈ RdZ , i-th left
singular vector Vw ∈ RdvW, and i-th singular value σi ∈ R of (Vzf )(z) with σz ≥ ∙∙∙ ≥ σn,
dfz(uz) = σZ∙vw for ∀i,	(3)
Local Basis(w = f(z)) = {viw}1≤i≤n.	(4)
Then, the k-dimensional approximation of W around w is described as the following because Z =
RdZ (if σkz > 0). Note that Wwk is a submanifold1 ofW corresponding to the k components of Local
Basis, i.e. Tw Wwk = span{viw : 1 ≤ i ≤ k}.
{f (Z + X ti∙uz) | ti
∈ (-i, i),
for 1 ≤ i ≤ k
(5)
Locally affine mapping network In this paragraph, we focus on the locally affine mapping net-
work f, which is one of the most widely adopted GAN structures, such as MLP or CNN layers with
ReLU or leaky-ReLU activation functions. This type of mapping network has several well-suited
properties for Local Basis.
f(z) = X 1z∈p (Apz + bp)	(6)
p∈Ω
where Ω denotes a partition of Z, and Ap and bp are the parameters of the local affine map. With this
type of mapping network f, it is clear that the intermediate latent space W satisfies a differentiable
manifold property at least locally on the interior of each P ∈ Ω. The region where the property may
not hold, the intersection of several closure of p's in Ω, has measure zero in Z.
Moreover, the Jacobian matrix (Vzf)(z) becomes a locally constant matrix. Then, the approximat-
ing manifold Wwk (Eq 5) satisfies the submanifold condition, and is consistent locally for each p,
avoiding being defined for each w. In addition, the linear traversal of the latent variable w along viw
can be described as the curve on W (Eq 7). Most importantly, these curves on W (Eq 7), starting
from w in the direction of Local Basis, corresponds to the local coordinate mesh of Wwk .
Traversal(w = f (z), vw) :	(-e, E)	—→	Z	-f→	W, t →	(Z	+ 三∙	Uz) → (W +1 ∙ Vw)	(7)
Equivalence to Local PCA To provide additional intuition about Local Basis, we prove the fol-
lowing proposition. The proposition shows that Local Basis is equivalent to applying a PCA on the
samples on W around W.
Proposition 1 (Equivalence to Local PCA). Consider the Local PCA problem around the base
latent variable Wb = f(Zb) on W, i.e. PCA of the latent variable samples W0 around Wb.
w0 = TIf(Zb + C ∙ E) with E 〜N(0, I) andfor some small c > 0.	(8)
where T1f(Z) = Wb + (Vzb f)(Z - Zb) is the linear approximation of f around Zb. Then, the
principal components discovered in the Local PCA problem are equivalent to Local Basis at wb.
3.2	Iterative Curve-Traversal
We suggest a natural curve-traversal that can keep track of the W-manifold and an iterative method
to implement it. We divide the long curved trajectory into small pieces and approximate each piece
1Strictly speaking, Wwk may not satisfy the conditions of the submanifold. The injectivity of dfz on the
domain {z + Pi ti ∙ Uz | ti ∈ (—&, g), for 1 ≤ i ≤ k} is a sufficient condition for the submanifold. As
described below, this sufficient condition is satisfied under the locally affine mapping network f and σkz > 0.
4
Published as a conference paper at ICLR 2022
Figure 2: Illustration of Iterative Curve-Traversal (for N = 2).
by the local curves using Local Basis. We call this curve-traversal Iterative Curve-Traversal method.
Consistent with the linear traversal method, we consider Iterative Curve-Traversal γ departing in the
direction of a Local Basis. Explicitly, for a sufficiently large c > 0,
γ : (―c, C) —→ W, γ(0) = w, γ(0) = Vw for some 1 ≤ k ≤ dw	(9)
where {viw}i = Local Basis(w). We split the curve-traversal γ into N pieces γn and denote each
n-th iterate in W and Z as wn and zn for 1 ≤ n ≤ N. The starting point of the traversal is denoted
as the 0-th iterate w = w0, z = z0, and w0 = f (z0). (Fig 2) Note that to find Local Basis at wn,
we need a corresponding zn ∈ Z such that wn = f (zn).
Below, We describe the positive part Y+ = γ∣ [o,c)of Iterative Curve-Traversal. For the negative part,
We repeat the same procedure using the reversed tangent vector -Vw. The first step γ+ of Iterative
Curve-Traversal method with perturbation intensity I is as follows:
Y+ ：	[0,1/(N ∙ σz0)] —→ Z -→ W,	t -—→ (zo +1	∙ uzk0) --→	f(zo	+1 ∙ uzk0)	(10)
z1 = z0 + (NIJzO ) uk0 ,	w1 = f (ZI)	(II)
Note that wι is the endpoint of the curve γ+ and Y+ (0) = Vw. We scale the step size in Z by 1∕σz0
to ensure each piece of curve has a similar length of (I/N). To preserve the variation in semantics
during the traversal, the departure direction of γ2+ is determined by comparing the similarity betWeen
the previous departure direction Vkw0 and Local Basis at w1 . The above process is repeated N -times.
(The algorithm for Iterative Curve-Traversal can be found in the appendix.)
Y + (0) = vw1 where j = argmax ∣hvw0, v『1)|	(12)
1≤i≤dW
3.3	Results of Local Basis traversal
We evaluate Local Basis by observing how the generated image changes as we traverse W-space in
StyleGAN2 and by measuring FID score for each perturbation intensity. The evaluation is based on
two criteria: Robustness and Semantic Factorization.
Robustness Fig 3 and 4 present the Robustness Test results2. In Fig 3, the traversal image of Local
Basis is compared with those of the global methods (GANSPace (HarkOnen et al., 2020) and SeFa
(Shen & Zhou, 2021)) under the strong perturbation intensity of 12 along the 1st and 2nd direction of
each method. The perturbation intensity is defined as the traversal path length in W . The two global
methods show severe degradation of the image compared to Local Basis. Moreover, we perform
a quantitative assessment of robustness. We measure the FID score for 10,000 traversed images
for each perturbation intensity. In Fig 4, the global methods show the relatively small FID under
the small perturbation. But, as we impose the stronger perturbation, the FID scores on the global
methods increase sharply, implying the image collapse in Fig 3. By contrast, Local Basis achieves
much smaller FID scores with and without Iterative Curve-Traversal.
2Ramesh et al. (2018) is not compared because it took hours to get a traversal direction of an image. See
appendix for the Qualitative Robustness Test results of Ramesh et al. (2018).
5
Published as a conference paper at ICLR 2022
=
I = 10 I =
I=10 I = 12
=6 I = 8
1
(a) GANSpace
(c) Local Basis (Ours)
(b) SeFa
(d) Iterative Curve-Traversal (Ours)
Figure 4: Quantitative Robustness Test on the W -space of the StyleGAN2 (Karras et al., 2020b)
trained on FFHQ. Frechet Inception Distance (FID)(Heusel et al., 2017) is measured for 10,000
traversed images for each perturbation intensity. Left: 1st direction, Right: 2nd direction
Figure 3: Qualitative Robustness Test on the W -space of the StyleGAN2 (Karras et al., 2020b)
trained on FFHQ. Each traversal image is generated by the linear traversal on W except for (d)
under the strong perturbation intensity I ofup to 12. The intensity is linearly increased from 0 to 12
for each column. We infer the deterioration of the traversal image along the global method is due
to the escape of the latent traversal from the latent manifold. (See the appendix for the additional
Robustness Test results along the first 10 components of Local Basis.)

=，




We interpret the degradation of image as due to the deviation of trajectory from W . The theoretical
interpretation shows that the linear traversal along Local Basis corresponds to a local coordinate axis
on W , at least locally. Therefore, the traversal along Local Basis is guaranteed to stay close to W
even under the longer traversal. However, we cannot expect the same property on the global basis
because it is based on the global geometry. Iterative Curve-Traversal shows more stable traversal
because of its stronger tracing to the latent manifold. This further supports our interpretation.
Semantic Factorization Local Basis is discovered in terms of singular vectors of dfz . The dis-
entangled correspondence, between Local Basis and the corresponding singular vectors in the prior
space, induces a semantic-factorization in Local Basis. Fig 5 and 6 presents the semantics of the
image discovered by Local Basis. In Fig 5, we compare the semantic factorizations of Local Ba-
Sis and GANSPaCe (Harkonen et al., 2020) for the particular semantics discovered by GANSpace.
For each interpretable traversal direction of GANSpace provided by the authors, the corresponding
Local Basis is chosen by the one with the highest cosine similarity. For a fair comparison, each
traversal is applied to the specific subset of layers in the synthesis network (Karras et al., 2020b)
provided by the authors of GANSpace with the same perturbation intensity. In particular, as we
impose the stronger perturbation (from left to right), GANSpace shows the image collapse in Fig 5a
and entanglement of semantics (Glasses + Head Raising) in Fig 5d. However, Local Basis does not
show any of those problems. Fig 6 provides additional examples of semantic factorization where the
latent traversal is applied to a subset of layers predefined in StyleGAN. The subset of the layers is
selected as one of four, i.e. coarse, middle, fine, or all styles. Local Basis shows decent factorization
of semantics such as Body Length of car and Age of cat in LSUN (Yu et al., 2015) in Fig 6.
6
Published as a conference paper at ICLR 2022
(a) Face length
(b) Open mouth
(c) Sunlight on face
Figure 5: Comparison of Semantic Factorization between Local Basis and GANSpace on pre-
trained StyleGAN2-FFHQ. We compare the semantic-factorizing directions of GANSpace provided
by the authors (Harkonen et al., 2020) with Local Basis of the highest cosine similarity. Local Basis
factorizes semantics of image better, notably without collapsing compared to the GANSpace.
同
(d) Glasses

(a) StyleGAN2 LSUN Car
Age
I 2nd direction
All
Stand up
I 5th direction
Coarse
Color
Ilst direction
Middle
Pattern
I 19th direction
Fine
(b) StyleGAN2 LSUN Cat
Figure 6: Additional Semantic Factorization examples of Local Basis. The examples are dis-
covered by manual inspection due to the unsupervised nature while applying the latent traversal to a
subset of the layers predefined in StyleGAN (Karras et al., 2019): coarse, middle, fine, and all styles.
(See the appendix for the additional examples of Semantic Factorization without layer restriction.)
3.4	Exploration inside Abstract Semantics
Abstract semantics of image often consists of several lower-level semantics. For instance, Old can be
represented as the correlated distribution of Hair color, Wrinkle, Face length, etc. In this section, we
show that the adaptation of Iterative Curve-Traversal can explore the variation of abstract semantics,
which is represented by the cone-shaped region of the generative factors (Trauble et al., 2021).
Because of its text-driven nature, we utilize the global basis3 from StyleCLIP (Patashnik et al., 2021)
corresponding to the abstract semantics of Old. Then, we consider the modification of Iterative
Curve-Traversal following the given global basis vglobal. To be more specific, the departure direction
of each piece of curve γi in Eq 12 is chosen by the similarity to vglobal , not by the similarity to
previous departure direction. The results for old are provided in Fig 7. (See the appendix for other
examples.) Step size denotes the length of each piece of curve, i.e. (I/N) in Sec 3.2. For a fair
comparison, the overall perturbation intensity I is fixed to 4 by adjusting the number of steps N .
The linear traversal along the global basis adds only wrinkles to the image and the image collapses
shortly. On the contrary, both Iterative Curve-Traversal methods obtain the diverse and high-fidelity
image manipulation for the target semantics old. In particular, the diversity is greatly increased as we
add stochasticity to the step size. We interpret this diversity as a result of the increased exploration
area from the stochastic step size while exploiting the high-fidelity of Iterative Curve-Traversal.
3We use the global basis defined on W+ (Tov et al., 2021). See the appendix for detail.
7
Published as a conference paper at ICLR 2022
Figure 7: Iterative Curve-Traversal guided by global basis from StyleCLIP for the semantics
of old. Left: Linear traversal along global basis. Middle: Iterative Curve-Traversal of fixed step
size (Stepsize = (0.02, 0.04, 0.08, 0.16)). Right: Stochastic Iterative Curve-Traversal (Step size is
sampled from Uniform Noise on [0.05, 0.15])
4	EVALUATING WARPAGE OF W-MANIFOLD
In this section, we provide an explanation for the limited success of the global basis in W -space of
StyleGAN2. In Sec 3, we showed that Local Basis corresponds to the generative factors of data.
Hence, the linear subspace spanned by Local Basis, which is the tangent space Tw Wwk in Eq 5,
describes the local principal variation of image. In this regard, we assess the global disentangle-
ment property by evaluating the consistency of the tangent space at each w ∈ W . We refer to the
inconsistency of the tangent space as the warpage of the latent manifold. Our evaluation proves
that W -manifold is warped globally. In this section, we present the quantitative evaluation of the
global warpage by introducing the Grassmannian Metric. The qualitative evaluation by observing
the subspace traversal is provided in the appendix. The subspace traversal denotes a simultaneous
traversal in multiple directions.
Grassmannian Manifold Let V be the vector space. The Grassmannian manifold Gr(k, V )
(Boothby, 1986) is defined as the set of all k-dimensional linear subspaces of V . We evaluate
the global warpage of W -manifold by measuring the Grassmannian distance between the linear sub-
spaces spanned by top-k Local Basis of each w ∈ W . The reason for measuring the distance for
top-k Local Basis is the manifold hypothesis. The linear subspace spanned by top-k Local Basis
corresponds to the tangent space of the k-dimensional approximation of W (Eq 5). From this per-
spective, a large Grassmannian distance means that the k-dimensional local approximation of W
severely changes. Likewise, we consider the subspace spanned by the top-k components for the
global basis. In this study, two types of metrics (i.e. Projection metric and Geodesic metric) are
adopted as metrics of the Grassmannian manifold.
Grassmannian Metric First, for two subspaces W, W0 ∈ Gr(k, V ), let the projection into each
subspace be PW and PW0, respectively. Then the Projection Metric (Karrasch, 2017) on Gr(k, V )
is defined as follows.
dproj(W,W0)= kPW -PW0k	(13)
where || ∙ || denotes the operator norm.
Second, let MW , MW0 ∈ RdV ×k be the column-wise orthonormal matrix of which columns span
W, W0 ∈ Gr(k, V ), respectively. Then, the Geodesic Metric (Ye & Lim, 2016) on Gr(k, V ), which
is induced by canonical Riemannian structure, is formulated as follows.
dgeo(W,W0)=	Xk θi2!	(14)
where θi = cos-1(σi(MW> MW0)) denotes the i-th principal angle between W and W0.
8
Published as a conference paper at ICLR 2022
(a) Projection Metric
Figure 8: Grassmannian metric. The shaded region illustrates (mean ± standard deviation) inter-
vals of each score. Above all, Random w metric is much larger than the Close w . This means a
large variation of Local Basis on W , which demonstrates that W -space is globally warped. More-
over, the metric result shows the local consistency of Local Basis and the existence of limited global
alignment on W . (See Sec 4 for detail)
(b) Geodesic Metric
Evaluation We evaluate the global warpage of the W -manifold by comparing the five distances
as we vary the subspace dimension.
1.	Random O(d): Between two random basis of RdW uniformly sampled from O(dW)
2.	Random w: Between two Local Basis from two random w ∈ W
3.	Close w: Between two Local Basis from two close w0 , w ∈ W (See appendix for the
Grassmannian metric with various = |z0 - z|.)
w0 = f(z0),	w = f(z)	where |z0 - z| = 0.1	(15)
4.	To global GANSpace: Between Local Basis and the global basis from GANSpace
5.	To global SeFa: Between Local Basis and the global basis from SeFa
Fig 8 shows the above five Grassmannian metrics. We report the metric results from 100 samples for
the Random O(dW) and 1,000 samples for the others. The Projection metric increases in order of
Close w, To global GANSpace, Random w, To global SeFa, and Random O(dW). For the Geodesic
metric, the order is reversed for Random w and To global SeFa. Most importantly, the Random w
metric is much larger than Close w. This shows that there is a large variation of Local Basis on W ,
which proves that W -space is globally warped. In addition, Close w metric is always significantly
smaller than the others, which implies the local consistency of Local Basis on W . Finally, the
metric results prove the existence of limited global disentanglement on W . Random w is smaller
than Random O(d). This order shows that Local Basis on W is not completely random, which
implies the existence of a global alignment. In this regard, both To global results prove that the
global basis finds the global alignment to a certain degree. To global GANSpace lies in between
Close w and Random w. To global SeFa does so on the Geodesic metric and is similar to Random
w on the Projection metric. However, the large gap between Close w and both To global implies
that the discovered global alignment is limited.
5	Conclusion
In this work, we proposed a method for finding a meaningful traversal direction based on the local-
geometry of the intermediate latent space of GANs, called Local Basis. Motivated by the theoretical
explanation of Local Basis, we suggest experiments to evaluate the global geometry of the latent
space and an iterative traversal method that can trace the latent space. The experimental results
demonstrate that Local Basis factorizes the semantics of images and provides a more stable trans-
formation of images with and without the proposed iterative traversal. Moreover, the suggested
evaluation of the W -space in StyleGAN2 proves that the W -space is globally distorted. Therefore,
the global method can find a limited global consistency from W -space.
9
Published as a conference paper at ICLR 2022
Acknowledgement
This work was supported by the NRF grant [2021R1A2C3010887], the ICT R&D program of
MSIT/IITP [2021-0-00077] and MOTIE [P0014715].
Ethics S tatement
The limitations and the potential negative societal impacts of our work are that Local Basis would
reflect the bias of data. The GANs learn the probability distribution of data through samples from
it. Thus, unlike the likelihood-based method such as Variational Autoencoder (Kingma & Welling,
2014) and Flow-based models (Kingma & Dhariwal, 2018), the GANs are more likely to amplify
the dependence between the semantics of data, even the bias of it. Because Local Basis finds a
meaningful traversal direction based on the local-geometry of latent space, Local Basis would show
the bias of data as it is. Moreover, if Local Basis is applied to real-world problems like editing
images, Local Basis may amplify the bias of society. However, in order to fix a problem, we have to
find a method to analyze it. In this respect, Local Basis can serve as a tool to analyze the bias.
Reproducibility Statement
To ensure the reproducibility of this study, we attached the entire source code in the supplementary
material. Every figure can be reproduced by running the jupyter notebooks in notebooks/*. In
addition, the proof of Proposition 1 is included in the appendix.
References
Rameen Abdal, Yipeng Qin, and Peter Wonka. Image2stylegan: How to embed images into the
stylegan latent space? In Proceedings of the IEEE/CVF International Conference on Computer
Vision,pp. 4432-4441, 2019.
Rameen Abdal, Peihao Zhu, Niloy J Mitra, and Peter Wonka. Styleflow: Attribute-conditioned
exploration of stylegan-generated images using conditional continuous normalizing flows. ACM
Transactions on Graphics (TOG), 40(3):1-21, 2021.
Yoshua Bengio, Aaron Courville, and Pascal Vincent. Representation learning: A review and new
perspectives. IEEE transactions on pattern analysis and machine intelligence, 35(8):1798-1828,
2013.
William M Boothby. An introduction to differentiable manifolds and Riemannian geometry. Aca-
demic press, 1986.
Andrew Brock, Jeff Donahue, and Karen Simonyan. Large scale gan training for high fidelity natural
image synthesis. In International Conference on Learning Representations, 2018.
Chia-Hsing Chiu, Yuki Koyama, Yu-Chi Lai, Takeo Igarashi, and Yonghao Yue. Human-in-the-loop
differential subspace search in high-dimensional latent space. ACM Transactions on Graphics
(TOG), 39(4):85-1, 2020.
Lore Goetschalckx, Alex Andonian, Aude Oliva, and Phillip Isola. Ganalyze: Toward visual defi-
nitions of cognitive image properties. In Proceedings of the IEEE/CVF International Conference
on Computer Vision, pp. 5744-5753, 2019.
Ian J Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair,
Aaron C Courville, and Yoshua Bengio. Generative adversarial nets. In NIPS, 2014.
Erik Harkonen, Aaron Hertzmann, Jaakko Lehtinen, and Sylvain Paris. Ganspace: Discovering
interpretable gan controls. Advances in Neural Information Processing Systems, 33, 2020.
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter.
Gans trained by a two time-scale update rule converge to a local nash equilibrium. Advances in
neural information processing systems, 30, 2017.
10
Published as a conference paper at ICLR 2022
Ali Jahanian, Lucy Chai, and Phillip Isola. On the” steerability” of generative adversarial networks.
In International Conference on Learning Representations, 2019.
Tero Karras, Timo Aila, Samuli Laine, and Jaakko Lehtinen. Progressive growing of gans for im-
proved quality, stability, and variation. In International Conference on Learning Representations,
2018.
Tero Karras, Samuli Laine, and Timo Aila. A style-based generator architecture for generative
adversarial networks. In Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition, pp. 4401-4410, 2019.
Tero Karras, Miika Aittala, Janne Hellsten, Samuli Laine, Jaakko Lehtinen, and Timo Aila. Training
generative adversarial networks with limited data. arXiv preprint arXiv:2006.06676, 2020a.
Tero Karras, Samuli Laine, Miika Aittala, Janne Hellsten, Jaakko Lehtinen, and Timo Aila. Analyz-
ing and improving the image quality of stylegan. In Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition, pp. 8110-8119, 2020b.
Daniel Karrasch. An introduction to grassmann manifolds and their matrix representation. 2017.
Diederik P Kingma and Prafulla Dhariwal. Glow: generative flow with invertible 1× 1 convolutions.
In Proceedings of the 32nd International Conference on Neural Information Processing Systems,
pp. 10236-10245, 2018.
Diederik P Kingma and Max Welling. Auto-encoding variational bayes. In Proceedings of the
International Conference on Learning Representations (ICLR), 2014.
Or Patashnik, Zongze Wu, Eli Shechtman, Daniel Cohen-Or, and Dani Lischinski. Styleclip: Text-
driven manipulation of stylegan imagery. arXiv preprint arXiv:2103.17249, 2021.
David Pfau, Irina Higgins, Aleksandar Botev, and Sebastien Racaniere. Disentangling by subspace
diffusion. arXiv preprint arXiv:2006.12982, 2020.
Antoine Plumerault, Herve Le Borgne, and Celine Hudelot. Controlling generative models with
continuous factors of variations. In International Conference on Learning Representations, 2020.
URL https://openreview.net/forum?id=H1laeJrKDB.
Alec Radford, Luke Metz, and Soumith Chintala. Unsupervised representation learning with deep
convolutional generative adversarial networks. In Proceedings of the International Conference on
Learning Representations (ICLR), 2016.
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal,
Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual
models from natural language supervision. Image, 2:T2, 2021.
Aditya Ramesh, Youngduck Choi, and Yann LeCun. A spectral regularizer for unsupervised disen-
tanglement. arXiv preprint arXiv:1812.01161, 2018.
Yujun Shen and Bolei Zhou. Closed-form factorization of latent semantics in gans. In CVPR, 2021.
Yujun Shen, Jinjin Gu, Xiaoou Tang, and Bolei Zhou. Interpreting the latent space of gans for
semantic face editing. In Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition, pp. 9243-9252, 2020.
Omer Tov, Yuval Alaluf, Yotam Nitzan, Or Patashnik, and Daniel Cohen-Or. Designing an encoder
for stylegan image manipulation. ACM Transactions on Graphics (TOG), 40(4):1-14, 2021.
Frederik Trauble, Elliot Creager, Niki Kilbertus, Francesco Locatello, Andrea Dittadi, Anirudh
Goyal, Bernhard Scholkopf, and Stefan Bauer. On disentangled representations learned from
correlated data. In International Conference on Machine Learning, pp. 10401-10412. PMLR,
2021.
Paul Upchurch, Jacob Gardner, Geoff Pleiss, Robert Pless, Noah Snavely, Kavita Bala, and Kilian
Weinberger. Deep feature interpolation for image content changes. In Proceedings of the IEEE
conference on computer vision and pattern recognition, pp. 7064-7073, 2017.
11
Published as a conference paper at ICLR 2022
Andrey Voynov and Artem Babenko. Unsupervised discovery of interpretable directions in the gan
latent space. In International Conference on Machine Learning, pp. 9786-9796. PMLR, 2020.
Binxu Wang and Carlos R Ponce. The geometry of deep generative image models and its applica-
tions. arXiv preprint arXiv:2101.06006, 2021.
Ceyuan Yang, Yujun Shen, and Bolei Zhou. Semantic hierarchy emerges in deep generative repre-
Sentations for scene synthesis. International Journal ofComputer Vision, pp. 1-16, 2021.
Ke Ye and Lek-Heng Lim. Schubert varieties and distances between subspaces of different dimen-
sions. SIAM Journal on Matrix Analysis and Applications, 37(3):1176-1197, 2016.
Fisher Yu, Yinda Zhang, Shuran Song, Ari Seff, and Jianxiong Xiao. Lsun: Construction of
a large-scale image dataset using deep learning with humans in the loop. arXiv preprint
arXiv:1506.03365, 2015.
Jiapeng Zhu, Ruili Feng, Yujun Shen, Deli Zhao, Zhengjun Zha, Jingren Zhou, and Qifeng Chen.
Low-rank subspaces in gans. arXiv preprint arXiv:2106.04488, 2021.
12
Published as a conference paper at ICLR 2022
A	Proposition proof
Denote 3zb f) by J. Then, from w0 = Tif (Zb + C ∙ e),
w0 = Wb + c ∙ Je 〜N(Wb, c2 ∙ JJ|)	(16)
The first principal component vi is the vector such that v|(c ∙ Je) has the maximum variance.
Var(V* I 11(C ∙ Je)) = c2 ∙ ||v|J||2	(17)
Therefore,
Vi = argmax Var(vl(c ∙ Je)) = argmax || J| ∙ v∣∣2	(18)
||v||2=i	||v||2=i
Clearly, vi corresponds to the first right singular vector of J|, i.e. the first left singular vector of J,
from the linear operator norm maximizing property of singular vectors. Inductively, k-th principal
component vk is the vector such that
Vk = argmax Var(vl(c ∙ Je))	where Vk ⊥ {vi, v2,…,vk-i}	(19)
||v||2=i
Thus, vk becomes the k-th left singular vector of J. Therefore, the principal components from the
Local PCA problem are equivalent to Local Basis at wb .
B Algorithm
Algorithm 1 Local Basis
Input:
1:	z ∈ RdZ is the input code.
2:	f : RdZ → RdW is the mapping network.
Output: LOCALBASIS(z, f)
3:	W — f(z)
4:	J ∈ RdW ×dZ — JACOBIAN(z,w)
5:	U, S, V J SVD(J)
6:	return {U, S, V }
Algorithm 2 Iterative Curve-Traversal along positive direction
Input:
1: z ∈ RdZ is the input code.
2: f : RdZ → RdW is the mapping network.
3: k ∈ [1, min {dZ, dW}] is the ordinal number of direction to traverse.
4: I is the total perturbation intensity.
5: N ≥ 1 is the number of iterations.
Output: ITERATIVETRAVERSAL(z, f, k, I, N)
6: z0 J z
7: c J ones(dZ, 1)
8: for i ∈ [0, N) do
9:	U, S, V J LOCALBASIS(zi, f)
10:	if i40 then
11:	c J— UT ∙ Ui-I
12:	k J arg max(|c|)	. The row number most similar to the previously selected basis.
13:	end if
14:	ui, vi J sign(ck)Uk, sign(ck)Vk	. Aligns with previous orientation
15:	si J Skk
16:	zi+i J Zi + SiINvi
17: end for
18: return {z0, ..., zN}
13
Published as a conference paper at ICLR 2022
C Model and Computation Res ource Details
Model We evaluate GANSPace (Harkonen et al., 2020), SeFa (Shen & Zhou, 2021), and Local
Basis on StyleGAN2 models for FFHQ (Karras et al., 2019) and LSUN (Yu et al., 2015) provided
by the authors (Karras et al., 2020b).
Computation Resource We generated Latent traversal results on the environment of TITAN RTX
with Intel(R) Xeon(R) Gold 5220 CPU @ 2.20GHz. However, it requires a low comPutational cost
to get a Local Basis. For examPle, on the environment of GTX 1660 with Ryzen 5 2600, comPuting
a Local Basis takes about 0.05 seconds.
D Code License
The files models/WraPPers.py, notebooks/ganspace_utils.py and notebooks/notebook_utils.py are a
derivative of the GANSPace, and are Provided under the APache 2.0 license. The directory netdissect
is a derivative of the GAN Dissection project, and is provided under the MIT license. The directories
models/biggan and models/stylegan2 are provided under the MIT license.
14
Published as a conference paper at ICLR 2022
E Distribution of Sigular Values of Jacobian
(a) Singluar values σiz with 0 ≤ σiz ≤ 2
(b) All Singluar values σiz
Figure 9: Histogram of the Singular Values σiz of dfz for three random z and the random matrix.
The random matrix is sampled from the Gaussian distribution, then transformed to have the mean
and standard deviation of the 100 Jacobian matrix. The sharp peak around zero demonstrates that
most of the linear perturbation from z collapses. This observation proves our manifold hypothesis.
To better represent the sparsity of singular values, we provide the histogram of sigular values σiz
with 0 ≤ σiz ≤ 2 separately.
F Grassmannian Metric
O	IO 20	30	40	50
Subspace Dimension
(b) Geodesic Metric
(a) Projection Metric
Figure 10: Grassmannian metric between two close w , w0 ∈ W as we vary . We denote =
|z0 - z| where w0 = f (z0), w = f (z). As expected, the Grassmannian metric monotonically
increases as we increase . However, even for the case of = 0.5, the evaluated metric is much
smaller than To global GANSpace. Therefore, regardless of , every metric for Close w supports our
claim for the global warpage of W -space. In the main text, we present only the case of = 0.1. The
reported Grassmannian metrics, Fig 10 in the supplementary material and Fig 8 in the main text, are
evaluated on the SytleGAN2 model trained on FFHQ.
0	10	20	30	40	50
Subspace Dimension
15
Published as a conference paper at ICLR 2022
G More Latent Traversal Examples
(a) GANSpace
(b) SeFa
(c) Ramesh et al. (2018)
(d) Local Basis (Ours)
(e) Iterative Curve-Traversal (Ours)
Figure 11: Enlarged figure for Fig 3. Each row represents latent traversal on the W -space of the
StyleGAN2-FFHQ, except for (c). Ramesh et al. (2018) provides the local traversal directions on
Z . Except for (e), each traversal image is generated by the linear traversal. The latent code w is
perturbed up to 12 along the 1st and 2nd direction of the corresponding method. The perturbation
intensity is linearly increased from 0 to 12 for each column. Since Ramesh et al. (2018) is defined
on Z , we downscaled the perturbation intensity by the singular values from Local Basis for a fair
comparison. In the case of the existing methods, the quality of the image gets severely degraded as
we perturb stronger. On the other hand, Local Basis shows a relatively stable traversal.
16
Published as a conference paper at ICLR 2022
(a) Local basis (Ours)
(b) Iterative Curve-Traversal (Ours)
(c) GANSpace
(d) SeFa
Figure 12: Additional Robustness Test results of each Latent Traversal methods along the first 10
components. For each traversal methods, each row corresponds to a latent traversal of perturbation
up to 12. Compared to the global methods, GANSpace and SeFa, even Local Basis with linear
traversal (Fig 12a) shows more stable traversal on images. Moreover, Local Basis with Iterative
Curve-Traversal (Fig 12b) rarely shows any collapse under the latent traversal of 12 along the curve.
17
Published as a conference paper at ICLR 2022
(a) StyleGAN2 FFHQ
(b) StyleGAN2 FFHQ
(c) StyleGAN2 LSUN Cat
Figure 13: Additional examples of Semantic Factorization without layer restriction, i.e. Latent
traversal along the first 10 components of Local Basis with a moderate perturbation ofup to 5. Local
Basis finds diverse and natural-looking semantic variations on each dataset.
(d) StyleGAN2 LSUN Car
18
Published as a conference paper at ICLR 2022
Figure 14: Iterative Curve-Traversal guided by global basis only at departure from StyleCLIP
for the semantics of old. Contrary to Fig 7, Iterative Curve-Traversal follows the global basis only
at departure. After that, the departure direction is chosen by the similarity to the previous departure
direction. Left: Linear traversal along global basis. Middle: Iterative Curve-Traversal of fixed
stepsize (Stepsize = (0.02, 0.04, 0.08, 0.16)). Right: Stochastic Iterative Curve-Traversal (Stepsize
is sampled from Uniform Noise on [0.05, 0.15])
H	Implementation Details for Sec 3.4
In Sec 3.4, we utilize the global basis from StyleCLIP (Patashnik et al., 2021) defined on W+, the
layer-wise extension of W introduced in (Abdal et al., 2019; Patashnik et al., 2021). To be more
specific, since the synthesis network in StyleGAN has 18 layers, we obtain an extended latent code
w+ ∈ W + defined by the concatenation of latent codes wi ∈ W of dimension 512 for each i-th
layer and it can be described as follows:
w+ = (wι, W2, ∙ ∙ ∙ , W18) ∈ R512×18.	(20)
Note that our Iterative Curve-Traversal originally defined on W has a canonical extension to W +
without additional changes in structures or methodologies.
For implementing the stochastic Iterative Curve-Traversal introduced in Sec 3.4, we firstly find
a global basis on W+ using StyleCLIP (Patashnik et al., 2021) which implies a given semantic
attribute in the form of text (e.g. old). Now denote the global basis by vg+lobal, which can be
represented as follows:
+	global global	global
Vglobal = (VI	，v2	,…,v18	).	(21)
Then we perform the (extended) Iterative Curve-Traversal following vg+lobal , equipped with a
stochastic movement for each step. In practice, we consider two options to choose a traversal di-
rection for each step; First, follow the direction most similar to the previously selected basis (as
Algorithm 2), except for the first iteration. Note that we compute the similarity between the local
basis and the global basis only at once when choosing the first traversal direction. Second, follow
the direction most similar to the given global basis. This is slightly different from our Algorithm
2, however, we empirically verify that setting the exploration in that way leads to a more desirable
image change.
Fig 14 shows that the first method still preserves the image quality well, but it does not guarantee that
the desired direction of image change, namely ‘old’. We speculate the reason why such phenomenon
occurs is that most of the information contained in the meaningful global basis disappears after the
first step (a unique, direct comparison to the global basis), although our methodology guarantees that
the latent code does not escape from the manifold and achieve a high image quality. Nevertheless,
Fig 15 shows that the second method for the stochastic Iterative Curve-Traversal can change a given
facial image in a very high quality and various ways.
19
Published as a conference paper at ICLR 2022
Figure 15: Additional Examples of Stochastic Iterative Curve Traversal guided by the global
basis from StyleCLIP for the semantics of Old. Left: Linear traversal along global basis. Right:
Stochastic Iterative Curve-Traversal
20
Published as a conference paper at ICLR 2022
Figure 16: Subspace traversal with two directions on W -space of the StyleGAN2. The horizontal
(red box) and vertical (green box) axes correspond to the 1st and 2nd directions of each method.
I Subspace Traversal
In Section 4, we proved that the W -space in StyleGAN2 is warped globally. Specifically, the sub-
space of traversal direction generating principal variation in the image changes severely as we vary
the starting latent variable w. To verify the claim further, we visualize the subspace traversal on the
latent space W . The subspace traversal denotes a simultaneous traversal in multiple directions. In
this paper, we visualize the two-dimensional traversal,
Subspace TraversalWj)(x, y) = G (W + NNVw + NVw)	(22)
where w = f(z) and G denotes a subnetwork of the given GAN model from W to the images space
X . Since the disentanglement into the linear subspace implies the commutativity of transformation
(Pfau et al., 2020), the subspace traversal can be a more challenging version of linear traversal
experiments.
Fig 16 and Fig 17 show results of the subspace traversal for the global basis and Local Basis. Starting
from the center, the horizontal and vertical traversals correspond to the 1st and 2nd directions of each
method. The same perturbation intensity per step is applied for both directions. When restricted to
the linear traversal (red and green box), the GANSpace shows relatively stable traversals. However,
the traversal image deteriorates at the corner of the subspace traversal. By contrast, Local Basis
shows a stable variation during the entire subspace traversal. This result proves that the global basis
is not well-aligned with the local-geometry of the W manifold.
21
Published as a conference paper at ICLR 2022
Figure 17: Subspace traversal with two directions on W -space of the StyleGAN2. The horizontal
(red box) and vertical (green box) axes correspond to the 1st and 2nd directions of each method.
22
Published as a conference paper at ICLR 2022
J Local Basis on Other models
Figure 18: Comparison of GANSpace and Local Basis on StyleGAN-FFHQ (Karras et al.,
2019) Each traversal image is generated along the first 10 components of each method with a per-
turbation of up to 5.
23
Published as a conference paper at ICLR 2022
(a) GANSpace
(c) GANSpace
Figure 19: Comparison of GANSpace and Local Basis on BigGAN-512 (Brock et al., 2018) Each
traversal image is generated along the first 10 components of each method with a perturbation of up
to 3.
(d) Local Basis (Ours)
(b) Local Basis (Ours)
24