Published as a conference paper at ICLR 2022
Provably convergent quasistatic dynamics
for mean-field two-player zero-sum games
Chao Ma, Lexing Ying
Department of Mathematics
Stanford University
Stanford, CA 94305, USA
{chaoma,lexing}@stanford.edu
Ab stract
In this paper, we study the problem of finding mixed Nash equilibrium for mean-
field two-player zero-sum games. Solving this problem requires optimizing over
two probability distributions. We consider a quasistatic Wasserstein gradient flow
dynamics in which one probability distribution follows the Wasserstein gradient
flow, while the other one is always at the equilibrium. Theoretical analysis are
conducted on this dynamics, showing its convergence to the mixed Nash equilib-
rium under mild conditions. Inspired by the continuous dynamics of probabil-
ity distributions, we derive a quasistatic Langevin gradient descent method with
inner-outer iterations, and test the method on different problems, including train-
ing mixture of GANs.
1	Introduction
Finding Nash equilibrium has seen many important applications in machine learning, such as gener-
ative adversarial networks (GANs) (Goodfellow et al., 2014a) and reinforcement learning (Busoniu
et al., 2008). In these problems, pure Nash equilibria are usually search for a function f(x, y). Yet,
the problems arising from machine learning are usually nonconvex in x and nonconcave in y, in
which case pure Nash equilibrium may not exist. And even if it exists, there is no guarantee for any
optimization algorithm to find it efficiently. This difficulty is reflected in practice, that compared
with simple minimization, machine learning applications involving Nash equilibria usually have
more complicated behaviors and more subtle dependence on hyper-parameters. For example, stable
and efficient training of GANs requires a number of carefully designed tricks (Gao et al., 2018).
On the other hand, the mixed Nash equilibrium (MNE) is known to exist in much more general set-
tings, e.g. when the strategy spaces are compact and the payoff function is continuous (Glicksberg,
1952). In the mixed Nash equilibrium problem, instead of taking “pure strategies” x and y, two
”mixed strategies” for x and y, in the form of probability distributions, are considered, resulting in
the following functional,
f (x, y)p(x)q(y)dxdy,
where p and q are density functions of probability distributions of x and y, respectively. Efforts
are invested to develop theoretically endorsed algorithms that can efficiently find MNE for high
dimensional problems, with applications on the training of mixture of GANs. In Hsieh et al. (2019),
a mirror-descent algorithm is proposed and its convergence is proven. In Domingo-Enrich et al.
(2020), theoretical analysis and empirical experiments are conducted for a gradient descent-ascent
flow under a Wasserstein-Fisher-Rao metric and its particle discretization.
In this paper, we also consider the mixed Nash equilibrium problem, and propose a simple Qua-
siStatic Wasserstein Gradient Flow (QSWGF) for solving the problem. In our dynamics, we treat
q as a component with much faster speed than p, hence is always at equilibrium as p moves. With
entropy regularization for both p and q (without requirement on the strength of the regularizations),
we prove that the QSWGF converges to the unique mixed Nash equilibrium from any initialization
(under mild conditions). Furthermore, we show there is a simple way to discretize the QSWGF, re-
gardless of the complexity of the Wasserstein gradient flow of p induced by the fact that q is always
1
Published as a conference paper at ICLR 2022
at equilibrium. Concretely, a partition function related with p appears in the QSWGF dynamics,
and we find an efficient way to approximate the partition function. By discretizing the QSWGF,
we derive a particle dynamics with an inner-outer structure, named the QuasiStatic Langevin Gra-
dient Descent algorithm (QSLGD). In QSLGD, after each iteration of the outer problem (for the x
particles), the inner loop conducts sufficient iterations to bring the y particles to equilibrium. Nu-
merical experiments show the effectiveness of QSLGD on synthetic examples and training mixture
of GANs. Our method outperforms the vanilla Langevin gradient descent-ascent method when the
entropy regularization is weak.
As a summary, our two major contributions are:
1.	We propose the quasistatic Wasserstein gradient flow dynamics for mixed Nash equilibrium
problems, and show its convergence to the unique Nash equilibrium under weak assump-
tions. Our result neither requires the entropy regularization to be sufficiently strong, nor
assumes the dynamics to converge a priori.
2.	We derive a simple while practical quasistatic Langevin gradient descent algorithm by dis-
cretizing the quasistatic Wasserstein gradient flow, by finding an efficient way to approx-
imate the partition function appearing in the dynamics of p. The proposed algorithm is
applied on several problems including training mixtures of GANs.
2	Related work
The mixed Nash equilibrium problem has a long history, with the proof of its existence dates back
to Morgenstern & Von Neumann (1953). It draws new attention in recent years, especially in the
machine learning community, due to the development of GANs (Goodfellow et al., 2014a) and ad-
versarial training (Goodfellow et al., 2014b). Training mixture of GANs is already discussed in
paper (Goodfellow et al., 2014a). Some numerical experiments were conducted in (Arora et al.,
2017). In Grnarova et al. (2017), the authors proposed an online learning approach for training mix-
ture of GANs, and proved its effectiveness for semi-shallow GANs (GANs whose discriminator is
a shallow neural network). Yet, rigorous theoretical treatment to an algorithm started from (Hsieh
et al., 2019), in which a mirror descent method was studied and proven to converge. The imple-
mentation of the mirror descent method involves big computational cost that asks for heuristics to
alleviate. Later, (Domingo-Enrich et al., 2020) studied more efficient algorithms under a mixture of
Wasserstein and Fisher-Rao metrics. Theoretically, the time average of the dynamics’ trajectories is
shown to converge to the mixed Nash equilibrium. As a comparison, in this work we show the global
convergence of the quasistatic Wasserstein gradient flow without the need of taking time average.
Meanwhile, the Wasserstein nature of our dynamics makes it easy to implement as well.
The Wasserstein gradient flow in the density space has been explored in previous works. For exam-
ple, (Wang &Li, 2019) studied the Nesterov’s accelerated gradient flows for probability distributions
under the Wasserstein metric, and (Arbel et al., 2019) studied practical implementations of the natu-
ral gradient method for the Wasserstein metric. Both works focus on minimization problems instead
of min-max problems considered in this work. A more related work is Lin et al. (2021b), where a
natural gradient based algorithm is proposed for training GANs. Yet, the method still optimizes one
generator and one discriminator, searching for pure Nash equilibrium. Another work that derives
algorithms for GANs from a Wasserstein perspective is (Lin et al., 2021a).
Another volume of works that studies the Wasserstein gradient flow in the machine learning con-
text is the mean-field analysis of neural networks. This line of works started from two-layer neural
networks (Mei et al., 2018; Rotskoff & Vanden-Eijnden, 2018; Chizat & Bach, 2018; Sirignano &
Spiliopoulos, 2020), to deep fully-connected networks (Araujo et al., 2019; Sirignano & SPilioPoU-
los, 2021; Nguyen, 2019; Wojtowytsch et al., 2020), and residual networks (Lu et al., 2020; E et al.,
2020). The mean-field formulations treat parameters as probability distributions, and the training
dynamics are usually the gradient flow under Wasserstein metric. Attempts to prove convergence of
the dynamics to global minima are made (Mei et al., 2018; Chizat & Bach, 2018; Rotskoff et al.,
2019), though in the case without entropy regularization a convergence assumption should usually
be made a priori.
2
Published as a conference paper at ICLR 2022
3	The quasistatic dynamics
We consider the entropy regularized mixed Nash equilibrium problem, which in our case is equiva-
lent with solving the following minimax problem:
min max
p∈P(Ω) q∈P(Ω)
j
Jω×ω
K(x, y)p(x)q(y)dxdy + β-1
j
Jω
p log pdx - β-1
q log qdy.
Jω
(1)
In (1), Ω is a compact Riemannian manifold without boundary, and P(Ω) is the set of probability
distributions on Ω. Since Ω is compact, any probability distribution in P(Ω) naturally has finite mo-
ments. Let E(p, q) = Jω×ω K(x，y)p(dx)q(dy), and S(P) = JqPlogPdx and S(q) = Jq qlog qdy
be the (negative) entropy of p and q, respectively. Then, the minimax problem (1) can be written in
short as
min max E(P, q) +β-1S(P) - β-1S(q).	(2)
p∈P(Ω) q∈P(Ω)
Remark 1. Strictly speaking, in (1) we should distinguish probability distributions and their den-
sity function (if exist), and the entropy should also be defined using the Radon-Nikodym derivative
with canonical measure. In this paper, since P and q indeed have density functions because of the
entropy regularization, we shall abuse the notation by using P and q to represent both probability
distributions and their density functions.
The entropy regularizations in (1) and (2) make the problem strongly convex in P and strongly
concave in q. Hence, there exists a unique Nash equilibrium for the problem. Such results are
shown for example by the following theorem from (Domingo-Enrich et al., 2020).
Theorem 1.	(Theorem 4 of (Domingo-Enrich et al., 2020)) Assume Ω is a compact Polish metric
space equipped with canonical Borel measure, and that K is a continuous function on Ω X Ω.
Then, problem (2) has a unique Nash equilibrium given by the solution of the following fixed-point
problem:
P(X) = 〒exp(一βU (x,q)),	q(x) = 〒exp(βV (y,p)),	(3)
Zp	Zq
where Zp and Zq are normalization constants to make sure P and q are probability distributions,
and U and V are defined as
U(x,q) = δEp∙^(χ)= Z K(X,y)q(y)dy, V(y,p) = δE^)(y) = Z K(χ,y)p(χ)dχ.
δp Jω	δq Jω
Considering the efficiency in high-dimensional cases, a natural dynamics of interest to find the Nash
equilibrium for (2) is the gradient descent-ascent flow under the Wasserstein metric,
∂tPt = V ∙ (ptV(U(x, qt) + β-1 logPt)),
∂tqt = V ∙ (qtV(-V(y,pt) + β-1 log qt)) ,	(4)
because it can be easily discretized into a Langevin gradient descent-ascent method by treating the
PDEs as Fokker-Planck equations of SDEs. When β-1 is sufficiently large, (4) can be proven to
converge linearly to the unique MNE of (2) (Eberle et al., 2019). However, when β-1 is small,
whether (4) converges remains open. This hinders the application of (4) because in practice the
entropy terms are usually used as regularization and are kept small. (We realize that it is proven
in Domingo-Enrich & Bruna (2022) when our work is under review.)
In (4), the dynamics of p and q have the same speed. In this work, instead, we study a quasistatic
Wasserstein gradient descent dynamics, which can be understood as a limiting dynamics when the
speed of q becomes faster and faster compared with that ofp. In this case, at any time t, we assume
qt reaches at the equilibrium of the maximizing problem instantaneously by fixing p = pt in (2).
That is to say, at any time t, qt is determined by
qt = q[pt] := arg max E(pt, q) - β-1S(q).	(5)
q∈P (Ω)
On the other hand, pt follows the Wasserstein gradient descent flow with qt = q[pt] at the equilib-
rium:
∂tPt = V∙ (ptV (δ(E(pt,q叫-JTS(q[pt])) + β-1 logpt)) .	(6)
3
Published as a conference paper at ICLR 2022
The following theorem shows qt = q[pt] can be explicitly written as a Gibbs distribution depending
on pt , and thus the free energy in (6) can be simplified to depend on a partition function related with
pt.
Theorem 2.	Assume K is continuous on the compact set Ω and β > 0. Then, for fixed Pt the
maximization problem (5) has a unique solution
q[pt](y) :
-ɪ- exp(βV (y,pt)),
Zq(pt)
(7)
where Zq (p) is a normalization factor, Zq (p) :=	exp(βV (y, p))dy. Moreover, the dynamics (6)
for pt can be written as
∂tPt = V ∙ (ptV (δβ 1l0p Z(Pt) + β-1 logpt))	(8)
Let Fp,β(P) := β-1 log Zq (P) + β-1S(P). By Theorem 2, the dynamics (8) ofPt is the Wasserstein
gradient descent flow for minimizing Fp,β (P). By the Proposition 3 below, Fp,β is strongly convex
with respect to P. Therefore, it is possible to prove global convergence for the dynamics (8), and
thus the convergence for the quasistatic Wasserstein gradient flow for the minimax problem (2).
Proposition 3. For any probability distributions pi, p2 in P(Ω), and any λ ∈ [0,1], we have
Fp,β (λP1 + (1 - λ)P2) < λFp,β (P1) + (1 - λ)Fp,β (P2).
In practice the partition function log Zq (Pt) in (8) seems hard to approximate, especially when Ω is
in high dimensional spaces. However, we show in the following proposition that the variation of the
partition function with respect to Pt can be written as a simple form involving qt . This property will
be used to derive a particle method in Section 5
Proposition 4. Forany P ∈ P(Ω), we have
δβ-i log Zq (P) E 「八	zɑʌ
-------7~~-- = U (∙, q[P]),	(9)
δP
where q[P] is defined in (7). Therefore, the dynamics (8) is equivalent with
∂tPt = V ∙ (PtV (U (x,q[Pt]) + β-i log Pt)) .	(10)
4 Convergence analysis
In this section, we analyze the convergence of the quasistatic dynamics (7), (8). First, we make the
following assumptions on K.
Assumption 1. Assume K ∈ C∞(Ω X Ω), which means K has continuous derivatives ofany order
(with respect to both x and y).
Since Ω is compact, assumption 1 implies boundedness and LiPSChitz continuity of any derivatives
ofK.
Now, we state our main theorem, which shows the convergence of QSWGF to the Nash equilibrium.
Theorem 5.	(main theorem) Assume Assumption 1 holds for K. Then, starting from any initial
Po, qo ∈ P(Ω), the dynamics (7), (8) has a unique solution (Pt, qt)t≥0, and the solution converges
weakly to the unique Nash equilibrium of(2), (p* ,q*), which satisfies the fixed point problem (3).
Theorem 5 guarantees convergence of the quasistatic Wasserstein gradient flow for any β, giving
theoretical endorsement to the discretized algorithm that we will introduce in the next section. Note
that the initialization qo in the theorem is not important, because we assume q achieves equilibrium
immediately after the initialization.
Remark 2. The assumption on K ’s smoothness can be made weaker. For example, during the
proof, up to 4-th order derivatives of K is enough to give sufficient regularity to the solution of the
dynamics. We make the strong assumption partly to prevent tedious technical analysis so as to focus
on the idea and insights.
4
Published as a conference paper at ICLR 2022
Proof sketch We provide some main steps and ideas of the proof of the main theorem in this
section. The detailed proof is put in the appendix.
By the last section, since qt is always at equilibrium, we only need to considering a Wasserstein
gradient descent flow for Fp,β (p). Therefore, we can build our analysis based on the theories in (Mei
et al., 2018) and (Jordan et al., 1998). However, compared with the analysis therein, our theory deals
with a new energy term—βT log Zq(p), which has not been studied by previous works. From now
on, let Ep,β(P) = β-1 log Zq(p),and Ψ(∙,p) = δEp,P(P). By simple calculation we have
Ψ(x,p) = U(x, q[p]) = Zjp)J K(x,y)exp U βK(x,y)p(x.)dx) dy.
(11)
First, we study the free energy Fp,β(p), and show that it has a unique minimizer which satisfies a
fixed point condition. This is the result of the convexity of Fp,β . We have the following lemma.
Lemma 1. Assume Assumption 1 holdsfor K. Then, Fp,β has a unique minimizer p* that satisfies
FP,β (p*) = UinfSFp,β (p*)∙
p∈P(Ω)
Moreover p* is the unique solution of the following fixed point problem,
p* = 1 exp (-βΨ(x,p*)),	(12)
Z
where Z is the normalization factor.
Next, we want to show that any trajectory given by dynamics (10) will converge to the unique
minimizer of Fp,β. To achieve this, we first study the existence, uniqueness, and regularity of the
solution to (8), i.e. the trajectory indeed exists and is well behaved. Related results are given by the
following lemma.
Lemma 2. Assume Assumption 1 holdsfor K. Then, StartingfromanyinitiaIpo ∈ P(Ω), the weak
solution (Pt)t≥o to (8) exists and is unique. Moreover, (Pt) is smooth on (0, ∞) X Ω.
The proof of Lemma 2 is based on Proposition 5.1 of (Jordan et al., 1998). Especially, the existence
part is proven using the JKO scheme proposed in (Jordan et al., 1998). We consider a sequence of
probability distributions given by the following discrete iteration schemes with time step h,
p0h = p0 , pkh = arg min .11W2 (P, Ph-1) + hFP,β(P) ? , k > 0,
P∈P(Ω) I 2	J
where W2(p, q) means the 2-Wasserstein distance between probability distributions p and q. Let
(pth)t≥0 be the piecewise constant interpolations of (pkh)k≥0 on time. We show (pth) converges
weakly (after taking a subsequence) to a weak solution of (8) as h tends to 0. Details are given in
the appendix.
Finally, noting that Fp,β is a Lyapunov function of the dynamics (8), we have the following lemma
showing the convergence of (pt)t≥0 to the solution of the Boltzmann fixed point problem (12). This
finishes the proof of the main theorem.
Lemma 3. Let (Pt)t≥o be the solution of (8) from any initial po ∈ P(Ω). Let p* be the unique
minimizer of Fp,β given by (12). Then, pt converges to p* weakly as t → ∞.
As a byproduct, since our convergence results does not impose requirement on β, if one is interested
in the minimax problem without entropy regularization,
p∈Pi(Ω) qmaΩ)
E(p, q),
(13)
then, Theorem 5 in (Domingo-Enrich et al., 2020) ensures that the quasistatic dynamics converges
to approximate Nash equilibrium of (13) as long as β-1 is small enough. Specifically, a pair of
probability distributions (p, q) is called -Nash equilibrium of (13) if
sup E(p, q0) - inf E(p0, q) ≤ .
q0∈P(Ω)	p0∈P(Q)
Then, we have the following theorem as a direct results of Theorem 5 in (Domingo-Enrich et al.,
2020):
5
Published as a conference paper at ICLR 2022
Theorem 6.	Let CK be the bound of K that satisfies |K (x,y)∣ ≤ CK for any x,y ∈ Ω, and let
Lip(K) be the Lipschitz constant of K. For any > 0, let δ = /(2Lip(K)), and let Vδ be the
volume ofa ball with radius δ in Ω. Then, as long as
β > - log
(2(1-Vδ)
I	Vδ
there exists T > 0 which depends on , such that for any t > T, the solution pt , qt of the dynamics
(7) and (8) at t satisfies
sup E(pt, q0) -	inf E(p0, qt) ≤ .
q0∈P (Ω)	p0∈P(Q)
5 The quasistatic Langevin gradient descent-ascent method
It is well known that PDEs with the form
∂tp(t, X)= V ∙ (p(t, x)μ(t, x)) + λ∆p(t, x)
are Fokker-Planck equations for SDEs dXt = —μ(t, Xt)dt + √2λdWt, and the solution for the
PDE characterizes the law of Xt—the solution of the SDE—at any time. This result connects the
Wasserstein gradient flow with SDE, and gives a natural particle discretization to approximate the
continuous Wasserstein gradient flow. For example, the Wasserstein gradient descent-ascent flow
dynamics (4) is the Fokker-Planck equation of the SDEs
dXt = -VxU (Xt, qt)dt + p2β-1dW^t
dYt = Vy V (匕,pt)dt + √2β-1dWt,,
where pt and qt are the laws of Xt and Yt, respectively, and Wt and Wt0 are two Brownian motions.
Note that we have
VxU(x, q)
L
Jω
VxK(x, y)q(y)dy,
VyV(y,p)
L
Jω
VyK(x, y)p(x)dx.
Therefore, i.i.d. picking XOi)〜po and Y0(i) 〜qo for i = 1,2,..., n, the particle update scheme,
named Langevin Gradient Descent-Ascent (LGDA),
n n	_____
Xk+i = XEi- - X VxK (Xki,Yfh + PhFi,
j=1
n n	______
Y(+)1 = Y((ii + n X VyK(Xy),Y(ii) + p2-β-1ζ(ii,
(14)
j=1
approximately solves the SDEs, and thus the empirical distributions of Xk(i) and Yk(i) approximate
the solutions of (4) when n is large. Here, ξk(i) and ζk(i) are i.i.d. samples from the standard Gaussian.
Quasistatic Langevin gradient descent method Similarly, the dynamics (8) for p is the Fokker-
Planck equation for the SDE
dXt = -VΨ(x,pt)dt + P 2β-1dWt,	(15)
where pt is the law of Xt. By proposition 4 we have Ψ(x,pt) = U(x, q[pt]). Hence, (15) can be
written as
dXt = -VxU (Xt, q[pt])dt + √2β-1dWt,	(16)
with q[pt] at the equilibrium of the maximization problem (5), which can be attained by solving the
SDE
dYt = Vy V (Yt,pt)dt + √2β-1dWt,	(17)
for sufficiently long time. This motivates us to design a quasistatic particle method as a discretization
for the quasistatic Wasserstein gradient flow. Specifically, the method consists of an inner loop and
an outer loop. The method starts from some particles X0(i) and Y0(i), i = 1, 2, ..., n, sampled i.i.d.
from p0 and q0, respectively. Then, at the k-th step, the inner loop conducts enough iterations on the
Y particles to solve (17) with pt fixed (i.e. with the X particles fixed), which drives the empirical
distribution of {Yk(i)}in=1 near equilibrium before each update of the outer loop. Next, the outer loop
updates Xk(i) according the SDE (16). The algorithm is summarized in Algorithm 1.
6
Published as a conference paper at ICLR 2022
Algorithm 1: Quasistatic Langevin gradient descent method (QSLGD)
input ： nχ,ny,k0,k1,k2,T ∈ N+, hχ,hy > 0,p0,q0 ∈ P(Ω)
output: Final particles (XT(i) , YT(i))in=1
1	Sample (X0(i))in=x1 i.i.d. from p0, and (Y0(i))in=y1 i.i.d. from q0;
2	Y0(,i) 一 Y0(i) for i = 1, 2,…,ny;
3	for S - 1 to ko do
4	Y0(,is) - Yfi)-I + hy nP VyK(XOj),Y⅛)-ι) + P2hyβ-1ξ ;	/* remark3.1 */
x j=1
5 end
6
7
8
9
10
11
12
13
14
15
16
17
18
Y0(i) - Y0* i 2ko for i =1, 2,...,ny；
for t — 1 to T do
Yt-1,0 - Yt-1 for i = 1, 2,...,ny；
for s — 1 to kι do
Yt-I,s - Y⅛s-1 + h PP VyK(X j1,Yt-l,s-l) + P2hyβ-1 ξ;
x j=1
end
for s — 1 to k2 do
Yt-i,s + kl - Yt(X+kl-1 + h nP VyK(Xj1 , t-1,s+k1 -1)+ P2hyβ=τ ξ;
j=1
Yt-SLT)ny+i) 一 γt-1,s+kι, for i = 1, 2,...,ny;
end
...	...	k2ny	________
Xf) - Xt-1 + Ikhr P Vy K X-1, Yt-I) + √2hXβ-τξ ;	/* remark 3.2 */
y j=L
YFJ Yt-1,kι+k2,for i =1,2,...,ny;
end
Remark 3. Generally speaking, Algorithm 1 consists of two nested loops. The inner loop solves
Y particles to equilibrium in each step of the outer loop, while the outer loop makes one iteration
every time, using the equilibrium Y particles. In the following are some additional explanation for
the Algorithm:
1 line 4: at the beginning of the algorithm, we conduct k0 additional inner iterations for Y ,
where k0 may be a large number. This is because at the beginning the Y particles are far
from equilibrium. In later outer iterations, since each time the X particles only move for a
small distance, the Y particles are close to the equilibrium. Therefore, k1 and k2 need not
to be large.
2 line 17: In each inner loop, we conduct k1 + k2 inner iterations for the Y particles, and
collect those from the last k2 iterations. We use these k2n particles in the update of X
particles to approximate the distribution q[p]. We assume during the last k2 inner iterations
the Y particles are at equilibrium. One can take k2 to be 1 if ny is large enough, while
taking large k2 allows smaller number of Y particles.
5.1 Examples
In this section, we apply the quasistatic Langevin gradient descent method to several problems.
1-dimensional game on torus We first consider a problem with x and y on the 1-dimensional
torus. Specifically, we consider
K(x, y) = sin(2πx) sin(2πy),
where x, y ∈ R/Z. It is easy to show that, with this K and a positive β, at the Nash equilibrium
of the problem (1) p and q are both uniform distributions. We take initial distributions p0 and q0
7
Published as a conference paper at ICLR 2022
Figure 1: Experiment results with K(x, y) = sin(2πx) sin(2πy). The three figures show the KL
divergence of the empirical particle distribution to the uniform distribution of LGDA and QSLGD
at different β, η and number of particles. Each point is an average of 5 experiments.
to be the uniform distribution on [0, 1/4]. Figure 1 shows the comparison of the quasistatic particle
method with LGDA for different β, step length, and number of particles. In the experiments, all
quasistatic methods take k0 = 1000 and k2 = 1, with different k1 shown in the legends. For
each experiment, we conduct 300000, 150000, 60000, 30000 outer iterations for LGDA, QS2, QS5,
and QS10, respectively. We take different different numbers of iterations for different methods in
the consideration of different number of inner iterations. The error is then computed after the last
iteration, measured by the KL divergence of the empirical distribution given by particles and the
uniform distribution (both in the forms of histograms with 10 equi-length bins). Each point in the
figures is an average of 5 experiments.
Seen from the left figure, the QSLGD has comparable performance than LGDA when β is small,
in which case diffusion dominates the dynamics, while it performs much better than LGDA when
β is large. We can also see better tolerance to large β when more inner iterations are conducted.
This shows the advantage of the QSLGD over LGDA when the regularization stength is weak. The
middle figures shows slightly better performance of the QSLGD when the step length η (both ηx
and ηy) is small. However, when η is big, LGDA tends to give smaller error. The results may be
caused by the instability of the inner loop when η is big. It also guides us to pick small step length
when applying the proposed method. Finally, the right figure compares the influence of the number
of particles when β = 100 and η = 0.01, in which case the two methods perform similarly. We can
see that the errors for both methods scale in a 1/n rate as the number of particles n changes.
Polynomial games on spheres In the second example, we consider a polynomial games on sphere
similar to that studied in (Domingo-Enrich et al., 2020),
K(x, y) = xTA0x + xTA1y + yT A2y + yT A3(x2),	(18)
where x, y ∈ Sd-1 and (x2) is the element-wise square of x. In this problem, we consider the Nash
equilibrium of minp maxq E(p, q). Hence, we take big β (small β-1) and compare the Nikaido and
Isoda (NI) error of the solutions found by different methods (NikaidO & Isoda, 1955). The NI error
is defined by
NI(p, q) := sup E(pt, q0) - inf E(p0, qt),
q0∈P (Ω)	p0∈P(Q)
which is also used in Theorem 6. The left panel of Figure 2 shows the NI errors of the solutions found
by different methods with different dimensions, we see comparable performance of the QSLGD with
LGDA.
GANs Finally, we test our methods on the training of GANs. We train GANs to learn Gaussian
mixtures. The results after training are shown in the middle and right panels of Figure 2, where
Gaussian mixtures with 4 and 8 modes are learned, respectively. We train GANs with 5 generators
and 5 discriminators, and take k0 = 100, k1 = 5, k2 = 1. The results show that the mixture of
GANs trained by QSLGD can learn Gaussian mixtures successfully.
In the right panel of Figure 2, we show the results of learning high dimensional Gaussian mixtures.
In the d-dimensional experiment, the Gaussian mixture has d modes centered at e1, e2, ..., ed with
8
Published as a conference paper at ICLR 2022
Figure 2: (Left) The NI error of the solutions found by different algorithms for the polynomial game
(18), at different dimensions. Each point is an average of 10 experiments. (Middle left, Middle
right) Generation results of mixture of GANs. The blue points are sampled from groundtruth dis-
tribution, while the green points are generated by the a mixture of generators. (Right) The average
squared distance of generated data to closest mode center for learning high dimensional Gaussian
mixtures.
standard deviation 0.1. Here, ei is the i-th unit vector in the standard basis of Rd. Model and
algorithm with same hyper-parameters as above are used. In the figure, we measure the average
squared distance of the generated data to the closest mode center along the training process. The
figure shows that the average squared distance can be reduced to 0.3 - 0.5 after 10000 iterations.
While the ideal value is 0.1, the current results still show that the learnt distribution concentrates at
the mode centers. Better results may be obtained after longer training or careful hyper-parameter
tuning.
6 Discussion
In this paper, we study the quasistatic Wasserstein gradient flow for the mixed Nash equilibrium
problem. We theoretically show the convergence of the continuous dynamics to the unique Nash
equilibrium. Then, a quasistatic particle method is proposed by discretizing the continuous dynam-
ics. The particle method consists of two nested loops, and conduct sufficient inner loop in each step
of the outer loop. Numerical experiments show the effectiveness of the method. Comparison with
LGDA shows the proposed method has advantage over LGDA when β is large (which is usually the
case of interest), and performs as good as LGDA in most other cases.
Theoretical extensions are possible. For example, strong convergence results may be established by
similar approaches taken in (Feng & Li, 2020). We leave this as future work.
In practice, the idea of nested loops is not new for minimax optimization problems. It is already
discussed and utilized in the earliest works for GANs (Goodfellow et al., 2014a), and Wasserstein
GANs (Arjovsky et al., 2017). In those works, the discriminator is updated for several steps each
time the generator is updated. Our work is different from these works because we consider mixed
Nash equilibrium and hence our method is particle based, while their method searches for pure Nash
equilibrium.
Finally, though particle methods finding mixed Nash equilibria have stronger theoretical guarantees,
applying these methods to the training of GANs faces the problem of computational cost. With both
the generator and discriminator being large neural networks, training mixture of GANs with many
generators and discriminators imposes formidable computational cost. Developing more efficient
particle methods for GANs is an important future work.
References
Dyego Araiujo, Roberto I Oliveira, and Daniel Yukimura. A mean-field limit for certain deep neural
networks. arXiv preprint arXiv:1906.00193, 2019.
Michael Arbel, Arthur Gretton, Wuchen Li, and Guido MontUfar. Kernelized WaSSerStein natural
gradient. arXiv preprint arXiv:1910.09652, 2019.
9
Published as a conference paper at ICLR 2022
Martin Arjovsky, Soumith Chintala, and Leon Bottou. Wasserstein generative adversarial networks.
In International conference on machine learning, pp. 214-223. PMLR, 2017.
Sanjeev Arora, Rong Ge, Yingyu Liang, Tengyu Ma, and Yi Zhang. Generalization and equilibrium
in generative adversarial nets (gans). In International Conference on Machine Learning, pp. 224-
232. PMLR, 2017.
Lucian Busoniu, Robert Babuska, and Bart De Schutter. A comprehensive survey of multiagent rein-
forcement learning. IEEE Transactions on Systems, Man, and Cybernetics, Part C (Applications
and Reviews), 38(2):156-172, 2008.
Lenaic Chizat and Francis Bach. On the global convergence of gradient descent for over-
parameterized models using optimal transport. arXiv preprint arXiv:1805.09545, 2018.
Carles Domingo-Enrich and Joan Bruna. Simultaneous transport evolution for minimax equilibria
on measures. arXiv preprint, https://arxiv.org/pdf/2202.06460.pdf, 2022.
Carles Domingo-Enrich, Samy Jelassi, Arthur Mensch, Grant Rotskoff, and Joan Bruna. A mean-
field analysis of two-player zero-sum games. arXiv preprint arXiv:2002.06277, 2020.
Weinan E, Chao Ma, and Lei Wu. Machine learning from a continuous viewpoint, i. Science China
Mathematics, 63(11):2233-2266, 2020.
Andreas Eberle, Arnaud Guillin, and Raphael Zimmer. Quantitative harris-type theorems for dif-
fusions and mckean-vlasov processes. Transactions of the American Mathematical Society, 371
(10):7135-7173, 2019.
Qi Feng and Wuchen Li. Entropy dissipation via information gamma calculus: Non-reversible
stochastic differential equations. arXiv preprint arXiv:2011.08058, 2020.
Fei Gao, Yue Yang, Jun Wang, Jinping Sun, Erfu Yang, and Huiyu Zhou. A deep convolutional
generative adversarial networks (dcgans)-based semi-supervised method for object recognition in
synthetic aperture radar (sar) images. Remote Sensing, 10(6):846, 2018.
Irving L Glicksberg. A further generalization of the kakutani fixed point theorem, with application
to nash equilibrium points. Proceedings of the American Mathematical Society, 3(1):170-174,
1952.
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair,
Aaron Courville, and Yoshua Bengio. Generative adversarial nets. Advances in neural information
processing systems, 27, 2014a.
Ian J Goodfellow, Jonathon Shlens, and Christian Szegedy. Explaining and harnessing adversarial
examples. arXiv preprint arXiv:1412.6572, 2014b.
Paulina Grnarova, Kfir Y Levy, Aurelien Lucchi, Thomas Hofmann, and Andreas Krause. An online
learning approach to generative adversarial networks. arXiv preprint arXiv:1706.03269, 2017.
Ya-Ping Hsieh, Chen Liu, and Volkan Cevher. Finding mixed nash equilibria of generative ad-
versarial networks. In International Conference on Machine Learning, pp. 2810-2819. PMLR,
2019.
Richard Jordan, David Kinderlehrer, and Felix Otto. The variational formulation of the fokker-
planck equation. SIAM journal on mathematical analysis, 29(1):1-17, 1998.
Alex Tong Lin, Samy Wu Fung, Wuchen Li, Levon Nurbekyan, and Stanley J Osher. Alternating the
population and control neural networks to solve high-dimensional stochastic mean-field games.
Proceedings of the National Academy of Sciences, 118(31), 2021a.
Alex Tong Lin, Wuchen Li, Stanley Osher, and Guido Montufar. Wasserstein proximal of gans.
arXiv preprint arXiv:2102.06862, 2021b.
Yiping Lu, Chao Ma, Yulong Lu, Jianfeng Lu, and Lexing Ying. A mean field analysis of deep
resnet and beyond: Towards provably optimization via overparameterization from depth. In In-
ternational Conference on Machine Learning, pp. 6426-6436. PMLR, 2020.
10
Published as a conference paper at ICLR 2022
Song Mei, Andrea Montanari, and Phan-Minh Nguyen. A mean field view of the landscape of two-
layer neural networks. Proceedings ofthe National Academy ofSciences, 115(33):E7665-E7671,
2018.
Marc Mezard and Andrea Montanari. Information, physics, and computation. Oxford University
Press, 2009.
Oskar Morgenstern and John Von Neumann. Theory of games and economic behavior. Princeton
university press, 1953.
Phan-Minh Nguyen. Mean field limit of the learning dynamics of multilayer neural networks. arXiv
preprint arXiv:1902.02880, 2019.
HUkUkane NikaidO and KazUo Isoda. Note on non-cooperative convex games. Pacific Journal of
Mathematics, 5(S1):807-815,1955.
Grant Rotskoff, Samy Jelassi, Joan BrUna, and Eric Vanden-Eijnden. Global convergence of neUron
birth-death dynamics. arXiv preprint arXiv:1902.01843, 2019.
Grant M Rotskoff and Eric Vanden-Eijnden. NeUral networks as interacting particle systems:
Asymptotic convexity of the loss landscape and Universal scaling of the approximation error.
stat, 1050:22, 2018.
JUstin Sirignano and Konstantinos SpiliopoUlos. Mean field analysis of neUral networks: A central
limit theorem. Stochastic Processes and their Applications,130(3):1820-1852, 2020.
JUstin Sirignano and Konstantinos SpiliopoUlos. Mean field analysis of deep neUral networks. Math-
ematics of Operations Research, 2021.
Yifei Wang and WUchen Li. Accelerated information gradient flow. arXiv preprint
arXiv:1909.02102, 2019.
Stephan Wojtowytsch et al. On the banach spaces associated with mUlti-layer relU networks:
FUnction representation, approximation theory and gradient descent dynamics. arXiv preprint
arXiv:2007.15623, 2020.
11
Published as a conference paper at ICLR 2022
A Proofs for Section 3
A.1 Proof of Theorem 2
Note that the free energy in (5) can be written as
/
Jω
V (y, pt)q(y)dy
- β-1S(q),
(19)
in which the first term is linear with respect to q. Hence, a calculation with Lagrange multiplier
shows (19) has a unique minimizer q[pt] with the form of a Gibbs distribution (e.g. see Chapter 4
of (Mezard & Montanari, 2009)):
q[pt](y)
Z~1P) exp(βV (y,pt)).
(20)
Next, we consider the free energy forptwhen q is at the equilibrium. By (19) we have
E(pt, q [pt]) =	V(y, pt)q[pt](y)dy
Jω
=/、V V(y,pt)eχp(βv(y,pt))dy.
Zq (Pt) Jω
(21)
On the other hand, we have
β-1S(q[Pt]) = β-1
Jω
=β T ZΩ
__	1
Zq (Pt)
e e e exp(βV(y,Pt)) log
Zq(pt)
eχpβV y, pt)) dy
Z (Pt)eχp(βV(y,Pt)) (βV(y,pt) - log Zq(pt)) dy
V(y,pt) exp(βV (y, pt))dy - β-1 logZq(pt).
Jω
(22)
Combining (21) and (22), we obtain
E(pt, q[pt]) + β-1S(pt) - β-1S(q[pt]) = β-1 logZq(pt) +β-1S(pt).
Therefore, the dynamics of Pt is the Wasserstein gradient descent flow minimizing the free energy
β-1logZq(Pt) + β-1S(Pt), given by
∂tPt = V ∙ (ptV (δβ-1l0p Z(Pt) + β-1 logPt))
This finishes the proof.
A.2 Proof of Proposition 3
Since S(P) is strongly convex, it suffices to show logZq(P) is convex. Recall that
log Zq (P) = log	exp(βV(y, P))dy .
Note that V(∙,p) = ʃ K(x, ∙)p(x)dx is linear with respect to p, we have
V(∙, λpι + (1 - λ)p2) = λV(∙,pι) + (1 - λ)V(∙,p2).
Hence,
logZq(λP1 + (1 - λ)P2) = log
log
exp(βV(y, λP1 + (1 - λ)P2))dy
(/ exp(βλV(y,pι)) ∙ exp(β(1 - λ)V(y,p2))
exp(βV(y, P2))
≤ log	exp(βV (y, P1))
= λlogZq(P1) + (1 - λ)logZq(P2).
The second last line is given by the Holder inequality.
(23)
12
Published as a conference paper at ICLR 2022
A.3 Proof of Proposition 4
The proposition follows from the following derivations.
δβ-1 log Zq (p)
δp
1 ɪ δZq (P)
Zq (P)	δp
β-1 -y15 e exp(βV(y,P))βK(χ,y)dy
Zq (P) Jω
e exx	∖eχp(IeV(y,P))，
I K(χ,y)-----τrτ~∖—dy
Jω	Zq(P)
K(x, y)q[P](y)dy
Jω
U (x, q[P]).
(24)
B Proof of Theorem 5
In this section, we prove our main theorem. The proof will follow the sketch given in Section 4.
Given the assumptions on K and the conclusions of Lemma 1 and Lemma 2, Lemma 3 is a direct
result of Lemma 10.12 in (Mei et al., 2018), Which We Will ignore the proof. In the folloWing,
We shoW Lemma 1 and Lemma 2. Some techniques in the proof come from (Jordan et al., 1998)
and (Mei et al., 2018).
B.1 Proof of Lemma 1
Our proof folloWs the proof of Proposition 4.1 in (Jordan et al., 1998). First, We shoW the existence
of the minimizer for Fp,β. To See this, note that K is bounded on Ω. Assume CK is a constant such
that |K(x, y)| ≤ CK for any x,y ∈ Ω. Then, we have
Ep,β(P) =	U(x, q[P])P(x)dx =	K(x,y)q[P](y)P(x)dxdy ≥ -CK,
and
S(p) = / p(x) logP(x)dx ≥ - -Ldx =――.
Jω	Jω e	e
This means Fp,β (P) is lower bounded, i.e. infp Fp,β (P) > -∞. Hence, we can find a sequence
(Pk )k∞=1 such that
lim Fp,β(Pk) = inf Fp,β (P).
k→∞	p
Similar to (Jordan et al., 1998), we can show boundedness of { max{Pk logPk, 0}dx} and
{ P2kdx}, which implies that (Pk) is uniformly integrable, and thus there exists a weakly convergent
subsequence of (Pk).
Without loss of generality, assume Pk * p* in L1(Ω). Then we need to show p* is a minimizer of
Fp,β. By (Jordan et al., 1998), the entropy term satisfies
S(p*) ≤ liminf S(Pk).
k→∞
Hence, the conclusion follows if Ep,β is continuous in the weak topology. To show this, first note
that for any P ∈ P(Ω), We have
exp(eV(y,P))dy ≥ e-βCK .
Jω
Because the function log(x) is 1/c-Lipschitz for x ∈ [c, ∞], for any Pk we have
IeT logZq(Pk)- β-1 logZq(p*)∣ ≤ βTeeCK
(y,Pk)-eβV3,pD)dy .
13
Published as a conference paper at ICLR 2022
By similar boundedness argument, we have
/ (eβV(y,pk)-eβV(y,p*)) dy
eβV(y，Pk)-eβV(y,p*)1 dy
≤ eβCK	β |V(y,pk) - V (y, p*)| dy
Jω
≤ βeβCK
Jω Jω
K(χ,y)(pk(X)-p*(χ))dχ dy
Ω
Totally we have
β-1 log Zq(pk) - β-1 log Zq(p*) ≤ e2βCK
Jω Jω
K(χ,y)(pk(X)-p*(χ))dχ dy.
Ω
Since K is bounded and Lipschitz, it is easy to show that
lim
k→∞
Jω Jω
K(x, y)(pk(χ) — p*(χ))dχ dy = 0.
Ω
Therefore, we have
Fp,β(p*) ≤ liminf FP,β(pk) = inf FP,β(p),
k→∞	p
and thus Fp,β(p*) = infp Fp,β(p).
Next, we show p* satisfies the fixed point condition
p* = 1exp(-βΨ(x,p*))∙
Z
(25)
This follows the proof of Lemma 10.3 in (Mei et al., 2018), by first showing p* has full support on
Ω, and then showing
Ψ(χ,p*) + β-1 log p* (x)
is a constant.
Finally, we show p* is unique following Lemma 10.4 of (Mei et al., 2018). Specifically, we show
the Boltzmann fixed point problem (25) only has one solution by the convexity of Fp,β . Assume
(25) has two different solutions p1 and p2, i.e.
pi = -τ77^-exp(-βΨ(x,pι)), p2 = --^-exp(-βΨ(x,p2)).
Z(p1)	Z(p2)
Then, we have
logZ(p1) = -βΨ(x, p1) - logp1(x),
logZ(p2) = -βΨ(x, p2) - logp2(x).
Taking difference of the above two equations, and integrating with p1 - p2, we have
0 =	(log Z(p1) - logZ(p2))(p1(x) - p2(x))dx
Jω
= -β (Ψ(x, p1) - Ψ(x,p2))(p1(x) -p2(x))dx -	(logp1 (x) - logp2(x))(p1(x) -p2(x))dx.
Jω	Jω
(26)
By the monotonicity of log x, the second term of (26) is non-negative, and takes zero only ifp1 = p2.
For the first term, recall that we have proven in Proposition 3 that Ep,β is convex, we then have
Ep,β(p1) ≥ Ep,β (p2) +	Ψ(x,p2)(p1(x) - p2(x))dx,
Jω
and
Ep,β(p2) ≥ Ep,β (p1) +	Ψ(x,p1)(p2(x) - p1(x))dx.
Jω
Taking difference of the two equations gives
(Ψ(x, p1) - Ψ(x, p2))(p1(x) - p2 (x))dx ≥ 0.
Jω
Therefore, (26) holds if and only if p1 = p2. This finishes the proof of uniqueness of p*, and also
completes the proof of Lemma 1.
14
Published as a conference paper at ICLR 2022
B.2 Proof of Lemma 2
We show the existence of the weak solution using the JKO scheme used in (Jordan et al., 1998). Let
dist(∙, ∙) be the distance metric on Ω. Then, the 2-Wasserstein distance is on P(Ω) is defined as
W2(p1,p2) :
inf	dist(x1, x2)2dγ(x1, x2)
where Γ(p1,p2) contains all couplings of pi and p2, i.e. probability distributions on Ω X Ω with first
and second marginals being p1 andp2, respectively. Then, for any h > 0, we consider the sequence
of probability distributions (pkh)k∞=0 obtained by the following iteration scheme:
Ph = Po,	Ph = argmin11 W2(p,ph-i) + hFp,β (P)I , k> 0,	(27)
p∈P(ω)[2	J
By similar argument of Proposition 4.1 in (Jordan et al., 1998), each minimization problem in (27)
has a unique solution. Hence, (Pkh)k∞=o is uniquely defined. Let Pth be the piecewise constant inter-
polation of (Pkh ) on t, i.e.
Pth = Pkh, fort ∈ [kh, (k + 1)h),
for k = 0, 1, 2, . We now show that there exists a subsequence of hn → 0 and a Pt such that
phn * pt on (0, T) × Ω for any T > 0 and Pt is a weak solution of (8). This is proven in two steps:
1.	The existence of weakly convergence subsequence, and
2.	Pth approximately satisfies the equation (8).
For the first point, we show uniform integrability by showing
kxk2Pkh (x)dx ≤ C
Jω
and
max{Pkh logPkh, 0}dx ≤ C
Jω
(28)
(29)
for any h and k ≥ 0, and an absolute constant C. Equation (28) follows directly from the compact-
ness of Ω. For (29), note that for any h and k ≥ 0 We have
1W22(Ph,Ph-i) + hFp,β(Ph) ≤ hFp,β(Ph-1),
which implies
Therefore,
Fp,β (Pkh) ≤ Fp,β (Pkh-1).
max{Pkh log Pkh, 0}dx ≤
Jω
S(Pkh) +
Jω
min{Pkh log Pkh, 0} dx
Fp,β (Pkh) - Ep,β(Pkh) +
Jω
Fp,β (Poh) - Ep,β(Pkh) +
Jω
LdX
e
Ldx.
e
Since K is bounded, Ep,β is bounded, and thus the above expression is also bounded, which gives
(29). With (28) and (29), there exists Pt(x) and a sequence (hn) with hn → 0, such that Pthn * Pt
in L1((0, T) × Ω) for any T > 0. Moreover, Pt ∈ P(Ω) for almost every T. By changing Pt on
a zero measure set of t, We can assume Pt ∈ P(Ω) for any t ∈ (0, ∞). With the same analysis
as (Jordan et al., 1998), the weak convergence can happen for any t, i.e. Phn * Pt in L1 (Ω) for any
t ∈ (0, ∞).
≤ SgTΩ 1 dx
≤
≤
15
Published as a conference paper at ICLR 2022
For the second point, similar to (Jordan et al., 1998), consider any vector field ξ ∈ C∞(Ω, Ω) and
the corresponding flux Φτ given by
∂τΦτ = ξ(Φτ), Φ0 (x) = x,
and let qτ = Φτ ]pkh, then we have
T ( (2 Wm(PhT ,qτ) + hFP,β (qT )
W22(pkh-1,pkh)+hFp,β(pkh)	≥0	(30)
for any τ > 0. We need to study the limit when τ → 0+. By the calculation in (Jordan et al., 1998)
we have
and
liτ→sup 1G W22(PhT,qτ)- 2 W2(ph
dTS(qτ)
x)ξ(y)dγ(x, y),	(31)
T=0	Ω Ω
(32)
where the γ in (31) is the optimal transport between pkh-1 and pkh. For the Ep,β term, we have
τ→m+1(Ep，e (qτ)- Ep，e (Ph))=τ→m+ βτlog
γ Jω exp(βV(y,qτ))dy -
.Rω eχp(βV (y,ph))dy.
lim
τ→0+
1
1 Γ∕ω exp(βV(y,qτ))dy
βτ [Rω eχp(βV(y,ph))dy
-1
βZq (Ph)
1
βZq (Ph)
lim
τ→0+
(exp(βV (y, qτ)) - exp(βV (y,pkh)))dy
/ exp(βV(y,ph))β (/ VχK(x,y) ∙ ξ(x)ph(x)dx) dy
=/ Vχψ(X,ph) ∙ ξ(X)Ph(X)dx.
Jω
Combining the above result with (31) and (32), taking both ξ and -ξ, we get from (30) that
(33)
/	(y — x)ξ(y)dγ(x,y) + h/ VxΨ(x,ph) ∙ ξ(x)ph(x)dx — h / PhV ∙ ξdx = 0	(34)
for any ξ ∈ C∞(Ω, Ω). Then, following the derivation in (Jordan et al., 1998) (proof of Proposition
5.1), as well as the following control
N
XW22(Pkh-1,Pkh)≤Ch
k=1
for any N that satisfies Nh ≤ T for some fixed T, we can integrate (34) over t by viewing Pkh as Pth
at appropriate t, and take the limit hn → 0 and show that Pt is a weak solution. During the limit, we
need to pay special attention to the second term, i.e. the following limit, which is not dealt with in
the reference:
lim /	/ VxΨ(x,Phn) ∙ ξ(x)Phn (x)dx = /	/ VxΨ(x,Pt) ∙ ξ(x)Pt(x)dx.	(35)
n→∞ Jo Jω	Jo Jω
We prove this by showing VxΨ(X,Pthn) converges to VxΨ(X,Pt) uniformly.
For any fixed t, recall that we have
Pthn * Pt .
Therefore, for any y ∈ Ω,we have
K(X, y)Pthn (X)dX →
K(X, y)Pt (X)dX.
16
Published as a conference paper at ICLR 2022
Note that Ω K(x, y)p(x)dx is uniformly continuous with respect to y for any P ∈ P(Ω), We can
conclude that Ω K(x, y)phn (x)dx converges to Ω K(x, y)pt(x)dx uniformly over y. Hence, we
have Zq (pthn) → Zq(pt), and q[pthn](y) → q[pt](y) uniformly. This further implies that
VχΨ(x,phn)=[
Jω
VxK(x, y)q[pthn](y)dy
converges to VxΨ(χ,pt) for all X ∈ Ω. This finishes the proof of (35), and also completes the proof
that pt is a weak solution of of equation (8).
Now we have proven the existence of the weak solution. The regularity and uniqueness of the
solution follows the same analysis of Proposition 5.1 in (Jordan et al., 1998).
17