Figure 1: Overall pipeline of FIFO. For each iteration of training, the fog-pass filtering moduleand the segmentation network are updated alternately. (top) Given Gram matrices of feature mapsof the segmentation network as input, the fog-pass filtering module learns to extract fog factors,which are drawn together if they are from the same fog domain so that fog conditions of images arediscriminated by their fog factors. (bottom) The segmentation network is trained by reducing thegap between fog factors of images with different fog conditions as well as by the segmentation loss.
Figure 2: A schematic of FIFO. (a) The fog-pass filtering modules. Each of them takes as inputthe upper triangular part of a Gram matrix and returns a fog factor. The loss pulls or pushes a pairof fog factors according to the equivalence of their fog conditions. (b) Training of the segmentationnetwork with the frozen fog-pass filters. Given a pair of images with different fog conditions asinput, the network is trained by closing the gap between their fog factors and that between theirsegmentation predictions as well as by the ordinary segmentation loss.
Figure 3: Empirical analysis on the impact of FIFO. (a) 2D visualization of distributions of Grammatrices and their fog factors. (b) Comparison between the quality of k-means clustering of theGram matrices and that of the corresponding fog factors in adjusted Rand index. (c) The fog-stylegap between different domains before and after training with FIFO, where the gap is measured bythe average Hausdorff distance between two sets of fog factors.
Figure 4: Images reconstructed by the baseline, a variant ofFIFO closing the gap between Gram matrices, and FIFO.
Figure 5: Qualitative results on the real foggy datasets. (a) Input images. (b) Baseline. (C) FIFOwithout the fog-pass filtering. (d) FIFO. (e) Groundtruth.
Figure 6: Independence scoreof fog factors and Gram ma-trices on content factors.
Figure 7: Additional qualitative results on the real foggy datasets. (a) Real foggy images. (b)Baseline. (c) FIFO closing the gap between gram matrices. (d) FIFO. (e) Groundtruth.
Figure 8: Additional qualitative results on image reconstruction. (a) Real foggy images. (b)Baseline. (c) FIFO closing the gap between gram matrices. (d) FIFO.
