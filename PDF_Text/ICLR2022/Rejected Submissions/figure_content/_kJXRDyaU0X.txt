Figure 1: We focus in imitation learning in the presence of temporally correlated perturbations(exogenous noise, (a)) or not having access to the full state (endogenous noise, (b)). We formalizeboth in a graphical model (c) that allows us to leverage a technique known as instrumental variableregression to find a policy that isn’t corrupted by spurious correlations introduced by the confounder.
Figure 2: The structuralcausal model (SCM) we con-sider. We are interested infinding h, the causal rela-tionship from X to Y , eventhough there is an unobservedconfounder, U . To do so,we leverage the effect of Z,which provides independentrandomness from U.
Figure 4: The SCM for imitation learn-ing with unobserved confounders. Theconfounding is mediated via the dynam-ics into the state, introducing spuriouscorrelations between states (X = st)and actions (Y = at ). To break the con-founding, we can utilize the past state asan instrument (Z = st-1).
Figure 5: DoubIL deconfoundsinputs to the second stage by re-simulating state transitions.
Figure 6: We train behavioral cloning, DoubIL, and ResiduIL on trajectories from a modified Lu-narLander environment, computing standard errors across 5 runs. The left plot shows that DoubILand ResiduIL are better able to match the desired E[a|do(s)] on states from expert rollouts, whilethe middle plot shows they are able to generalize better to the state dist. of an expert w/o noise. Theright plot shows how we can compare the results of behavioral cloning and causal IL procedures toidentify areas of the state space where the effect of confounding is strong (the red dots).
Figure 7: We compute κ(Π)for an LQG problem wherewe vary the number of steps aconfounder sticks around for.
