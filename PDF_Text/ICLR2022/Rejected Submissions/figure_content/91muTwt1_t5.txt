Figure 1: Geometric Editing for 3D Molecular GenerationRigid Fragment Library Single bond rotation is the major cause of dihedral angle changes, assingle bond is less constrained and has lower rotational energy barrier comparing to double bondsand bonds in ring structures. Therefore, we construct a rigid fragment library by breaking singlebonds in 2D molecules from the ChEMBL database (Gaulton et al., 2017), which is a manually cu-rated database of bioactive molecules with drug-like properties. As shown in Figure 1 top right, thebroken bond for generating fragments are labeled as an editable site for molecular construction anda hydrogen atom is added to maintain the original valency3 . The same 2D fragment with differenteditable sites are merged as one member in the library and the editable sites are combined. The3D conformation of the resulted fragments are generated using RDKit (Landrum, 2021). As rota-tional flexibility is constrained inside fragment, each 2D fragment only corresponds to one or a fewvalid 3D conformations and each conformation is considered as a separate member in the fragmentlibrary.
Figure 2: Proposal Architecture for Editing Operation Prediction.
Figure 3: 3D Binding Pose Comparison between Existing Actives and Generated Molecules4.3 Ablation StudyIn this section we study the contributions of HMPNN model and weighted maximum likelihood esti-mation loss in the adaptive proposal using JNK3 target. The comparisons are performed using 1000sampling chains. Table 2 summarizes the performance of different proposal strategies. Randomrepresents a proposal which randomly selects any bonds and fragments to modify the molecularstructure. HMPNN (Random Weight) represents HMPNN model with random weights. MPNNstands for using MPNN to propose editing operations, whereas, HMPNN indicates the use of hier-archical MPNN instead. Except for the Random proposal, all other proposals only allows editingon the fragment level as part of our architecture design. In addition, all proposals are equipped withsimulated annealing for property optimization. The results indicates the adaptive proposal parame-terized using HMPNN is better than the random proposal reflected by the Prod score, median and top10 Vinadock scores. HMPNN (Random Weight) shows better performance than Random proposalin the Prod score and obtains similar performances on Vinadock scores, which reflects editing on thefragment level is more effective in drug-like space exploration. Comparing to MPNN model, theaddition of a fragment layer also leads to a performance increase in Prod score and Top 10 Vinadockand achieves a comparable result in Median Vinadock .
Figure 4: Visualization of Properties Changes Over Steps. A. Chemical Space Coverage. Visu-alization of chemical space coverage at step 10 (black), step 100 (yellow) and step 1000 (red).
