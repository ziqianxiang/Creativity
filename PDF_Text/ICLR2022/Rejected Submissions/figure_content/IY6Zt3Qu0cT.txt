Figure 1: Overview of Fragment-based Sequential Translation (FaST). FaST is trained in a two-stepfashion. In the first step, we train a VQ-VAE that embeds molecular fragments. In the second step,we train a search policy that uses the learned latent space as an action space. The search policystarts an episode by sampling a molecule from the frontier set F, which consists of an initial set ofstarting molecules (I), and good molecules discovered by the policy (C). The molecule is encodedby an MPNN, which is then used to predict either an Add or Delete action. When the Add action isselected, the model predicts and samples an atom as the attachment point and subsequently predictsa fragment to attach to that atom. When the Delete action is selected, the model samples a directededge, indicating the molecular fragment to be deleted.
Figure 2: Comparison of the sample complexity of different methods. The x-axis is the number ofmolecules searched through and the y-axis is the number of discovered molecules, where the target isto obtain a set of 5,000 molecules that achieves SR = 1, Nov = 1 and Div = .7. Our method (FaST)achieves the best sample complexity with 71k molecules visited. Fast+50k and MARS+50k are theirrespective models trained with the same fixed fragment vocabulary extracted from ChEMBL.
Figure 3: (a, b) plots the t-SNE embedding of fragments from generated compounds of our modelvs. Rational-RL and MARS. The visualization shows that that our model produces a much morediverse set of fragments, which is a proxy for functional groups appearing in generated molecules.
Figure 4: (a) t-SNE of fragments sampled from a trained VAE and VQ-VAE. The fragments sampledfrom the VAE are tightly clustered, showing much less diversity compared to the fragments sampledfrom the VQ-VAE. (b,c) Random samples from the VAE (b) and the VQ-VAE (c). “A” denotes theattachment point for the fragment. We see that the samples from the VAE are relatively simple.
Figure 5: Sample translation of our model for the constrained penalized logP task (δ = 0.6).
Figure 6: Samples of FaST on the GSK3β+JNK3+QED+SA task. Red indicates the atoms andbonds that are eligible for addition/deletion, while green indicates the selected atom or bond.
Figure 7: Randomly sampled molecules generated by FaST on the GSK3β+JNK3+QED+SA task.
Figure 8: Comparison of reconstruction accuracy when using SMILES string vs SELFIES string.
