Figure 1: Comparison betWeen stochastic rounding (SR) and round-to-nearest (RDN) quantization.
Figure 2: The effect of LUQ on the neural gradients histograms for one layer of ResNet18 Cifar100dataset, with the underflow threshold α (red dashed line). The first step (green arrow) represents theeffect of stochastic pruning (Eq. (15)) on the neural gradient. The second step (grey arrow) representsthe logarithmic unbiased quantization (Eq. (16)), that quantize all the values |x| > α.
Figure 3: (a): ResNet50 top-1 validation accuracy in ImageNet dataset with different quantizationschemes for the neural gradients. SP refers to stochastic pruning (Eq. (15)). RDNP refers to round-to-nearest-power (Eq. (19)). Notice that with the suggested LUQ we are able to almost close thedegradation from baseline. (b): ResNet18 top-1 validation accuracy in CIFAR100 with quantizationof the neural gradients to 2-bit (FP2 - [1,1,0] format) using different samples numbers to reduce thevariance. Notice that 16 samples completely close the gap to the baseline.
Figure 4: (a): Standard MAC block illustration containing the two main blocks - one for GEMM andsecond for accumulator. The GEMM block for hybrid datatype as in our case (FP4 and INT4) requiresa casting to a common datatype before being inserted into the multiplier. (b): The suggested MACblock, which replace the multiplier with the proposed MF-BPROP. Instead of doing an expensivecasting followed by a multiplication, we propose to make only a simple XOR and a transformation(Appendix A.3) reducing the GEMM area by 5x (Appendix A.4).
Figure 5: (a): Comparison of the top-1 validation accuracy in ResNet-50 ImageNet dataset with theproposed LUQ and with the quantization dynamic range approximation in In-hind Fournarakis &Nagel (2021) in 4-bit training. (b): Comparison of ResNet-18 3 bit training on Cifar100 dataset ofLUQ with 2 samples with longer training of regular LUQ. Both methods have similar overhead, butthe SMP method leads to better accuracy.
Figure 6: Illustration of MF-BPROP block which replaces a standard multiplication. It includes: (1)a simple xor operation between the sign. (2) A transform to standard FP7 format. We present thetable to make this transform - E and M represent the bits of the FP4 and INT4 respectively withoutthe sign. Exp and Mant are the bits of the output exponent (4-bit) and mantissa (2-bit) of the outputin FP7 format.
