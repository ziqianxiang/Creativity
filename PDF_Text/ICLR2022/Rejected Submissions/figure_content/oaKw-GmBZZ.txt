Figure 1: (a) A square domain with structuredmesh discritization (b) A curved domain with anunstructuredd2unj/dx2 = (Un+1,j - 2unj + Un+1j) ∕δχ2,and etc. Re-writing the equation for an arbitrary discretized point, we finduin,+j 1 = uin,j +δtFwhere F = α (ui,j +1 — ui,j ) + α (ui,j-1 — ui,j ) + β (ui+1,j — ui,j ) + β (ui-1,j — ui,j ), whereα = Dδt∕δx2 and β = Dδt∕δy2. Solving for this equation for all the points along with the boundaryconditions the updates for the discretized points can be achieved. Note that here the update rulecan be seen as the summation of updates that only depend on neighboring points. Although inthis example with a simple linear equation and a structured grid it was easy to find the update ruleF, given an arbitrary domain that requires a triangular mesh for discretization (see Fig. 1b) and anonlinear governing equation the update rule is not straight forward to be worked out. Our objectivehere is to learn the approximation of the differential operator using a graph representation of thedomain with message passing neural networks. Since in a general PDE the differential operatorF(u, Vu, V2u,… ;λ) contains local spatial derivatives and only local neighboring values at a pointare relevant to approximate the differential operator at that point. As a result, a graph neural networkis a promising framework to approximate the above right-hand side for the next value predictions.
Figure 2: (a) Example of a physical domain governed by the time dependent PDE ut = N (u; λ), andthe spatial discretization that represents a graph structure. The inset figure shows the node features uiand the edge features on the mesh eij . (b) Graphical representation for one layer pass of messagepassing neural network: given node values ui(k) and edge attributes eij , a message is generatedfor each edge such that mi(jk) = φ(k) ui(k) , u(jk) , eij where φ(k) is a neural network; next, givenaverage message value N Pj∈M(i) m(k) and the node features u(k), the next feature set u(k+1) forthe nodes are obtained using another neural network γ(k) .
Figure 3: Message passing graph neural network learning to predict the heat equation: Input dataframes (first four columns), prediction (fifth column), and ground truth (the last column) for threedifferent test cases in each row. The simulation data corresponds to the heat equation 4 with differentboundary conditions. The first four columns correspond to the results with ∆t = 20δ time difference,and the network predicts the results for the next frame with ∆t = 20δt after the last frame. Theaverage MSE loss for the test data is 5.1 × 10-6.
Figure 4: MPGNN trained on a square domain, predicting the values on a new unseen physicaldomain. We train an MPGNN to predict the heat equation on a square domain (see figure 3). Next, weuse the sample MPGNN to predict the PDE values on an unseen geometry and boundary conditions.
Figure 5: MSE error tried on thesame and different geometry versusnumber of input framesand calculating the final average MSE error on the test data set on both similar and different geometry.
Figure 6: (a) Schematic of a recurrent message passing graph neural network (R-MPGNN) learningto predict the heat equation: input data are the initial three frames (t1, t2, t3) and the network predictsthe next time step (t4 ). In the next layer the output of the previous layer t4 is concatenated to the lasttwo frames t2 , t3 to create the input for the next layer (t2 , t3 , t4), and so on. (b) Test data input andoutputs for the R-MPGNN predicting the next frames in time in comparison with the ground truth.
Figure 7: MPGNN trained Navier-Stokes equation with periodic boundary condition. Each rowrepresents a different test simulation, where the first five columns are the input frames and the lasttwo columns are respectively the MPGNN prediction and the ground truth result. We find that theaverage L2 error for the test data is 5.4 × 10-5 .
Figure 8: MPGNN trained to predict advection-diffusion equation with horizontal periodic boundary.
Figure 9: Schematic of a nodes and edges for a simulation with a periodic boundary condition.
