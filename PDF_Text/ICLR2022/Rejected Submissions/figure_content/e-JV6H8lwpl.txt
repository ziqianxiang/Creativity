Figure 1: Proposed network structure. The sequences of past inputs utp and outputs ytp are oncecompressed into state variables Xt, and then reflected in the prediction of the sequence of futureoutputs ytf .
Figure 2: Result of tracking controlThen, to support the interpretation discussed in section 4, figure 3 shows the visualization of thestate estimator and predictor at the operating point at t = 50, where the change in water level isslow and nonlinearity is expected to be weak. The dashed lines in figures 3(a)-(c) and the bitmapon the right in figure 4(d) show the corresponding properties of the linearized system of (23) at theoperating point. Since linear systems also have degrees of freedom in how they coordinate in statespace, a transformation matrix Φ := PxJ 翁 ∈ Rnx ×nx is used to align the coordinate system. Fromfigures 3(a) and (b), the state estimator E obtained by the proposed method agrees well with theKalman filter for the linearized system of the true system, and it can be confirmed that the proposedmethod yields almost optimal state estimators as expected for subspace methods in an ideal situationwith sufficient data. It can also be seen that the predictor is consistent with the true system.
Figure 3: Visualization of E and P at t = 50(a) Markov parameters of state estimator for up(solid : (∂E ):j , dashed : (φ->Eu)J(c) Predictor unforced response(solid : (∂∂P)i,: ,dashed : (PxΦ)i,)120(P U)i；j! @P"∂uf i ij1	20 1	20j	jU 0.060.040.02(b) Markov parameters of state estimator for yp(Solid :(源)Jdashed : (φ->Ey)：j)(d) Predictor Markov parametersFigure 4:	Visualization of E and P at t = 3808
Figure 4:	Visualization of E and P at t = 3808Under review as a conference paper at ICLR 2022figure 4(d), the Toeplitz structure of linear systems is partially lost, indicating the existence of non-linearity. In figures 4(a) and (b), it can be seen that an estimator that is less dependent on the outputand more focused on the recent input than the Kalman filter for the linearized system is obtained.
Figure 5:	Width of bottleneck n^ and performancethe performance does not degrade until the width of the bottleneck n^ goes below the actual statedimension nx = 2. Also, the performance of the MPC calculated by Pt4=00h +1 lt(ut, xt,2) does notshow degradation until n^ < nx = 2 as shown in figure 5(b), and these results support the use ofthe bottleneck to provide interpretability.
Figure 6: Visualization of E and P for linear caseXt；1(a) Trajectory of actual state xtXt；1(b) Trajectory of state estimate XtFigure 7: Comparison of actual state and model state300100200 00D Supplementary ExampleTo demonstrate the applicability to high dimensional systems, the proposed method is applied tothe problem of estimating the dynamics of video discussed in (Beintema et al., 2021). Consider anenvironment where a nonlinear force acts a ball and we observe it with a camera of 25 × 25 pixels.
Figure 7: Comparison of actual state and model state300100200 00D Supplementary ExampleTo demonstrate the applicability to high dimensional systems, the proposed method is applied tothe problem of estimating the dynamics of video discussed in (Beintema et al., 2021). Consider anenvironment where a nonlinear force acts a ball and we observe it with a camera of 25 × 25 pixels.
Figure 8:	Validation of model dynamics (above: images from target system without noise, below:images from constructed model)actual image without noise, indicating that the dynamics are correctly learned. A video version offigure 8 is provided in the supplementary material as actual-simulated.mp4.
Figure 9:	(Top) noiseless images, (Middle) noisy images, (Bottom) denoised imagesthe proposed method. A video version of figure 9 is provided in the supplementary material asactual-noisy-denoised.mp4.
