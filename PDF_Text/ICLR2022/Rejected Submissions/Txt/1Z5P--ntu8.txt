Under review as a conference paper at ICLR 2022
On the Global Convergence of Gradient De-
scent for multi-layer ResNets in the mean-
FIELD REGIME
Anonymous authors
Paper under double-blind review
Ab stract
Finding the optimal configuration of parameters in ResNet is a nonconvex mini-
mization problem, but first order methods nevertheless find the global optimum
in the overparameterized regime. We study this phenomenon with mean-field
analysis, by translating the training process of ResNet to a gradient-flow partial
differential equation (PDE) and examining the convergence properties of this limit-
ing process. The activation function is assumed to be 2-homogeneous or partially
1-homogeneous; the regularized ReLU satisfies the latter condition. We show that
if the ResNet is sufficiently large, with depth and width depending algebraically
on the accuracy and confidence levels, first order optimization methods can find
global minimizers that fit the training data.
1	Introduction
Training of multi-layer neural networks (NN) requires us to find weights in the network such that its
outputs perfectly match the prescribed outputs for a given set of training data. The usual approach
is to formulate this problem as a nonconvex minimization problem and solve it with a first-order
optimization method based on gradient descent (GD). Extensive computational experience shows
that in the overparametrized regime (where the total number of parameters in the NN far exceeds the
minimum number required to fit the training data), GD methods run for sufficiently many iterations
consistently find a global minimum achieving the zero-loss property, that is, a perfect fit to the training
data.
What is the mechanism that allows GD to perform so well on this large-scale nonconvex problem?
Part of the explanation is that in the overparametrized case, the parameter space contains many
global minima, and some evidence suggests that they are distributed throughout the space, making
it easier for the optimization process to find one such solution. Many approaches have been taken
to characterize this phenomenon more rigorously, including landscape analysis, the neural tangent
kernel approach, and mean-field analysis. All such viewpoints aim to give an idea of the structure
and size of the NN required to ensure global convergence.
Our approach in this paper is based on mean-field analysis and gradient-flow analysis, the latter being
the continuous and mean-field limit of GD. We will examine residual neural networks (ResNets),
and study how deep and wide a ResNet needs to be to match the data with high accuracy and high
confidence. To relax the assumptions on the activation function as far as possible, we follow the
setup in (Chizat & Bach, 2018), which requires this function to be either 2-homogeneous or partially
1-homogeneous. We show that both depth and width of the NN depend algebraically on and η,
which are the accuracy and confidence levels, respectively.
Mean-field analysis translates the training process of the ResNet to a gradient-flow partial differential
equation (PDE). The training process evolves weights on connections between neurons. When dealing
with wide neural networks, instead of tracing the evolution of each weight individually, one can
record the evolution of the full distribution of the weight configuration. This perspective translates
the coupled ordinary differential equation system (ODE) that characterizes evolution of individual
weights into a PDE (the gradient-flow equation) characterizing the evolution of the distribution. The
parameters in the PDE naturally depend on the properties of the activation functions. Gradient-flow
1
Under review as a conference paper at ICLR 2022
analysis is used to show that the PDE drives the solution to a point where the loss function becomes
zero. We obtain our results on zero-loss training of ResNet with GD by translating the zero-loss
property of the gradient-flow PDE back to the discrete-step setting.
This strategy of the proof was taken in an earlier paper (Ding et al., 2021) where multi-layer ResNets
were also analyzed. The main difference in this current paper is that the assumptions on the activation
function and the initial training state for obtaining the global convergence are both much relaxed. This
paper adopts the setup from (Chizat & Bach, 2018) of minimal Lipschitz continuity requirements on
the activation function. Furthermore, the paper (Ding et al., 2021) required a dense support condition
to be satisfied on the final parameter configuration has a support condition. This condition is hard
to justify in any realistic setting, and is discared from current paper. Further details on these issues
appear in Section 3.
We discuss the setup of the problem and formally derive the continuous and mean-field limits in
Section 2. In Section 3, we discuss related work, identify our contribution and present the main
theorem in its general terms. After precise definitions and assumptions are specified in Section 4, we
present the two main ingredients in the proof strategy. The mean-field limit is obtained by connecting
the training process of the ResNet to a gradient-flow PDE in Section 5, and the zero-loss property of
the limiting PDE is verified in Section 6. The main theorem is a direct corollary of Theorem 5.1 and
Theorem 6.1 (or Theorem 6.2).
2	ResNet and gradient descent
The ResNet can be specified as follows:
1M
zl+1(X)= ZI (X) + ML	f (zl(x), θl,m) , l =0, 1,...,l - 1 ,	(I)
m=1
where M andL are the width and depth, respectively; z0 (X) = X ∈ Rd is the input data; and
zL (X) is the output from the last layer. The configuration of the NN is encoded in parameters
ΘL,M = {θl,m }lL=-01,m,M=1 , where each parameter θl,m is a vector in Rk and f : Rd × Rk → Rd is the
activation function. The formulation (1) covers“conventional” ResNets, which have the specific form
1M
zl + 1(X) = Zl(X) + ml E Uι,mσ(w>mzι (X) + bl,m) , l = 0, 1, ..., L - 1 ,
m=1
where Wl,m, Ul,m ∈ Rd, bl.m ∈ R, and σ is the ReLU activation function. In this example, we have
θl,m = (Wl,m, Ul,m, bl,m) ∈ Rk, with k = 2d + 1.
Denote by ZΘL,M (l; X) the output of the ResNet defined by (1). (This quantity is the same as zL(X)
defined above, but we use this alternative notation to emphasize the dependece on parameters ΘL,M .)
The goal of training ResNet is to seek parameters ΘL,M that minimize the following mismatch or
loss function:
12
E(θL,M) = Ex〜μ 2 (g(ZΘl,M (L； X))- y(X)),	⑵
where g(∕) : Rd → R is a given measuring function, y(∕) ∈ R is the label corresponding to x, and μ
is the probability from which the data X is drawn.
Classical gradient descent updates the parameters according to the formula
ΘL+M = θl,m - hVθE(θL,M),
where h is the step length. In the limit as h → 0, the updating process can be characterized by the
following ODE (Chizat & Bach, 2018, Def 2.2) (rescaled byL, M):
dθL,M (S)
ds
-MLVΘE(ΘL,M),
for s ≥ 0 ,
(3)
where s represents pseudo-time, the continuous analog of the discrete stepping process.
2
Under review as a conference paper at ICLR 2022
2.1	The continuous limit and the mean-field limit
The continuous limit of (1) is obtained when the ResNet is infinitely deep, with L → ∞. By
reparametrizing the indices l = [0, ∙∙∙ ,L - 1] with the continuous variable t ∈ [0,1], We can view Z
in (1) as a function in t that satisfies a coupled ODE, with 1/L being the stepsize in t. Accordingly,
θl,m can be recast as θm(t = l/L), and denoting Θ(t) = {θm(t)}mM=1, we can write the continuous
limit of (1) as
dz(t; x)	1 M
-dt- = Mff(Z (t x),θm(t)), t ∈ [0,1],	with z(0; X)= x.
m=1
Extending (2), we define the cost functional E as
E(Θ) = Ex~“ 2(g(Zθ(1;X))- y(x))2
(4)
(5)
where ZΘ(t; X) solves (4) for a given collection Θ(t) of the M functions {θm(t)}. Similar to (3),
we can use GD to find the configuration of Θ(t) that minimizes (5) by making Θ(t) flow in the
descending direction of E(Θ). Denote s the pseudo-time of the training process, and Θ(s; t) the
collection of functions at the training time s:
∂Θ	δE
--=-M --
ds	δθ Θ(s;.)
s >0,	t ∈ [0, 1]
(6)
where δΘΘ is the functional derivative of E with respect to Θ, and thus a list of M functions of t for
every fixed s.
The mean-field limit is obtained by making the ResNet infinitely wide, that is, M → ∞. Considering
that the right hand side of (4) has the form of an expectation, it approaches an integral in the limit,
with respect to a certain probability density. Denoting this PDF by ρ(θ, t) ∈ C([0, 1]; P2)1, and
assuming that the θm are drawn from it, the ODE for Z translates to the following:
dz^ = Z f(z(t; x),θ)dρ(θ,t),
dt	Rk
t ∈ [0, 1] with Z(0; X) = X .
(7)
Mimicking (5), we define the following cost function in the mean-field setting:
E(P)= Ex~μ 1 (g(Zρ(1; X)) -y(X))2 ,	⑻
where Zρ(t; X) is the solution to (7) for a given ρ. Then, similar to the gradient flow for ΘL,M
and Θ(t), the probability distribution ρ that encodes the configuration of θ flows in the descending
direction of E(ρ) in pseudo-time s. Since ρ(θ, t, s) needs to be a probability density for all s and t,
its evolution in s is characterized by a gradient flow in the Wasserstein metric (Chizat & Bach, 2018;
Lu et al., 2020; Ding et al., 2021):
=- = Ne ∙	ρ 3θ ~Γ~	) ,	s > 0, t	∈	[0, 1] with P(θ, t, 0) = Pini(θ, t) ,	⑼
ds	∖ δρ P"))
where δp is the functional derivative with	respect to	ρ,	and thus a function of (θ, t) for every fixed	s.
Using the classical	calculus-of-variations	method, this	functional derivative can be computed as:
δE
δP
(θ,t) = Eχ~μ (p>(t; x)f (Zρ(t; x),θ)),
ρ
(10)
where pρ(∙; x), parameterized by x, maps [0,1] → Rd, and is a vector solution to the following ODE:
-dt~ = -p> Z Jzf (ZP ,θ)ρ(θ,t)dθ.
(11)
1A collection of probability distribution that is continuous in t and has bounded second moment in θ for all t.
The definition is to be made rigorous in Def 4.1.
3
Under review as a conference paper at ICLR 2022
with pρ(t = 1; x) = (g(Zρ(1; x)) - y(χ)) Pg(ZP(1; x)). In the later sections, to emphasize the S
dependence, we use δE(ΘΘ(S)) and δE(P(S)) to denote 焉乜3.)and 用()respectively. As a
summary, to update ρ(θ, t, s) to ρ(θ, t, s + δs) with an infinitesimal δs, we solve (7) for Zρ(t; x),
using the given ρ(θ, t, s), and compute pρ using (11). This then allows us to compute δE(ρ(S)) (θ, t)
which, in turn, yields ρ(θ, t, s + δs) from (9). In (11), ∂zf is a d × d matrix that stands for the
Jacobian of f with respect to its z argument.
3	Related work and Contribution
There is a vast literature addressing the overparameterization of DNN. Many perspectives have been
taken to justify the success of the application of the first order (gradient descent) optimization methods,
in this overparameterized regime. We briefly review related works, and identify our contribution.
The earliest approach to understanding overparametrization was landscape analysis, in which the
countours of the nonconvex objective function were studied to find which properties make it possible
for a first order method to converge to the optimizer. Different NN structures are then analyzed to see
which have these properties (Jin et al., 2017; Ge et al., 2015; Du et al., 2017; Ge et al., 2018; Nguyen
& Hein, 2018; Du & Lee, 2018; Soltanolkotabi et al., 2019; Nguyen & Hein, 2017; Kawaguchi, 2016;
Yun et al., 2018). This approach naturally limits the types of DNN that can be “explained,” since
most DNN structures do not satisfy the required properties.
Another approach taken in the literature is related to the Neural Tangent Kernel (NTK) regime,
which is the regime in which the nonlinear problem is reduced to a nearly linear model due to the
confinement of the iterates to a small region around the initial values. Insensitivity of the so-called
Gram matrix is evaluated in the limit of the number of weights (Allen-Zhu et al., 2019; Du et al.,
2019a; Zhang et al., 2019; Chatterji et al., 2021; Du et al., 2019b; Jacot et al., 2018; Liu et al., 2020;
Frei et al., 2019). The argument is that zero-loss solutions are close to every point in the space,
and one can find an optimal point within a small region of the initial guess. The NTK arguments
are shown to work well in several real application problems, such as the classification problem (Li
& Liang, 2018; Zou et al., 2019). However, as pointed out by (Ba et al., 2020; Wei et al., 2019;
Fang et al., 2019), NTK approximately views nonlinear DNN as a linear kernel model, a rather
limited description, so the estimates obtained through NTK might not be sharp. Indeed, the empirical
observation in (Allen-Zhu & Li, 2019; Arora et al., 2019) have suggested that the kernel models are
not as general as NN, and certain (nonlinear) features of NN are not captured.
Finally, there is the mean-field limit perspective that we adopt in this paper. The term “mean-field"
indicates that in a system with a large ensemble of particles, the field formed by averaging across
all samples exerts a force on each sample. Instead of tracing the trajectory of each sample, one can
characterize the evolution of the full distribution function that represents the field. This idea originated
in statistical physics, and is made rigorous under the framework of kinetic theory. In training an
overparametrized ResNet context, a large number of weights evolve to decrease the cost function.
In the mean-field limit, the training process evolves the distribution function of these weights. A
significant advantage of the mean-field approach is that once we derive a formula for the gradient flow,
standard PDE techniques can be adopted to describe the convergence behavior. This approach was
taken in (Araujo et al., 2019; Fang et al., 2019; Nguyen, 2019; Du et al., 2019a; Chatterji et al., 2021;
Chizat & Bach, 2018; Mei et al., 2018; Wojtowytsch, 2020; Lu et al., 2020; Sirignano & Spiliopoulos,
2021; 2020). The case of a single hidden layer NN in the regime as M → ∞ is studied by Chizat
& Bach (2018); Mei et al. (2018); Wojtowytsch (2020), who justified the mean-field approach and
demonstrated convergence of the gradient flow process to a zero objective. In the multi-layer case,
Lu et al. (2020) showed the convergence of a PDE that can be viewed as a modified version of the
true gradient flow, hinting at convergence of the real mean-field limit. Nguyen & Pham (2021) also
gave the global convergence of the mean-field limit of DNN for a certain class of NN structures, but
their work excludes such important practical NN structures as ResNet. The work most closely related
to ours is (Ding et al., 2021), but this paper makes technical assumptions on ρ∞ and f that restrict
the usefulness of the results, as we discuss below following the statement of Theorem 3.1.
We note that in certain parameter regimes, the mean-field and NTK perspectives can sometimes be
unified; see (Chen et al., 2020).
4
Under review as a conference paper at ICLR 2022
We follow the roadmap of Chizat & Bach (2018); Ding et al. (2021), which shows that the PDE (9)
achieves the global minimum for which E(ρ(θ, t, s = ∞)) = 0, and that the gradient flow in the dis-
crete setting (3) can be closely approximated by the PDE, Sothat E(Θl,m(S)) ≈ E(ρ(∙, ∙,s)). These
two results together show that E (ΘL,M (s)) ≈ 0 for pseudo-time s sufficiently large. Specifically,
the two main tasks of the paper are as follows.
一 Task 1: We need to give a rigorous proof of the continuous and mean-field limit. This
will be stated in Theorem 5.1, to justify that for every fixed s < ∞, when M, L → ∞,
E(Θl,m(S)) ≈ E(Θ(s; ∙)) ≈ E(ρ(∙, ∙, s)). The dependence of these approximations on L
and M are made precise.
一 Task 2: We need to demonstrate the convergence to global minimum. This is stated
in Theorem 6.1 and 6.2, for two different cases. In both theorems, we obtain the global
convergence for the gradient flow, assuming certain homogeneity and the Sard-type regularity
for f . A weak assumption of the initialization of ρini is also imposed.
By combining these two, we obtain the main result of the paper.
Theorem 3.1 Let the conditions in Theorem 5.1 and 6.1 (or 6.2) hold. Then for any positive and η,
there exist positive constants C0 depending on ρini(θ, t), and C depending on ρini (θ, t), S such that
when
C(ρini(θ, t), S)	C(ρini(θ, t), S)
s > Co(Pini(θ,t),e), M > ---------西-------, L > -----------------,
we have
P(∣E(Θl,m(s))| ≤ -) ≥ 1 - η,
where E is defined in (2) and ΘL,M solves (3).
This theorem gives quantitative bounds for M and L. The number of weights required to reduce
the cost function below - is O(M L) = O(1/-3). The theorem also suggests that L and M are
independent parameters.
The results resonate with those obtained in (Chizat & Bach, 2018) for the 2-layer NN, and extend
those in (Ding et al., 2021) greatly. Specifically, compared with the results in (Chizat & Bach, 2018),
where ρ(θ, S) follows a typical gradient flow in the probability space on θ in time S (Ambrosio et al.,
2008), we have, at each training time S, a “list” of probability measures ρ(θ, t) on θ, for all t. The
members of this list are coupled, flowing together in S in the descending direction of the cost function
E. New analytical estimates are developed to deal with this non-traditional gradient flow.
Ding et al. (2021) takes a similar approach to ours, but their assumptions on the support of ρ(θ, t, S =
∞) are quite strong: The limiting probability measure ρ(θ, t, S = ∞) is assumed to have the
full support over θ. The assumption greatly reduces the technical difficulty of the proof, but it
is impractical and hard to justify, thus preventing the results from being of practical use. In the
current paper, this support condition is replaced by the well-accepted homogeneity condition adopted
by (Chizat & Bach, 2018). As a consequence, the structure of the gradient flow must be examined
closely to demonstrate convergence, requiring considerable technical complications. Lu et al. (2020)
also investigates gradient flow for training multi-layer neural network, but the gradient flow structure
is modified for mathematical convenience. All blocks are integrated together, making ρ a probability
measure over the full (θ, t)-space. This design is inconsistent with the structure of the ResNet design
that we investigate in this paper.
4	Notations, Assumptions, and Definitions
Throughout the paper we denote the collection of probability distributions with bounded second
moments as P2(Rk), that is, P2(Rk) = {ρ : Jrx ∣θ∣2 dρ(θ) < ∞}. We assume certain regularity
properties for the activation function f, the measuring function g, the data y, and the input measure
μ, as follows.
Assumption 4.1 (Assumptions on f) Let f : Rd × Rk → Rd be a C2 function.
1.	(linear growth) For all x ∈ Rd, θ ∈ Rk, there is a constant C1 such that
If I ≤ Cι(∣θ∣2 + i)(∣χ∣ + 1).	(12)
5
Under review as a conference paper at ICLR 2022
2.	(locally Lipschitz) For all r > 0, and |x| < r, θ ∈ Rk, we have for C2 (r) monotonically
increasing with respect to r that the following bounds hold:
∣∂χf∣≤ C2(r)(∣θ∣2 + 1),	∣∂θf | ≤ C2(r)(∣θ∣ + 1).	(13)
3.	(local smoothness) There exists k1 ∈ (0, k] with the following property: Denoting θ =
(θ[i],θ[2]), r = max{∣x∣, ∣θ[i] |}, where θ[i] ∈ Rk1, θ[2] ∈ Rk-k1, we have for C3(r)
monotonically increasing with respect to r that the following bounds hold:
∂xi ∂θj f (x, θ) ≤C3(r),	i+j=2, i,j ≥0.	(14)
When k1 < k, we have in addition that
max{∣∂χf∣,∣f∣} ≤ C3(r)(∣θ[2]∣ + 1),®”f| ≤ C3(∣x∣) (∣θ[i] | + 1).	(15)
4.	(universal kernel) The function set hh = Rk f(x, θ) dρ(θ), ρ ∈ P2 (Rk) is dense in
C (|x| < R; Rd) for all R > 0.
Assumption 4.2 (Assumptions on data) Let g,y : Rd → R be C2 functions, and let μ be the
probability distribution of x. We assume the following.
5.	μ(x) is compactly supported, meaning that there is R* > 0 such that the support of μ is
within a ball ofsize Rμ around the origin, that is, supp(μ) ⊂ Br* (~).
6.	y(χ) ∈ L∞∕Rd), that is, sup∣χ∣≤R ∣y(χ)∣ < ∞.
7.	g(x) and Vg(x) are Lipschitz continuous. Moreover, ∣Vg(x)∣ has a positive lower bound,
that is, infχ∈Rd ∣Vg(x)∣ > 0.
We note that Assumption 4.1 admits many commonly used activation functions (E et al., 2020). One
example of a function satisfying this assumption is f(x, θ) = f(x, θ[1] , θ[2] , θ[3] ) = θ[3]σ(θ[1]x+θ[2] ),
where θ[1] ∈ Rd×d, θ[2] ∈ Rd, θ[3] ∈ R and σ is a component-wise regularized ReLU activation
function, see Remark H.2.
We now build the metric on the function space for our solutions. Note that the solution ρ(θ, t, s)
to (9) is expected to be a continuous function in (t, s), and a distribution of θ for each (t, s). For this
non-standard probability space, we first introduce the following metric.
Definition 4.1 2 C([0, 1]; P2) is a collection of continuous paths of probability distribution ν(θ, t)
(θ ∈ Rk ,t ∈ [0,1]) where 1. V (∙,t) ∈ P2 (Rk) for every fixed t ∈ [0,1]; 2. For any to ∈ [0,1],
limt→to W2 (ν(∙,t), v(∙,to)) = 0, where W2 is the classical Wasserstein-2 distance. The space
C([0,1]; P2) is equipped with thefollowing metric di (vι, v2) = SuPt W2(v1(∙,t), v2(∙,t)).
Accordingly, C ([0, ∞); C([0, 1]; P2)) is a collection of continuous paths of probability distribution
v(θ,t, s) (with θ ∈ Rk, t ∈ [0,1], S ∈ [0, ∞)), where 1. V (∙, ∙,s) ∈ C ([0,1]; P2) for every fixed
S ∈ [0, ∞). 2. Forany so ∈ [0, ∞), lims→s° di (ν (∙, ∙, s), V (∙, ∙, so)) = 0 (where di is defined above).
The metric in C([0, ∞); C([0,1]; P2)) is defined by d2 (νι, ν2) = suPt,s W2(ν1(∙,t, s), ν2(∙,t, s)).
Since P2 is complete in W2 distance, C([0, 1]; P2) and C([0, ∞); C ([0, 1]; P2)) are complete metric
spaces under di and d2 respectively also. To give a rigorous justification of the mean-field limit,
we use the particle representation of ρ(θ, t, s). Thus, at least we need to assume that we can find a
stochastic process that is drawn from the initial condition ρini(θ, t). We call such initial conditions
admissible.
Definition 4.2 We call a continuous path of probability distribution V(θ, t) ∈ C([0, 1]; P2) ad-
missible if it has a particle representation, namely there exists a continuous stochastic process
θ(t) : [0, 1] → Rk and r > 0 such that for any to ∈ [0, 1], we have
θ(to)〜V (θ,to), lim E (∣θ(t)- θ(to)∣2) =0,	∣θ(to)∣<r.	(16)
t→t0
2C([0,T]; A) is defined to be the set of functions f (a, t) suchthat for any t ∈ [0,T], f(∙,t) ∈ A and f (∙,t)
is continuous with respect to t under the metric defined on A. In Definition 4.1, we set T = 1 and A = P2,
where the natural metric on A is W2 .
6
Under review as a conference paper at ICLR 2022
Furthermore, ν(θ, t) is called limit-admissible if its M -averaged trajectory is bounded and Lipschitz
with high probability. (See the rigorous definition in Definition E.1.)
We note that without the dependence on t, probability distributions are “admissible", in the sense that
one can draw a sample from a given distribution. In Appendix A, we show that if the initial condition
ρini(θ, t) is admissible, (9) has a unique solution ρ(θ, t, s) that is admissible for each s.
The global convergence result depends on Sard-type regularity, defined as follows.
Definition 4.3 Given a metric space Θ, a differentiable function h : Θ → R, and a subset Θ ⊂ Θ,
we say h satisfies Sard-type regularity in Θ ifthe set ofregular values* 3 of h|& is dense in its range,
where h|& ： Θ → R is a confinement of h in Θ.
Remark 4.1 This regularity assumption is not a common one; we have adopted it from Chizat &
Bach (2018). This property is essentially that most of the points in the range ofh lie in an open set
and h is locally monotonic. The assumption is rather mild and can be satisfied by most commonly
seen regular functions, unless the function oscillates wildly.
5	Mean-field and continuous limit
In this section, we focus on the justification of mean-field and continuous-limit result. This is to prove
that E(ρ(∙, ∙, s)), E(Θ(s; ∙)), and EgLM(S)) are asymptotically close to each other for every s. In
the next section, We prove convergence of E(ρ(∙, ∙, s)) as S → ∞.
To show the asymptotic equivalence of the three quantities, we need to compare (3), (6), and (9), and
take the measurement in E according to (2), (5) and (8).
Theorem 5.1 Suppose that Assumptions 4.1 and 4.2 are satisfied. Assume that ρini (θ, t) is limit-
admissible and suppθ(ρini(θ,t)) ⊂ {θ∣∣θ[i]∣ ≤ R} with some R > 0 for all t ∈ [0,1]. Let
{θm (0; t)}mM=1 in (6) be i.i.d. drawn from ρini (θ, t). Let
•	ΘL,M (S) = {θl,m(S)} be the solution to (3) with initial condition θl,m (S = 0) =
θm(0； L);'	'
•	θm(S; t) be the solution to (6) with the initial condition θm(0; t);
•	ρ(θ, t, S) be the solution to (9) with initial condition ρini (θ, t).
Then for any positive , η, and S, there exists a constant C > 0 that depends on ρini (θ, t) and S such
that when
A/、C(Pini(θ,t),S)	C c C(Pini(θ,t),S)	八
M > ------K-----, L > ------------, s < S ,
2η
we have:
min{P (∣E(Θl,m (S))- E(Θ(s; ∙))∣ ≤ e/2) , P (∣E(Θ(s; ∙)) - E(ρ(∙, ∙,s))∣ ≤ e/2)} ≥ 1 - 1 η.
It follows that
P(∣E(Θl,m(S))- E(ρ(∙, ∙, s))| ≤ C) ≥ 1 - η, ∀s<S.
Here E(Θl,m(s)), E(Θ(s; ∙)), and E(ρ(∙, ∙, s)) are defined in ⑵，(5), and (8), respectively.
The proof of this result appears in Appendix E. This theorem suggests that for every fixed S > 0, the
gradient descent of ΘL,M is approximately the same as the gradient floW of ρ(θ, t), in the sense that
the tWo costs are close to each other With high probability, When L and M are sufficiently large. The
size of the ResNet depends negative-algebraically on C (the desired accuracy) and η (the confidence
of success). The result translates the evolution (gradient descent) of ΘL,M to the evolution (gradient
floW) of ρ(θ, t), and thus matches the zero-loss property of the parameter configuration of a finite
sized ResNet to its limiting PDE, Whose analysis can be performed With standard PDE tools.
31
3For a function h : Θ → R, a regular value is a real number α in the range of h such that h-1 (α) is included
in an open set Where h is differentiable and Where dh does not vanish.
7
Under review as a conference paper at ICLR 2022
The proof of Theorem 5.1 divides naturally into two components. We show that for all s < S,
E(ρ(∙, ∙, S)) ≈ E(Θ(s; ∙)) and E(Θ(s; ∙)) ≈ E(Θl,m(S)) with high probability. The former is
obtained from mean-field limit theory, justifying that the particle trajectory θm(t, s) follows ρ(θ, t, s)
for all t in pseudo-time S ∈ [0, S]. The latter makes use of continuity in t and traces the differences
between θm(L) and θι,m. These two components of the proof are summarized in Theorems E.1 and
E.2, respectively. According to the formula of the Frechet derivatives (10) and (11), the estimates in
these theorems naturally route through the boundedness of pρ, pΘ, pΘL,M, and similarly Zρ,Θ,ΘL,M.
It is technically demanding to derive these bounds, but they are not surprising. We dedicate a large
portion of the appendix to addressing the well-posedness of these systems. See Appendices A-D,
where we show these equations have unique solutions with proper initial conditions, along with the
required bounds. Naturally, these estimates depend on regularity of f, g, y, and μ.
To gain some intuition for the equivalence between (6) and (9), we test them on the same smooth
function h(θ). To test (9), we multiply both sides by h and perform integration by parts to ob-
tain 鼎 RRk hdρ(θ) = - RRk VθhVθδEgs)) dρ. This is to say 鼎E(h) = E(V©hNg型*)∙
Testing h on (6) also gives the same formula. Supposing that P = MM PM= 1 δθm , we have
品E(h) = -M PM=I Vθh(θm) Wθm = — PM=I Vθh(θm)δθm. The right hand side is also
E (VθhVθδE(P(S))∖ if and only if MδEδθ⑻" = VθδE(ρ) (θm,t). This will be shown to hold
δρ	δθm	δρ
true in Appendix F.
6	Convergence to global minimizer
After translating the study of ΘL,M to the study of ρ(θ, t), this section presents results on when and
how E(ρ) converges to zero loss by examining the conditions for the global convergence of (9). We
first identify the property of global minimum.
Proposition 6.1 Suppose that ρ ∈ C ([0, 1]; P2) has E(ρ) > 0. Then for any t0 ∈ [0, 1], there exists
a measure ν(θ) of Rk such that Rk dν(θ) = 0 and
(θ, t0) dν(θ) < 0.	(17)
See Appendix H.1 for the proof of this result. At the stationary point of the cost function, δE (θ, to)=
0, then there is no ν satisfying (17), so E(ρ) is necessarily trivial. Our task now becomes to check
under what conditions on f we can have δE becoming 0 as S → ∞. We give two possibilities, both
requiring a separation initialization and certain homogeneities. In the first case, we require f to be
2-homogeneous, and the result is collected in Section 6.1. In the second case, we require f to be
partially 1-homogeneous; see Section 6.2.
6.1	The 2-homogeneous case
The results in this section are obtained under the following assumption on f. (Functions can be
designed to satisfy this assumption easily; see Remark H.1.)
Assumption 6.1 The function f(x, θ) : Rd × Rk is 2-homogeneous, meaning that f(x, λθ) =
λ2f(x, θ) for all (x, θ, λ) ∈ Rd × Rk × R.
Theorem 6.1 Let Assumption 6.1 and conditions of Theorem 5.1 hold true with k1 = k. Let ρ∞(θ, t)
be the long-time limit of (9), that is, ρ(θ, t, S) converges to ρ∞ (θ, t) in C([0, 1]; P2) as S → ∞. Then
E(ρ∞) = 0 if the following hold:
•	Separation initialization: There exists t0 ∈ [0, 1] such that ρini (θ, t0) separates4 the spheres
raSk-1 and rbSk-1, for some 0 < ra < rb.
4We say that a set C separates the sets A and B if any continuous path in with endpoints in A and B
intersects C.
Lk δp p
8
Under review as a conference paper at ICLR 2022
•	Sard-type regularity: 笔 I	(θ, to) satisfies the Sard-type regularity condition in Sk-I.
ρ ρ∞
A proof appears in Appendix H.2. A corollary of this theorem, when combined with Theorem 5.1
with k1 = k, gives Theorem 3.1, the main result of our paper.
6.2	The partially 1 -homogeneous case
The following assumption is used in this section. (Functions that satisfy this assumption include
regularized ReLU; see Remark H.2.)
Assumption 6.2 Let θ = (θ[1], θ[2]) with θ[1] ∈ R and θ[2] ∈ Rk-1:
1.	(partially 1-homogeneous in θ) f can be written as f(x, θ) = f(x, θ[1] , θ[2] ) =
θ[1]fb(x,θ[2]),
2.	(locally bounded and smooth) For any r > 0, f (x, θ[2] ) is bounded and Lipschitz with
Lipschitz continuous differential for (x, θ[2] ) ∈ Br (~0) × Rk-1.
When Assumption 6.2 holds true, Assumption 4.1 part 3 can be satisfied with k1 = 1. Then, we
introduce the main result in this section.:
Theorem 6.2 Let Assumption 6.2 and conditions of Theorem 5.1 hold true with k1 = 1. Let ρ∞(θ, t)
be the limit of (9) as s → ∞. Then E(ρ∞) = 0 if the following hold:
•	Separation initialization: There exists t0 ∈ [0, 1] such that ρini(θ[1], θ[2], t0) separates the
spheres {-r0} × Rk-1 and {r0} × Rk-1 for some r0 > 0, where θ[1], θ[2] are defined by
Assumption 4.1 item 3 with k1 = 1.
•	Sard-type regularity: δE I	((l,θ[2]),t0) : Rk-I → R satisfies the Sard-type regularity
ρ ρ∞
condition.
•	For any P ∈ C([0,1],P2), define Hr,ρ 仅⑶)=δEpρ)∣~ (l,re^,to) where。⑵=而⑶
with r = ∣Θ2∣ and 京⑵ ∈ Sk-2. Suppose that Hr,ρ converges in CI(Sk-I2) as r → ∞ to a
function H∞,ρ. Furthermore, assume that H∞,ρ∞ satisfies the Sard-type regularity condi-
tion in Sk-2 and that the intersection of regular values of H∞,ρ∞ and δEδPpP) ∣	(1, θ[2], to)
is also dense in the intersection of their range.
The proof is found in Appendix H.3. This result, combined with Theorem 5.1 in the case of k1 = 1,
gives the main result in Theorem 3.1. The assumptions in Theorem 6.2 are rather technical and
seemingly tedious. However, we note that only the first two assumptions — 1-homogeneous and
the separation assumption — are crucial. The third and fourth assumptions concern the regularity
of the Frechet derivative of ρ; they are rather mild and serve to exclude wildly oscillating functions;
see Remark 4.1. Most commonly seen functions are regular enough that these two assumptions are
satisfied.
7	Ethics Statement
This work does not present any foreseeable societal consequence.
8	Reproducibility Statement
The notations, assumptions and definitions are clarified in Section 4. And all proofs appear in the
Appendix.
9
Under review as a conference paper at ICLR 2022
References
Z. Allen-Zhu and Y. Li. What can ResNet learn efficiently, going beyond kernels? In Advances in
Neural Information Processing Systems, volume 32, 2019.
Z. Allen-Zhu, Y. Li, and Z. Song. A convergence theory for deep learning via over-parameterization. In
Proceedings of the 36th International Conference on Machine Learning, volume 97 of Proceedings
ofMachine Learning Research, pp. 242-252. PMLR, 09-15 JUn 2019.
L. Ambrosio, N. Gigli, and G. Savare. Gradient flows: in metric spaces and in the space ofprobability
measures. Springer Science and Business Media. Birkhauser Basel, 2008.
D. Araujo, R. Oliveira, and D. Yukimura. A mean-field limit for certain deep neural networks.
arXiv/1906.00193, 2019.
S. Arora, S. Du, W. Hu, Z. Li, R. Salakhutdinov, and R. Wang. On exact computation with an
infinitely wide neural net. In NeurIPS, 2019.
J. Ba, M. Erdogdu, T. Suzuki, D. Wu, and T. Zhang. Generalization of two-layer neural networks:
An asymptotic viewpoint. In ICLR, 2020.
N. Chatterji, P. Long, and P. Bartlett. When does gradient descent with logistic loss interpolate using
deep networks with smoothed relu activations? arXiv/2102.04998, 2021.
Z. Chen, Y. Cao, Q. Gu, and T. Zhang. A generalized neural tangent kernel analysis for two-
layer neural networks. In Advances in Neural Information Processing Systems, volume 33, pp.
13363-13373, 2020.
L. Chizat and F. Bach. On the global convergence of gradient descent for over-parameterized models
using optimal transport. In Advances in Neural Information Processing Systems, volume 31, 2018.
Z. Ding, S. Chen, Q. Li, and S. Wright. Overparameterization of deep resnet: zero loss and mean-field
analysis. arXiv/2105.14417, 2021.
S. Du and J. Lee. On the power of over-parametrization in neural networks with quadratic activation. In
Proceedings of the 35th International Conference on Machine Learning, volume 80 of Proceedings
of Machine Learning Research, pp. 1329-1338. PMLR, 10-15 Jul 2018.
S. Du, C. Jin, J. Lee, M. Jordan, A. Singh, and B. P6czos. Gradient descent can take exponential time
to escape saddle points. In Advances in Neural Information Processing Systems, volume 30, 2017.
S. Du, J. Lee, H. Li, L. Wang, and X. Zhai. Gradient descent finds global minima of deep neural
networks. In Proceedings of the 36th International Conference on Machine Learning, volume 97
of Proceedings of Machine Learning Research, pp. 1675-1685, 09-15 Jun 2019a.
S. Du, X. Zhai, B. P6czos, and A. Singh. Gradient descent provably optimizes over-parameterized
neural networks. In International Conference on Learning Representations, 2019b.
W. E, C. Ma, S. Wojtowytsch, and L. Wu. Towards a mathematical understanding of neural network-
based machine learning: what we know and what we don’t. arXiv/2009.10713, 2020.
C. Fang, Y. Gu, W. Zhang, and T. Zhang. Convex formulation of overparameterized deep neural
networks. arXiv/1911/07626, 2019.
S. Frei, Y. Cao, and Q. Gu. Algorithm-dependent generalization bounds for overparameterized deep
residual networks. In NeurIPS, 2019.
R.	Ge, F. Huang, C. Jin, and Y. Yuan. Escaping from saddle points — online stochastic gradient for
tensor decomposition. In Proceedings of The 28th Conference on Learning Theory, volume 40 of
Proceedings of Machine Learning Research, pp. 797-842. PMLR, 03-06 Jul 2015.
R. Ge, J. Lee, and T. Ma. Learning one-hidden-layer neural networks with landscape design. In
International Conference on Learning Representations, 2018.
10
Under review as a conference paper at ICLR 2022
A. Jacot, F. Gabriel, and C. Hongler. Neural tangent kernel: Convergence and generalization in neural
networks. In Advances in Neural Information Processing Systems, volume 31, 2018.
C. Jin, R. Ge, P. Netrapalli, S. Kakade, and M. Jordan. How to escape saddle points efficiently. In
Proceedings of the 34th International Conference on Machine Learning, volume 70 of Proceedings
ofMachine Learning Research, pp.1724-1732. PMLR, 06-11 Aug 2017.
K. Kawaguchi. Deep learning without poor local minima. In Advances in Neural Information
Processing Systems, volume 29, 2016.
Y. Li and Y. Liang. Learning overparameterized neural networks via stochastic gradient descent
on structured data. In Proceedings of the 32nd International Conference on Neural Information
Processing Systems, NIPS’18, pp. 8168-8177, 2018.
C. Liu, L. Zhu, and M. Belkin. On the linearity of large non-linear models: when and why the
tangent kernel is constant. In Advances in Neural Information Processing Systems, volume 33, pp.
15954-15964, 2020.
Y. Lu, C. Ma, Y. Lu, J. Lu, and L. Ying. A mean field analysis of deep ResNet and beyond:
Towards provably optimization via overparameterization from depth. In Proceedings of the 37th
International Conference on Machine Learning, volume 119, pp. 6426-6436, 13-18 Jul 2020.
S.	Mei, A. Montanari, and P. M. Nguyen. A mean field view of the landscape of two-layer neural
networks. Proceedings of the National Academy of Sciences, 115(33):E7665-E7671, 2018.
P. M. Nguyen. Mean field limit of the learning dynamics of multilayer neural networks.
arXiv/1902.02880, 2019.
P.	M. Nguyen and H. Pham. A rigorous framework for the mean field limit of multilayer neural
networks. arxiv/2001.11443, 2021.
Q.	Nguyen and M. Hein. The loss surface of deep and wide neural networks. In Proceedings of
the 34th International Conference on Machine Learning, volume 70 of Proceedings of Machine
Learning Research, pp. 2603-2612. PMLR, 06-11 Aug 2017.
Q.	Nguyen and M. Hein. Optimization landscape and expressivity of deep cnns. In ICML, 2018.
J. Sirignano and K. Spiliopoulos. Mean field analysis of neural networks: A law of large numbers.
SIAM Journal on Applied Mathematics, 80(2):725-752, 2020.
J. Sirignano and K. Spiliopoulos. Mean field analysis of deep neural networks. Mathematics of
Operations Research, 2021. doi: 10.1287/moor.2020.1118.
M. Soltanolkotabi, A. Javanmard, and J. Lee. Theoretical insights into the optimization landscape of
over-parameterized shallow neural networks. IEEE Trans. Inf. Theor., 65(2):742-769, February
2019. ISSN 0018-9448.
C. Wei, J. Lee, Q. Liu, and T. Ma. Regularization matters: Generalization and optimization of neural
nets v.s. their induced kernel. In NeurIPS, 2019.
S. Wojtowytsch. On the convergence of gradient descent training for two-layer relu-networks in the
mean field regime. arXiv/2005/13530, 2020.
C.	Yun, S. Sra, and A. Jadbabaie. Global optimality conditions for deep neural networks. In
International Conference on Learning Representations, 2018.
H. Zhang, D. Yu, M. Yi, W. Chen, and T. Liu. Convergence theory of learning over-parameterized
resnet: A full characterization. arXiv/1903.07120, 2019.
D.	Zou, Y. Cao, D. Zhou, and Q. Gu. Gradient descent optimizes over-parameterized deep relu
networks. Machine Learning, 109:467-492, 2019.
11
Under review as a conference paper at ICLR 2022
Appendix: Introduction
The appendix contains proofs and supporting analysis for the theorems in the main text. We start by
proving well-posedness of the ResNet ODE and the gradient flow. We then justify the continuous and
mean-field limit. Finally, we prove the global convergence of the gradient-flow PDE. The sections
are organized as follows.
Appendix A: Well-posedness. We summarize the well-posedness of the continuous limit ODE (4),
the mean-field limit ODE (7), and the associated gradient flows (3), (6), and (9). The results are
collected in Theorem A.1.
Appendix B: This section collects the detailed proof for the well-posedness of the ResNet ODE in
its continuous limit (4), and the mean-field limit (7), and finalizes the proof of Theorem A.2.
Appendix C: This section prepares some a-priori estimates for showing the well-posedness of the
gradient flow equations.
Appendix D: This section contains a detailed proof for the well-posedness of gradient flow equa-
tions (3) and (9) and finalizes the proofs of Theorem A.3 and A.4.
Appendix E-G: Proof of Theorem 5.1, the continuous and mean-field limit. Section E lays out the
structure of the proof, Section F shows the continuous limit, and Section G shows the mean-field
limit.
Appendix H: Proof of Theorem 6.1 and 6.2: Global convergence of the gradient flow.
The analytical core of the paper lies in Appendices H and E, which describe properties of the gradient
flow PDEs and explain why the gradient descent method for ResNet can be explained by these
equations. The technical results of Appendix B-D can be skipped by readers who are interested to
proofs of the main results.
Throughout, We denote by C(∙) a generic constant whose value depends only on its arguments. The
precise value of this constant may change each time it is invoked. Throughout Appendices A-G, we
assume that Assumption 4.1 holds for some 0 < k1 ≤ k.
A	Well-posedness result
In this section, we show the well-posedness of ODEs (4), (7) and gradient flows (3), (6), and (9).
Theorem A.1 The following claims hold.
一 WeU-PosednessofODE:
•	If {θm (t)}mM=1 is continuous, then (4) has a unique C1solution.
•	Ifρ ∈ C([0, 1]; P2), then (7) has a unique C1 solution.
一 Well-Posedness of gradient flow:
•	(3) has a unique solution.
•	If {θm(0; t)}mM=1 is continuous, then (6) has a unique solution {θm(s; t)}mM=1 that is continuous
in (s, t).
•	If ρini(θ, t) is admissible and suppθ(ρini(θ,t)) ⊂ {θ∣∣θ[i] | ≤ R} with some R > 0 for all t ∈
[0, 1], then (9) has a unique solution ρ(θ, t, s) in C ([0, ∞); C ([0, 1]; P2)) with initial condition
ρini (θ, t). Furthermore, for each s, ρ(θ, t, s) is admissible.
Note that the well-posedness of (4) and (6) are direct corollaries of that of (7), (3), and (9) (the
corresponding continuous versions), according to Remark A.1, A.2. Thus, we merely prove well-
posedness on the continuous level, in Theorems A.2, A.3, and A.4. Specifically,
•	Theorem A.2 (Appendix A.1) shows the well-posedness of the dynamical system for z;
•	Theorems A.3 and A.4 (Appendix A.2) justify the well-posedness of the gradient flow of
the parameter configuration.
12
Under review as a conference paper at ICLR 2022
A.1 Well-posedness of the OID (7)
As L and M approach ∞, z satisfies the ordinary-integral equation (7). We justify that this differential
equation is well-posed, in the sense that the solution is unique and stable.
Theorem A.2 Suppose that Assumption 4.1 holds with and that X is in the support of μ, then (7) has
a unique C1 solution. Specifically, for ρ1, ρ2 ∈ C([0, 1]; P2), we have ∣Zρι (t; x)| ≤ C(Lι), and for all t ∈ [0, 1]: ∣Zρι (t; X)- Zρ2(t; x)| ≤ C(Lι, L2)d1(ρ1,ρ2), where Li are the second moments of ρi, that is, Li = [ I ∣θ∣2dρi(θ, t)dt, i = 1, 2. 0	Rk	(18) (19) (20)
We leave the proof to Appendix B. Besides the well-posedness result, the theorem also suggests
that a small perturbation to ρ is reflected linearly in Zρ, the solution to (7). This means that a small
perturbation in the parameterization of the ResNet leads to only a small perturbation to the ResNet
output.
Remark A.1 Although we do not directly show the well-posedness of (4), it follow immediately from
Theorem A.2. One way to make this connection is to reformulate the discrete probability distribution
as
1M
Pdis(θ,t)= M Σ>θm(t)(θ),
m=1
where Θ(t) = {θm (t)}mM=1 is the list of trajectories. Since θm (t) is continuous in t, we have
ρdis(θ, t) ∈ C ([0, 1]; P2). Since
1M
M Xlf(z(t； x),θm (t))=Lk
f(z(t; x), θ) dρdis(θ, t) ,
using Theorem A.2, (4) has a unique C1 solution when Θ(t) is continuous.
A.2 Well-posedness of the gradient flow
The gradient flow of the parameterization is also well-posed, both in the discrete setting and the
continuous mean-field limit. In the discrete setting, we have the following result.
Theorem A.3 (3) has a unique solution.
Further, (9) characterizes the dynamics of the continuous mean-field limit of the parameter configura-
tion, and is also well-posed.
TheoremA.4 If ρini(θ,t) is admissible and supp0 (ρai(θ,t)) ⊂ {θ∣∣θ[i]∣ ≤ R} with some R > 0 for
all t ∈ [0, 1]. Then (9) has a unique solution ρ(θ, t, s) in C([0, ∞); C ([0, 1]; P2)) that is admissible
for each s. Further, we have
dE(P(∙, ∙, S))
ds
≤0.
(21)
The proofs of these two theorems can be found in Appendix D.
Remark A.2 Using the same argument as in Remark A.1, calling
1M
Pdis(θ,t,s) = M ∑>θm3t)(θ),	(22)
the well-posedness of (6) follows immediately from Theorem A.4. Furthermore, according to the
definition (5) and (8), we have
E (Pdis(∙,∙,s)) = E (Θ(s; ∙)).
As a consequence, if Θ(s; t) satisfies (6), then ρdis satisfies (9), and vice versa. The well-posedness
result in Theorem A.4 for (9) then can be extended to justify well-posedness of (6).
13
Under review as a conference paper at ICLR 2022
B Proof of Theorem A.2
This section contains the Proof of Theorem A.2. We reWrite (7) as folloWs:
^"彳; x) = F(Zρ, t), ∀t ∈ [0,1] with z(0; X)= x,
Where for a given p ∈ C([0, 1]; P2) We use the notation:
F(z, t) =	f(z, θ) dp(θ, t) .
(23)
The proof of Theorem A.2 relies on the classical Lipschitz condition for the Well-posedness of an
ODE.
Proof [Proof of Theorem A.2] Since ρ ∈ C([0, 1]; P2), We have a constant C such that
sup I ∣θ∣2 dp(θ,t) < C < ∞ .
0≤t≤i Rk
For any t∈ [0, 1], using (12) from AssumPtion 4.1 equation, We have
|F(z,t)I ≤ ZJf(Zi,θ)l dp(θ,t) ≤ Cι(∣z∣ + 1)ZJ∣θ∣2 + 1)dp(θ,t) ∙
To shoW the boundedness result (18), We multiPly (23) by Zρ1 (t; x) and use (24) to obtain
(24)
d∣Zρι (t; x)|2
dt
≤2Ci (∣Zρ1I2 + ∣Zριl)ɪfc(∣θ∣2 + 1)dpι(θ,t)
≤4Ci Lfc(∣θ∣2 + 1)dpι(θ,t)(∣Zρι (t;x)∣2 + 1).
Using GronWall's inequality, We have
Where L1
∣Zρι (t x)| ≤ exp 2Ci
∣θ∣2 dpi dt + 1
+1)
≤ exp (2C1 (L1 + 1)) (|x| + 1) ,
RDL)Rk ∣θ∣2 dpi dt. Since X ∈ SUPP μ (So that |x| < R), we have (18). This gives us an
a-priori estimate of (23).
Next, using (13) from AssumPtion 4.1, We have
If (zi,θ) - f (Z2,θ)l ≤ C2(∣z1∣ + ∣Z2∣) (∣θ∣2 + 1) |zi - Z2∣ .
Then, using boundedness of the second moment of θ, We have
(25)
|F (z1 , t) - F (z2 , t)| ≤
(f(z1, θ) - f(z2, θ)) dρ(θ, t)
≤ C2(|z1 | + lz2ð / (lθl2 + I) dp(θ, t)|z1 - z2|
< C2 (|zi | + |z2 |)(C + 1)|zi - z2 | ,
Which imPlies that F(z, t) is locally LiPschitz in z for all t∈ [0, 1]. Combining this With the a-Priori
estimate in (18), classical ODE theory imPlies that (23) has a unique Ci solution.
To Prove the stability result (19), We define Zρi as in (23) Parameterized by pi ∈ C([0, 1]; P2), and
denote
∆(t; x) = Zρ1 (t; x) - Zρ2 (t; x) .
14
Under review as a conference paper at ICLR 2022
Then by sUbtracting the two eqUations, we obtain
d∣∆(t; x)∣2
dt
2	∆(t; x),	f (Zρ1 (t;	x),	θ) dρ1(θ, t) -	f (Zρ2 (t; x),	θ)	dρ2(θ, t)
2	∆(t; x),	f (Zρ1 (t;	x),	θ) dρ1(θ, t) -	f (Zρ2 (t; x),	θ)	dρ1(θ, t)
∖	1R-------------------------z-R--------------------------} /
(I)
+2 ∆(t; X),	f(Zρ2 (t; X), θ) dρ1 (θ, t) -	f (Zρ2 (t; X), θ) dρ2(θ, t)	.
∖	------------------------z-R-------------------------} /
(II)
We noW bound (I) and (II). For (I), We have using (13) and (25) that
I(I)I ≤2C2 (IZρ1 (t; X)I + IZρ2 (t; X)I) I∆(t; X)I	(IθI2 + 1) dρ1(θ, t)
≤C(L1, L2)I∆(t; X)I	(IθI2 + 1) dρ1(θ, t),
(26)
(27)
where the second inequality comes from (18). For (II), we denote the particle representation
θι(t)〜ρι(θ,t) and θ2(t)〜P2(θ,t) SUchthat(E (∣θι - θ2∣2))1/2 = W2(ρ1(∙,t),ρ2(∙,t)). Then
∣(II)∣ ≤ E(∣f(Zρ2(t;x),θι) - f(Zρ2(t;x),θ2)∣)
≤ C2(Zρ2(t;X))E((∣θι∣ + ∣Θ2∣ + 1)∣Θ1 - Θ2∣)
≤ C(L2)E((仇| + 阳 + i)∣θι- Θ2∣)
≤ C(L2) (E (∣Θ1∣2 + ∣Θ2∣2 + 1))1/2 (E (∣θι - θ212))1∕2
≤ C(L2) (E (∣Θ1∣2 + ∣Θ2∣2 + 1))1/2 W2(ρ1(∙,t),ρ2(∙,t))
≤ C(L2) ( I ∣θ∣2dρ1(θ,t)+ [ ∣θ∣2dρ2(θ,t) + l)	d1(ρ1,ρ2),
Rk	Rk
where we Use mean-valUe theorem and (13) in the first ineqUality to obtain
If (Zρ2(t X),θ1) - f(Zρ2(t X),θ2)∣ ≤∣∂θ f(Zρ2 (t; X),θ1 + λθ2)∣∣θ1-θ2∣
≤C2(Zρ2 (t； X))(Iθ1l + lθ2l + I)lθ1 - θ21,
for some λ ∈ [0, 1]. We Use (18) in the second ineqUality of (28).
Plugging (27)-(28) into (26) and using Holder,s inequality, We obtain that
(28)
d|*X)I2 ≤C(L1, L2)∣∆(t; x)I2 Z ∣θ∣2 dρ1(θ,t)
dt	Rk
+ C(L2)∣∆(t; x)∣(^Jθ∣2dρ1(θ,t) + LJθ∣2dρ2(θ,t) + l) / d1(ρ1,ρ2)
≤C(L1, L2) ( I ∣θ∣2dρ1(θ,t) + ( ∣θ∣2dρ2(θ,t) + l) (∣∆(t; x)∣2 + d2(ρ1,ρ2)),
Rk	Rk
Where We used Young’s inequality in the last line. Since I∆(0; X)I = 0, We complete the proof of (19)
using Gronwall,s inequality.	■
C A-priori estimation of the cost function
Some a-priori estimates are necessary in the proof for the main theorems. We first consider the case
when f satisfies only Assumption 4.1 with 0 < k1 ≤ k. (Better a-priori estimates can be obtained
when f also satisfies the homogeneity properties of Sections 6.1 or 6.2.)
15
Under review as a conference paper at ICLR 2022
C.1 A-PRIORI ESTIMATE FOR GENERAL f
According to (10), the Frechet derivative can be computed, similarly to (Lu et al., 2020), as follows:
δEpp)(θ,t)= Ex〜μ (p>(t;x)f(Zρ(t;x),θ)) ,	(29)
where pρ (t; x) is the solution to the following ODE:
J	~^= = -p> Z dzf (Zρ(t; χ),θ)dρGt),	Ca
∂t	Rk	(30)
lpρ(1; X) = (g(ZP(I; X))- y(X) Vg(Zρ(1; χ)).
We now show that pρ is Lipschitz continuous with respect toρ.
Lemma C.1 Suppose that X is in the support of μ. Suppose that ρι, ρ2 ∈ C([0,1]; P2) andpρλ,, pρ2
are the corresponding solutions of (30). Denote L1 and L2 as in (20) and
R = min rsupp(ρ1) ∪supp(ρ2) ⊂ θθ[1] < r .
Then the following two bounds are satisfied:
∣Pρι(t;x)| ≤ C(Li),	(31)
and
lPρι (t； X)- Pρ2 (t； x)| ≤ C(R, L) di (Pl,P2) ,	(32)
where L = max{L1, L2}.
Proof From (13) in Assumption 4.1,
Rk
∂zf (Zρι (t; X),θ) dρι(θ, t) ≤C(Zρι (t; X)) ZJ∣θ∣2 + 1) dρι(θ,t)
≤C(Li)∕j∣θ∣2 + 1)dρι(θ,t),
(33)
where we use (18) in the second inequality. It follows from the initial condition of (30) that
Pρι (1; x) ≤ C(∣Zρι (1,x)I + 1) ≤ C(Li),
where we use Assumption 4.1 in the first inequality and (18) in the second inequality. Noting that (30)
is a linear equation, (31) follows naturally when we combine (33) with the inequality above.
To prove (32), we define
δ9 X) = Pρι(t； X) - Pρ2 (t； X).
For t = 1, with X ∈ SuPP μ, we have
δ(1; X)I = ∖Pρι (1； X)- Pρ2 (1； X)I
=l(g(Zρι(1;X)) -y(X)) Vg(ZPI(1;X))- (g(Zρ2(1;X)) -y(X)) Vg(ZP2(1;X))I (34)
≤ C(L)IZPI(1;x) - Zρ2(1;x)I	( )
≤ C(L)di(ρi,ρ2),
where we use Assumption 4.1, (18), and ∣χ∣ < Rμ in the first inequality and (19) in the second
inequality. The following ODE is satisfied by ∆:
“'t'X) = -∆>(t; x) [ ∂zf (Zρι (t; x),θ) dρι(θ,t) + p>2(t; x)Dριg (t; x),
∂t	Rk
where
Dρ1,ρ2 (t; x) = L/zf (Zρ2 (t; x),θ) dρ2(θ, t) - Lfc∂zf (Zρι (t; x),θ) dρι(θ, t).
(35)
(36)
16
Under review as a conference paper at ICLR 2022
To show the boundedness of Dρ1,ρ2 (t; x), we follow the same strategy as that for (26). By splitting
into two terms, we obtain
1DPI ,P2 (t； X)
I
∂z f(Zρ2 (t; x),θ)dρ2(θ,t) - / Jz f(Zρ2 (t; x),θ)dρι(θ,t)
{
(I)
}
|
∂z f (Zρ2 (t; x), θ) dρ1(θ, t) -
Rk
{^^^^^
(II)
(37)
∂z f (Zρ1 (t; x), θ) dρ1(θ, t) .
}
The bound of (II) relies on part 3 of Assumption 4.1: Because the supports of ρ1, ρ2 are contained in
{θ∣ ∣θ[i] I < R} and Z is bounded by (18), We have
I(II)I ≤ C(R,L) ∣Zρι (t; X)- Zρ2(t; x)| ≤ C(R, L)d1(ρ1,ρ2),	(38)
Where We use (19) in the second inequality.
To bound (I), we use the particle representation θι ~ ρι(θ,t) and θ2 ~ ρ2(θ,t) such that
(E (仇一θ2∣2))1/2 = W2(ρ1(∙,t),ρ2(∙,t)). We then have
(I) ≤ E (∣∂z f(Zρ2 (t; x),θι) - ∂z f(Zρ2 (t; X),θ2)∣)
≤C(R,L)E(Iθ1 -θ2I)
≤ C(R, L)(E (∣θι-θ2∣2))1∕2	(39)
≤ C(R, L)d1(ρ1, ρ2),
where we use the mean-value theorem, part 3 of Assumption 4.1 with Iθ1,[1] I < R and Iθ2,[1] I < R,
(18) in the second inequality. Substituting (38) and (39) into (37), we obtain
IDP1,P2(t; x)I≤ C(R, L)dι(ρ1,ρ2).
By substituting this bound into (35) and using (33), we have
d%”2 ≤ C(R, L) (∆(t; x)∣2 + d1(ρι, P2)) .	(40)
The result (32) follows from the initial condition (34) and Gronwall,s inequality.	■
The second lemma concerns the continuity of VθδEP.
Lemma C.2 Suppose that ρ, ρ1 , ρ2 ∈ C([0, 1]; P2 ). Define
max
1≤i≤3
IθI2 dρi(θ, t) dt,
L
Lsup = max sup	IθI2 dρi (θ, t) ,
1≤i≤3 t∈[0,1] Rk
and
R = mrin {r∣supp(ρ) ∪supp(ρ1) ∪ supp(ρ2) ⊂ {θIIθ[1]I < r}} .
Then for any (θ, t), (θ1, t1), (θ2, t2) ∈ Rk × [0, 1] and s > 0, the following properties hold.
• Boundedness:
▽J-δp~(θ,t) ≤C(L)(Iθl +1),	dθ[i] ~δρr~(θ,t) ≤C(L)(Iθ[i]| +I) (41)
•	Lipschitz continuity in θ and t: There exists Q1 : R2 → R+ that depends increasingly on
both arguments such that
VθδEρ)(θι,tι) -VθδEp(Θ2,t2)
δρ	δρ
(42)
≤Q1 L, im=a1,x2(Iθi,[1] I) Iθ1 - θ2I + Q1	Lsup, im=a1,x2(Iθi,[1] I) (Iθ2I + 1)It1 - t2I ,
17
Under review as a conference paper at ICLR 2022
•	Lipschitz continuity in P. There exists Q : R2 → R+ that increasingly depends on both
arguments such that
VθδEδP1)(θ,t)-VθδEδρ2)(θ,t) ≤ Q(L,∣θ[i]∣,R)(1 + ∣θ∣)d1(ρ1,ρ2),	(43)
where di is defined in Definition 4.1.
Proof To prove the first bound of (41), we restate (29) as follows
vθ -δρ~ (θ, t) = Ex〜μ (p> (t； x)dθ f(Zρ(t; x), θ)),
from which it follows that
Vθ WPPkθ,t ≤ Ex 〜“ (∣∂θ f (Zρ(t; χ),θ)∣∣pρ (t; x)|) ≤ C (L)(∣θ∣ + 1),
where we use (13), (18), and (31) in the second inequality. To prove the second bound in (41), we
use the bound of ∣ ∂θ^ f (χ, θ) ∣ according to Assumption 4.1 part 3 to obtain
∂θ[i] δEpp)(θ,t) ≤ Ex〜“(∣ Mjf (Zρ(t; x),θ) ∣ ∣pρ(t; x)∣) ≤ C(L)(Iθ[i] ∣ + 1),
To prove (42), we assume ti > t2 without loss of generality, and use the triangle inequality to obtain
VθδEρ)(θi,tι) -VθδE(ρ)(Θ2,t2)
δρ	δρ
≤ ∣ Ex'μ (p>(ti； x)∂θf (Zρ(tι; x), θi) - p>(ti； x)∂θf (Zρ(tι; x), θ2)) ∣
'----------------------------------V---------------------------}
(I)
+ ∣ Exi (p;(ti； x)∂θf (Zρ(ti; x), θ2) - p>(ti； x)∂θf (Zρ(t2; x), θ2)) ∣
、---------------------------------V-----------------------------------}
(II)
+ ∣ Exi (p;(ti； x)∂θf(Zρ(t2;x),θ2) - PT(t2； x)∂θf (Zρ(t2;x),θ2))∣ .
、-----------------------------------V------------------------------}
(III)
(44)
To bound (I), we use the mean-value theorem, Assumption 4.1 (14), and (18) to obtain
∣∂θf (Zρ(tι;x),θi) - ∂θf (Zρ(tι;x),θ2)∣ ≤ ∣∂2f (Zρ(tι; x), (1 - λ)θi + λθ2)∣∣θi - θ2∣
≤ C(LSUP)Iti- t2∣,
where we use Assumption 4.1 (12) together with (18) and L ≤ Lsup. This bound implies that
(II)	≤ Ex〜“(∣p>(ti; x)∣ ∣∂θf(Zρ(ti； x),θ2) - ∂θf(Zρ(t2; x),θ2)∣)
≤ C(L)Ex〜“ (∣∂θf(Zρ(Sx),θ2) - ∂θf(Zρ(t2:x),θ2)∣)
≤ C(LSUP, ∣θ2,[i] ∣)Ex〜“(∣Zρ(ti:x) - Zρ(t2: x)∣)
≤ C(LSUP,∣θ2,[i]∣)∣ti- t2∣,
where we use (31) in the first inequality, Assumption 4.1 (14) for f, and (18) in the second inequality.
18
Under review as a conference paper at ICLR 2022
To bound term (III), we again use boundedness of Zρ , pρ and the Lipschitz condition of f to obtain
∣Pρ(tι; X)- Pρ(t2; x)| ≤ [ P p>(t; x)∂z f(Zρ(t; x),θ)dρ(θ,t)dt
t2	Rk
≤ C(L) [tt I (∣θ∣2 + 1)dρ(θ,t)dt
t2	Rk
≤ C(L)(Lsup + 1)|t1 - t2|
≤ C(LsUp)|ti-12∣,
so that
(In) ≤ Ex〜μ (∣∂θf(Zρ(t2; χ),θ2)∣∣Pρ(t1; X)- Pρ(t2; x)|) ≤ C(LsUP)(∣Θ2∣ + I)∣t1-12∣,
where we use Assumption 4.1 (13) in the second inequality. By substituting these bounds into (44),
we complete the proof of (42).
Finally, to prove (43), We recall the definition of the Frechet derivative, to obtain
Ve δE(ρι)(θ,t) -vθ δE(ρ2)(θ,t)
δρ	δρ
≤Ex〜μ (∣∂θf (Zρι (t; χ),θ)pρι (t; x) - ∂θf(Zρ2(t χ),θ)pρ2(t; x)|)
≤Ex〜μ (∣∂θf(Zρι(t; X),θ) - ∂θf(Zρ2(t; χ),θ)∣∣Pρι(t;x)|)
+ Ex〜” (∣∂θf (Zρ2(t; x),θ)∣ ∣Pρι (t; x) -Pρ2 (t;x)|)
≤C(L, ∣θ[i] |)Ex〜μ (∣Zρι (t; x) - Zρ2 (t; x)|) + C(L)(∣θ∣ + 1)Ex〜“(跖(t; x) - p02 (t; x)|)
≤C(L, ∣θ[i]l, R)(1 + ∣θ∣)dι(ρι,P2),
Where We use Assumption 4.1 for f With (18) and (31) in the third inequality. In the last inequality,
WeUse(19),(32).	■
C.2 A-priori estimate under the homogeneous assumption
In Theorem 6.1 and 6.2, 2-homogeneity or partial 1-homogeneity are assUmed. When these properties
hold, We can sharpen the estimates obtained in the previoUs section. We sUmmarize oUr resUlts here.
Lemma C.3 Suppose that Assumption 4.1 holds, then there exists a constant C3(r) depending
increasingly on r such that for any r > 0 with |x| < r and θ ∈ Rk, we have the following.
•	If f is 2-homogeneous (Assumption 6.1), then
∣∂xf I ≤ C3(r)(∣θ∣2 + 1) ,	∣∂x∂θf | ≤ C3(r)(∣θ∣ + 1),	∣∂2f I ≤ C3(r).	(45)
•	If f is partially 1-homogeneous (Assumption 6.2), then
∣∂xf∣ ≤ C3(r)(∣θ∣ + 1),	∣∂x∂θf| ≤ C3(r)(∣θ∣ + 1),	∣∂2f∣≤ C3(r)(∣θ∣ + 1), (46)
where | ∙ | denotes the Frobenius norm.
Proof When f satisfies AssUmption 4.1 and AssUmption 6.2, (46) can be obtained from direct
calcUlation. When f is 2-homogeneoUs in θ, We have
f(x,θ) = ∣θ∣2f(x,θ∕∣θ∣) = f1(θ)f2(x,θ),
where fι(θ) = ∣θ∣2,f2(x,θ) = f (x,θ∕∣θ∣). Naturally, with product rule, the derivatives of f
becomes the products of derivatives of fι and f2. We then obtain (45), noting that when ∣θ∣ > 1, we
have
∣∂xf1∣=0,	∣∂x∂θfι∣ ≤ 0,	∣∂xfι∣ =0,	∣∂θfι∣ ≤ 2∣θ∣,	∣∂jfι∣ ≤ 2k,
and
C(r)	C(r)	C(r)
∣dxf2∣ = C(r),	ldxdθf2∣	≤	∣θ∣ ,	|dxf2|	=	C(r),	ldθf2|	≤ ∣θ∣ ,	∣dθf2∣	≤ 怛|2 ∙
19
Under review as a conference paper at ICLR 2022
The estimates above allow us to improve the stability results in Lemmas C.1 and C.2.
Lemma C.4 Suppose that Assumption 4.1 holds and let ρ1, ρ2 ∈ C([0, 1]; P2). Define L1 and L2
as
in (20) and
Lsup
sup
t∈[0,1]
/
Rk
∣θ∣2dρι(θ,t).
Then we have the following results.
• If f either satisfies Assumption 6.1 or Assumption 6.2, we have the following properties.
1.	Stability ofpρ:
∣Pρι (t; X)-Pρ2 (t; x)| ≤ C(Lι, L2)d1(ρ1,ρ2).	(47)
2.	Lipschitz continuity in ρ:
VeδE(ρ1)(θ,t) -VθδE(ρ2)(θ,t) ≤ C(Lι, L2)d1(ρ1,P2)(∣θ∣ + 1) ,	(48)
δρ	δρ
where d1 is defined in (4.1).
•	Lipschitz continuity in θ and t: If f satisfies Assumption 6.1, then for any (θ1, t1), (θ2, t2) ∈
Rk × [0, 1], we have
VeδE(ρ1)(θι,tι) -VeδE(ρ1)(θ2,t2) ≤ C(L1)∣θ1 -Θ2∣ + C(LTp)(∣Θ2∣ + 1)∣tι-12∣.
δρ	δρ
(49)
•	Lipschitz continuity in θ and t: If f satisfies Assumption 6.2, then for any (θ1, t1), (θ2, t2) ∈
Rk × [0, 1], we have
VeδE(ρ1)(θι,tι) -VeδE(ρ1)(θ2,t2) ≤ C(LTp)(∣θ1∣ + ∣θ2∣ + l)(∣θ1-θ2∣ + ∣t1-t2∣),
δρ	δρ
(50)
Remark C.1 We note that in comparing (32) with (47) and (42)-(43) with (48)-(50), the main
differences are the dependence of the bounds on θ. The new estimates have explicit (and mild)
dependence on θ.
Proof First, to prove (47), we let ∆(t; x) = pρ1 (t; x) - pρ2 (t; x), and recall (35) and (36). Using
the boundedness of Zρ in (18) and (19), and calling (45) (or (46)), we have from (36) that
∣Dρ1,P2(t;x)| ≤ C(Lι,L2) ( I ∣θ∣2dρι(θ,t)+ [ ∣θ∣2dρ2(θ,t) + l) d1(ρ1,ρ2).
Rk	Rk
By substituting into (35), and using (31), (33), and Holder,s inequality, We have
d*x)|2 ≤C(Lι,L2 (Z ∣θ∣2dρι(θ,t)+ Z ∣θ∣2dρ2(θ,t) + l) ∆(t;x)∣2
dt	Rk	Rk
+ C(Ll, L2) ( I ∣θ∣2dρι(θ,t)+ [ ∣θ∣2dρ2(θ,t) + l) d2(ρι,P2).
Rk	Rk
The result (47) folloWs from the initial condition (34) together With GronWall’s inequality.
Next, to prove (48), We have
VeδE(ρ1)(θ,t) -VeδE(ρ2)(θ,t)
δρ	δρ
≤Ex 〜μ (∣∂e f(Zρι (t; χ),θ)Pρι (t; X)- ∂e f (Zρ2 (t; χ),θ)pρ2 (t; x) |)
≤Ex〜μ (∣∂e f(Zρι (t; χ),θ) - ∂e f(Zρ? (t; χ),θ)∣ “ (t; x)|)
+ Ex〜μ (∣∂ef(Zρ2(t; x),θ)∣ ∣Pρι(t; X)-Pρ2(t;x)|)
≤C(L1, L2)(∣θ∣ + 1) (Ex〜“ (∣Zρι(t; X)- Zρ2(t; x)|) + Ex。” (∣Pρι(t;X)-pp?(t; x)|))
≤C(L1, L2)d1(ρ1,ρ2)(∣θ∣ + 1),
20
Under review as a conference paper at ICLR 2022
where we also use (13), (18), (31), (45) (or (46)) in the second inequality and (19) and (47) in the
final inequality.
Finally, to prove (49) and (50), we have as in (44) that
VθδE(ρ1)(θι,tι) - VθδE(ρi)(θ2,t2)
δρ	δρ
≤ IEx〜μ (p>1 (ti； x)∂θ f(Zρι (tl； x),θ1) - p>1 (tl； x)∂θf(Zρι (tl； x), θ2)) I
'------------------------------------{z----------------------------------}
(I)
+1Ex〜μ (p>1 (tl； x)∂θ f(Zρι (tl； x),θ2) - p>1 (tl； x)∂θ f(Zρι (t2； x), θ2)) I	(51)
'----------------------------------{z----------------------------------}
(II)
+ ∣Ex〜μ (p>1(tl； x)∂θ f(Zρι (t2； x),θ2) - p>1 (t2； x)∂θ f(Zρι (t2； x),θ2))∣ .
'----------------------------------{z----------------------------------}
(III)
The boundedness of the three terms above relies on Assumption 4.1 and (45) (or (46)).
To bound (I), if f is 2-homogeneous, we have
I(I)I ≤ C(Ll)∣θl-θ2∣,
where we use (18), (31), and ∂θ2f ≤ C(|z|). If f satisfies Assumption 6.2, we have
I(I)I ≤ C(Ll)(IθlI + Iθ2I + 1)Iθl - θ2I ,
where we use (18), (31), and ∂θ2f(z, θ) ≤ C(IzI)(IθI + 1).
The bounds of (II) and (III) are same for both homogeneity assumptions and similar to the proof of
Lemma C.2. For (II), we have
∣∂θ f(Zρι (tl ； x),θ2) - ∂θ f(Zρι (t2； x),θ2)∣≤ C (Ll)(∣θ2 I + 1)∣Zρι (tl； X)- Zρι (t2； x)∣
and
∣Zρι (tl； X)- Zρι (t2； x)∣≤ C(Ll)(Llup + 1)∣tl - t2∣.
For (III), we also use
∣∂θf(Zρι(t2；X),θ2)∣ ≤ C(Ll)(∣θ2∣ + 1)
and
∣Pρι (tl； x) - Pρι (t2； x)∣ ≤ C(LI)(LIup + 1)∣tl - t2∣ .
These estimates, together with Ll ≤ Ljup and (51), prove the claims (49) and (50).	■
D	Well posedness of gradient flow
Theorem A.4 is about well-posedness of the gradient flow equation (9) in the mean-field limit, while
Theorem A.3 shows the corresponding result in the discrete setting. The proof for the two are similar.
We first show the mean-field limit well-posedness, Theorem A.4.
D.1 Proof of Theorem A.4
We use the fixed-point argument. To do so, we first define a subset of C([0, S]； C([0, 1]； P2)) with
compact support measures, as follows:
Ωs = {φ(θ,t,s) ∈C([0,S ]； C([0,1]； P2 ))∣∃r > 0, supp(φ) ⊂{Θ∣∣Θ[i]∣ < r}, ∀(t,s) ∈ [0,1] × [0,S]}
∩ {Φ(θ,t,s) €C([0,S]；C([0,1]；P2))∣φ(θ,t,0)= ρini(θ,t)}
For any φ(θ,t, s) ∈ Ωs with φ(θ,t, 0) = ρini(θ,t), We define a map
P=Ts(φ) : Ωs → Ωs	(52)
21
Under review as a conference paper at ICLR 2022
where φ solves
f 丁 = Vθ ∙b(θ,t,s)VθδE≡(θ,t)),
lnθ,t, O) = PiniGt).
(53)
The strategy is to show this map is a contraction map, so that there is a fixed point in the set Ωs,
which is then the solution to equation (9).
The proof of Theorem A.4 is divided into three steps:
Step 1: We show TS is well-defined map from Ωs to Ωs.
Step 2: We give a bound of d2(TS(φ1),TS(φ2)) in terms of d2(φ1 ,φ2). One can then tune S to
ensure TS is a contraction map, meaning there is a unique fixed point φ* sothat φ* = TS (φ*),
and thus φ* solves (53) for s < S.
Step 3: We extend the local solution to a global solution.
Step 1. According to the definition of (53), for a fixedφ(θ,t,s), let
[
dθφ3t) _ V δE(φ(s))
-dS- = -vθ -δρ-
θφ(0; t)〜Pini(θ,t).
(θφ(s; t), t) ,
(54)
Then θφ 〜 夕=TS(φ). To show the existence of 夕 amounts to showing the wellposedness of (54).
According to Lemma C.2 (41) and (42), the force VθδφEj(∙,t) has a linear growth and is locally
Lipschitz. Classical ODE theory then suggests there is a unique solution for s ∈ [0,S], which
depends continuously on the initial value θ(0; t).
Denoting
LS,φ = sup	∣θ∣2 dφ(θ, t, s) dt,
0≤s≤S 0	Rk
Lisnuip = sup	∣θ∣2 dρini(θ, t),
0≤t≤1 Rk
sup
LS,φ
Rini
RS,φ
sup I ∣θ∣2 dφ(θ,t,s)
0≤t≤1,0≤s≤S Rk
r>0 {supp(Pini(θ,t)) ⊂{θ∣∣θ[i]∣ <r}, ∀t ∈ [0,1]},
r>0 {supp(φ(θ,t,s)) ⊂ {θ∣∣θ[i]∣ <r}, ∀(t,s) ∈ [0,1] X [0,S]},
(55)
we have the following proposition.
Proposition D.1 Suppose that θφ(s; t) solves (54) and φ ∈ Ωs. Thenfor any (tι, si),也，s2) ∈
[0, 1] × [0, S], we have
E(∣θφ(sι"ι)∣2) ≤ exp(SC(LS,φ))(LSUp + 1),%⑪⑶山)∣
≤ exp(SC(LS,φ)) (Rini + 1)	(56)
and
E (∣θφ(si；ti) - θφ(s2"2)∣2)
≤ C (LSUp, Rini, S) (e (∣θφ(0; ti) — θφ(0; t2)∣2) + ∣ti — t2∣2 + ∣sι - s212).
(57)
Proof To prove the first bound in (56), we multiply (54) on both sides by θφ and use boundedness of
the forcing term (41) to obtain
d ∣θφ(s工ι)∣2
ds
≤ C(LS,φ)(∣θφ(s;t1)∣2 + 1).
22
Under review as a conference paper at ICLR 2022
Using GrOnWall's inquality together with E (∣θφ(0; tι) |2) ≤ Lsup, We obtain the first bound in (56).
To prove the second bound in (56), We use the bound of dθ^ δEpρ) (θ, t) ∣ according to Lemma C.2
(41):
d ∣θφ,[(s"1)∣ ≤ C(Ls,φ)(∣θφ,[i](s; tι)∣2 + 1).
Using Gronwall's inquality together with ∣θφ,[i] (0; tι) | ≤ Rini, We obtain the second bound in (56).
To shoW (57), We first Write
E (∣θφ(si; tl) - θφ(s2; t2)|2)
≤ 2E (∣θφ(sι; tι) - θφ(sι; t2)∣2) +2 E (∣θφ(sι; t2) - θφ(s2; t2)∣2) ,	(58)
|
}
}	'------------------------
(II)
{z
(I)
then bound the two terms (I) and (II) separately. For (I), we use (54), the second bound of (56), and
Lemma C.2 (42)
d ∣θφ(s; tι) - θφ(s; t2)∣2
ds
≤C(Ls,φ, Rini) ∣θφ(s; tl) - θφ(s; t2)∣2 + C(LSuφ, Rini)(∣θφ(sι; t1)∣2 + ∣θφ(sι; t2)∣2 + 1)∣tl - t2∣2 ,
Using the first bound in (56) and Gronwall’s inequality, this implies that
E Qθφ(sι;tι) - θφ(s1"2)∣2) ≤ C (LSup,Rini,s) (E (∣θφ(0;tι) - θφ(0; t2)∣2) + ∣tι- t2∣2).
(59)
For (II), we obtain an estimate by integrating (54) from s1 to s2 and using the boundedness of
VθδEδ(P) in (41). From the Gronwall inequality, we have
lθφ(s1; t2) - θφ(s2; t2)| ≤ C(LS,φ) (/ * lθφ(S; t2)| ds + |s1 - s2”.
Using first bound in (56) and Holder’s inequality, this implies
E∣θφ(sι; t2) - θφ(s2"2)∣2 ≤ C (Ls,φ, Lsup, S) ∣sι -s2∣2	(60)
and thus combining with (59) and substituting in (58), we complete the proof.	■
An immediate corollary of Proposition D.1 is that the map TS(∙) is well defined.
Corollary D.1 For every fixed S > 0, the map Ts is well defined. That is,for any φ ∈ Ωs , one can
find φ =
we have
Ts(φ) ∈ Ωs as the unique solution of (53). In particular, for any (t, s) ∈ [0,1] X [0, S],
I ∣θ∣2 ʤ(θ,t,s) ≤ exp(SQι(Ls,φ))(LsUP + 1),
Rk
supPθW(θ,t, s)) ⊂ {Θ∣∣Θ[1]I ≤ exp(SQι(Ls,φ)) (Rini + 1)},
(61)
where Q1 : R+ → R+ is depends only on LS,φ and is an increasing function of its argument.
Proof For fixed (t, S) ∈ [0,1] × [0, S], define 夕(θ, t, S) as the distribution of θφ(s; t). Using classical
stochastic theory (Ambrosio et al., 2008, Prop 8.1.8),夕(θ, t, s) is a solution to (53). The estimate of
the support is a consequence of (56). Finally, using (16) and (57), we obtain that
( Jim	W2(^(∙,t, s),^(∙,to,so)) ≤ lim (e (∣θφ(s; t)-θφ(so; t°)∣2)) / = 0,
(t,s)→(t0,s0)	(t,s)
which proves the continuity in S and t, so that 夕 ∈ C([0,S];C([0,1]; P2)). By combining all the
factors above, we conclude that 夕 ∈ Ωs.	■
23
Under review as a conference paper at ICLR 2022
Step 2. We show now that TS is a contraction map for S sufficiently small.
Proposition D.2 For any φ1,φ2 ∈ Ωs, we have
d2(TS(φ1),TS(φ2)) ≤ SQ2(LS,RS,S)d2(φ1,φ2),	(62)
where Q2 : R3 → R+ is an increasing function and LS = max{LS,φ1 , LS,φ2 }, RS =
max{RS,φ1 , RS,φ2}, with LS,φ, RS,φ defined in (55).
Proof Denote by θφi (s; t) the solutions to (54) with φ = φi using the same initial data, that is,
θφι (0; t) = θφ2(0; t).
As in the previous subsection, We translate the study of 夕i to the study of。@名.Defining
∆t(s) = ∣θφι(s;t)-θφ2(s;t)|,
We have according to the definition of Wasserstein distance that
d2(Ts(Φι),Ts(φ2)) ≤	sup E (∆2(S)).
(t,s)∈[0,1]×[0,S]
Using (54), We obtain
d^ ≤ 4(∆t(s))2 +4 VθδE⅜≡(θφι,t) -VθδE≡l(θφ2,t) 2
ds	δρ 1	δρ 2
≤ 4(∆t(s))2 + 8 VθδE(φp(s))(θφι,t) — VθδE(φp(s))(θφ2,t) 2	(63)
+ 8VθδE(≡(θφ2,t)-Vθ-(θφ2 J .
δρ	δρ
The second term on the right hand side involves the continuity addressed in Lemma C.2 (42)
Vθ δE(Φp(s))(θφι,t)-Vθ δE(φp(s))(θφ2,t) 2 ≤ C(LS, RS,S)(∆t(s))2,
Where We use the second bound in (56) to substitute the constant in (42). Then the last term of (63)
involves the continuity discussed in (43). In particular, We have
Vθ δE⅜≡(θφ2 ,t)-Vθ δEφ≡ (θφ2 ,t)
δρ	δρ
≤C(Rs ,42 ,[i]l)(1 + ∣θφ2∣)d1(Φ1,Φ2) ≤ C(LS, RS ,S )(1 + ∣θφ2 ∣)d2(Φι,Φ2),
Where d2 is defined in Definition 4.1 and in the second inequality We use the second bound in (56) to
substitute the constant in (43).
By substituting in (63), We obtain
d(∆dSs))2 ≤ C(LS, Rs, S) [(∆t(s))2 + (1 + ∣θφ2 ∣2)d2(φι,φ2)],
Which implies
d (E(；S(S))2) ≤ C(LS, Rs,S) [(E(∆t(s))2) + d2(φι,φ2)],
where we use the first inequality in (56). From the Gronwall inequality, there exists Q2 : R3 → R+
is an increasing function such that
E ((∆t(s))2) ≤ SQ2(Ls, RS, S)d2(Φι,Φ2),
completing the proof.	■
To apply the contraction mapping theorem, we need to verify two conditions in order to show that
there exists a fixed point φ* = TS(φ*):
24
Under review as a conference paper at ICLR 2022
•	There is a closed subset in Ωs such that TS maps this set to itself.
•	TS is a contraction map in this subset.
For the closed subset, we define
Bpo = {Φ ∈ Ωs∣supp(φ(t, S)) ⊂ {θ∣∣θ[i]∣ ≤ 4(Rmi + 1)},	∀(t, S) ∈ [0,1] × [0,S]}
∩ {φ ∈ Ωs∣Z%∣Θ∣2 dΦ(θ,t,s) ≤ 4(LsuP + 1), ∀(t,s) ∈ [0,1] × [0,S]}.	(64)
We now claim that for small enough S, TS is a contraction map in Bρ0 .
Proposition D.3 Suppose that S is small enough that
exp(SQ1(4(Lisnuip + 1))) (Lisnuip + 1) ≤ 4(Lisnuip + 1,
exp(SQ1(4(Lisnuip + 1))) (Rini + 1) ≤4(Rini+1),
SQ2(4(LSUp + l), 4(Rmi + 1),S) < 1,
where Q1 and Q2 are defined in Corollary D.1 and Proposition D.2, respectively. Then we have the
following.
•	If φ ∈ Bρ0, then TS (φ) ∈ Bρ0, that is, for any (t, S) ∈ [0, 1] × [0, S], we have
SuPP(TS(φ)(t, S)) ⊂ {Θ∣∣Θ[1] | ≤ 4(Rini + 1)},
and
£ ∣θ∣2 dTs(φ)(θ,t,s) ≤ 4(LsuP + 1).
(65)
(66)
•	TS is a contraction map in this subset, meaning that for any φ1 , φ2 ∈ Bρ0 , we have
d2(Ts(Φι), TS(Φ2)) < 1 d2(Φ1,Φ2).	(67)
Proof First, using Corollary D.1 (61) and noticing LS,φ ≤ 4 (Lisnuip + 1), we prove (65), (66). Then,
using (62) with (65) and (66), we have
d2(Ts (Φι), TS (φ2)) ≤ SQ2(4(LsuP + 1), 4(Rini + 1),S) < 2 d2(φ1,φ2),
which proves (67).	■
Using the contraction mapping theorem, we can obtain directly that TS (φ) has a fixed point in Bρ0
when S is small enough.
Corollary D.2 If S satisfies conditions in Proposition D.3, then there exists a unique φ*(θ, t, s) ∈
Bpo ⊂ Ωs such that φ*(θ, t, s) is a solution to (9) with initial condition ρini(θ,t).
This is a direct consequence of the application of contraction mapping theorem.
Finally, we prove that the cost function decreases along the flow.
Lemma D.1 Suppose that φ*(θ,t, s) ∈ C([0, S];C([0,1];P2)) solves (9) with initial condition
ρini (θ, t). Then for 0 < S < S, we have
dE(φ*,t,S)) = - Z 1 Z Vθ δEf≡ (θ,t) 2 dφ*(θ,t,s)dt ≤ 0.	(68)
dS	0	Rk ∣	δρ	∣
Proof Denote by θ*(s; t) the associated path, meaning that θ*(s; t) solves (54) with φ = φ*, then
θ* 〜φ*, meaning the distribution of θ* is φ*. According to (9), we obtain using a change of variable
that
dE(φTt,S)) = - Z 1 f Vθ δEf≡ (θ,t) 2 dφ*(θ,t,s)dt ≤ 0,	(69)
dS	0	Rk ∣	δρ	∣
which proves the result. We note that the derivation in (69) is formal. A rigorous proof can be found
in (Ding et al., 2021, Appendix I).	■
25
Under review as a conference paper at ICLR 2022
Step 3. In this final step of the proof, We extend the local solution from Corollary D.2 to a global
solution. Lemma D.1 shows that the formula of 喏,so we can then use this formula to improve
the bound for the support of the solution (61). This improvement Will be shoWn in the folloWing
corollary. This improved estimate helps in extending the local solution to the global solution.
Corollary D.3 For fixed S satisfying the condition in Proposition D.3, denote by φ*(θ,t, S) ∈
C([0, S]; C([0, 1]; P2 )) the solution to (9) with initial condition ρini (θ, t). Then for any (t, s) ∈
[0, 1] × [0, S], we have
I ∣θ∣2 dφ*(θ,t,s) ≤ C (S, Rini, Lsup),
Rk
supp(φ*(t,s)) ⊂ {θ∣∣θ[1]∣ ≤ C (S, Rini, Lsup)},
where the quantity C depends only on S, Rini, and Lisnuip).
(70)
Proof According to (61), it suffices to prove
Ls,Φ* =SUp 1 I ∣θ∣2 dφ*(θ,t,s)dt ≤ C (S, Rini, Lsup).
0≤s≤S 0	Rk
Denote by θ*(s; t) the particle representation of φ*, meaning that θ*(s; t) solves (54) with φ = φ*.
Since θ*(s; t)〜φ*(s; t),
Ls,φ* = SUP / / ∣θ∣2 dφ*(θ,t, s)dt
0≤s≤S 0	Rk
sup Z E (∣θ*(s; t)|2) dt.
0≤s≤S 0
Using (54), we obtain that
d∣θ*(s; t)|2
ds
≤ ∣θ*(s;t)| Vθ
δE"))
δρ
(θ*(s"),t),
which gives
d R01E (∣θ*(s; t)|2) d
ds
1
E (∣θ*(s; t)|2) dt
1 E	Vθ
δE "))
δρ
(θ*(s"),t)
2 dt
E (∣θ*(s; t)|2) dt)
dE(φ*(θ,t,s))
ds
where we use the HOlder inequality and (68) from Lemma D.1 in the last equality. Since
11 E (∣θ*(0; t)|2) dt ≤Lsuip,
0
S
0
dE (φ*(θ,t,s))
ds
ds ≤ E(ρini(θ,t)) - E(Φ*(θ,t,S)) ≤ C(Lsup),
we obtain
Ls,Φ* = OsUP / 1 E (∣θ* (u; t)|2) dt ≤ C (S, Lsup)
by GrOnWall's inequality. This proves (70).
By contrast with (61), this estimate removes the dependence of the bound on LS,φ. This improvement
is important because it relaxes the fixed-point argument from the dependence on the initial guess φ.
We are now ready to prove Theorem A.4.
Proof [Proof of Theorem A.4] From Corollary D.2, let S1 be a constant satisfying the conditions in
Proposition D.3. Then there is a local solution φ* ∈ C([0, S1]; C([0,1]; P2)) to (9).
26
Under review as a conference paper at ICLR 2022
We now denote by S * the largest time within which the solution exists, where We denote this solution
by φ* ∈ C ([0, S*);C([0,1]; P2)). We aim to show that S* = ∞. According to Corollary D.3 (70),
for any s < S* and t ∈ [0, 1], we have
/
Rk
∣θ∣2 dφ* (θ,t,s) ≤ C(S*, Rini, Lsup),
supp(φ*(t,s)) ⊂ {θ∣∣θ[1]∣ ≤ C (S*, Rini, Lsup)}
Define R* = Rs*,φ*, L* = LSuP@* according to (55). Since R*, L* < ∞, let US choose ∆s* small
enough to satisfy
exp(∆S*Q1(4(L*+1))) (L* + 1) ≤ 4(L*+1),	exp(∆S*Q1(4(L*+1))) (R* + 1) ≤ 4(R*+1),
δS* Q2(4(L* + I), 4(R* + I), δs* ) ≤ 2 ,
If S* is finite, then, using Proposition D.3 and Corollary D.2, we can further extend φ* to be supported
on C ([0, S* + ∆s*); C([0,1]; P2)), giving a contradiction. If follows that S* = ∞, as desired.
Finally, (21) is a direct result of Lemma D.1.	■
D.2 Proof of Theorem A.3
This section is dedicated to Theorem A.3 — we show the well posedness of the gradient flow in the
finite-layer case. We rewrite the gradient of (2) as follows
∂E(Θl,m )
∂θl,m
where pΘL,M (l; x) solves:
M1L Ex 〜μ (dθ f (ZΘL,M (l； x),θl,m )PΘL,M (l； X)),
(71)
l	p>L,M (l; x) = p>L,M (I + 1; x) (I + ML X dzf (ZθL,M (I + 1; x),θl+1,i))	(72)
[pθL,M (L - 1; x) = (g(ZθL,M (L; x)) - y(x)) Vg(ZθL,M (L； x)),
for 0 ≤ l ≤ L - 2. We unify the space in a similar fashion to Definition 4.1.
Definition D.1 ΘL,M = {θl,m}lL=-01,m,M=1 ∈ LL∞,M if and only if
SUP ∣θl,m∣ < ∞ .
l,m
The metric in LL∞,M is defined as
1 M	1/2
dl,L,M (Θl,m, ΘL,m) = max ( M X ∣θl,m - θl,m∣2 )
m=1
Definition D.2 For s ≥ 0, we have ΘL,M (s) = {θl,m(s)}lL=-01,m,M=1 ∈ C([0, ∞); LL∞,M) if and only if
1. For fixed s ∈ [0, ∞), ΘL,M (s) ∈ LL∞,M.
2. For any s0 ∈ [0, ∞),
lim d1,L,M (ΘL,M (s), ΘL,M (s0)) = 0 ,
s→s0
where d1,L,M is defined in Definition D.1.
The metric in C ([0, ∞); LL∞,M) is defined by
d2,L,M ΘL,M, Θe L,M = sup d1,L,M (ΘL,M (s), Θe L,M (s)) .
27
Under review as a conference paper at ICLR 2022
Theorem A.3 is to say that the solution to (3) is unique in C([0, ∞); LL∞,M) if ΘL,M (0) ∈ LL∞,M.
Before proving the theorem, prepare some a-priori estimates of ZΘL,M and pΘL,M.
Lemma D.2 Suppose that Assumption 4.1 holds and that X is in the support of μ. Let
ΘL,M = {θl,m}lL=-01,m,M=1 , and Θe L,M = nθel,mo
L-1,M
l=0,m=1
and denote
LΘL,M
L
Θe L,M
L-1 M
LM XX lθl,ml2,
l=0 m=1
L-1 M
LM XX 而,mF,
l=0 m=1
Rl,m = sup ∣∣θι ,m|, θel
,m o .
Then for 0 ≤ l ≤ L - 1, we have the following properties:
•	Boundedness in ZΘL,M:
ZΘL,M (l + 1; x) ≤C(LΘL,M),	(73)
•	Lipschitz in ZΘL,M:
ZΘL,M (l + 1;x) - ZΘe L,M (l + 1; x) ≤ C LΘL,M, LΘe L,M d1,L,M ΘL,M, Θe L,M ,
(74)
•	Boundedness in pΘL,M:
pΘL,M (l; x) ≤ C(LΘL,M),	(75)
•	Lipschitz in pΘL,M:
pΘL,M (l; x) - pΘeL,M(l; x) ≤ C (RL,M) d1,L,M ΘL,M, Θe L,M .	(76)
Proof From (1) and (12) we obtain
(∣ZΘL,M (I + 1; X)I + 1) ≤ CI (1 + LM X (lθl,ml2 + 1)) (IZΘL,M (l； X)I + 1)
m=1
≤ CI exP (LM X (同,m|2 + 1)) (1ZΘL,M (l； x)| + 1) ,
m=1
which proves (73) by iteration on l.
From (13) and (73) we obtain
ML X |dzf (zΘl,m (l + 1; x),θl,m) | ≤	IMLM) X (lθl,mF + 1),
m=1	m=1
which by (72) implies
lPθL,M (l； X)I ≤ (i+ CCeMLM ) X (Iθl,mF + 1)) lPθL,M (I +1； X)I .
m=1
From this bound, together with IpΘL,M (X, L - 1)I ≤ CIZΘL,M (L; X)I ≤ C(LΘL,M), we prove (75)
by iteration on l.
28
Under review as a conference paper at ICLR 2022
To prove (74), we subtract the two updating formulas and split the estimate to obtain
ZΘL,M (l + 1； X) - ZΘe L,M (l + 1； X)
≤ (1 + CMML XX (Iθl,mI2 + 1)) ^ΘL,M (l； X)- ZΘ l,m (l； X)|
+----( ILML θL'M) (M X (lθl,ml2 + lθl,ml2 + 1)! d1,L,M (θL,M, θL,M),
m=1
where we use (1) together with the bounds (13), and (73). Noting that IZΘL,M (0； X)-ZΘe	(0； X)I =
0, we prove (74) by iteration on l.
Finally, for (76), we subtract two equations in the form of (72), and use (72)-(75) together with
Lipschitz continuity to obtain
pΘL,M (l; x) - pΘeL,M (l; x)
M
m=1
+
≤
l C(RL,M )〃 (C K
H----L----d1,L,M (θL,M, θL,M
The initial data is also controlled, as follows:
1PΘl,m (L - 1； X)- PΘLM (L - 1； X)I ≤ C 1ZΘL,M (L； X)- ZΘLM (L； X)I
≤ C(RL,M)d1,L,M ΘL,M, ΘL,M
(77)
By combining this with (77), we prove (76) by iteration on l.
Lemma D.2 resembles Theorem A.2 and Lemma C.1. These estimates allow us to prove Theorem A.3.
Since the proof strategy is exactly the same, we omit details. Essentially we define a map
θ(s) = TSl,m(Θ0(s)) : C([0, ∞); L∞m) → ,C([0, ∞); L∞m),
where Θ(s) solves:
e
—Q = -MLVθE(Θ0(s)), for S ≥ 0,
ds
where Θ defines the forcing term. The estimates above provide all the ingredients to show the map is
well-defined, and for a small enough S, the map is also contracting, leading to the uniqueness of the
solution to (3). Similar to Lemma D.1, one can also show 祭 = -ML∖VθE(Θl,m)∣2, improving
the estimates and removing the constants’ dependence on the initial guess. This extends the local
solution to the global one, as done in Step 3 for the continuous case.
E Proof of Theorem 5.1
Theorem 5.1 links the cost defined by ΘL,M (S) with that defined by ρ(θ, t, S) for all S. The continuous
and mean-field limits are obtained, with both L and M sent to infinity. We decompose this result into
two parts, discussing mean-field and continuous limits separately.
We start with the full definition of "limit-admissible" for a distribution ρ.
29
Under review as a conference paper at ICLR 2022
Definition E.1 For an admissible ρ(θ, t), we say ρ(θ, t) is limit-admissible if the average of a large
number of particle presentations is bounded and Lipschitz with high probability. That is, for an
admissible ρ(θ, t), there are two constants C3 and C4, both greater than supt∈[0,i] Jrx ∣θ∣2dρ(θ, t)
such that, for any M stochastic process presentation {θm(t)}mM=1 that are i.i.d. drawn from ρ(θ, t),
thefollowing properties are satisfiedfor any η > 0 and M > C3:
1.	Second moment boundedness in time:
pf SUp ɪ XX ∣θm(t)∣2 ≤ C4) ≥ 1 - η.	(78)
t∈[0,1] M m=1
2.	For all L > 0, we have
2
θm(t) - θm ( L
dt ≤
C4
L2
≥ 1-η.
(79)
We now state the two theorems that play complementary parts in Theorem 5.1. The first theorem
addresses the limit in M under the assumption that L = ∞. This is the mean-field part of the analysis.
Theorem E.1 Let Assumptions 4.1 and 4.2 hold with some 0 < k1 ≤ k. Assume that ρini(θ, t) is
limit-admissible and suppθ(ρini(θ,t)) ⊂ {θ∣∣θ[i]∣ ≤ R} with some R > 0 forall t ∈ [0,1]. Suppose
that {θm(0; t)}mM=1 are i.i.d drawn from ρini (θ, t). Suppose in addition that
•	ρ(θ, t, s) solves (9) with the initial condition ρini (θ, t), and
•	θm(s; t) solves (6) with the initial condition θm(0; t).
Then for any , η, S > 0, there exists a constant C(ρini(θ, t), S) > 0 depending on ρini (θ, t), S such
that when M > C(Pi吗㈤⑼,we have
P(∣E(Θ(s;∙)) - E(ρ(∙, ∙,s))| ≤ E) ≥ 1 -η, ∀s<S.
Proof See Appendix F.	■
The conclusion of this result suggests that for a 1 - η confidence of an E accuracy, M grows
polynomially with respect to 1/e and 1∕η.
The second result considers the convergence of the parameter configuration for the discrete ResNet
(1) to that for the continuous ResNet (4) as L → ∞. This is the continuous-limit part of the analysis.
Theorem E.2 Let Assumptions 4.1 and 4.2 hold with some 0 < k1 ≤ k. Assume that ρini(θ, t) is
limit-admissible andsuppθ(ρini(θ,t)) ⊂ {θ∣∣θ[i]∣ ≤ R} with some R > 0forallt ∈ [0,1]. Suppose
that {θm (0; t)}mM=1 are i.i.d drawn from ρini (θ, t). Suppose in addition that
•	θm(s; t) solves (6) with initial condition θm(0; t),
•	θι,m(s) solves (3) with initial condition θm(0; L).
Then for any E, η, S > 0, there exists a constant C(ρini (θ, t), S) > 0 depending on ρini (θ, t), S such
that when M ≥ C(Pini∖tt)S and L ≥ C(Piniy,t),S), we havefor all s < S that
P(∣E(Θ(s; ∙)) - E(Θl,m(s))l ≤ E) ≥ 1 - η.
Proof See Appendix G.	■
This theorem shows that when the width is large enough, then with high probability, in the whole
training process with s < S, the difference between the loss functions defined by the discrete ResNet
and its continuous counterpart decreases to 0 as L → ∞.
30
Under review as a conference paper at ICLR 2022
F Convergence to the mean-field PDE
This section is dedicated to mean-field analysis and the proof of Theorem E.1. The intuition of this
theorem is largely aligned with many other mean-field results, as demonstrated in (Ding et al., 2021).
As argued in Section 5, to show “equivalence" between (6) and (9), we can test them on the same
smooth function h(θ). Testing (9) on amounts to multiplying h on both sides of the equation by h.
From integration by parts we have
-d Z hdρ(θ) = — Z VθhVθ δE(P(s)) dρ,
ds Rk	Rk	δρ
that is,
d-E(h) = E (VθhVθ δE(P(s))).
ds	δρ
To test (6) on h, We let P = M PM=I δθm and obtain
d	1 M	d	M	δE
dSE(h) = M X vθh(θm) dSθm = - X vθh(θm)褥.
We see that (9) and (6) are equivalent When tested by h, if and only if the right hand sides of the tWo
equations above are the same, that is,
MδE = Vθ δE(ρ)(θm,t).	(80)
δθm	δρ
This claim can be established from the definitions of the Frechet derivatives for δE(ρ and -⅛E; see
δρ	δθm
(Ding et al., 2021, Lemma 33).
To give a quantitative estimate on hoW quickly (6) converges to of (9), We utilize the particle
method, a classical strategy for the mean-field limit. We sketch the proof here and Will it more
rigorous in the folloWing subsections. We make use of tWo particle systems. In one system, the
particles evolve themselves, While in the second, the particles are moved forWard according to the
underlying field constructed by the limit. In our situation, the former particle system consists of the
M stochastic processes {θm(s; t)} that descend according to E(Θ(s; ∙)). The latter particle system
will be termed Θ(s; t) = {θm(s; t)}M=1; it descends according to E(ρ(∙, ∙, s)), the limiting cost
function. Essentially, We prove
E(Θ(s; •)) ≈ E (Θ(s;t)) ≈ E(ρ(∙, ∙, S)).
The latter approximation arises roughly from the law of large numbers, but the former needs to be
proved rigorously by tracing the two different evolving ODEs.
To be more specific, let ρ(θ, t, S) be the solution to (9) with admissible initial conditions ρini(θ, t),
and let θm (S; t) be the solution to (6) with initial conditions {θm (t, 0)}mM=1 that are i.i.d drawn from
ρini (θ, t). Using the definition of E in (8), we have
∣E(ρ(∙, ∙,s)) - E(Θ(s; ∙))∣
≤Ex 〜μ
1	21	2
2 (g(ZP(S)(1;x)) - y(X)) — 2 (g(Zθ(s)(1;x)) - y(X))
≤Ex〜“ (|g(zp(s)(1；X))- g(Zθ(s)(1;X))IQg(ZP(S)(1；x)) + g(Zθ(s)(1; χ))∣ + Iy(X)|))	(81)
≤C(Ls) g(Zρ(s)(1; X)) - g(ZΘ(s)(1; X))
≤C(Ls)∣Zρ(s)(1; X)- Zθ(s)(1; X)| ,
where LS = max {∕01 RRk ∣θ∣2 dρ(θ,t, s)dt,吉 R01 PM=I ∣θm(s; t)|2 dt . In this derivation, we
used the Lipschitz property of g, the boundedness of y (required in Assumptions 4.1-4.2), and the
boundedness of ZP and ZΘ(S). Boundedness of ZP was shown in Theorem A.2, while the bound for
ZΘ(S) will be addressed in Lemma F.3. The constant C depends on the support of ρini, as well as on
31
Under review as a conference paper at ICLR 2022
S and the LiPschitz constant of g. It follows from (81) that to control E(ρ(∙,∙, S)) - E(Θ(s; ∙)), We
need to control
Zρ(s) (1; x) - ZΘ(s) (1; x) .	(82)
To do so, we emPloy the Particle method and invent a new Particle system.
According to (80), we can reformulate the original Particle system as
dθm(s; t) = -Vθ δE(pdls(s)) (θm(s; t)), ∀(t,s) ∈ [0,1] × [0, ∞),
dS	δρ
where we denote
1M
P (θ,t,s) = MM Σ>θm3t)(θ).
(83)
(84)
We invent a new system that follows the underlying flow governed by the limit. Define Θ(S)
M
{θm(s; t)}M=ι, where θm solves
∙dθ⅛^ = -Vθ δEρ≡ Rm (s；t)) ,	∀(t,s) ∈ [0,1] × [0, ∞),
(85)
with initial condition
θm(0; t) = θm(0; t) .	(86)
As a consequence, We have θm(s; t)〜ρ(θ, t, S) for all (t, s). The corresponding ensemble dιstπbu-
tion is
1M
edis(θ,t,s) = MM X δem(s.)(θ).	(87)
m=1
TL T	1	∙1	11	. ∙	1	.	Z-X /	∖	r Zi /	∖~∖	1	.	1	. ∙	1	.	Px /	∖
Now we have available particle system Θ(S) = {θm(S)}, a newly invented particle system Θ(S) =
{θm(S)} and the mean-field flow ρ. Accordingly, there are three versions of Z: Zρ(s) that solves (7)
using ρ(S) and ZΘ(s) and ZΘe (s) that solve (4) using Θ(S) and Θ(S), respectively. We use the
following relabelling for convenience:
dis	edis
Zs = Zρ(s) ,	Zs	= ZΘ(s) ,	Zs	= ZΘe (s) .
(88)
Similarly, there are three sets ofp: pρ(s), pρdis(s), and pρedis(s) that solve (11) using ρ(S), ρdis(S), and
ρedis(S), respectively. We relabel similarly to (88) and write
ps = pρ(s) , psdis = pρdis (s) ,	pesdis = pρedis (s) .	(89)
Since Θ(S) serves as a bridge, we translate the control of (82) to:
Zs(t;x)-Zsdis(t;x) ≤ Zs(t; x) - Zesdis(t; x) + Zesdis(t; x) - Zsdis(t; x) .	(90)
Bounding Zs (t; x) - Zesdis(t; x) can be done using the law of large numbers. Bounding
Zesdis(t;x) -Zsdis(t;x)
translates to controlling Pm R1 ∣θm(s; t) - θm(s; t)| dt, for which we will
evaluate the difference between equations (83) and (85). Since these two equations have the same

initial data, the difference between θm and θm can then be controlled when the right-hand side forcing
terms are close.
This approach divides the proof naturally into two components. In Section F.1, we give the rigorous
bound of (90), while in Section F.2, we trace the evolution of the difference Pm R(I ∣θm(s; t)-
θm(S; t)| dt in S, thus finalizing the proof for Theorem E.1.
32
Under review as a conference paper at ICLR 2022
F.1	Stability in the mean-field regime
Here we discuss control of the two terms on the right-hand side of (90). Recall that Θ(S) and Θ(S)
satisfy (83) and (85), and the two corresponding ensemble distribution are defined in (84) and (87),
respectively. For any S > 0, define
Lsup
sup
0≤t≤1,0≤s≤S	Rk
1M	1M
lθl dρ(θ,t, s), M X lθm(S; t)| , M X lθm(S; t)|
i=1
i=1
(91)
2
RS = r>0 {supp(ρ(θ,t, S)) ∪ {θm(s; t)}MM=ι ⊂ {Θ∣∣Θ[1]I < r}, ∀(t, S) ∈ [0,1] × [0, S]},
We have the following lemma:
Lemma F.1 For every fixed s, let Zs and Zsdis be as defined in (88). Then there exists a constant
C (Lssup) such that for all t ∈ [0, 1], s ∈ [0, ∞), we have
—
≤ C(Lsup) & X
2	1/2
m=1
θm (s; τ) - θm(s; τ)	dτ
(92)
+ C(Lssup)
Z 1 Z
0R
Rk
f (Zs(τ; x), θ) d(ρ(θ, τ, S) - ρedis(θ, τ, S))∣∣ dτ!

Proof Since the statement holds for a fixed S, we eliminate all S dependence in all calculations in the
proof, for conciseness.
Recalling the definitions in (88), we denote
∆e (t; x) = Zs(t;x) - Zesdis(t;x),	∆(t; x) = Zesdis(t;x) - Zsdis(t;x) .
It follows from the triangle inequality that
∣Zs(t;X)- Zdis(t;χ)∣ ≤ ∣∆(t;x)| + ∣∆(t;x)∣.
We now bound these two terms. We first apply the same argument as in the proof of Theorem A.2
(see (26) in Appendix B) to obtain
d ∆e(t; x)
dt
≤ C(Lsup) ∣∆(t;x)
|2
f (Zs (t; x),θ) d(ρ(θ,t,s) - Pdis(θ,t,s)).
Using the Gronwall inequality and the fact that ∣∆ (0; x)| = 0, We have
∆e(t; x) ≤C(Lssup)
Z 1 Z
0R
Rk
f (Zs(t; x), θ) d(ρ(θ, t, S) - ρedis(θ, t, S))∣∣∣2 dτ!	.	(93)
for all t ∈ [0, 1]. Similarly, to bound ∆(t; x), we have
2
d ∣∆(t; x)|2
dt
≤C(LSup) ∣∆(t;x)|
f Zesdis (t; x), θ	d(ρdis(θ, t, s) - ρedis(θ, t, s))	.

From Assumption 4.1 and the fact that Zdis is bounded in Theorem A.2, we have
Lkf(ZdS(t x),θ) d(ρdis(θ,t, s) - ρdis(θ, t, s))
2	1M|
≤ C(Lsup) (MjE∣θm(s; "θm(s; t)
2
similar to the proof of Theorem A.2 (see (28) in Appendix B).
33
Under review as a conference paper at ICLR 2022
Using ∆(0; x) = 0, We apply GrOnWall's inequality to obtain
∆(t;x)l ≤ C(L
θm(s; T) - θm(s; T)
1/2
2 dT!
(94)
The result is obtained from adding (93) and (94).
The difference in ps and psdis :
Lemma F.2 For every fixed s ∈ [0, ∞), let ps and psdis be defined in (89). There exists a constant
C(Rs) with Rs, Lssup defined in (91) such that for all t ∈ [0, 1]:
ps (t; x) - psdis (t; x)
≤ C(Rs, Lsup) & X
m=1
2	1/2
θm(s; T) - θm (s; T)	dT

+C(Rs,Lssup)
Z 1 Z
0R
Rk
2	1/2
f (Zs(T; x), θ) d(ρ(θ, T, s) - ρedis(θ, T, s))	dT
(95)
+C(Rs,Lssup)
Z 1 Z
0R
Rk
2	1/2
∂zf (Zs (T; x), θ) d(ρ(θ, T, s) - ρedis(θ, T, s))	dT
Proof As in the previous proof, We eliminate dependence on s in some notation, for conciseness.
Denoting ∆p(t; x) = ps(t; x) - psdis(t; x), We recall (11) to have:
d∣∆p (t; x)|2
≤2
dt
ʌ ∂zf (Zs(t; x),θ)dρ(θ,t, s) ∣∆p(t; x)∣2
+ 2∣∆p(t; x)| Ipdisl |£dz f (Zs(t; x),θ) dρ(θ,t, S) - L Mdz f (Zdis(t; x),θ) dρdis(θ,t, S)
≤ C(Lsup)∣∆p(t;x)∣2
+2	∂zf(Zs(t; x), θ) dρ(θ, t, S) -	∂zf (Zsdis(t; x), θ) dρdis(θ, t, S)
≤C(Lsup)∆p(t; x)|2
2
+ 6 l/fc ∂zf (Zs(t； x),θ) dρ(θ, t, S)- /∕zf (Zs(t； x), θ) dedis(θ, t, S)
2
2
+6	∂zf(Zs(t; x), θ) dρedis(θ, t, S) -	∂zf (Zs(t; x), θ) dρdis(θ, t, S)
'--------------------------------------------------------------------
{Z
(I)
+6	∂zf(Zs(t; x), θ) dρdis(θ, t, S) -	∂zf(Zsdis
Rk	Rk
X------------------------------------------------------
^z
(II)
2
(t; x), θ ) dρdis (θ, t, S)	,
}
}
Where We use (13) from Assumption 4.1 together With (18) and (31) in the second inequality. To
bound (I) on the right-hand side, We recall the definition (84) and (87), and use Assumption 4.1 (14)
34
Under review as a conference paper at ICLR 2022
along with the boundedness of Z (as shown in (18)) to obtain
1M	2
(D ≤ 而 X ∣∂z f(Zs(t; x),θm(s; t)) - ∂z f(Zs(t; x),θm(s; t))|
m=1
≤C(Rs, LsuP) M M X ∣θm (s；t) - em (S； t)∣!
≤C(Rs, Lsup)	XX ∣θm(s; t) - θm(s; t)∣J ,
where We use Holder,s inequality in the last inequality. For (II), We have
1M
(II) ≤ (MEIdZ f (Zs (t; x),θm(s; t)) - ∂z f(Zd (t; x),θm(s; t))∣
m=1
≤ C (Rs, LsuP)∣Zs(t; x) - Zd* is(t; x)∣2.
By substituting (96) and (97) into the bound above, We obtain
d∣∆p (t; x)∣2
dt
(96)
(97)
2
1 M ∣	∣2
=C(LsuP) ∣∆p(t; x)∣2 + C (Rs,	LsuP)	MJ	X	∣θm(s; t)	- θm(s; t)∣	+ ∣Zs(t; x)	-	Zdis(t;	x)I2
m=1
+ 6 l/fc ∂zf (Zs(t； x), θ) dρ(θ, t, S)- /∂zf (Zs(t; x),θ) dedis(θ, t, S)
2
The “initial condition" for ps and psdis yields
∣∆p(1; χ)∣≤ C(LsUP)IZs(1; X)- Zdis(1;x)|.
(98)
The result is obtained When We substitute (92) into (98) and use the GronWall’s inequality.
F.2 Proof of Theorem E.1
With the quantitative description of (90) presented in Lemma F.1, We complete the proof for Theo-
rem E.1 in this section. Recall from (55) that
Rini=r>0	{supp(pini(t))	⊂ {θ∣ιθ[1]1 <*，∀t	∈ [°，1]}，LsuP=0≤up1 JC lθl2	dρini(θ,t)
and note that Rini ≥ Iθm,[1] (0; t)I for all m, t. Define
dis,suP
Lini
1M
sup T7 E lθm(0; t)|2 ,
0≤t≤1 M m=1
We note that When M is large, Lidniis,suP is close to LisnuiP (Which has no randomness) With high
probability. We have the folloWing lemma:
Lemma F.3 For a given S > 0, there exists a constant C (S, Rini) such that for any t ∈ [0, 1], S ∈
[0, S], we have
1M
M X ∣θm(s; t)I2 ≤ CS Rini, LdruP),
m=1
{θm(s; t)}M=1 ⊂{θ∣∣θ[1]l ≤ C (S, Rini, Ldns由)},
(99)
35
Under review as a conference paper at ICLR 2022
Furthermore, for any X with |x| < Rμ (as in Assumption 4.2, item 4), and any S ∈ [0, S] and
t ∈ [0, 1], the ODE solution is bounded as follows:
Zsdis(t;x) ≤C(S,Rini,Lidniis,sup),	(100)
while the following bound holds on psdis :
psdis (t; x) ≤ C(S,Rini,Lidniis,sup).	(101)
The bound (99) is a result of Corollary D.3. The bounds (100) and (101) are obtained using the same
arguments as in Theorem A.2 and Lemma C.1.
The next lemma bounds the support and second moment of ρedis(θ, t, s).
Lemma F.4 Under conditions of Theorem E.1, for any S > 0, there is a constant C(S, Rini, Lidniis,sup)
depending only on Rini, Lidniis,sup, S such that for any t ∈ [0, 1], s ∈ [0, S], we have
1M
mm X ∣θm(s; t)∣2 ≤ C (S, Rini, Ldrup),
m=1
(102)
{em(s; t)}M=ι ⊂{θ∣∣θ[1]∣ ≤ C (S, Rini, Ldrup)},
Proof Similar to the proof of Proposition D.1, we multiply (85) by θm(s; t) on both sides and utilize
the bound (41) from Lemma C.2, where L in (41) is replaced by C(S, Rini, Lidniis,sup) according to
Corollary D.3. We thus obtain
|em(S； t)| ≤ C(S, Rini, Ldrup) (lem(O； t) I + 1),
and
Iem,[1](s; t)I ≤ C (S, Rini, Ldrup) (lem,[1](0; t)I + l)
which implies (102) by (86).	■
Denote Ls0up = max{Lidniis,sup, Lisnuip}. According to Definition E.1 (78), Ls0up should be bound by
C4 with high probability. We are now ready for the main proof of this section.
Proof [Proof of Theorem E.1] First, using Lemmas F.3, F.4, there is a constant C(S, Rini, Ls0up)
depending only on Rini, Ls0up, S such that for any t ∈ [0, 1], s ∈ [0, S]
1 M	2	1 M
maχ{ / lθl2 dρGt,s), M X ∣θm(s; t)l , M X lθm(S；t)|2 >
Rk	M m=1	M m=1
≤ C(S,Rini,Ls0up),
SUPP(ρ(θ, t,s)) ∪ {θm(s; t)}M=ι ∪ {θm(s; t) }：= ɪ ⊂ {θ∣∣θ[1]∣ ≤ C (S, Rini, L0up)}
Recalling (81), we have Ls ≤ C(S, Rini, Ls0up) and
∣E(ρ(∙, ∙, s)) — E(Θ(s; ∙))∣ ≤ C (S, Rini, L0up)∣Zs(1; X)- Zdis(1; x)∣ .
FUrthermore, according to Lemma F.1 (92), from (103)
∣Zs(t; X)- Zdis(t; x)∣
(103)
(104)
+C(S,Rini,Ls0up)
≤ C(S, Rini, L
θm (S; τ) - θm (S; τ)∣∣ dτ
2	1/2
2	1/2
f (Zs (τ; x), θ) d(ρ(θ, τ, S) - ρedis(θ, τ, S))∣ dτ
(105)

The second term in this boUnd can be treated Using the law of large nUmbers. We focUs on controlling
the first term.
36
Under review as a conference paper at ICLR 2022
Step 1: Estimating 焉 PM=I R01 ∣θm(s; t) - em(s; t)I dt. Defining
ʌ ∕∖ 八/ ，\ 7Γ /	，、
△t,m(s) = θm(s; t)-θm(s; t),
we note that A,m,(0) | = 0. By taking the difference of (83) and (85) and multiplying both sides by
△t,m(s), we obtain
d∣∆t,m(s)∣2
ds
-2 0t,m (s), Ex 〜μ (∂θ f (Zs(t; x), θm)ps(t; X)- ∂θ f (ZdIS(t; x), θm)pdis(t; x)))
-2 (∆t,m(s), Exi (∂θ f(Zs(t; x),θm)ps (t; X)- ∂θ f(Zs(t; x),em)pdis(t; x)):
(I)
(106)
-2 (4t,m(s), Ex〜μ
0
(∂θf (Zs(t; x),em)pdis(t; x) - ∂θf (Zdis(t; x),θm)pdis(t; x)
{^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^—
(II)
For (I), we have from the bounds of ZS in (18), respectively, that
∣(I)∣ ≤ C(S, Rini, LOUP)(藐∣ + 1)Ex〜“(∣ps(t; x) -pdis(t; x)∣),
which can be controlled using Lemma F.2 (95). For (II), we have
∣(II)∣ ≤C(S, Rini, LOUP)Ex〜“ (∣∂θf(Zs(t; x),θm) - ∂θf(Zdis(t; x),θm) ∣ )
≤C(S, Rini, L0up)艮〜“(∣ ZS(t; x) - Zdis(t; x) ∣ ) + ∖θm - θm∣],
where the first term can be controlled using Lemma F.1 (92). In both estimates, we used the property
of f in Assumption 4.1 and bounds on Z, p, θmji], and θmji]. By substituting these estimates into
(106), we obtain
d∣△心)∣2 ≤ C(S,Rini,L0up)∣△刖(s)∣2
+ C(S, Rini, LOUP)I△刖(S)IEx〜“(∣ Zs(t; x) - Zdis(t; x) ∣ )
+ C(S,Rini,LOUP)I△加(s)∣ (∣em∣ + 1) Ex〜“(∣ps(t;x) -pdis(t;x) ∣ ),
which implies that
1匹
M X
m=1
d∣dm(s)∣2
ds
/ I M
≤ C(S, Rini, L0up) (M∙ Edm(s)∣2
+ C(S, Rini, LOup)(三 X dm(s)∣) Ex〜“(∣ Zs(t; x) - Zdis(t; x) ∣ )
m=1
+ C(S, Rini, LOup) (M∙ X 4,m(s)∣ (∣θm∣ + 1)) Ex〜“(∣ps(t; x) -pdis(t; x) ∣ )
≤ C(S, Rini, LOup) G X dm(s)∣2) + C (S, Rini, LOUP)Ex 〜“ (∣ps(t; x) - pdis(t; x) ∣ 2)
∖	m=1	)
+ C (S, Rini, LOUP)Ex 〜“ (∣ Zs (t; x) - Zdis(t; x) ∣ 2),
(107)
37
Under review as a conference paper at ICLR 2022
where in the last inequality we use Holder’s inequality
G XX ∆t,m(s)∣ 脩1 + ι)) Ex 〜“ Qps(t; X)- pdis(t; X)D
m=1
1M
≤ IM 2 dm
≤C(S,Rini,Ls0up)
≤C(S, Rini, L0up) ] (E X ∣∆t,m(s)∣2) + Ef (∣Ps(t; X)- pdis(t; x)∣2)
m=1
Noting the estimate in Lemma F.1-F.2, we obtain
d M∙ PM=J01∆t,m(s)∣2 dt
ds
≤ C(S,Rini,L
∣∆t,m(s)∣2 dt
+C(S,Rini,Ls0up)Ex
+C(S,Rini,Ls0up)Ex
Rk
f (Zs(τ; x),θ) d(-edis(θ,τ,s)) 2 dτ
Rk
∂z f (Zs(τ; x),θ) d(-edis(θ,τ,s)) 2 dτ),
which implies, using GronWall's inequality, that
Mm X
m=1
1
∣∆t,m(s)∣2 dt
+ C(S, Rini, Ls0up)Ex
≤ C(S, Rini, Ls0up)Ex
f (Zs(t; X), θ) d(ρ(θ, τ, s) - ρedis(θ, τ, s))	dτds
Rk
∂z f (Zs(t; x),θ) d(ρ(θ,τ,s) - Pdis(θ,τ,s)) dτ ds ),
where we use ∣∆t,m(0)∣ = 0.
(108)
2
38
Under review as a conference paper at ICLR 2022
Step 2: Completing the proof. By substituting (108) into (92), noticing Rs ≤ C(Rini, S), we obtain
(109)
All three terms in (109) can be controlled in expectation. Here we take the expectation with respect
to the randomness initial drawing of {θm(0; t)}mM=1. For (I), we have
E(I) = E
≤ C(S, Rini, LsuP)
Rk
f (Zs(τ; x), θ) d(ρ(θ, τ, s) - ρedis(θ, τ, s))∣∣∣ dτds
ɑf (Zs (τ； x),θ) d(ρ(θ,τ,s) - ρdis(θ,τ,s
dτ ds
If (Zs(τ; x),θ) |2 dρ(θ,τ, s)dτ ds
M
≤ C(S, Rini, LsuP)
M
where we use θm(s; t)〜ρ(θ, t, S) In the first inequality. In second inequality, If kι < k, we use first
inequality of Assumption 4.1 (15) with IIθ[1] II ≤ C(S, Rini, LisnuiP) and |Zs| ≤ C(S, Rini, LisnuiP). If
kι = k, we use (12) and ∣θ∣ = ∣θ[i] ∣ ≤ C (S, Rini, Lsup) and |Zs| ≤ C (S, Rini, LsUiP) in the second
inequality. By similar reasoning, we obtain
E(II) ≤
C(S,Rini,Lisnuip)
, E(III) ≤
C(S,Rini,Lisnuip)
From Markov’s inequality, these bounds imply that when M >
M
C(Rini,S,LSUip)
e2η
, we have
P ({(I) < e2} ∩ {(II) < e2} ∩ {(III) < e2}) > 1 — n/2 .
Finally, using Definition E.1 (78), when M > 2C3,
P (L0up ≤ C4) ≥ 1 - n/2.
(110)
(111)
By substituting (110) and (111) into (109), we see that there exists a constant C(Rini, C3, C4, S)
such that for any , η > 0, when M >
C(Rini,C3,C4,S)
we obtain that
P(IZs(1;X)-Zdis(1;x)| <e) > 1 -η.
By using this result and (111) in conjunction with (104), we complete the proof.
M
否
39
Under review as a conference paper at ICLR 2022
G Convergence to the continuous limit
This section is dedicated to the continuous limit and, in particular, the proof of Theorem E.2.
G. 1	Stability with discretization
Before proving Theorem E.2, and similarly to Appendix F.1, we first consider the stability of Z andp
under discretization. Defining the path of parameters Θ(t) = {θm(t)}mM=1 and the set of parameters
ΘL,M = {θl,m}lL=-01,m,M=1, we have the following lemma.
Lemma G.1 Suppose that AssumPtion 4.1 holds and that X is in the support of μ. Denoting
1M	1M
LsUp = 0-4 MM X∣θl,m∕ X∣θm 叫
R= rin>f0
n{θl,m}m=1,l=1∪{θm(t)}M=1 ⊂{θ∣∣θ[1]∣<r}, ∀t ∈ [0,1]},
(112)
there exists a constant C(R, Lsup) depending only on R, Lsup such that for any 0 ≤ l ≤ L - 1, we
have
SUP { IZΘ (t; X) - zΘl,m (I; X) I , IZΘ (t; X) - zΘl,m (I + 1; X) ∣}
L ≤t≤+
≤ C (R, Lsup) (MM X X Zɪ ∣θl,m -θm(τ )12 dτ!	+ C(RjLsUp)
∖vi l=0 m=1，LL	)
and
sup IpΘ (t; X) - pΘL,M (l; X)I
Ll ≤t≤l+1
≤ C(R, LsUp) (MM X X 广dm -θm(τ)12 dτ!1/2 + CRP
∖vi l=0 m=1，E	)
(113)
(114)
Proof Define
Z(t; X) = ZΘ (t; X),	p(t; X) = pΘ (t; X) ,
and
L-1	L-1
Z(t; X) =): zΘl,m (l; x)1 LL ≤t< l+1 ,	p(t; X) =): PΘl,m (l; x)1 L <t≤ l+1 ,	(115)
l=0	l=0
with
Z(1;X) = ZΘL,M (L; X), pe(0; X) = pΘL,M (0; X) .	(116)
Using (1), (72), Assumption 4.1, and Lemma D.2 (73) and (75), we obtain for all l
that
C(LsUp)
lZθL,M (I + 1; X) - ZΘL,M (l; x) l <	L	,
lpθL,M (I + 1; X) — pθL,M (l; X)I <	L	.
Now define ∆t by
∆t = Z(t; X) - Z(t; X) .
For t ∈ [L, l+1 ],we have from (4) that
0,1,...,L- 1
(117)
∣∆t∣ ≤ ∣δ
If (Z(τ; X),θm(τ))∣dτ
≤∣∆山 CP X 广(5)I2 + 1)dτ
m=1 J L
≤1δ d +
C(LsUp)
L
(118)
40
Under review as a conference paper at ICLR 2022
where we use (12), (18), and (112) in the last two inequalities. From (1) and (4), we obtain further
that
Iδ ⅛iI = Iδ∕ +
1 M	.1±1	〜
M X I	f (Z(τ; x),θm(τ)) — f (Z(τ; x),θl,m) dτ
≤i δ i i+
m=1 J L
1	∕*⅛1
M E ∕j	f(Z(τ; x),θm(τ)) — f (Z(τ； x),θι,m) dτ
m=1 J L
1 M	1±1	〜
M XL	f (Z(τ; x),θl,m) - f (Z(τ; x),θl,m) dτ
(I)	( 1 M	l+^	,
≤ I ∆ ⅛∣+ C(LSUP)而 XL L (∖θm (τ )∖ + ∖θl,m∖ + 1)∖θm(τ) — θl,m∖ dτ
∖ m=1 J L
1M
+ C (Lsup)∖∆ξ ∖ 近 E(∖θl,m∖2 + 1)
∖	m=1
< (1 + F)I △ J+C(Lsup
(∣θm(τ)∣ + ∖θl,m∖ + l)∣θm(τ) - θl,m∖ dτ
+ C (Lsup)
where ξ ∈ [L,+],and we used the mean-value theorem with (13), (18), (73) in (I) and (112), (118)
in (II). By applying this bound iteratively, we obtain
∣ ∆l I ≤ C(Lsup) ∖∆0∖+C(Lsup) ( MM X X	(∖θm(τ)∖ + ∖θl,m∖ + 1)∖θm(τ) — θl,m∖ d“+ C(LSup)
∖	j=0 m=1
where ∖∆0∖ = 0. By combining this bound with (118) and using Holder,s inequality with (112), we
obtain that
∖∆t∖≤ C(Lsup) (MM X X Aɪ ∖θl,m - θm(τ)∖2 dτ)	+ C(Lsup)
(119)
∖	l=0 m=1 J L
By combining (119) with (117), we prove (113).
To prove (114), we define
∆p (t; x) = p(t; x) — P(t; x).
Similarly to (34), we obtain
∖∆p(1;x)∖ ≤ C(LSUP)∣ Z(1;x) — Z(1;x)
≤ C(LSUP) (E X X 广 ∖θl,m - θm(τ)∖2 小)+
∖01 l=0 m=1 J E	)
For t ∈ (V, l+1] and using (11), we obtain that
(120)
+
m=1 J L
∖∆p (t； X) ∖≤ I △;
M fl+ι
X /	∖∂zf (Z(τ; x),θm(τ))∖ ∖p(τ; x)∖ dτ
' m	m '	m=1 "
≤ ∆p (中;x)∣ + 中
t
M f l+ι
X /: (∖θm(τ)∖2 + 1)dτ
m=1 J E
MM
≤ ∆p (*; x)∣ + F
(121)
41
Under review as a conference paper at ICLR 2022
where we use (13), (18), and (31) in the second inequality and the definition of Lsup from (112) in
the last line.
From (11), we obtain that
p>( Ll ; x)=p>( l+1; x) + M X Li L
p> (τ; x) ∂z f(Z(τ; x),θm(τ))dτ,
while (72) implies that
∂z f (ZΘL,M (l; x), θl,m) dτ,
where pe is defined in (115), (116).
By bounding differences of these two expressions, we have
(II)
∂z f (ZΘL,M (l; x), θl,m) dτ .
+ MM
M ztl+ι
e> (l+1 ； x) dzf (ZΘl,m (l； x),θm(τ)) - p> (l+1 ； X
m=1 J L
{z^
(III)
We bound (I), (II), and (III) in turn.
(122)
}
(I): Using (13), (18), and (112), we obtain that
(I) ≤ T∆p(t;X)I
L
(II): Using Assumption 4.1 (14) together with (18), (73), (75), and (112), we obtain that
C(R, Lsup)
(II) ≤	( L--
M
C(R, Lsup )
≤ L
M	l+1
X I	IZ(τ； X)-zΘl,m (l； x)| dτ
m=1 J ~L
(1 I LT M fl+	∖ 1/2 I
((M XX l lθl0,m -θm(T )12 dτl + L
∖ ∖	l0 =0 m=1 j l	)
where we make use of (113) in the last inequality.
(III): Using Assumption 4.1 item 3 together with (73), (75), and (112), we obtain that
(In) ≤ CRP X 广 ∣θm(τ) - θι,m∣dτ
m=1 J L
S / 1 M	∖ 1/2
≤ C(R LSUPX	(而 Σ ∣θm(τ) - θl,m∣2∖	dτ
42
Under review as a conference paper at ICLR 2022
By substituting these three bounds and (121) into (122), we obtain
≤ 0+ C(R, Lsup)
+ C(R,Lsuρ)
)bp (lɪ； x)∣
1 LT M ι+μ	∖ 1/2	1
M XX	∕l,	lθl0,m -θm(T)|2 dτ)	+ L
l0 = 0 m=1 'j l	)
z∙l+1 ( 1 M	∖ 1/2
+ C(R, LUp)L (而 Σ ∣θm(τ )-θl,m∣]	dτ +
C(R, Lsup)
L2
By applying this bound iteratively, and using (120) and (121), we obtain
∣∆p (t; x)∣≤ C (R, Lsup) (( MM X X ZI_ɪ ∣θl,m -θm(τ )|2 dτ!	+ L
(123)
where We also use Holder,s inequality to write
LT fk+1 ( 1 M	、1/2
C(R, Lsup)∑∕L	(而 Σjθm(τ — ,ml]	dT
(ι LT M rψ
≤ C(R，LsuP)而 XX l
∖ l=0 m=1 J L
1/2
∣θl,m — θm(τ)∣2 dτ)
We obtain (114) by combining (123) with (121).
G.2 Proof of Theorem E.2
We denote by θm(s; t) the solution to (6) with initial {θm(0; t)}mM=1 that are i.i.d drawn from
Pini(θ, t). Further, θιm(s) is a solution to (3) with initial value θιm(0) = θm,(0; L) for 0 ≤ l ≤
L - 1 and 1 ≤ i ≤M	. Define
Ldns,sup = 0≤upi{ ⅛ XU0； t)4
and recall Rini defined in (55). According to Definition E.1, Lidniis,sup is bounded with high probability.
Then, we have the following lemma:
Lemma G.2 For fixed S > 0 and any s ∈ [0, S], there exists a constant C(S, Rini, Lidniis,sup)
depending only on S, Rini, Lidniis,sup such that
1M
M X lθl,m(s)l2 ≤ C (S, Rini, Lns,sup),
{θl,m(s)}M=i,l = 1 ⊂ {θM1]l ≤ C(S，Rini，^^^)}，
(124)
Furthermore, the ODE solution and 夕㊀工 M (S) are bounded as follows, for any X in the SuPPort of μ
and l = 0, 1, . . . , L - 1:
ZΘL,M (s)(l + 1; x) ≤C S,Lidniis,sup,Rini ,	(125)
and
pΘL,M (s)(l; x) ≤C S,Lidniis,sup,Rini .	(126)
43
Under review as a conference paper at ICLR 2022
The proof is quite similar to that of Lemma F.3, so we omit the details.
We are now ready to prove Theorem E.2.
Proof [Proof of Theorem E.2] From (99) and (124) we obtain for all t ∈ [0, 1], s ∈ [0, S],
1M	1M
maχ MM E ∣θι,m(s)∣2,M7 E ∣θm(s;t)∣2	≤ c(s,Rini,Ldns,sup),
m=1	m=1	n	(127)
{θm(s; t)}M=1 ∪ {θl,m(s)}M=j1,l = 1 ⊂ {θMl]l ≤ CS Rini, Ldrup)},
where C(S, Rini, Lidniis,sup) is a constant depending on S, Rini, and Lidniis,sup.
From a similar derivation to (81), we obtain
∣E(Θ(s; ∙)) - E(Θl,m(s))| ≤ C(S, Rini, Ldns,sup) |Z©(s)(1； X)- Zθl,m(S)(L x)∣ .	(128)
Thus, to prove the theorem, it suffices to prove that ∣ZΘL,M (s)(L; x) - ZΘ(s)(1; x)∣ is small. For this
purpose, according to (113), we need to bound the quantity
(129)
where ∆t,m(S) = θl,m(S) - θm(S; t). The next part of the proof contains the required bound.
First, using (3) and (6), we obtain that
d∣∆t,m(s)∣2
dS
-2 <4t,m (S), Ex~μ (dθf (ZΘl,m (S)(I； X) ,θl,m (Sy)PΘl,m (S)(I; X)- dθf (ZΘ(s) (t; X) ,θm (S; t))pΘ(s) (t; X)))
-2 (at,m(s), Ex~μ (dθf (zΘl,m(s) (l； x), θl,m(S))pθL,M(s)
(l； X)- dθf (ZΘ(s)(t; X),θm(S； t))PθL,M(S) (l X)):
{z
(I)
-2 (at,m(s), Ex〜μ(∂θ f (Zθ(s)(t; x),θm(S; t))PθL,M (s)(l; X)- ∂θ f (Zθ(s)(t; X), θm(S; t))Pθ(s)(t; x))^ ∙
^Z
(II)
(130)
To bound (I), we use (126) to obtain
I(I)I ≤ C(S, Rini, Ldns,sup)Eχ 〜μ (∣∂θ f(ZθL,M (s)(l; X),θl,m(s)) - ∂θ f(Zθ(s)(t; X),θm(s; t))∣)
≤ C(S, Rini, Ldns,sup) [Ex〜μ (∣ZθLM(s)(l; X) - Zθ(s) (t; x)∣ + ∣θl,m(s) -θm(s; t)|)],
(131)
where we use Assumption 4.1 (14), (100), (125), and (127) in the second inequality. To bound (II),
we use (13), (100), and (127) to obtain
I(II)I ≤ C (S, Rini, Lins,sup)(∣θm(s; t)I + 1)Eχ 〜μ (∣PΘl,m (s)(l; x) - Pθ(s)(t; x)∣) .	(132)
By substituting (132) and (131) into (130), we obtain
d∣∆t,m(S)I2
dS
≤ C(S,Rini,Lidniis,sup)I∆t,m(S)I2
+ C (S, Rini, Ldns,sup)∆t,m(S)∣Eχ 〜μ (∣Zθl,m (s)(l; X) - Zθ(s) (t； X)∣)
+ C (S, Rini, Ldns,sup)∣∆t,m(S)∣(∣θm(S; t)| + 1)Eχ 〜μ (∣PΘl,m (s)(l； X)- Pθ(s)(t; x)∣) ∙
44
Under review as a conference paper at ICLR 2022
Using Holder,s inequality similar to (107), We obtain
d吉 Pm=IA,m(s)∣2
ds
≤ C (S, Rini, Ldis,sup) (M∙ X ∆t,m(s)"
m=1
+ C (S, Rini, Ldis,sup )Eχ 〜μ (∣PθL,M (s)(t; X)- Pθ(s)(t; x)∣2)
+ CS Rini, Ldis,sup)Eχ〜μ (∣Zθl,m(s)(t; X)- Zθ(s)(t; x) ∣2)
(133)
By substituting (113) and (114) into (133), we obtain
d焉 PLOI Pm=IRF ∣∆t,m(s)l2 dt
ds
1 1 LT m	fψ	1 ∖
≤ C(S, Rini, £『Up) (M XX I	A,m(S) |2 dt + L2 ),
∖1 l=0 m=1 J L	)
Which implies, from GronWall’s inequality, that
1 L-1 m	1+1	/ 1 L-1 m	1+1	1 ∖
M XX l	dm(s)∣2 dt ≤ C (S, Rini, Ldis,sup) M XX I	∣∆t,m(0)∣2 dt +	.
l=0 m=1J L	=	l=0 m=1' L	)
(134)
We have thus established the bound (129). We also have
LT m 1+1	LT m	1+1
M XXZ1	dm(0)12 dt = M XXZ1
l = 0 m=1 ,j l	l=0 m=1 ,j L
θm (0; L
I2
- θm(0; t)II dt .
(135)
To complete the proof, we use (79) and take M ≥ 8CC3 to obtain
P (⅛ S X 广"0)12dt ≤ C4! ≥ 1 - 8
l = 0 m=1 L
According to (78), when M > 8C3,
P(Ldis,sup ≤ °4)≥ 1 - 8
(136)
By using these expressions to substitute 吉 PL=OI Pm=IRιL ∣∆t,m(0)∣2 and Ldis,sup into (134),
We find that there exists a constant C0(C4, Rini, S) depending on C4, Rini, and S such that if
8C3
M ≥ —3,
η
C0(C4,Rini,S)
L ≥ -------------

then we have
M X X Ziψ∆t,m(s)∣2 dt ≤ E2! ≥ 1 - 4
(137)
∖ l = 0 m=1 J L	)
Using (137), (136), and (127) to bound the right hand side of (113), we find that there exists another
constant C00(C4, Rini, S) depending on C4, Rini, and S such that if
8C3
M ≥ —3,
η
C00(C4,Rini,S)
L ≥ ---------------

then we have
P (∣ZΘ(S)(I; X)- zΘl,m (S)(L; X)I ≤ E) ≥ 1 - 2 ,
By using this result and (136) in conjunction With (128), We complete the proof.
45
Under review as a conference paper at ICLR 2022
H Proof of global convergence result
Intuitively, if the equation (9) converges to a stationary point, denote by ρ∞, so that ∂sρ∞ = 0, then
δE
vθ而
(θ, t) = 0, ρ∞(θ, t)-a.e. θ ∈ Rk , a.e. t ∈ [0, 1] .
ρ∞ (∙, ∙)
The rest of the analysis shows that E(ρ∞) = 0 when this happens. However, it is not direct because
the condition above only suggests the fact that 需：(.)is a piecewise constant function. We need
a stronger result that shows this constant has to be zero. This is achieved by Proposition 6.1. To
show this proposition, we follow the proof in (Lu et al., 2020) that explores the expressive power
of f(x, θ), particularly the universal kernel property of Assumption 4.1. It is this proposition that
identifies stationary points with the global minimizer.
We should mention that the zero loss was demonstrated by Chizat & Bach (2018) for the 2-layer
problem where the stability equates to zero-loss due to convexity. The extension to the multi-layer
case is more difficult since convexity is not present.
H.1 Proof of Proposition 6.1
We first prove a lower bound for pρ in the following lemma.
Lemma H.1 Suppose that ρ ∈ C ([0, 1]; P2) and that pρ is a solution to (11). Denoting
Lρ
θ∣2dρ(θ,t),
then for any t ∈ [0, 1] we have that
Exi (∖Pρ(t; x)∖2) ≥ Q(LP)E(P),
where Q : R+ → R+ is a decreasing function.
(138)
Proof Recall that the initial condition for pρ in (11) is:
pρ(1;X) = (g(ZP(I;X))- y(X)) Vg(ZP(I;X)),
so from Assumption 4.1, we have
Ex〜μ (∖pρ(1;x)∖2) ≥ (jnfd ∖Vg(X)∖) E(ρ).
Further, since the equation is linear, we have
dP>
∂t
-pρ> Rk ∂zf(Zρ, θ)dρ(θ, t).
According to equation (13) in Assumption 4.1, we obtain
Rk
∂z f(Zρ(t; x),θ)dρι(θ,t) ≤ C(Zρ(t; x))∕j∖θ∖2 + 1)dρ(θ,t)
≤ C(LP)	(∖θ∖2 + 1) dρ1(θ, t),
where we use (18) in the second inequality. By combining the last two bounds in the usual way, we
obtain
d∖ppdt X)F ≤(2C(LP) IRJ∖θ∖2 + 1)dρ(θ,t)) ∖Pρ(t; x)∖2,
By solving the equation, we have
∣Pρ(t; x)∣2 ≥ ∣Pρ(1; x)∣2exp -2C(Lρ)
θ∣2 + 1)dρ(θ,t)] ≥ C(Lρ)∖pρ(1; x)∣2.
46
Under review as a conference paper at ICLR 2022
The proof is finalized by taking expectation on both sides, and note that monotonicity comes from the
format of the exponential term.	■
We are now ready to prove Proposition 6.1.
Proof [Proof of Proposition 6.1] Denote
Lρ
θ∣2 dρ(θ, t) dt.
According to existence and uniqueness of the solution to (7), for any t ∈ [0, 1], we can construct a
map Zt such that
Zt(x) = Zρ (t; x) .
Since the trajectory can be computed backwards in time, Zt-1 is well defined. Further, we denote
μt = (Zt)]μ to be the pushforward of μ under map Zt and let
p*(t; X)= PP (t; Z-1(x)).
By Assumption 4.1 and classical ODE theory, Zt and Zt-1 are both continuous maps in x, and so are
Pρ(t; x) and p*(t; x). With the change of variables, We have for all t ∈ [0,1] that
δE(P) (θ,t)= I P>(t; x)f(Zt(x),θ)dμ = ( (p*(t; x))>f (x,θ)dμ;.	(139)
δρ	Rd	Rd
For a fixed t0 ∈ [0, 1], we have boundedness of the Jacobian from Lemma C.1, meaning that
sup
x∈supp(μ)
dμto (z-1(χ))
dμ(x)
≤ C(Lρ).
2
As a consequence, μjζ (x) has a compact support since μ(χ) does. We denote the size of the support
by R*, defined to be a real number such that supp (μζ (x)) ⊂ {x : |x| < R*}.
We now derive a general formula for R δEPρ) (θ, t) dν. Recalling (139), we have
Z δE(P) (θ,to)dν (θ) = Z (p*(to; x))> (Z f(x,θ)dν (θ)∖ dμt0 (x)
Rk δρ	Rd	Rk	0
= L(P* (to； x))> (∕j(x,θ)dν (θ)+ p*(x,to)) dμto(x)	(140)
— [ (p*(to; x))>P*(x,to)dμ*0 (x).
Rd
Noticing that according to Lemma H.1, if E(P) 6= 0, the second term above is strictly negative (less
than -Q(LP)E(ρ)), the goal then is to find V for which / dν = 0 that makes the first term small, so
that the right-hand side in (140) is negative. Defining the continuous function h to be
h(x) = P* (t0; x) +	f(x, θ) dP(θ, t0) ,
then according to Assumption 4.1, for arbitrarily small e, there is a V so that ʃ ^ = 0 and
h(x) — ( f(x, θ)d^(θ)
Rk
≤.
∞
L∣x∣<R*
Setting V = P — V and substituting into the first term of (140), we obtain
∕jp*(to; x))> (ʌ f (x,θ)dν(θ) + p*(x,to)) dμto (x)
≤	|P*(t0;x)| h(x) —
/ f(x,θ)dν(θ) dμ*o(X)
Rk
≤ kP*(t0; x)kL∞∣<R*
h(x) — / f(x,θ)d^(θ)
Rk
∞
L|x|<R*
(141)
47
Under review as a conference paper at ICLR 2022
By choosing E small enough that (141) is less than 2Q(LP)E(P) We have from (140)
R δEPρ) (θ, to) dν(θ) < 0, completing the proof.	■
H.2	2-homogeneous case: Proof of Theorem 6.1
We first give an example of 2-homogeneous activation function that satisfy Assumption 4.1, and 6.1.
Remark H.1 A function that satisfies Assumption 4.1 and the 2-homogeneous property of Assump-
tion 6.1 is f(x, θ) = f(x, θ[1], θ[2]) = σ(θ[1]x + θ[2]) exp(-|x|2), where θ[1] ∈ Rd×d, θ[2] ∈ Rd,
and σ(x) = | max{x, 0}|2 applied componentwise.
Before proving the Theorem 6.1, We first introduce the folloWing lemma, Which shoWs that the
separation property is preserved in the training process. Our proof of this result is adapted from
(Chizat & Bach, 2018).
Lemma H.2 Let Assumptions 4.1 and 4.2 hold, and suppose that ρini(θ, t) is admissible with compact
support. Let ρ(θ, t, s) ∈ C ([0, ∞); C([0, 1]; P2)) solve (9). If there exists t0 ∈ [0, 1], so that the
initial condition ρini(θ, t0) separates the spheres raSk-1 and rbSk-1 for some 0 < ra < rb, then for
any s0 ∈ [0, ∞), ρ(θ, t0, s0) separates the spheres ra0 Sk-1 and rb0 Sk-1 for some 0 < ra0 < rb0.
Proof For every fixed 0 < s0 < S < ∞, We note that the particle representation θρ (s; t0) of
ρ(θ, t0 , s) updates the folloWing equation:
∙d⅛^ = -VθδE(ρ≡(θρ(s;to),to),
ds	δρ
θρ(0; to) = θ .
s∈ (0, S)
(142)
Define the map Ps(θ) to be the solution map that solves the equation above for given initial condition
θ up to time s. Our proof amounts to shoWing that this map preserves the separation property.
According to (Chizat & Bach, 2018, Proposition C.11), We need only shoW that the inverse map of
Ps(θ) is stable near 0 for any fixed 0 < s< S. That is, for any E > 0, We need to identify η > 0
such that
Ps-1(θ) ⊂B(0),	∀θ∈Bη(0) ,	(143)
Where Bη(0) is the k-dimensional ball around original 0 With radius η.
Since f is 2-homogeneous in θ, We have that ∣∂θf (z, 0)| = 0 for all z. Thus, from (10),
Vθ δE(P(S)) (0,to) =0.
δρ
Using estimate (49) from Lemma C.4, We obtain
VθδE(ρ(S)) (θ,to) ≤ C(LSUp)∣θ∣,
where LSUp = supo≤s≤s,t∈[o,i])Rk ∣θ∣2 dρ(θ, t, s) dt. This upper bound on the velocity implies in
particular that
∣P-1(Θ)∣≤∣Θ∣ exp(C(LSup)s),
which establishes (143) when we choose η to satisfy η < E exp(-C(LSUp)s), concluding the proof. ■
We are now ready to prove Theorem 6.1.
Proof [Proof of Theorem 6.1] Since ρ(θ, t, S) converges to ρ∞ (θ, t) in C([0, 1];P2), we have for any
to that
sup I ∣θ∣2 dρ(θ,to,s) < ∞.
s≥o Rk
According to Proposition 6.1, it suffices to prove that
δE(ρ∞)(θ,t0) =0, ∀θ ∈ Rk .
δρ
(144)
(145)
48
Under review as a conference paper at ICLR 2022
We use a contradiction argument: We will assume that (145) is not satisfied and show that
)Rk ∣θ∣2 dρ(θ,to, S) blows UP to infinity as S → ∞, contradicting (144). In particular, We will
use homogeneity to construct a set in which the second moment blows up.
Define the functions h∞ and hs as follows:
h∞(θ) = δE(ρ∞)(θ,to),	hs(θ)= δE,(S)) (θ,to).
δρ	δρ
Recall from (10) that
-δ~~ (θ,t0) = Eμ (p>(t0, X)f (Z(t0; x), θ)) .	(146)
Since (145) is not satisfied, there exists a θ* such that δE(P∞) (θ*,to) = 0, From (146), by Holder's
inequality,
0 < ∣δEδρ∞2(θ*,t0) ≤ (Ex〜μ (∣pρ∞(to;X)∣2))1∕2 (Ex〜μ (|f(Z(to;X),θ*)∣2))1∕2 ,
which implies
Ex 〜” (∣Pρ∞ (to； x)∣2) > 0 .
Then, Since f is a universal kernel according to Assumption 4.1, we can find ν such that
f(Z(to； x), θ) dν approximates -pρ∞(to, x). leading to
h∞(θ)dν(θ)=
δE(ρ∞)
δP
(θ,to)dν (θ) < -1 Ex。”(∣pρ∞ (to； x)∣2) < 0 .
As a consequence, there exists at least one point θo ∈ Rk such that h∞ (θo) < 0. Since f is
2-homogeneous, by (10), h is also 2-homogeneous, so that
h∞(θo∕∣θo∣) < 0.
Because of continuity, there is a small neighborhood around θo∕∣θo∣ in SkT where h is strictly
negative. Moreover, since h is Sard-type regular, there exist > 0 and η > 0 such that
∫A = ne ∈ Sk-1∣h∞∣sk-ι (θɔ < -e} = 0 ,
[Veh∞∣sk-1 (θɔ ∙nθ >η,	∀ e ∈ ∂A,
where h∞∣sk-ι is the confinement of h∞ on Sk-1, and n is the outer normal vector to ∂A.
This statement of h∞ can be extended to hs for sufficiently larger S as well. Using estimate (48) from
Lemma C.4, we obtain that
hs(θ) → h∞ (θ) in Cl1oc (Rk),	as S → ∞ ,
meaning there exists S > 0 such that for any S ≥ S, we have
hs |Sk-1 θe < -∕2,	∀ θe ∈ A ,
VehslSk-I (e ∙nθ > 2η, ∀e∈ ∂A.
Extending this patch on the unit sphere to the whole domain, we define the cone:
A = {θ ∈ Rk∣∣θ∣ > 0, θ∕∣θ∣ ∈ A}.
Using the 2-homogeneous property of hs, we have for S ≥ S that
(hs(θ) < — e∣2∣ ,	∀θ ∈ a,
[Vθ hs(θ) ∙ nθ > 0 ,	∀θ ∈ ∂ A∩{∣θ∣ > 0},
where ~nθ is the outer normal vector to ∂A.
(147)
49
Under review as a conference paper at ICLR 2022
-I-V T	、 C	.t . ∕' 11	.1	t∙ . n	t∙	1 ʌ	. -i	/	∖
We now define a new system that follows the gradient flow corresponding to ρs . Denote by θ (s; α)
the solution to the following ODE:
dθ (s; α
ds
^ , 、
-Vθ δE(ρ(s)) (b (s; α) ,to) = -Vθ hs (b(s; α)) , s>S (148)
θ (S; α) = α,
where α ∈ Rk. According to (147), when θ ∈ ∂A∩{∣θ∣ > 0}, Vθhs(θ) points outwards, away from
A. We also notice that θb s; ~0 = ~0. Thus if the ODE starts with from some α ∈ A, then for any
s≥ S, the particle stays within A, that is,
θb(s; α) ∈ A.	(149)
As a consequence, we have
d θb(s; α)
ds
-2 Dθb(s; α),	Vθhs	θb(s; α))E	= -4hs	θb(s; α))
> 2 θb (s; α)
(150)
where we use the 2-homogeneous property of hs in the second equality and (147) in the final
inequality.
According to Lemma H.2, there exist two spheres separated by ρ(θ, t0, S ), meaning that there exist
β > 0 and γ > 0 relatively small (for example, with β < ra0 ) such that
dρ(θ, to, S )> γ .
A∩(Bβ (~o))c
By tracing the trajectory of (148), we have
∙L(Bβ(~))c dρ(θ, t0,s) = ZkIb(Sa∈A∩(Be(~))c dρ(α,to,S)
≥	dρ(α, to, S )> γ, s ≥ S ,
A∩(Bβ (~o))c
(151)
where in the first inequality we also use
d|b(s；a)|2
ds
≥ 0 when α ∈ A. Further, we have
2
d /∕∩(Bβ(~))c 1b(s°)∈A∩(Bβ(~))c lθ(S； a)| dρ(α, t0, S)
ds
d RA∩(Bβ(~))c|b(s； a)| dP(α,t0,S)
≥2A∩(Bβ(~0))c
ds
2
θ (s; α) dρ(α, t0 , S
≥ 2γβ2
where we use (150) in the second inequality and (151) in the final inequality. It follows that
s→∞L∩(Bβ(~))c 1b(sa)∈A∩(Bβ(~))c Ib(S； α)l2 dp(a，t0，S) = ∞ .
It follows from this result that
lim I ∣θ∣2 dρ(θ, to, s) = ∞ ,
s→∞ Rk
contradicting (144). Therefore, we must have
δE(ρ∞)(θ,to) = 0, ∀θ ∈ Rk ,
δρ
which completes the proof.
50
Under review as a conference paper at ICLR 2022
H.3 Partially 1 -homogeneous case: Proof of Theorem 6.2
We first give an example of partially 1-homogeneous activation function that satisfy Assumption 4.1,
and 6.2.
Remark H.2 The following function satisfies Assumptions 4.1 and 6.2: Let θ = (θ[1] , θ[2] , θ[3] )
with θ[1] ∈	Rd,	θ[2] ∈	Rd×d,	θ[3]	∈	Rd.	Define f(x,θ)	=	f(x,θ[1],θ[2],θ[3])
θr11σ θθ[2]σ2(Iθ∣2]DX +
θ[1]σ I ∣θ[2]∣ X +
θ[3] σ2(Iθ[3] I) ∖
-∣θ[3]∣-)
, where σ(X) is a regularized ReLU activation function, and
σ2, σ2(x)∕x : R+ → R+ are bounded, Lipschitz, and differentiable with Lipschitz differential. One
way (Ofmany) to define a regularizedReLU activation function is σ(x) = (X + η)2∕(4η) 1 方日-明切 +
X1x∈(η,∞), for some small η.
As in the previous theorem, we prove a lemma, adapted from (Chizat & Bach, 2018, Lemma C.13),
that asserts preservation of the separation property.
Lemma H.3 Let Assumptions 4.1 and 4.2 with k1 = 1. Suppose that ρini(θ, t) is admissible
and suppj(ρini(θ,t)) ⊂ {θ∣∣θ[i]∣ ≤ R} with some R > 0 for all t ∈ [0,1]. Let ρ(θ,t,s) ∈
C([0, ∞); C ([0, 1]; P2)) solve (9). Suppose in addition that
•	f satisfies the partial 1-homogeneous condition (see Assumption 6.2),
•	The initial conditions satisfy the separation condition, that is, there exists t0 ∈ [0, 1] such
that ρini(θ[1] , θ[2] , t0) separates the spheres {-r0} × Rk-1 and {r0} × Rk-1 for some
r0 > 0.
Then for any s0 ∈ [0, ∞), ρ(θ[1] , θ[2], t0, s0) separates {-r0} × Rk-1 and {r0} × Rk-1 for some
r0 > 0.
Proof Note that the particle representation θρ(s; t0) of ρ(θ, s, t0) satisfies
(
dθρ(s*0)
ds
θρ(0; t0)
-VθδEδ≡ (θρ(s;t0),t0),
θ.
(152)
Define a continuous map P : Rk × [0, ∞) → Rk as the solution to (152), that is, P(θ, s) is the
solution to (152) with initial condition θρ(0; t0) = θ, where t0 is fixed. Define a diffeomorphism
ψ : R × Rk-1 → R × B1 (0) as follows:
J (θ[1], (θ ⑵ Aθ[2]D ∙ tanh (lθ[2]D ) ,	θ[2] = 0
(θ[1],0),	θ[2] =0,
ψ(θ[1], θ[2]) =
where θ[1] ∈ R is the first component of θ and θ[2] ∈ Rk-1 contains the remaining components. This
map keeps the first component of θ[1] intact and shrinks θ[2] to push its amplitude below 1. This
diffeomorphism preserves the connection/separation property.
Define the continuous map Q as follows:
Q(θ, s) = ψ ◦ P(ψ-1 (θ), s) : R × B1 (0) × [0, ∞) → R × B1 (0) .
Since ψ preserves the connection property, the lemma is proved if we can show ψ ◦ P(supp(ρini), s)
separates {-r0} × B1 (0) and {r0} × B1 (0) for some r0 > 0. Since ψ ◦ P(supp(ρini), s) =
Q(ψ(supp(ρini)), s), we trace the evolution of Q(θ, s) for θ ∈ R × B1(0). According to (Chizat &
Bach, 2018, Proposition C.14), this translates to showing Q(θ, s) can be continuously extended to
R ×B1 (0) X [0,S] → R X Bi (0), with the extension satisfying
Q(θ, s) ∈ R × ∂B1 ~0 ,	∀θ ∈ R × ∂B1 ~0 , s ∈ [0, ∞) ,	(153)
meaning that the extension Q(∙, S) maps R X ∂Bι(~) to itself for all S ∈ [0, ∞).
51
Under review as a conference paper at ICLR 2022
Denoting Qs (θ) = Q(θ, s), we consider the velocity field of this flow (similar to the proof of (Chizat
& Bach, 2018, Lemma C.13)):
-dQs = (Vθψ (PS ◦ ψ-1 ⑻))dPsdsψ
=-(Vθψ (PS ◦ ψ-1 (θ))) (vθ δE(ρ(s)) (PS ◦ ψ-1 (θ), to))
=-(Vθψ (ψ-1 (QS))) (vθ3PSs) (ψ-1(Qs),to)) = V(Qs, S).
From the fourth condition of Theorem 6.2, the velocity field V(θ, s) can be continuously extended to
R × ∂B1 (0) as follows:
V(θ, S) = V(θ[1], θ[2], S)
(- (Vθψ (ψ-1(θ))) (VθδEP^
1 (-H∞,ρ(s)(θ[2]), 0),
(ψ-1(θ),to)),
∣θ[2]l < 1
lθ[2] | = 1 ,
where H∞,ρ(s) is the limit of δE(P(S)) (1, rθ[2],to) as r → ∞. Within this velocity field, QS can be
continuously extended to R ×Bι (0) X [0, ∞) → R X Bi (0) with the extension satisfying (153).
This completes the proof.	■
We are now ready to prove Theorem 6.2.
Proof [Proof of Theorem 6.2] The technique of proof is similar to the 2-homogeneous case. Since
ρ(θ, t, S) converges toρ∞ (θ, t) in C([0, 1]; P2), we have
sup
S≥0
I ∣θ∣2dρ(θ,to,s)
Rk
<∞.
(154)
According to Proposition 6.1, it suffices to prove that
δE(ρ∞) l∩ , δ	δE(P∞) l∩ 口 , δ δ δE(ρ∞) ∕1 口 , ʌ ∩	V√∕)	Z- !D>k C'
-δρ- (θ,t0) =	-δρ- (θ[1],θ[2],t0)	= θ[1] —δρ- (1,θ[2],t0)	=0,	∀θ	∈ R	.	(155)
In the following, we will show that 人忆 ∣θ∣2dρ(θ, to, s) blows up as S → ∞ if (155) fails to hold, in
contradiction to (154).
Denote
h∞(θ[2]) = δEδp∞)(1,θ[2],to),	hS(θ[2]) = δE(ρ(s))(1,θ[2],to).	(156)
Then if (155) is not satisfied, without loss of generality, we can assume that there exists θ[2] such that
h∞(θ[2]) < 0. Since h∞ satisfies Sard-type regularity, there exist > 0 and η > 0 such that
A = {θ[2]∈ RkTlh∞ (θ[2]) < -e} = 0;	Vθ[2]h∞(θ[2]) ∙ ~θ[2] > η,	∀θ[2]∈ ∂A,
where nθ[2] is the outer normal vector on ∂A.
Using the definition of δp as in (10), we have
vθ[2] δEPPs2(1, θ[2], t) - vθ[2]δEδP∞)(1,θ[2],t)
=Ex~μ (dθ[2] f (ZP(S) (t； x), θ[2] )pp(S)(t; X)- dθ[2] f (Zρ∞ (t; x), θ⑵ )pρ∞ (t; x))
≤ Exi (∣∂θ[2] f(Zp(S)(t; x),θ[2]) - ∂θ[2] f(Zp∞ (t； x),θ[2])∣ ∣Pp(S) (t； x)|)
+ Exi (∣dθ[2]∕(ZP∞ 也 x),θ[2])l IpP(S)(t； X)- Pp∞ 9 x)∣)
≤ C (Ex〜μ (∣Zp(S)(t; x) - Zp∞(t； x)∣) + Ex〜μ (IpP(S)(t； x) - pp∞(t； x)∣))
≤ Cd1 (P(S), P∞) ,
52
Under review as a conference paper at ICLR 2022
where we have used the Lipschitz continuity of f and its derivatives as in Assumption 6.2 and the
estimates (18), (31), and (47). We thus have
hs(θ[2]) → h∞(θ[2]) in C1(Rk-1),	as s → ∞.
As a consequence, there exists S > 0 such that for any s ≥ S
Jhs (θ[2]) < -〃2,	∀ θ[2] ∈ A ,
lVθ[2]hs(θ[2]) ∙ nθ[2] > 1 η,	∀θ[2] ∈ ∂A.
(157)
(158)
Extending this set to the whole space, we define
A = {(θ[i],θ⑵)∈ (0,∞)× A} ∙
Since ∂A = {(θ[i], θ[2]) ∈ (0, ∞) X ∂A} ∪ {θ[i] = 0,。⑵ ∈ A}, from (158) and the definition of
hs, we have
Vθ δE(P(S)) (θ,t0) ∙ ~Θ = Θ[1] (Vθ[2]hs(θ[2]) ∙ nθ[2]) > 0, ∀θ ∈ (0, ∞)× ∂A,	(159)
where ~nθ is the outer normal direction on ∂A, and ~nθ[2] is the outer normal vector on ∂A. When
θ ∈ {θ[1] = 0, θ[2] ∈ A},
Vθ δE(P(S)) (θ,t0)] = hs(θ[2]) < 0,	[vθ δE (P(S)) (θ,t0)] =0,	i = 2,...,k,	(160)
δρ	1 δρ	i
where Hi means the i-component of the vector. This implies that VgδE(P(S)) (θ, to) points strictly
downward when θ ∈ {θ[i] = 0, θ[2] ∈ A}.
*	.	.1 rʌ 1	. 1	.1	「	，c	1∙	c - 分/	、
As in the 2-homogeneous case, we consider the gradient flow corresponding toPs. Denote by θ (S; α)
the solution to the following ODE:
(dda	= -vθδEP(s1 (b(s； α) ,to)= -V (θ[i]hs (θ[2]))仅(s； α)) , s>S (161)
Ib (S; α)	= α ,
where α ∈ Rk. Since the minus gradient is pointing inward to A, as stated in (159) and (160), θb (S； α)
stays in A if θ (s0; a) ∈ A for some s0 ∈ [S, s]. Moreover, using (161), if θ (s; a) ∈ A, we have
d|"[1]d：。) ।	= -2b[i]	(s； a)	hs	仅2]	(s;	0))	> μi]	(s;	a) ,	(162)
where the last inequality uses (158).
Similar to (Chizat & Bach, 2018, Proposition C.4), we claim that there exists Si ≥ S, β > 0, and
γ > 0 such that (see detailed proof in Appendix H.3.1)
dP(θ, t0, Si) > γ .
Then
2
^
d Rk
lj(Sι 0)∈(β,∞) × A∣θ[i](s; a)| dρ(α,t0,S)
ds
≥ eLJb(Sιa∈(β,∞)×Ab[i](s;α) dρ(α,t0, S)
≥ eβ ɪ Jb(Shα)∈(β,∞)×A dρ(α,t0, S)
= β	dP(θ, t0, Si) ≥ βγ .
Since
2	2
sl→∞∕β,∞)×Alθ[i]1 dρ(θ,t0,S) ≥ sl→∞41b(Sιa∈(β,∞)×A∣θ[i](s,α)∣
(163)
(164)
dP(α, t0 , S ) = ∞ ,
53
Under review as a conference paper at ICLR 2022
we finally obtain, using (164), that
lim / ∣θ∣2 dρ(θ,to,s) ≥ lim /	∣θ[i]∣2 dρ(θ,to,s) = ∞ .
s→∞ Rk	s→∞ (β,∞)×A
This limit contradicts (154), implying that (155) must hold, as claimed.
H.3.1 Claim in the proof of Theorem 6.2
In this section, we prove the statement in (163), meaning that we need to find S1 ≥ S, β > 0, and
γ > 0 such that
dρ(θ, t0, S1) > γ .
(165)
Supposing that A dρ(θ, t0, S) > 0, then by making β and γ small enough, (165) is satisfied
naturally.
If A dρ(θ, t0, S) = 0, then it suffices to shoW that there exists S1 > S such that
dρ(θ, t0, S1) >0.
A
(166)
Define hs(θ[2] ) and h∞(θ[2]) as in (156). Because of the fourth condition in Theorem 6.2, there exists
a function h0(θ) on C1 (Sk-2) such that
h∞ (rθe) -r-→-∞→ h0(θe),	in C1(Sk-2 .
Combining this with (157), there exists h > e/2 such that khs∣∣L∞ ≤ h*. Further, for any ξ > 0,
We can find θ 诲 ∈ A and S0 large enough such that
∣Vθ*2]hs(θ[2])∣ <ξ,	∀s ≥ s0.
(167)
According to Lemma H.3, there exists rS0 > 0 such that ρ(θ[1] , θ[2] , t0, S0) separates {-rS0} ×
Rk-I and {rso} X Rk-1. Considering the set [-rs，,rs，] X {θ的}, it must intersect the support of
ρ(θ[i], θ[2], to, S0) due to the separation property. Thus, any open set that contains [-rs，, rs，] X {θ^ }
must have a positive measure in ρ(θ[1] , θ[2] , t0, S0). Because A dρ(θ, t0, S0) = 0 and (-rS0 -
1, ∞) x A is a open set that covers [-rs，, rs，] X {θ6]},there exists a open set U ⊂ (-rs，— 1,0] X A
such that
dρ(θ[1], θ[2], t0, S0) >0.
U
Thus, we can find a point 0 < r* ≤ rs，+ 1 and an arbitrary small σ > 0 such that
Bσ(-r*,θR ⊂ (-rs，- 1 - σ, σ) X A, and [	dρ(θ,to,S0) > 0.
Bσ(-r*,θ[*2])
Recalling the system (161), we claim the following:
ττr7 .	11	1	. 1	， . C - E	1	.1	,	/ Λ7 ∖	— Λ r
When ξ, σ are small enough, there exists S1 > S0 such that θ (S1; α) ∈ Afor any
α ∈Bσ(-r").
If this claim is true, then
dρ(θ, t0, S1) ≥	dρ(θ, t0, S0) >0.
，A	JBσ (-r* 稣])
which proves (166) and the lemma.
54
Under review as a conference paper at ICLR 2022
Now, we prove the claim. Because f satisfies Assumption 6.2 and the second moment of P is
uniformly bounded in s, for all s > 0, we have
δE≡)(1,θ[2],t0) - δEρ≡(1 坨,to)≤ L∣θ[2]-饲 |,
Ve SE (P(S)) (1,θ[2] ,tθ)-Vθ δEρ(s" (1"02] ,to) ≤ L∣θ[2] -θ02]∣ ,
(168)
for some constant L. According to (161), we have
dθ[i] (s; α) _
-ds- =
d| b[2](s; a)-%]/
ds	≤
where
-r* — σ
2 | b[2](s; a) - θ[2] | | b[1](s; a) 1 1 vθ[2] hs e[2](s; α))∣
≤ b[i](S0 ； ɑ) ≤ σ, and 加(夕；α)-碓]| ≤ σ.
To prove the claim, it suffices to show that there exists Si > S0 such that
b[i] (Si； α) > 1 and θ[2] (Si; α) ∈ A .
S ≥ S0 (169)
(170)
(171)
We first show that θ[i] increases and the right hand-side of (169) is bounded. Since A is a open set,
there exists an arbitrary small Σ > 0 such that B∑(θ由)U A. We first choose σ < min{Σ, 2}. When
| b[1] (s； a) | ≤ "J2 h* + 2,	|b[2] (S； a) - θ*2] | ≤ ς ,	(172)
we have from (158), (167), and (168) that
( . . . ∖	√l / . . . ∖
—[1ds2- = -hs 仅2](s； a)) <h*,	—[1d-^— = -hs e[2](s； 0)) > e/2	(173)
and
d| b[2](s; α) - θ[2] | 2
ds
≤ 2 (2rS1+-^h* + 2)| b[2] (s; α)-碓]| (L | b[2] (s； α)-碓]| + B	(174)
≤ 2L (2工+ 2 h* + 2)| b[2](s; α) - θ*2]/+ 2 (也产h* + 2)Σξ .
When S = S0 and α ∈ Bσ(-r*, %), we have from (170) that
.^ . .	2r q/ + 2	. ^ ,.
lθ[1] (S ; a)| ≤ rS0 + 1 + σ < ---------------h + 2,	|bb[2] (S ; a) - θ[2]1 ≤ σ < ς .
Thus, for s slightly larger than S0, we still have that
| θ[i](s;Q) | < 2rs' + 2h* + 2 and
θ[2](s;q) - θ[2] | < ς∙
Denote by S* the first time that
| b[i](S*; Q) | ≥ 2rs'J2h* + 2 or | b[2](S*; Q)-碓]| ≥ ∑.
Then we show that there exists Si ∈ [S0, S*] such that (171) is satisfied when σ, Σ, and ξ are small
enough. From (170), we have for s ∈ (S0, S*) that
θ[i] (s; Q) ≤ σ + (s — S0)h*
θ[1] (s; Q) > -rS0 - σ + (s - S )〃2,
< exp L
2rso + 2
€
h* + 2
2(s
- S0)
2rso + 2
€
h* + 2
1/2
55
Under review as a conference paper at ICLR 2022
where the first two inequlaties come from (173) and last inequality comes from (174) via GrGnWall's
inequality. Defining
2rs0 +2 o
S1 =-------------+ S ,
we can choose the positive values σ, Σ, and ξ small enough that
0
θb[1](S1, θS ) > -rS0 +(S1 - S0)/2 = 1,
and for s ∈ [S0, S1]
∣b[i](s; α)∣ < 2rS0J2h* + 2,	∣b[2](s; α) - θ^ < Σ .	(175)
According to (175), the bounds (172) are satisfied for S ∈ [S0, Si], which implies that Si < S*
00
and θ[2] (Si, θS ) ∈ A. Further, we have θ[i] (Si, θS ) > 1. By combining these two results,
we conclude that (171) is satisfied with the chosen values of σ, Σ, ξ, and Si. Thus, we have
θ (Si; α) ∈ (1, ∞) × A ⊂ A for any α ∈ Bσ(-r*, θ[*2] ), which proves the claim.
56