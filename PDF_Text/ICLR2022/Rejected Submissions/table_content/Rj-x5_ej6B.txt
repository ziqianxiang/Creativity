Table 1: The time complexities of the original reward imputation in Eq.(1) (first 4 columns) and thereward imputation using sketching in Eq.(5) (last 4 columns) for action Aj in the (n+ 1)-th episode,where Njn (Njn) denotes the number of steps in which the action Aj is executed (non-executed) inepisode n+ 1, Nbjn +Njn = B, and the sketch size c satisfying d < c < B and cd > B (MM: matrixmultiplication; MI: matrix inversion; Overall: overall time complexity for action Aj in one episode)Original reward imputation in Eq.(1)				Reward imputation using sketching in Eq.(5)			Item	Operation	Eq.	Time	Item	Operation	Eq.	TimeΦnA+j 1, Φb nA+j 1 bA+ 1, bA+ 1	MM	(3), (4)	O(Bd2)	GA+ 1, G A+ 1 PAj 1，PA+ 1	MM	(7), (8)	O(cd2)	MM	(3), (4)	O(Bd)		MM	(7), (8)	O(cd)(ΨnA+j1)-1	MI	(2)	O(d3)	(WA+1)-1	MI	(6)	O(d3)	—			ΓAj, ΛAj	Sketching	一	O(Njnd)	—			bAj, Λ Aj	Sketching	一	O(Nbjnd)Overall	一	—	O(Bd2)	Overall	一	一	O(cd2)where θA+1 denotes the estimated parameter vector of the imputed reward using sketching for actionA ∈ A, CAn ∈ Rc×Njn and CbAn ∈ Rc×Njn are the sketch submatrices for the observed term and theimputation term, respectively, and the sketch matrices for the two terms can be represented as∏Aj = [cAj,CAj,…，CAji ∈ Rc×Ln，∏Aj = [CA,，CA。，…，0工]∈ Rc×Ln.
Table 2: Performance comparison of coupon recommendation on commercial productAlgorithm	CVR (mean ± std)	CTCVR (mean ± std)	Time (sec., mean ± std)DFM-S	0.8656 ± 0.0473	0.3317 ± 0.0218	302.3140 ± 8.3045SBUCB	0.8569 ± 0.0037	0.4277 ± 0.0084	43.5435 ± 0.3659BEXP3	0.4846 ± 0.0205	0.2425 ± 0.0116	53.5001 ± 0.9220BEXP3-IPW	0.4862 ± 0.0187	0.2436 ± 0.0113	56.0101 ± 1.4142BLTS-B	0.8663 ± 0.0178	0.4285 ± 0.0157	218.2109 ± 1.8198PUIR	0.8807 ± 0.0053	-^0.4411 ± 0.0029	184.3575 ± 2.2346SPUIR	0.8770 ± 0.0059	0.4397 ± 0.0032	81.5753 ± 1.5879PUIR-RS	0.8763 ± 0.0056	0.4389 ± 0.0030	180.4999 ± 1.7763SPUIR-RS	0.8758 ± 0.0058	0.4391 ± 0.0031	80.8003 ± 2.90300.44OiiO-_ _ __ __PJeΛ∖3sυπEυ><10 SO 30	40 SO ββ 70	80 W	ONumber of Episodes NεeM3H 36EaΛ450	1∞	150	200	250	3∞Number of Episodes N
Table 3: Description of datasets in the experiments (T : number of instances; B: batch size; N :number of episodes; d: dimensionality of context; M : number of actions; CB satisfying B =CB2 N/d)Dataset	T	B	N	d	M	CBsynthetic data	126,000	1,400	90	40	5	25.00Criteo-recent	75,000	1,000	75	50	5	25.82Criteo-all	1,276,000	4,000	319	50	15	25.04commercial product	216,568	1,700	128	50	5	25.83•	The indicator variables of click events:C = 1 a click occurs in context si ,i 0 otherwise.
