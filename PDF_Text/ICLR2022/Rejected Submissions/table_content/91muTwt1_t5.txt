Table 1: Comparison of different drug design methodsTargets	Method	Uniq (%)	SR (%)	Nov (%)	Div	Prod	Median (kcal/mol)	Top 10 (kcal/mol)Set A	-IiGAN	99.8 ± 0.2	1.0± 0.9	100 ± 0.0	0.922 ± 0.001	0.01 ± 0.01	-5.91 ± 0.43	-8.79 ± 0.71	GEKO	100 ± 0.0	57.0 ± 13.2	100 ± 0.0	0.912 ± 0.004	0.52 ± 0.12	-9.58 ± 1.01	-12.23 ± 1.20	-JT-VAE~~	96.8 ± 0.2	11.3 ± 0.8	100 ± 0.0	0.910 ± 0.001	0.10 ± 0.01	-8.21 ± 0.30	-11.38 ± 0.13	RationaleRL	98.8 ± 0.7	26.7 ± 14.3	33.4 ± 2.0	0.883 ± 0.010	0.07 ± 0.04	-7.76 ± 0.21	-9.56 ± 0.23	GA+D	40.2 ± 3.7	23.7 ± 20.9	86.5 ± 13.5	0.849 ± 0.012	0.05 ± 0.04	-7.21 ± 1.00	-9.94 ± 1.04Set B	GraphAF	91.0 ± 0.4	0.5 ± 0.3	100± 0.0	0.946 ± 0.000	0.00 ± 0.00	-4.51 ± 0.18	-8.85 ± 0.22	MolDQN	56.2 ± 6.1	0.0 ± 0.0	100.0 ± 0.0	0.784 ± 0.043	0.00 ± 0.00	-5.54 ± 0.19	-6.95 ± 0.13	MolEvol	97.8 ± 0.4	41.4 ± 17.0	62.6 ± 18.4	0.737 ± 0.045	0.17 ± 0.03	-8.17 ± 0.19	-9.26 ± 0.44	MARS	84.7 ± 1.3	30.3 ± 24.7	90.1 ± 0.9	0.826 ± 0.002	0.19 ± 0.15	-7.73 ± 0.54	-9.54 ± 0.57	liGAN	99.8 ± 0.1	0.2 ± 0.1	100± 0.0	0.923 ± 0.002	0.00 ± 0.00	-5.34 ± 0.00	-8.03 ± 0.09	GEKO	100 ± 0.0	57.1 ± 2.1	100 ± 0.0	0.910 ± 0.001	0.52 ± 0.02	-9.22 ± 0.14	-11.84 ± 0.544.2	Results and AnalysisWe compare GEKO with baseline models on Target Set A and B and the average results over targetsin each set are summarized in Table 1. More detailed performance on each target can be found in theappendix. The performance of 2D molecular generation baselines, namely JT-VAE, RationaleRL,GA + D, GraphAF, MolDQN, MolEvol and MARS, is only reported on Target Set B. From theresults, it is obvious that GEKO outperforms baseline models on all evaluation metrics except fordiversity. In Target Set A, GEKO surpasses liGAN on the Prod score, which is an indicator for the
Table 2: Comparison of different proposal strategiesMethod	Uniq (%)	SR (%)	Nov (%)	Div	Prod	Median (kcal/mol)	Top 10 (kcal/mol)Random	∣	100.0	31.4	100.0	0.909	0.29	I -8.80	-12.09HMPNN (Random Weight)	100	50.0	100	0.914	0.46	-8.91	-11.99MPNN	100	54.1	100	0.911	0.49	-9.26	-12.28HMPNN	100	58.2	100	0.911	0.53	-9.24	-12.50In addition, we compare the effects of different loss functions in training the adaptive proposal(Table 3). WMLE, on top of the standard MLE, takes the score difference f (x0) - f (x) intoconsideration. Using WMLE results in a dramatic improvement on the model’s performance. Byexplicitly formulating the objective score difference in the loss function, the model can more easilylearn edits leading to significant improvements than those with moderate boosts.
Table 3: Comparison of different loss functionsMethod	Uniq (%)	SR (%)	Nov (%)	DiV	Prod	Median (kcal/mol)	Top 10 (kcal/mol)MLE	100	36.7	100	0.915	0.34	-8.59	-11.96WMLE	100	58.2	100	0.911	0.53	-9.24	-12.505	ConclusionIn this paper, we propose GEKO, which is a generalizable model to design drug molecules condi-tioned on a target binding site. We formulate the drug design and optimization task as a step-wiseediting process and developed a hierarchical MPNN model to learn the structure-activity relationand facilitate the design process. Our method shows great potential on 3D drug design tasks with a3-fold performance increase comparing to the best baseline model.
Table 4: Comparison of methods on individual target in Target Set AMethod	Target	Uniq (%)	SR (%)	Nov (%)	Div	Prod	Median (kcal/mol)	Top 10 (kcal/mol)	3H7W	99.9	0.0	100.0	0.923	0.00	-5.33	-7.47	5E19	99.8	1.5	100.0	0.923	0.01	-6.11	-9.43	2RD6	100.0	1.0	100.0	0.921	0.01	-5.78	-9.11	3VRJ	99.7	3.1	100.0	0.922	0.03	-6.67	-9.25liGAN	4OQ3	100.0	0.0	100.0	0.923	0.00	-5.20	-7.57	4CG9	99.6	0.8	100.0	0.922	0.01	-6.18	-9.29	3P0P	99.9	0.7	100.0	0.920	0.01	-6.27	-9.24	4PS7	99.9	0.4	100.0	0.923	0.00	-5.77	-8.60	5MKU	99.6	1.9	100.0	0.923	0.02	-6.19	-9.52	1FKG	100.0	0.1	100.0	0.921	0.00	-5.66	-8.47	3H7W	100.0	53.4	100.0	0.914	0.49	-8.52	-11.05	5E19	100.0	69.7	100.0	0.916	0.64	-9.60	-12.61	2RD6	100.0	50.3	100.0	0.908	0.46	-11.69	-14.33	3VRJ	100.0	67.9	100.0	0.919	0.62	-9.54	-12.21GEKO	4OQ3	100.0	40.6	100.0	0.909	0.37	-8.48	-10.78	4CG9	100.0	51.3	100.0	0.907	0.47	-9.89	-12.54	3P0P	100.0	67.7	100.0	0.916	0.62	-10.28	-13.41	4PS7	100.0	61.6	100.0	0.907	0.56	-10.37	-12.92
Table 5: Comparison of methods on individual target in Target Set BMethod	Target	Uniq (%)	SR (%)	Nov (%)	Div	Prod	Median (kcal/mol)	Top 10 (kcal/mol)JT-VAE	JNK3	96.9	10.4	100.0	0.911	0.09	-7.91	-11.50	GSK3β	96.6	12.1	100.0	0.908	0.11	-8.50	-11.25RationaleRL	JNK3	98.1	41.0	31.4	0.873	0.11	-7.97	-9.78	GSK3β	99.4	12.4	35.3	0.893	0.04	-7.55	-9.33GA + D	JNK3	36.5	44.6	73.0	0.837	0.10	-8.21	-10.98	GSK3β	43.9	2.7	100.0	0.860	0.01	-6.21	-8.90GraphAF	JNK3	90.6	0.1	100.0	0.946	0.00	-4.69	-8.63	GSK3β	91.4	0.8	100.0	0.946	0.01	-4.33	-9.07MolDQN	JNK3	50.2	0.0	100.0	0.827	0.00	-5.35	-6.82	GSK3β	62.3	0.0	100.0	0.741	0.00	-5.74	-7.08MolEvol	JNK3	98.2	58.4	44.2	0.782	0.20	-8.36	-9.70	GSK3β	97.4	24.4	81.1	0.692	0.13	-7.98	-8.82MARS	JNK3	83.4	54.9	91.0	0.825	0.34	-8.27	-10.12	GSK3β	85.9	5.6	89.3	0.828	0.04	-7.19	-8.97liGAN	JNK3	99.8	0.1	100.0	0.921	0.00	-5.34	-7.94	GSK3β	99.9	0.2	100.0	0.924	0.00	-5.33	-8.12GEKO	JNK3	100.0	55.0	100.0	0.911	0.50	-9.36	-12.38	GSK3β	100.0	59.2	100.0	0.909	0.54	-9.07	-11.30
