{
    "Decision": {
        "title": "Paper Decision",
        "decision": "Accept (Spotlight)",
        "comment": "This paper builds on the success of the FermiNet neural wave function framework by pairing it with a graph neural network which predicts the parameters of neural wave function from the geometry. The resulting PESNet trains significantly faster, with no loss of accuracy. This method constitutes an important advance in ML-powered quantum mechanical calculations.\n\nThe reviewers unanimously recommend acceptance."
    },
    "Reviews": [
        {
            "summary_of_the_paper": "The paper presents a new meta-learning method for solving the Schrodingers equation using neural networks. This method combines an existing neural wave function model called FermiNet together with a GNN (MetaGNN) to solve the Schrodingers equation for multiple geometries simultaneously. The MetaGNN takes the atomic graph as input and outputs a set of parameters that capture the 3D geometry of the system, which are then input to the FermiNet. The resulting method can is applicable to multiple geometries while being significantly faster to train.\n",
            "main_review": "Strengths\n1. The proposed PESNet obtains SOTA or near-SOTA results compared to previous methods while being much faster to train. \n2. Using meta learning, the PESNet is able to handle multiple geometries simultaneously.\n3. The use of meta learning in this manner is novel and interesting.\n\nWeakness\n1. Recently, a number of datasets based on DFT have been created (e.g. OC20) and various GNN models have been proposed to train on such datasets (e.g. Dimenet++, Gemnet, etc). This paper, in contrast, presents an ab initio method that does not require a training dataset. While the introduction section discusses the difference in these approaches, it is unclear how the PESNet compares to the the trained methods when they are trained on very large and diverse datasets like OC20. It would be  helpful to add some discussion on this.\n2. The paper uses a lot of terminology that is difficult to follow for somebody without a background in chemistry. Since ICLR is a general DL conference, I would urge the authors to change the text to make it easier to follow.\n",
            "summary_of_the_review": "This paper presents a novel ab initio method for solving the Schrodingers equation using meta-learning by combining existing neural wave function models with GNNs. The resulting method can solve the Schrodingers equation for multiple geometries while training significantly faster.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "Not applicable",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The paper develops a neural network based variational ansatz for modeling wave functions. Authors build their model on top of FermiNet architecture with a few modifications: they use a different feature embedding approach that is invariant with respect to basic spatial symmetries. In addition, authors use a GNN “hypernetwork” that predicts the parameters of the variational wave function for a given configuration of the system. With these modifications authors show that the model can be optimized on a range of system configurations simultaneously. The optimization is performed in a standard VMC setting.\n\nThe results are compared on commonly studied problems such as variations of energy of the H4 molecule, hydrogen chain system, nitrogen molecule and cyclobutadiene. Authors find that their approach generally achieves similar results to those of a FermiNet model, while training on multiple system configurations simultaneously, reducing the time needed to obtain variational energies for multiple configurations.",
            "main_review": "**Strengths**:\n* Comprehensive set of tests and comparison to other relevant work\n* Study of relevant hyperparameters and convergence analysis\n* Variational energies are respectable across all studied problems\n\n**Weaknesses**:\n* A major improvement of the method (compared to existing approaches like FermiNet) is that the model can be optimized on multiple similar configurations simultaneously to achieve faster net runtime. While it is an interesting observation that GNN is capable of conditioning the model parameters on the geometry to adjust the modeled ground state wave function, other methods could use optimization results from one configuration as a starting point for others. This generally speeds up the number of iterations needed to converge to slightly different solutions. Such an estimate would be a more fair approach to runtime comparison. I believe that even if the runtime advantage is noticeably reduced it is still an interesting result.\n* The other stress test to justify that the GNN model has learned something non-trivial would be to include a baseline method where the parameters of the wave function are not changing with the system. (e.g. show the results of PESNet for Fig. 3 and Fig. 4 with single parameters w; w_m predicted by GNN intermediate regime). This would enable a clear assessment of how relevant the modifications to the ground state are.\n",
            "summary_of_the_review": "The paper presents sufficiently strong results and an interesting demonstration of how a single network can be used to simultaneously approximate a family of ground state wave functions. Results are compared to relevant baselines and with simple additional checks suggested in the main review should be a good contribution to variational methods in quantum chemistry.\n\n**Update**\nAfter the discussion period many of my concerns have been cleared. Changing my score from 6 to 8. ",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
        },
        {
            "summary_of_the_paper": "The authors introduce an approach based on using graph neural networks to parametrize wavefunctions represented by an equivariant neural network. This allows them simultaneously solve for the ground state energy of multiple molecular configurations with variational Monte Carlo.",
            "main_review": "Overall, the manuscript is well written and theory and experiments are presented in a concise fashion. The idea of coupling neural wavefunctions for different nuclear configurations with a meta-GNN is promising, since this allows for simultaneous solution with VMC. The experiments demonstrate the utility of such an approach in terms of accuracy and computational speed up.  There are, however, some issues that should be addressed. \n\nFirst, the comparison of computational timings between the different methods is hard to follow at points. Is it correct to assume that the reported timings are those needed to solve for every configuration of a particular molecule? How is this handled in case of the systems where PESNet is solved for a continuous subset of structures (e.g. are there global convergence criteria)? Regarding the time per iteration reported in the SI, it is unclear how exactly these are computed. For example, in Table 1, it is assumed that 10000 iterations with PauliNet for H4+ take 43 hours, which should give a time per iteration of ~15 s instead of the 0.83 s reported. Similarly, solving PESNet for the same system takes only half the time in Table 1, while the SI reports 60000 iterations @ 1.29 s. Finally, there is  the question whether the pretraining on HF orbitals is included in the timings.\n\nSecond, the comparison between different approaches could profit from additional information. While not a completely reliable measure, it would be helpful to report the parameter count of the different models as used in the experiments in order to gain an impression of their overall flexibility. Moreover, an ablation study, where the MetaGNN and WFModel are optimized for the different configurations of a system individually would add to the analysis of the model. This would help to identify how the MetaGNN influences the wavefunction solution of a single conformer and if e.g. the structural dependence of the weights introduced in the MetaGNN is beneficial.\n\nFinally, regarding the the equivariant coordinate frame. The PCA based frame can potentially become unstable if structures are strongly distorted (e.g. principal axis change order). Perhaps the authors can comment on how this is handled and whether it presents a problem for the wavefunction model or limits the range of structural configurations that can be studied with a single metaGNN. Is the same coordinate frame used for all configurations of a system or are individual frames employed? Finally, it would be interesting to motivate why this particular approach of introducing SE(3) equivariance was chosen in favor of more conventional SE(3) equivariant graph networks.",
            "summary_of_the_review": "The manuscript is well written and the proposed approach is sufficiently novel. Its advantages are further clearly demonstrated in a series of experiments. As such, I recommend to accept this contribution.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
        }
    ]
}