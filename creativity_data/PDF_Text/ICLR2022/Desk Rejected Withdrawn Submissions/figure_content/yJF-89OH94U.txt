Figure 1: Illustration of unit contribution (i.e., weight × activation) to the class output. For class c, theoutput fc(x) is the summation of unit contribution from the penultimate feature layer of a neural network. Unitsare sorted in the same order, based on the expectation ofID data’s contribution (averaged over many CIFAR-10samples) on the x-axis. Shades indicate the variance for each unit. Left: For in-distribution data (CIFAR-10,airplane), only a subset of units contributes to the model output. Right: In contrast, out-of-distribution (OOD)data can trigger a non-negligible fraction of units with noisy signals, as indicated by the variances.
Figure 2: A toy example of summation of two independent Gaussian variables has increased variance.
Figure 3: Illustration of out-of-distribution detection using Directed Sparsification (DICE). We consider apre-trained neural network, which encodes an input x to a feature vector h(x) ∈ Rm . Left: The logit outputfc(x) of class c is a linear combination of activation from all units in the preceding layer, weighted by wi. Thefull connection results in a high variance for OOD data,s output, as depicted in the gray. Right: Our proposedapproach leverages a selective subset of weights, which effectively reduces the output variance for OOD data,resulting in a sharper score distribution and stronger separability from ID data. The output distributions arebased on CIFAR-10 trained network, with ID class label “horse” and SVHN as OOD.
Figure 4: Output distribution for ID (blue) and OOD(gray) under different sparsity parameters p. From leftto right, the variances of gray distributions decreaseas the sparsity increases, resulting in improved OODdetection performance (measured by FPR95).
Figure 5: Units in the penultimate layer are sorted based on theaverage contribution to a CIFAR-10 class (“airplane”). OOD data(SVHN) can trigger a non-negligible fraction of units With noisysignals on the CIFAR-10 trained model. Units are sorted in thesame order, based on the ID contribution.
Figure 6: Covariance matrix of unit contribution estimated on the OOD dataset SVHN. Modelis trained on ID dataset CIFAR-10. The unit indices are sorted from low to high, based on theexpectation value of ID’s unit contribution (airplane class, same as in Figure 1). The matrix primarilyconsists of elements with 0 value.
