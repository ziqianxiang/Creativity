Figure 1: Learning from three-body systems and extrapolating to multi-body (> 3) systems. Theinputs are the generalised position q and velocity q. The output is the acceleration q. As fortraining, multilayer perception (MLP) can only accept data with fixed input size. After users trainthe MLP using a dataset of three-body systems, they can only implement this network to simulatethe same system for testing. By contrast, our model can recurrently process input data to obtain theLagrangian L, which describes the evolution of the whole system. This feature supports our modelto accept data with different input sizes, extrapolate to multi-body systems with the same laws ofphysics, and predict the trajectories with high accuracy.
Figure 2: The compositional graph of the Modular Lagrangian Neural Network (ModLaNN). Thegeneralised position q and generalised velocity q are inputted into two branches and recursivelyprocessed. Each branch can contain more than one RelationCell R to deal with inputs with dif-ferent combination forms. For example, the input of Rq1 can be position qi for loop i to regressgravitational potential, and the input of Rq2 may be positions (qi , qj ) for loop i and j to repre-sent electric potential field. The outputs are used to calculate kinetic energy T , potential energy U,and Lagrangian L. The derivatives of L will be utilised for the accelerations q or resultant force ffollowing Equation 5.
Figure 3: Three dynamical systems for illustrations. (a) shows a single pendulum system. Bothmulti-pendulum systems (b) and multi-body systems (c) are highly chaotic systems whose dynamicsare hard to simulate (Shinbrot et al., 1992; Vaidyanathan & Volos, 2016).
Figure 4: Simulation results of a single pendulum system (best view in colour). Colours representthe change of time marked in the colour bar. Points mark the end of the trajectory. Our prediction(b) is very close to the ground truth (a). The endpoint of HNN's trajectory (c) implies the differencebetween the HNN simulation and the ground truth. (d) reveals that the baseline's trajectory quicklydiverges. (e) puts all trajectories together for better comparison, where HNN's orbit is smaller thanthe ground truth. (f) and (g) show our model can maintain minor mean squared errors (MSEs) incoordinates and energy.
Figure 5: Simulation of pendulum systems withvarying lengths (best view in colour). Each curverepresents one trajectory of a pendulum. Thecolour bar marks the time change.
Figure 6: Simulation results of a double pendulum system (best view in colour). Only our model (b)can make precise predictions close to the ground truth (a), while the HNN model (c) and baselinemodel (d) cannot converge. MSEs related to our model in (e) and (f) are much smaller than those ofthe other two models.
Figure 7: Simulation results of multi-pendulum (> 2) systems for extrapolations (best view incolour). The trajectories of the triple pendulum (a-c) and the quadruple pendulum (h-k) are listedcompared with the ground truth. MSEs of different components shown in (d-g) indicate that predic-tions by our model are close to the ground truth.
Figure 8: Simulation results of a three-body system (best view in colour). Our Prediction (b) hereis closest to the ground truth (a). The trajectory of object 1 Predicted by HNN (c) is away from theground truth. The baseline Performance is the worst, with the orbit (d) and energy (h) divergence.
Figure 9: Simulation results of multi-body (> 3) systems for extrapolations (best view in colour).
Figure 10:	Training results of pendulum systems with different datasets. In (a-g), models are trainedusing the dataset in which the pendulum's length is 4 m. The performances of HNN (c) and baselinemodel (d) are close to the ground truth (a). In (h-n), models are trained when the length is 1 m. Moresignificant divergences exist in trajectories predicted by HNN (j) and baseline model (k) comparedwith the ground truth (h). By contrast, our model made precise predictions in both situations (b) and(i). This difference can be seen using MSEs in (f-g) and (m-n). These results show that HNN andbaseline models are sensitive to the chosen datasets, while our models are robust.
Figure 11: Simulation results of three-body systems in three cases. Three models make their predic-tions in three initial conditions (a-h), (i-p), and (q-x). Within these cases, our model made the mostprecise predictions of the change of motion and energy.
