Under review as a conference paper at ICLR 2022
Learning Representation for Bayesian Opti-
mization with Collision-free Regularization
Anonymous authors
Paper under double-blind review
Ab stract
Bayesian Optimization has been challenged by the large-scale and high-
dimensional datasets, which are common in real-world scenarios. Recent works
attempt to handle such input by applying neural networks ahead of the classical
Gaussian process to learn a (low-dimensional) latent representation. We show
that even with proper network design, such learned representation often leads to
collision in the latent space: two points with significantly different observations
collide in the learned latent space, leading to degraded optimization performance.
To address this issue, we propose LOCo, an efficient deep Bayesian optimiza-
tion framework which employs a novel regularizer to reduce the collision in the
learned latent space and encourage the mapping from the latent space to the ob-
jective value to be Lipschitz continuous. LOCo takes in pairs of data points and
penalizes those too close in the latent space compared to their target space dis-
tance. We provide a rigorous theoretical justification for LOCo by inspecting the
regret of this dynamic-embedding-based Bayesian optimization algorithm, where
the neural network is iteratively retrained with the regularizer. Our empirical re-
sults further demonstrate the effectiveness of LOCo on several synthetic and real-
world benchmark Bayesian optimization tasks.
1	Introduction
Bayesian optimization is a classical sequential optimization method and is widely used in various
fields in science and engineering, including recommender systems (Galuzzi et al., 2019), medical
trials (Sui et al., 2018), robotic controller optimization (Berkenkamp et al., 2016), scientific exper-
imental design (Yang et al., 2019), and hyper-parameter tuning (Snoek et al., 2012), among many
others. Many of these applications involve evaluating an expensive blackbox function; therefore,
the number of queries should be minimized. A common way to model the unknown function is
via Gaussian processes (GPs) (Rasmussen and Williams, 2006), which have been extensively stud-
ied under the bandit setting, as an effective surrogate model of the unknown objective function in a
broad class of blackbox function optimization problems (Srinivas et al., 2010; Djolonga et al., 2013).
A key computational challenge for learning with GPs lies in optimizing specific kernels used for
modeling the covariance structures. Such an optimization task depends on the dimension of the
input space. For high-dimensional data, it is often prohibitive to train a GP model. Meanwhile,
local kernel machines are known to suffer from the curse of dimensionality (Bengio et al., 2005),
while the required number of training samples could grow exponentially with the dimensionality of
the data. Therefore, dimensionality reduction and representation learning algorithms are needed to
optimize the learning process.
Recently, Gaussian process optimization has been investigated in the context of latent space models.
For example, deep kernel learning (Wilson et al., 2016) learns a (low-dimensional) data represen-
tation and a scalable kernel simultaneously via an end-to-end trainable deep neural network. In
general, the neural network is trained to learn a simpler latent representation with reduced dimen-
sion and has the structure information already embedded for the GP. Combining the representation
learned via a neural network with GP could improve the scalability and extensibility of classical
Bayesian optimization, but it also poses new challenges for the optimization task, such as dealing
with the tradeoff between representation learning and function optimization (Tripp et al., 2020).
1
Under review as a conference paper at ICLR 2022
As we later demonstrate, a critical challenge brought by introducing representation learning into
Bayesian optimization is that the latent representation is prone to collisions: two points with signifi-
cantly different observations can get too close, and therefore collide in the latent space. The collision
effect in latent space models for Bayesian optimization is especially evident when information is lost
during dimensionality reduction and/or when the training data is limited in size. As illustrated in
Figure 1, when passed through the neural network, data points with drastically different observations
are mapped to close positions in the latent space. Such collisions could be regarded as additional
noise introduced by the neural network. Although Bayesian optimization is known to be robust to
mild noisy observations (Bogunovic et al., 2018), the collision in latent space could be harmful to
the optimization performance, as it is non-trivial to model the collision into the acquisition function
explicitly. Also, the additional noise induced by the collision effect will further loosen the regret
bound for classical Bayesian optimization algorithms (Srinivas et al., 2010).
Overview of main results To mitigate the collision effect, we
propose a novel regularization scheme that can be applied as a
simple plugin amendment for the latent space based Bayesian
optimization models. The proposed algorithm, namely Latent
Space Optimization via Collision-free regularization (LOCO),
leverages a regularized regression loss function to optimize the
latent space for Bayesian optimization periodically.
Concretely, our collision-free regularizer is encoded by a novel
pairwise collision penalty function defined jointly on the latent
space and the output domain. In order to mitigate the risk of
collision in the latent space (and consequently boost the opti-
mization performance), LOCo applies the regularizer to mini-
mize the collisions uniformly in the latent space.
We further note that for Bayesian optimization tasks, collisions
in regions close to the optimum are more likely to mislead the
optimization algorithm. Based on this insight, we propose an
optimization-aware regularization scheme that assigns higher
weight to the collision penalty on those pairs of points closer to
the optimum region in the latent space. This algorithm, which
We refer to as Dynamically-Weighted LOCO, is designed to dy-
namically assess the importance ofa collision during optimiza-
Figure 1: The collision effect in
latent space-based BO tasks When
having 100 data points and observa-
tions. Because the data points around
the optimum severely collided, BO is
misguided to the sub-optimum. Dif-
ferent from noise Which normally as-
sumed to be Gaussian, the collision
could be much more divergent. See
extended discussion in Appendix B.1.
tion. Compared With the uniform collision penalty in the latent space, the dynamic Weighting mech-
anism has demonstrated drastic improvement over the state-of-the-art latent space based Bayesian
optimization models.
We summarize our key contributions as folloWs:
I.	We investigate latent space based Bayesian optimization, and expose the limitations of existing
latent space optimization approaches due to the collision effect on the latent space (Section 3).
II.	We propose a novel regularization scheme as a simple plugin amendment for latent space
based Bayesian optimization models. Our regularizer penalizes collisions in the latent space
and effectively reduces the collision effect. Furthermore, We propose an optimization-aWare
dynamic Weighting mechanism for adjusting the collision penalty to improve the effectiveness
of regularization for Bayesian optimization (Section 4).
III.	We provide theoretical analysis for the performance of Bayesian optimization on regularized
latent space (Section 5).
IV.	We conducted an extensive empirical study on several synthetic and real-World datasets, in-
cluding a real-World case study for cosmic experimental design, and demonstrate the promis-
ing empirical performance for our algorithm (Section 6).
2	Related Work
This section provides a short survey on recent Work in Bayesian learning, Which Was designed to
overcome the high-dimensionality challenge for Gaussian process regression tasks and Bayesian
optimization.
2
Under review as a conference paper at ICLR 2022
Different surrogate models with internal latent space Some alternative surrogate models have
been proposed to replace classical GP in Bayesian optimization to overcome the challenge of high-
dimensional and highly-structured input in BO. Deep Network for Global Optimization (DNGO)
Snoek et al. (2015) uses a pre-trained deep neural network with a Bayesian linear regressor at the
last hidden layer of the network as the surrogate model. More generally, Deep Kernel Learning
(DKL) combines the power of the Gaussian process and neural network by introducing a deep
neural network g to learn a mapping g : X → Z from the input domain X to a latent space Z
(Wilson et al., 2016). It uses the latent representation z ∈ Z as the input of the base Gaussian
process. The neural network g and a spectral mixture-based kernel k form a scalable expressive
closed-form deep covariance kernel, denoted by kDK (xi, xj) → k(g(xi), g(xj)). The deep kernel
allows end-to-end learning and Bayesian optimization on the original input space.
Representation learning and latent space optimization Instead of reducing the dimensionality
and performing optimization in an end-to-end process, other methods aim to optimize in a related
low-dimensional space first and then map the solution back to the original input space. Djolonga
et al. (2013) assume that only a subset of input dimensions varies, and the kernel is smooth (i.e. with
bounded RKHS norm). Under these assumptions, the underlying subspace is learned via low-rank
matrix recovery. Random feature is another solution under this setting (Rahimi et al., 2007; Letham
et al., 2020; Binois et al., 2015; Nayebi et al., 2019; Wang et al., 2016). It is known that a random
representation space of sufficiently large dimension is guaranteed to contain the optima with high
probability. MUtny and Krause (2019) consider Quadrature Fourier Features (QFF)——as opposed to
Random Fourier Feature (RFF) in Rahimi et al. (2007)—to overcome the variance starvation prob-
lem, and proved that Thompson sampling and GP-UCB achieve no-regret with squared exponential
kernel in optimization tasks. However, both RFF and QFF methods rely on a key assumption that
the function to be optimized has a low effective dimension. In contrast, as discussed in Section 6 and
the supplemental materials, we show that LOCo performs well for challenging high-dimensional
BO problems where algorithms relying on the low effective dimension assumption may fail.
Another line of work on latent space optimization uses autoencoders to learn low-dimensional rep-
resentations of the inputs to improve the scalability and capability to leverage the structural infor-
mation (Mathieu et al., 2019), (Ding et al., 2020), (Gomez-Bombarelli et al., 2018; Huang et al.,
2015; Tripp et al., 2020; Lu et al., 2018). Mathieu et al. (2019), Ding et al. (2020) focus on disentan-
gled representation learning that breaks down, or disentangles, each feature into narrowly defined
variables and encodes them as separate dimensions.Tripp et al. (2020) iteratively train the autoen-
coder with a dynamic weighting scheme when performing optimization to improve the embedding.
Griffiths and Hernandez-Lobato (2020) and Letham et al. (2020) enforce certain properties on the
representation space to improve the optimization performance. To the best of the authors’ knowl-
edge, collision of the embeddings has not been explicitly studied. Binois et al. (2015) propose a
warped kernel to guarantee the injectivity in the random linear embedding, which is not applicable
in neural network-based methods.
A common challenge in applying these techniques to generic optimization tasks lies in the assump-
tion on the accessibility of training data: Bayesian optimization often assumes limited access to
labeled data, while surrogate models built on deep neural networks often rely on abundant access to
data for pretraining. Another problem lies in the training objective: During the training phase, these
surrogate models typically focus on improving the regression performance, and do not explicitly
address the artifact caused by collisions of the learned embeddings, which——as we later demonstrate
in Section 3.3——could be harmful to sequential decision-making tasks.
3	Problem Statement
In this section, we introduce necessary notations and formally state the problem. We focus on the
problem of sequentially optimizing a function f : X → R, where X ⊆ Rd is the input domain.
At iteration t, we pick a point xt ∈ X, and observe the function value perturbed by additive noise:
yt = f (Xt) + et with et 〜N(0,σ2) being i.i.d. Gaussian noise. Our goal is to maximize the
sum of rewards PtT=1 f(xt) over T iterations, or equivalently, to minimize the cumulative regret
RT := PtT=1 rt, where rt := max f (x) - f(xt) denotes the instantaneous regret of xt.
3
Under review as a conference paper at ICLR 2022
3.1	Bayesian Optimization
Formally, we assume that the underlying function f is drawn from a Gaussian process
G P (m(x), k(x, x0)), Where m(x) is the mean function and k(x, x0) is the covariance function.
At iteration t, given the selected points At = {x1, . . . , xt} and the corresponding noisy evalua-
tions yt = [yι,..., yt]>, the posterior over f also takes the form of a GP, with mean μt(x)=
kt(x)>(Kt + σ2I)-1yt, covariance kt (x, x0) = k(x, x0) - kt(x)>(Kt + σ2I)-1kt(x0), and vari-
ance σt2(x) = kt(x, x), where kt(x) = [k(x1, x), . . . , k(xt, x)]> and Kt is the positive definite
kernel matrix [k(x, x0)]x,x0∈At (Rasmussen and Williams, 2005). After obtaining the posterior, one
can compute the acquisition function α : X → R, which is used to select the next point to be
evaluated. Various acquisition functions have been proposed in the literature, including popular
choices such as Upper Confidence Bound (UCB) (Srinivas et al., 2010) and Thompson sampling
(TS) (Thompson, 1933).
Remark. Regret is commonly used as performance metric for BO methods. In this work we focus
on the simple regret rT = max f (x) — max f (Xt) and cumulative regret R(T) = PtL 1 r.
x∈X	t≤T	t=1
3.2	Latent Space Optimization
Recently, Latent Space Optimization (LSO) has been proposed to solve Bayesian optimization prob-
lems on complex input domains (Gomez-Bombarelli et al., 2018; HUang et al., 2015; TriPP et al.,
2020; LU et al., 2018). LSO learns a latent space mapping g : X → Z to convert the inpUt
space X to the latent space Z . Then, it constructs an objective mapping h : Z → R such that
f(x) ≈ h(g(x)), ∀z ∈ Z. In this paper, we model the latent space mapping g as a neural net-
work; the neural network g and the base kernel k together are regarded as a deep kernel, denote by
knn(x, x0) = k(g(x), g(x0)) (Wilson et al., 2016). In this context, the actual input space for BO is
the latent space Z and the objective function is h. With the acquisition function αnn(x) := α(g(x)),
we do not compute an inverse mapping g-1 as opposed to the aforementioned autoencoder-based
LSO algorithms (e.g. Tripp et al. (2020)), since BO directly select xt = arg max αnn(x) ∀t ≤ T. In
x∈X
our analysis, We use squared exponential kernel, i.e. k、E (x, x0) = σ∣E exp (一 (x；；)).
3.3	The Collision Effect of LSO
When the mapping g : X → Z is represented by a neural network, it may cause undesirable
collisions between different input points in the latent space Z. Under the noise-free setting, we say
there exists a collision in Z, if ∃xi, xj ∈ X, such that when g(xi) = g(xj), |f(xi) — f(xj)| > 0.
Such collision could be regarded as additional (unknown) noise on the observations introduced by
the neural network g. Given a representation function g, noisy observations y = f (x)+, we say that
there exists a collision, if for λ > 0, there exist Xi,Xj ∈ X, SUchthat ∣g(xj - g(xj )| < λ∣yi — y/
When the distance between a pair of points (xi, xj) in the latent space is too close compared to
their difference in the oUtpUt space, the different oUtpUt valUes yi , yj for the collided points in the
latent space coUld be interpreted as the effect of additional observation noise for g(xi) (or g(xj )).
In general, collisions coUld degrade the performance of LSO. Since the collision effect is a priori
Unknown, it is often challenging to be dealt with in LSO, even if we regard it as additional obser-
vation noise and increase the (defaUlt) noise variance in the GaUssian process. ThUs, it is necessary
to mitigate the collision effect by directly restraining it in the representation learning phase. One
potential method to avoid collision coUld be tUning the design of neUral networks. However, we
empirically show that increasing the network complexity often does not help to redUce the collision.
The stUdy is posed in Appendix B.2.
We consider a low-noise setting where the collision can play a more significant role in degrading the
optimization performance. As is shown in FigUre 1 that the collision coUld resUlt in larger difficUlty
in the optimization task. And when a collision exists, it is hard to distingUish it from the observation.
Therefore we focUsed on treating the collision when defining the penalty instead of dealing with the
stochasticity.
4
Under review as a conference paper at ICLR 2022
4	Latent Space Optimization via Collision-free Regularization
We now introduce LOCo as a novel algorithmic framework to mitigate the collision effect.
4.1	Overview of the LOCo Algorithm
The major challenge in restraining collisions in the latent space is that—unlike the formulation of
the classical regression loss—we cannot quantify it based on a single training example. We can,
however, quantify collisions by grouping pairs of data points and inspecting their corresponding
observations.
We define the collision penalty based on pairs of inputs
and further introduce a pair loss function to characterize
the collision effect. Based on this pair loss, we propose
a novel regularized latent space optimization algorithm1,
as summarized in Algorithm 1. The proposed algorithm
concurrently feeds the pair-wise input into the same net-
work and calculates the pair loss function. We demon-
strate this process in Figure 2.
Given a set of labeled data points, we can train the neu-
ral network to create an initial latent space representation
similar to DKL (Wilson et al., 2016)1 2. Once provided Figure 2: Schematic of LOCO
with the initial representation, we can then refine the la-
tent space by running LOCo and periodically update the latent space (i.e. updating the learned
representation after collecting a batch of data points) to mitigate the collision effect as we gather
more labels.
Algorithm 1 Latent Space Optimization via Collision-free Regularization (LOCO)
1:	Input: Penalty parameter λ (cf. Equation 1), regularization weight ρ (cf. Equation 3), impor-
tance weight parameter ζ (cf. Equation 2), neural network g, parameters θt = (θh,t, θg,t), total
time steps T ;
2:	for t = 1 to T do
3:	Xt J arg max a(g(x, θg,t))	. maximize acquisition function
x∈D
4:	yt J evaluation on xt	. update observation
5:	θt+1 J retrain θt with the pair loss function Lρ,λ,ζ,g(θt, Dt) as in Equation 3
6:	Output: max yt
4.2	Collision Penalty
This subsection aims to quantify the collision effect based on the definition proposed in Section 3.3.
As illustrated in Figure 2, we feed pairs of data points into the neural network and obtain their latent
space representations. Apart from maximizing the GP’s likelihood, we concurrently calculate the
amount of collision on each pair and incur a penalty when the value is positive. For xi, xj ∈ X,
yi = f(xi)	+ ,	yj	= f(xj) +	are the corresponding observations, and zi	=	g(xi),	zj	=	g(xj)	are
the corresponding latent space representations. We define the collision penalty as
Pij =max(λ∣yi - yj| - |zi — zj|,0)	(1)
where λ is a penalty parameter that controls the smoothness of the target function h : Z → R. As a
rule of thumb, one can estimate λ by sampling from the original data distribution P(X, Y ), (X, Y ) ∈
XX R, and choose the λ to be the maximum value such that Pi j max(λ∣yi 一 yj ∣一∣Xi — Xj |, 0) = 0
(i.e. to provide an upper bound for λ by keeping the total collision in the input domain to be zero).
1 Note that we have introduced several hyper-parameters in the algorithm design; we will defer our discus-
sion on the choice of these parameters to Section 6.
2To obtain an initial embedding in the latent space, the process does not require the labels to be exact and
allows the labels to be collected from a related task of cheaper cost.
5
Under review as a conference paper at ICLR 2022
4.3	Importance-Weighted Collision-Free Regularizer
Note that it is challenging to universally reduce the collisions by minimizing the collision penalty
and the GP’s regression loss—this is particularly the case with a limited amount of training data.
Fortunately, for optimization tasks, it is often unnecessary to learn fine-grained representation for
suboptimal regions. Therefore, we can dedicate more training resources to improve the learned
latent space pertaining to the potentially near-optimal regions. Following this insight, we propose
to use a weighted collision penalty function, which uses the objective values for each pair as an
importance weight in each iteration. Formally, for any pair ((xj , zj , yj), (xi, zi, yi)) in a batch of
observation pairs Dt = {((xm, zm, ym), (xn, zn, yn))}m,n where xn, xm ∈ At and yn, ym ∈ yt,
we define the importance-weighted penalty function as
eζ(yi+yj)
Pij= pijWij	with	Wij= P	ez(ym+yn).
(m,n)∈Dt
(2)
Here the importance weight ζ is used to control the aggressiveness of the weighting strategy.
Combining the kernel learning objective—negative log likelihood and the collision penalty for GP,
we define the pair loss function Lρ,λ,ζ,g as
Lρ,λ,ζ,g (θt,Dt) = - log(P (yt∣At,θt)) + ɪɪ	X	Pij
||Dt|| i∈Dt,j∈Dt
(3)
Here, -log(P(yt∣At,θt)) = - 1 y>(Kt + σ2I)-1yt - 1 |(Kt + σ2I)| - 2 log(2π) is the learning
objective for the GP (Rasmussen and Williams, 2005). ρ denotes the regularization weight; as we
demonstrate in Section 6, we initialize the regularization weight ρ to keep the penalty at the same
order of magnitude as the negative log likelihood. An alternative training process is to minimize the
regression loss and the collision penalty alternatively. We observe in our empirical study that both
training processes could lead to reasonable convergence behavior of the LOCo training loss.
5	Discussion and Theoretical Insight
This subsection discusses the theoretical insight underlying the collision-free regularizer, by inspect-
ing the effect of regularization on the regret bound of LOCo where the constantly trained neural
network feeds a dynamic embedding to the Gaussian process.
While the key idea for bounding the regret of UCB-based GP bandit optimization algorithms follows
the analysis of Srinivas et al. (2010), two unique challenges are posed in the analysis of LOCo.
Firstly, unlike previous work in Srinivas et al. (2010), the neural network is constantly retrained
along with the new observations. Thus, the input space for the downstream Gaussian process could
be highly variant.
For the discussion below, we consider a stationary and monotonic kernel, and assume that retraining
the neural network g does not decrease the distance between data points in the latent space. It is
worth noting that, although not strictly enforced, such monotonicity behavior is naturally encour-
aged by our proposed regularization, which only penalizes the pair of too-close data in the latent
space. Under the above assumption, the internal complexity of neural network training still makes
it challenging to bound the regret w.r.t the dynamics of the neural network. Thus, we investigate the
dynamics of the mutual information term in the regret bound, and justify the proposed collision-free
regularizer by showing that penalizing the collisions tends to reduces the upper bound on the regret.
We first consider a discrete decision set and then leverage the desired Lipschitz continuity on the
regularized space to extend our results to the continuous setting (cf full proofs in Appendix A).
Proposition 1. Let Z be a finite discrete set. Let δ ∈ (0, 1), and define βt = 2log |Z |t2 /6δ .
Suppose that the objective function h : Z × θ -→ R defined on Z and parameterized by θ is a sam-
ple from GP. Furthermore, consider a stationary and monotonic kernel, and assume that retraining
the neural network g does not decrease the distance between data points in the latent space. Run-
ning GP-UCB with βt for a sample h of a GP with mean function zero and stationary covariance
function k(x, x0), we obtain a regret bound of O^ ( y∕∖og(∖Z∖)T(γτ - I (h(zτ, θh,o); φτ)) with high
probability.
6
Under review as a conference paper at ICLR 2022
More specifically, with C1 = 8/ log 1 + σ-2 , we have
P RT ≤ ʌ∕CιTβτ(7T-^(h(ZτΓθh,0)ΓΦτ)) ≥ 1 — δ.
Here γT is the maximum information gain after T iterations, and φT as the identification of the
collided data points on Z. γT is defined asγT := max	I (yA, φT; h(A, θT)).
A⊂Z,∣A∣=T
The collision regularization reduced the maximum mutual information by a specific term dependent
on the distribution of the noise caused by the collision of data points. The distribution is dynamic
and determined by the complex learning process of the neural network. In the following, we show
that the mutual information is bounded within a given interval:
Assume φt is a random variable that identify zt ∈ Z, yt ∈ Y from its collided points, and the
variance of the collision is σc2ol, then we have
0 ≤ I (h(zτ,θh,o); Φt) ≤ 1∕2log ∣2πeσ2oil|
This means that if φt is a random variable sampled from a Gaussian distribution defined on h, then
I (h(zT , θh,0 ); φT ) is maximized.
The regularization also constrains the function h to be Lipschitz-continuous with a Lipschitz con-
stant, enabling a slightly narrower regret bound.
Proposition 2. Let Z ⊂ [0, r]d be compact and convex, d ∈ N, r > 0 and λ ≥ 0. Sup-
pose that the objective function h : Z × θ -→ R defined on Z and parameterized by θ is a
sample from GP and is Lipschitz continuous with Lipschitz constant λ. Let δ ∈ (0, 1), and
define βt = 2 log π2t2∕6δ + 2d log λrdt2 . Furthermore, consider a stationary and mono-
tonic kernel, and assume that retraining the neural network g does not decrease the distance
between data points in the latent space. Running GP-UCB with βt for a sample h of a GP
with mean function zero and stationary covariance function k(x, x0), we obtain a regret bound of
O*(PdT(TT-Γ(h(ZT,θh,0)ΓφT)) with high probability.
More specifically, with C1 = 8∕ log 1 + σ-2 , we have
P rt ≤ qCιTβτ(7T-^(h(zτΓθh,0)Γφτ)) + 2 ≥ 1 - δ∙
Here γT is the maximum information gain after T iterations, and φT as the identification of the
collided data points on Z. γT is defined as γT :
max
A⊂Z,∣A∣=T
I (yA, φT; h(A, θT)).
6	Experiments
In this section, we empirically evaluate our algorithm on several synthetic and real-world bench-
mark blackbox function optimization tasks. All experiments are conducted on Google Cloud GPU
instance (4 vCPUs, 15 GB memory, Tesla T4 GPU) and Google CoLab high-RAM GPU instance.
6.1	Experimental Setup
We consider five baselines in our experiments. Three popular optimization algorithms—particle
swarm optimization (PSO) (Miranda, 2018), Tree-structured Parzen Estimator Approach (TPE)
(Bergstra et al., 2011), a BoTorch (Balandat et al., 2020) implementation of Trust Region Bayesian
Optimization (TuRBO) (Eriksson et al., 2019), and standard Bayesian optimization (BO) (Nogueira,
2014) which uses Gaussian processes as the statistical model—are tuned in each task. Another base-
line we consider is the sample-efficient LSO (SE LSO) algorithm, which is implemented based on
the algorithm proposed by Tripp et al. (2020). We also compare the non-regularized latent space
optimization (LSO), LOCO with uniform weights (i.e. ζ = 0, referred to as LOCO), and the
dynamically-weighted LOCO (i.e. with ζ > 0, referred to as DW LOCO) proposed in this paper.
One crucial problem in practice is tuning the hyper-parameters. The hyper-parameters for GP are
tuned for periodically retraining in the optimization process by minimizing the loss function on a
7
Under review as a conference paper at ICLR 2022
(a) Max Area
(d) Water Converter
Iterations
(e) Supernova
---LOCo
---DW LOCo
Iterations
(b) Sum 200D
Supernova
∞706050φ3020lo
电60)」①-dujω
(c) Rastrigin 2D
(f) SPOKES
Figure 3: Experiment results on six pre-collected datasets. Each experiment is repeated at least
eight times.The colored area around the mean curve denotes the √σ=. Here σ denotes the empirical
standard deviation. n denotes the number of cases repeated in experiments. Note that the BO and
TPE implementation we tested can not finish in reasonable time for figure 3a and figure 3b.
validation set. For all our tasks, we choose a simple neural network architecture due to the reasoning
in section 3.3, as well as due to limited and expensive access to labeled data under the BO setting.
The coefficient ρ is, in general, selected to guarantee a similar order for the collision penalty to GP
loss. The λ should be tolerant of the additive noise in the evaluation. In practice, we choose the
simple setting λ = 1 and find it perform well. We also include a study of the parameter choice in
the appendix. ζ controls the aggressiveness of the importance weight. While ζ should not be too
close to zero (equivalent to uniform weight) , an extremely high value could make the regularization
overly biased. Such a severe bias could allow a heavily collided representation in most of the latent
space and degrade regularization effectiveness. The value choice is similar to the inverse of the
temperature parameter of softmax in deep learning (Hinton et al., 2015). Here we use ζ = 1 for
simplicity and find it robust to different tasks. All experiments are conducted on the pre-collected
datasets. We defer the detailed experimental setup to Appendix C.
6.2	Datasets and Results
We now evaluate LOCo on three synthetic datasets and three real-world datasets. We demon-
strated the improvement in LOCo that is enabled by the explicit collision mitigation in the lower-
dimensional latent space in terms of average simple regret.
2D Shape Area Maximization The dSprites dataset (Matthey et al., 2017) consists of images of
size 64 × 64 containing 2d Shapes with different scales, rotations, and positions. Each pixel value
of the images are binary, hence x ∈ {0, 1}64×64. The goal is to generate a shape x with maximum
area, which is equivalent to finding arg max Pi64×64 xi where i corresponds to the pixel index. The
x
neural network is pretrained on 50 data points. To meet the limitation of memory on our computing
instance, we uniformly sample 10000 points from the original dataset and approximately maintain
the original distribution of the objective value. The DW LOCo and LOCo outperform or matches
the baseline methods on this dataset.
8
Under review as a conference paper at ICLR 2022
Sum 200D We create a synthetic dataset Sum 200D of 200 dimensions. Each dimension is inde-
pendently sampled from a standard normal distribution to maximize the uncertainty on that dimen-
sions and examine the algorithm’s capability to solve the medium-dimensional problem. We want
to maximize the label f(x) = Pi2=001 exi which bears an additive structure and of non-linearity. The
neural network is pretrained on 100 data points. As illustrated by figure 3b DW LOCo and LOCo
could significantly outperform baselines that do not specifically leverage the additive structures of
the problem.
Rastrigin-2D The Rastrigin function is a non-convex function used as a performance test problem
for optimization algorithms. It was first proposed by Rastrigin (1974) and used as a popular bench-
mark dataset for evaluating Gaussian process regression algorithms (Cully et al., 2018). Formally,
the 2D Rastrigin function is f(x) = 10d + Pid=1 xi2 - 10 cos(2πxi), d = 2. For convenience of
comparison, we take the -f (x) as the objective value to make the optimization tasks a maximization
task.
Supernova-3D Our first real-world task is to perform maximum likelihood inference on three
cosmological parameters, the HUbble constant H ∈ (60, 80), the dark matter fraction Ωm ∈ (0,1),
and the dark energy fraction Ωa ∈ (0,1). The likelihood is given by the Robertson-Walker metric,
which reqUires a one-dimensional nUmerical integration for each point in the dataset from Davis
et al. (2007). The neUral network is pretrained on 100 data points. As illUstrated by figUre 3e, both
LOCo and DW LOCo demonstrate its consistent robUstness. Among them, DW LOCo slightly
oUtperform LOCo the early stage.
Water Converter Configuration-16D This UCI dataset we Use consists of positions and absorbed
power oUtpUts of wave energy converters (WECs) from the soUthern coast of Sydney. The applied
converter model is a fUlly sUbmerged three-tether converter called CETO. 16 WECs locations are
placed and optimized in a size-constrained environment.
Redshift Distribution-14D CarefUl accoUnting of all the reqUirements and featUres of these ex-
periments becomes increasingly necessary to achieve the goals of a given cosmic sUrvey. SPOKES
(SPectrOscopic KEn SimUlation) is an end-to-end framework that can simUlate all the operations and
critical decisions of a cosmic sUrvey (Nord et al., 2016). In this work, we Use SPOKES to generate
galaxies within a specified window of distances from Earth. We then minimize the HaUsdorff dis-
tance between the desired redshift distribUtion and the simUlation of specific cosmological sUrveys
generated by SPOKES. In oUr experiments, the neUral network is pretrained with 400 data points.
As illUstrated by figUre 3f, the simple regret ofDW LOCo drops slower yet eventUally oUtperforms
or matches other baselines’ performances.
In general, oUr experimental resUlts consistently demonstrate the robUstness of oUr methods against
collisions in the learned latent space. OUr method oUtperforms or matches the performance of the
best baselines in all scenarios. When compared to the sample-efficient LSO, DW LOCo performs
better in most cases and shows a steady capability to reach the optimUm by explicitly mitigating the
collision in the latent space. DUe to the dynamics of representation learning process, it is difficUlt to
claim that the performance improvement broUght by dynamic weighting is Universal. This aligned
with the observation in the experiments that DW LOCo brings observable improvement in the regret
cUrve at a certain stage for an optimization task and achieve an Ultimate performance that at least
matches LOCo. In contrast, the sample-efficient LSO might fail dUe to the collision problem.
7	Conclusion
We have proposed a novel regUlarization scheme for latent-space-based Bayesian optimization. OUr
algorithm—namely LOCo—addresses the collision problem indUced by dimensionality redUction
and improves the performance for latent space-based optimization algorithms. We show that the
regUlarization effectively mitigates the collision problem in the learned latent spaces and, therefore,
can boost the performance of the Bayesian optimization in the latent space. We demonstrate solid
empirical resUlts for LOCo on several synthetic and real-world datasets. FUrthermore, we demon-
strate that LOCo can deal with high-dimensional inpUt that coUld be highly valUable for real-world
experiment design tasks sUch as cosmological sUrvey schedUling.
9
Under review as a conference paper at ICLR 2022
References
Maximilian Balandat, Brian Karrer, Daniel R. Jiang, Samuel Daulton, Benjamin Letham, An-
drew Gordon Wilson, and Eytan Bakshy. BoTorch: A Framework for Efficient Monte-Carlo
Bayesian Optimization. In Advances in Neural Information Processing Systems 33, 2020. URL
http://arxiv.org/abs/1910.06403.
Yoshua Bengio, Olivier Delalleau, and Nicolas Le Roux. The curse of dimensionality for local
kernel machines. Techn. Rep, 1258:12, 2005.
James Bergstra, Remi Bardenet, Yoshua Bengio, and Balazs KegL Algorithms for hyper-parameter
optimization. In J. Shawe-Taylor, R. Zemel, P. Bartlett, F. Pereira, and K. Q. Weinberger, edi-
tors, Advances in Neural Information Processing Systems, volume 24, pages 2546-2554. Curran
Associates, Inc., 2011.
Felix Berkenkamp, Angela P Schoellig, and Andreas Krause. Safe controller optimization for
quadrotors with gaussian processes. 2016.
Mickael Binois, David Ginsbourger, and Olivier Roustant. A warped kernel improving robustness
in bayesian optimization via random embeddings. In International Conference on Learning and
Intelligent Optimization, pages 281-286. Springer, 2015.
Ilija Bogunovic, Jonathan Scarlett, Stefanie Jegelka, and Volkan Cevher. Adversarially robust opti-
mization with gaussian processes. In NeurIPS, 2018.
A.	Cully, K. Chatzilygeroudis, F. Allocati, and J.-B. Mouret. Limbo: A Flexible High-performance
Library for Gaussian Processes modeling and Data-Efficient Optimization. The Journal of Open
Source Software, 3(26):545, 2018. doi: 10.21105/joss.00545.
T. M. Davis, E. Mortsell, J. Sollerman, A. C. Becker, S. Blondin, P. Challis, A. Clocchiatti, A. V. Fil-
ippenko, R. J. Foley, P. M. Garnavich, S. Jha, K. Krisciunas, R. P. Kirshner, B. Leibundgut, W. Li,
T. Matheson, G. Miknaitis, G. Pignata, A. Rest, A. G. Riess, B. P. Schmidt, R. C. Smith, J. Spy-
romilio, C. W. Stubbs, N. B. Suntzeff, J. L. Tonry, W. M. Wood-Vasey, and A. Zenteno. Scruti-
nizing exotic cosmological models using ESSENCE supernova data combined with other cosmo-
logical probes. The Astrophysical Journal, 666(2):716-725, sep 2007. doi: 10.1086/519988.
Zheng Ding, Yifan Xu, Weijian Xu, Gaurav Parmar, Yang Yang, Max Welling, and Zhuowen Tu.
Guided variational autoencoder for disentanglement learning. In Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition, pages 7920-7929, 2020.
Josip Djolonga, Andreas Krause, and V. Cevher. High-dimensional gaussian process bandits. In
Neural Information Processing Systems, 2013.
David Eriksson, Michael Pearce, Jacob Gardner, Ryan D Turner, and Matthias Poloczek. Scalable
global optimization via local bayesian optimization. Advances in Neural Information Processing
Systems, 32:5496-5507, 2019.
Bruno Giovanni Galuzzi, Ilaria Giordani, Antonio Candelieri, Riccardo Perego, and Francesco
Archetti. Bayesian optimization for recommender system. In World Congress on Global Op-
timization, pages 751-760. Springer, 2019.
Jacob R Gardner, Geoff Pleiss, David Bindel, Kilian Q Weinberger, and Andrew Gordon Wilson.
Gpytorch: Blackbox matrix-matrix gaussian process inference with gpu acceleration. In Advances
in Neural Information Processing Systems, 2018.
Rafael Gomez-Bombarelli, Jennifer N Wei, David Duvenaud, Jose Miguel Hernandez-Lobato,
Benjamin Sanchez-Lengeling, Dennis Sheberla, Jorge Aguilera-Iparraguirre, Timothy D Hirzel,
Ryan P Adams, and Alan Aspuru-Guzik. Automatic chemical design using a data-driven contin-
uous representation of molecules. ACS central science, 4(2):268-276, 2018.
Ryan-Rhys Griffiths and Jose Miguel Hernandez-Lobato. Constrained bayesian optimization for
automatic chemical design using variational autoencoders. Chemical science, 11(2):577-586,
2020.
10
Under review as a conference paper at ICLR 2022
Geoffrey E. Hinton, Oriol Vinyals, and J. Dean. Distilling the knowledge in a neural network. ArXiv,
abs/1503.02531, 2015.
Wenbing Huang, Deli Zhao, Fuchun Sun, Huaping Liu, and Edward Chang. Scalable gaussian
process regression using deep neural networks. In Proceedings of the 24th International Con-
ference on Artificial Intelligence, IJCAr15, pages 3576 - 3582. AAAI Press, 2015. ISBN
9781577357384.
Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint
arXiv:1412.6980, 2014.
Ben Letham, Roberto Calandra, Akshara Rai, and Eytan Bakshy. Re-examining linear embeddings
for high-dimensional bayesian optimization. Advances in Neural Information Processing Systems,
33, 2020.
Xiaoyu Lu, Javier Gonzalez, Zhenwen Dai, and Neil Lawrence. Structured variationally auto-
encoded optimization. volume 80 of Proceedings of Machine Learning Research, pages 3267-
3275, Stockholm International Fairs, Stockholm Sweden, 10-15 Jul 2018. PMLR.
Emile Mathieu, Tom Rainforth, Nana Siddharth, and Yee Whye Teh. Disentangling disentanglement
in variational autoencoders. In International Conference on Machine Learning, pages 4402-4412.
PMLR, 2019.
Loic Matthey, Irina Higgins, Demis Hassabis, and Alexander Lerchner. dsprites: Disentanglement
testing sprites dataset. https://github.com/deepmind/dsprites-dataset/, 2017.
Lester James V. Miranda. PySwarms, a research-toolkit for Particle Swarm Optimization in Python.
Journal of Open Source Software, 3, 2018. doi: 10.21105/joss.00433.
Mojmir Mutny and Andreas Krause. Efficient high dimensional bayesian optimization with addi-
tivity and quadrature fourier features. Advances in Neural Information Processing Systems 31,
pages 9005-9016, 2019.
Amin Nayebi, Alexander Munteanu, and Matthias Poloczek. A framework for bayesian optimization
in embedded subspaces. In International Conference on Machine Learning, pages 4752-4761.
PMLR, 2019.
Fernando Nogueira. Bayesian Optimization: Open source constrained global optimization tool for
Python, 2014.
B.	Nord, A. Amara, A. Refregier, La. Gamper, Lu. Gamper, B. Hambrecht, C. Chang, J.E. Forero-
Romero, S. Serrano, C. Cunha, O. Coles, A. Nicola, M. Busha, A. Bauer, W. Saunders, S. Jouvel,
D. Kirk, and R. Wechsler. Spokes: An end-to-end simulation facility for spectroscopic cosmolog-
ical surveys. Astronomy and Computing, 15:1 - 15, 2016. ISSN 2213-1337.
Ali Rahimi, Benjamin Recht, et al. Random features for large-scale kernel machines. In Neural
Information Processing Systems, volume 3, page 5. Citeseer, 2007.
C.	E. Rasmussen and C. K. I. Williams. Gaussian Processes for Machine Learning. MIT Press,
2006.
Carl Edward Rasmussen and Christopher K. I. Williams. Gaussian Processes for Machine Learning
(Adaptive Computation and Machine Learning). The MIT Press, 2005. ISBN 026218253X.
Leonard Andreevic Rastrigin. Systems of extremal control. Nauka, 1974.
Jasper Snoek, Hugo Larochelle, and Ryan P Adams. Practical bayesian optimization of machine
learning algorithms. In 26th Annual Conference on Neural Information Processing Systems 2012,
pages 2951-2959, 2012.
Jasper Snoek, Oren Rippel, Kevin Swersky, Ryan Kiros, Nadathur Satish, Narayanan Sundaram,
Mostofa Patwary, Mr Prabhat, and Ryan Adams. Scalable bayesian optimization using deep
neural networks. In International conference on machine learning, pages 2171-2180. PMLR,
2015.
11
Under review as a conference paper at ICLR 2022
Niranjan Srinivas, Andreas Krause, Sham Kakade, and Matthias Seeger. Gaussian process opti-
mization in the bandit setting: No regret and experimental design. In Proceedings of the 27th
International Conference on International Conference on Machine Learning, ICML’10, pages
1015-1022, Madison, WL USA, 2010. OmniPress. ISBN 9781605589077.
Yanan Sui, Joel Burdick, Yisong Yue, et al. Stagewise safe bayesian optimization with gaussian
Processes. In International Conference on Machine Learning, Pages 4781-4789. PMLR, 2018.
William R ThomPson. On the likelihood that one unknown Probability exceeds another in view of
the evidence of two samPles. Biometrika, 25(3/4):285-294, 1933.
Austin Tripp, Erik Daxberger, and Jose MigUel Hernandez-Lobato. Sample-efficient optimization
in the latent sPace of deeP generative models via weighted retraining. Advances in Neural Infor-
mation Processing Systems, 33, 2020.
Ziyu Wang, Frank Hutter, Masrour Zoghi, David Matheson, and Nando de Feitas. Bayesian op-
timization in a billion dimensions via random embeddings. Journal of Artificial Intelligence
Research, 55:361-387, 2016.
Andrew Gordon Wilson, Zhiting Hu, Ruslan Salakhutdinov, and Eric P. Xing. Deep kernel learning.
volume 51 of Proceedings of Machine Learning Research, pages 370-378, Cadiz, Spain, 09-11
May 2016. PMLR.
Kevin K Yang, Zachary Wu, and Frances H Arnold. Machine-learning-guided directed evolution for
protein engineering. Nature methods, 16(8):687-694, 2019.
12
Under review as a conference paper at ICLR 2022
A	Proofs
In this section, we provide proofs for our main theoretical results (Proposition 1 and Proposition 2).
A.1 Proof of Proposition 1:
Regret Bound on Discrete Decision Set
We follow the proof structure in Srinivas et al. (2010) and introduce new notations to characterize
the learning process of the neural network and the collision in the proof.
Before proving Proposition 1, we first introduce a few useful lemmas.
Lemma 1. Pick δ ∈ (0,1) and set βt = 2log(∣D∣∏t∕δ), where Pt≥ι ∏-1 = 1, ∏t > 0. Then with
probability ≥ 1 - δ, ∀x ∈ D, ∀t ≥ 1
INg(X, θg,t-I),θt-1)- μtι | ≤ β1"σt-4g(X, θg,t-I))
Here θg,t-1 is the parameter for g at time step t - 1. θh,t-1 is the parameter for h at time step t - 1.
Proof. ∀X ∈ D, ∀t ≥ 1, Conditioned on yt-1 = (y1, ..., yt-1), {X1, ..., Xt-1} are deterministic,
and h(g(x, θg,t-1),θh,t-1)〜N(μt-ι(g(x, θg,t-ι)), σ2-ι(g(x, θg,t-ι))). Then using the SUbgaUs-
sianity of h, we have
PrQNg(X, θg,t-ι),θt-ι) - μtι| ≥ β1∕2σt-ι3x, θg,t-ι)D ≤ e-βt/2
Applying the union bound, with probability ≥ 1 - ∣D∣e-βt/2, ∀x ∈ D
INg(X, θg,t-ι),θt-ι) - μtι | ≤ e1/，t-i(g(X, θg,t-ι))
Let ∣D∣e-βt/2 = δ∕∏t, applying the union bound for ∀t ∈ N the statement holds.	口
Lemma 2. Consider a stationary and monotonic kernel, and assume that retraining the neural
network g does not decrease the distance between data points in the latent space. Then ∀t ≥ 1,
rt(θt-ι) ≤ 2β1∕2σt-4g(X, θg,t-ι)) ≤ 2一/2bt-i(g(X/g,T)).
Here θg,T is the parameter for g at time step T.
Proof.
rt(θt-i) = h(g(X*,θg,t-i), θh,t-i) - h(g(Xt, θg,t-i),θh,t-i)
≤ β1∕2σt-i(g(X*,θg,t-i)) + μt-i(g(X*,θg,t-i) - h(g(Xt,θg,t-i),θh,t-i)
1/2
≤ βt σt-i(g(Xt, θg,t-i)) + μt-i(g(Xt, θg,t-i) - h(g(∙t, θg,t-i), θh,t-i)
≤ 2e；%t-i(g(Xt,θg,t-1)
≤ 2B；%t-i(g(Xt,θg,τ))
The last line is because the non-decreasing distance between g(X, θg,T) and g(X0, θg,T) ∀X, X0 ∈ D
leads to larger variance σ, when using a stationary and monotonic kernel.	口
Lemma 3. The information gain for the points selected can be expressed in terms of the predictive
variance. If hT = (h(g(Xt, θg,T), θh,T)) ∈ RT:
1T
I (VT； hτ) = 2 £log(1 + σ-2σt-ι(g(Xt,θg,τ)))
t=1
13
Under review as a conference paper at ICLR 2022
Proof. First, we get I (yτ; hτ) = H(yτ) - 2 log ∣2πeσ211. Then,
H(yT) = H(yT-1) + H(yT|yT-1)
=H(yτ-i) + log(2πe(σ2-i(g(xτ, θg,τ))))
Since xι,…，xτ are deterministic conditioned on y-ι. The result follows by induction. □
Lemma 4. The gap of the mutual information between collision-free g(xt, θg,T) and unregularized
g(xt, θg,0) is
I (yτ； h(zτ, θh,τ)) = I (yτ； h(zτ, θh,τ)∣Φτ)
=I (yτ;h(ZT, θh,o)lφτ)
= I (yT, φT; h(zT, θh,0)) - I (h(zT, θh,0); φT))
Here zt = g(xt , θg,T). φ is the identification of collided data points.
The result is a simple application of the chain rule of mutual information. I (yT; hT) =
I (yT ; h(zT , θh,T )) corresponds to the information gain under fully regularized and assumed
collision-free setting. I (yT, φT; h(zT, θh,0)) corresponds to information gain under unregularized
setting.
Lemma 5. Pick δ ∈ (0, 1) and let βt be defined as in Lemma 1. Then, the following holds with
probability ≥ 1 - δ, ∀T ≥ 1,
T
X rt2 ≤ βTC1I (yT; hT) ≤ C1βT(γT - I (h(zT, θh,0); φT)).
t=1
Here C1 := log(l+σ-2) ≥ 8σ2.
Proof. We first observe that
4βtσt2-1(g(xt, θg,T)) ≤ 4βtσ2(σ-2σt2-1(g(xt, θg,T)))
-2
≤ 4β⅜σ2(log(1+ σ-2) ) log(1 + σ-2σ2-1(g(xt,θg,T)))
Combining the above inequality with Lemma 2, Lemma 3 and Lemma 4 completes the proof. □
Now we are ready to prove Proposition 1.
Proof of Proposition 1. Proposition 1 is a simple consequence of Lemma 4 and Lemma 5 and
CaUChy-SChWarz inequality.	□
A.2 Proof of Proposition 2:
Regret Bound with Lipschitz-Continuous Objective Function
We first modify Lemma 5.7 and Lemma 5.8 in Srinivas et al. (2010) since we are assuming the deter-
ministic Lipschitz-continuity for h. Use the same analysis tool Zt defined as a set of discretization
Zt ⊂ Z where Zt will be used at time t in the analysis.
We choose a discretization Zt of size (τt)d. so that ∀z ∈ Z,
||z -[z]t∣∣ι ≤ rd∕τt	(4)
where [z]t denotes the closest point in Zt to z.
Lemma 6. Pick δ ∈ (0, 1) and set β = 2 log(πtδ) +2dlog Lrdt2 , where Pt≥1 πt-1 = 1, πt > 0.
Let τt = Lrdt2. Hence then
|h(z*,θh,t-i)- μt-i([z*]t)∣ ≤ β"σt-i([z*]t) + 1/t2 Vt ≥ 1
holds with probability ≥ 1 - δ.
14
Under review as a conference paper at ICLR 2022
Proof. Using the Lipschitz-continuity and equation 4, we have that
Vz ∈ Z,∣h(z,θh,t-i) - h([z]t,,θh,t-i)∣ ≤ Lrd∕τt
By choosing τt = Lrdt2, we have |Zt| = (Lrdt2)d and
Vz ∈ Z, ∣h(z, θh,t-1)- h([z]t, θh,t-I)I ≤ 1/t2
Then using Lemma 1, We reach the expected result.	□
Based on Lemma 2 and Lemma 6, we could have the following result directly.
Lemma 7. Pick δ ∈ (0, 1) and set β = 2 log(2πtδ)+2d log Lrdt2 , where Pt≥1 πt-1 = 1, πt > 0.
Then with probability ≥ 1 - δ, for all t ∈ N, the regret is bounded as follows:
rt ≤ 2β1∕2σt-i(zt) + 1/t2
Proof. Using the union bound of δ∕2 in both Lemma 2 and Lemma 6, we have that with probability
1 - δ:
rt = h(z*) - h(zt)
≤ β1∕2σt-ι(Zt) + 1/t2 + μt-ι(Zt)- h(Zt)
≤ 2βt / σt-1 (zt) + 1/t2
which complete the proof.	□
Now we are ready to prove Proposition 2.
Proof of Proposition 2. Using Lemma 7, we have that with probability ≥ 1 - δ:
T
X 4βtσ2-i(xt) ≤ Cιβτ(γτ - I (h(zT,θh,0); φτ)) VT ≥ 1
t=1
By Cauchy-Schwarz:
T	______________________________
X 2β1r2σt-i(xt) ≤ ,Cιβτ(γτ - I (h(zτ,θh,o); φτ)) VT ≥ 1
t=1
Finally, substitute ∏t with π2t2∕6 (since P 1/t2 = π2∕6). Proposition 2 follows.	□
15
Under review as a conference paper at ICLR 2022
B Demonstration of the Collision Effect
B.1	Visualization of the Collision Effect in the Latent Space
We demonstrate the collision effect in the latent space. We train the same neural network on Feyn-
man dataset with 101 data points which demonstrate the latent space after two retrains with the
retrain interval set to be 50 data points. The regularized one employs DW LOCo, with the regu-
Iarization parameter P = 1e5, penalty parameter λ = 1e-2, retrain interval T, weighting parameter
γ = 1e-2 and the base kernel set to be square exponential kernel. The non-regularized one employs
LSO.
(a) 1-D regularized latent space
(b) 1-D non-regularized latent space
Figure 5: Illustrate the 1-D latent space of Feynman III.9.52 dataset. The second row shows the
ratio that the penalty define as equation 1 is non-zero. The third row shows point-wise estimation of
λ. 5a shows a regularized latent space with a few observable collisions. 5b shows a non-regularized
latent space with bumps of collisions especially around the maxima among the observed data points.
Besides, having fewer collisions in the latent space contribute to the optimization through improving
the learned Gaussian process. We observe in this comparison that the next point selected by the
acquisition function of the regularized version is approaching the global optima, while the next
point in the non-regularized version is trying to solve the uncertainty brought by the severe collision
near the currently observed maxima.
B.2	The Collision Effect on Proper Neural Networks
In this section, we provide empirical results supporting the claim in section 3.3 that increasing the
network complexity often does not help to reduce the collision in the latent space.
For Feynman task, we test the single-layer neural network, which consists of 10, 1001, 5000, or
6000 neurons with Leaky Relu activation functions.
For Max Area task, we test the three-layer dense neural network. The first layer consists of 50,
100, 1000 or 1500 neurons with Tanh activation functions. The second layer consists of 50 neurons
with Tanh activation functions. The third layer consists of 10 neurons with Leaky Relu activation
functions.
For Rastrigin-2D task, we test the single-layer neural network, which consists of 10, 100, 1000, or
5000 neurons with Leaky Relu activation functions.
For SPOKES task, we test the single-layer neural network, which consists of 10, 100, 1000, or 2000
neurons with Leaky Relu activation functions.
16
Under review as a conference paper at ICLR 2022
(d) SPOKES
(e) Water Converter
Figure 6: These curves show the network design test results. The collision value shown here is the
penalty term proposed in equation 1. The x-axis denotes the neural network’s general complexity.
The collisions for model with lowest test MSE are still significant.
For the Water Converter task, we test the three-layer dense neural network. The first layer consists
of 512, 1024, 2048, or 4096 neurons with Tanh activation functions. The second layer consists of
half of the first layer’s neurons with Tanh activation functions. The third layer consists of half of the
second layer’s neurons with Leaky Relu activation functions.
We demonstrate the collision effect on regression task on Rastrigin-2D.
17
Under review as a conference paper at ICLR 2022
(a) non-regularized latent space
(b) Negative Log Likelihood
(c) Mean Squared Error
Figure 7: Illustrate regression task on Rastrigin-2D dataset. 7a shows a non-regularized latent space
after sufficiently trained as is demonstrated in 7b. 7b shows the NLL of the training process. 7a
shows the corresponding MSE.
As illustrated in figure 7a, even after being sufficiently trained after 3000 iterations, there is still
collisions in the latent space especially around the optima. figure 7a shows that by regularizing the
latent space, the ultimate MSE could also be improved.
18
Under review as a conference paper at ICLR 2022
C S upplemental Materials on Algorithmic Details
Our implementation of LOCo and DW LOCo is built upon the open source package GPytorch
(Gardner et al., 2018). The deep kernel is trained with back propogation. We use the Adam (Kingma
and Ba, 2014) optimizer with learning rate set to be 1e-2. Below we discuss the detailed configura-
tion of the underlying neural network and the choice of the key parameters used by the algorithm.
C.1 Algorithmic Details on Neural Network Architecture
As the primary goal of our paper was to showcase the performance of a novel collision-free reg-
ularizer, we pick our network architectures to be basic multi-layer dense neural network. We use
a 4-layer dense neural network. Its hidden layers consist of 1000, 500, 50 neurons respectively,
each with Leaky Relu activation functions. The output layer also uses Leaky Relu as its activation
function and generates a 1-dimensional output.
Lth hidden layer
1st hidden layer
input layer
(1)
output layer
Figure 8: Network graph of a (L + 1)-layer dense network with D input units and 1 output units. In
our experiments, L is set to be 3.
Pre-training of the Neural Network We randomly select the points from the bottom of the dataset
to avoid the pre-training simplifying the optimization task while helping with initializing the param-
eters of the model. The points are used to initialize the neural network instead of being served as
initial selections of the optimization task. Without the pre-training stage, the latent embedding fed
by the neural network to the gaussian process would be random. The practical problem with such
randomness could be a much larger variance for the results since it influences the following neural
network training process and the optimization process. In practice, it’s always possible to collect
pre-training datasets from relative domains when aiming at optimizing unknown objective functions.
This pre-training method was also reported in the literature (Snoek et al., 2015).
19
Under review as a conference paper at ICLR 2022
C.2 Parameter choices
We investigate the robustness of parameter choices of the regularization parameter λ on the Rastrigin
2D dataset. We show the results in the figure below.
Study of A
LSO
-LOCo Λ=0.01
---L0CoΛ=0.1
---LOCoΛ=l
---- LOCo Λ= 10.0
----LOCo Λ= 100.0
---- DW LOCoA=O OI
---- DW LOCoΛ=0.1
DW LOCoA=I
----DW LOCo Λ=10.0
---- DW LOCoA=IOO.O
O	20	40	60	80	IOO
Iteration
Figure 9: Simple regret under different parameter settings on the Rastrigin 2D dataset. The colored
area represents the standard error of the tests at certain iteration. Each experiments are repeated
eight times. The figure shows that a moderately large λ suffices to achieve decent performance in
terms of simple regret. We believe that the wide range of objective values of the test dataset, which
otherwise would hurt the optimization performance, can be regularized by the collision penalty. The
curves demonstrate the decent performance of DW LOCo as long as the parameters are not set to
be too small.
20
Under review as a conference paper at ICLR 2022
D Additional Results
Random EMbedding Bayesian Optimization (REMBO) (Wang et al., 2016) leverages simple random
linear transformations to improve the efficiency in low-effective-dimension high-dimensional tasks.
We compare LOCo and DW LOCo with the performance of this random-embedding-based method
and empirically exposed the failure case of REMBO when its modeling assumption does not hold
(i.e. when dealing with dataset that has large effective dimensions).
Supernova
SPOKES	Rastrigin 2D
Figure 10: Experiment results on six synthetic & real datasets. Each experiment is repeated at least
eight times. The shaded area around the mean curve denotes the -√n. Here σ denotes the empirical
standard deviation. n denotes the number of cases repeated in experiments. As illustrated in the
figure, the random-embedding-based methods have been significantly outperformed by LOCo and
DW LOCo. We place the discussion over REMBO here for two reasons. Firstly, there has been
several problems about REMBO as discussed in section 2. Secondly, the experiments are conducted
on tasks where the effective dimensions are at a similar scale as the dimensionality of the original
inputs and doesn’t align with the assumption of REMBO.
21