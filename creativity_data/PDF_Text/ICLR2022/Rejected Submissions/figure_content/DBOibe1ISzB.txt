Figure 1: (a). Samples of the datasets. FluidFall contains two drops of water. FluidShake simulates a blockof water in a moving box. RiceGrip has a deformable object squeezed by two grippers. BoxBath contains arigid cubic washed by water. (b). Rollouts from generalizations of RiceGrip, where we increase the number ofparticles. SiT with abstract tokens, marked by +, can still maintain the object’s shape, while DPI-Net (Li et al.,2019) fail to simulate the deformable object.
Figure 2: Overview of our transformer-based model with abstract tokens, which are optional. SiT is composedof an encoding layer, stacks of L blocks extended from Transformer encoder blocks, and a decoding layer.
Figure 3: Qualitative results on FluidFall and BoxBath. When the two drops are getting closer in FluidFall butnot close enough to merge, previous methods are likely to mix them together due to the newly added neighborsfrom different drops and incorrect interactions. But SiT can still predict faithful rollouts.
Figure 4: Rendered rollouts on generalized FluidShake and BoxBath. More particles participate in simulations.
Figure 5: Few shots learning on FluidShake. Figure (a) shows the rollouts. Figure (b) draws the MSE curvesas the number of training examples increases. Our model are robust even with only 60% of training examples.
Figure 6: Overview of our uniform attention. The abstract tokens are optional. The tokens willattend to each other and update accordingly.
Figure 7: (a) is a sample frame on BoxBath. We select one particle in the center of red circle to showits attention scores on interactions from neighbors. (b)(c)(d)(e) show the heat maps from uniformattention in each block of SiT. The attention scores on interactions are assigned to the correspondingneighbors, which are shown by different colors. The darker the color, the lower attention score onparticles.
Figure 8: Rollouts on FluidFall. Here we display the settings where the larger drop is above the smaller drop.
Figure 9: Rollouts on FluidShake. DPI-Net still has some artifacts in predicting the wave of water, such as therollout at t = 63. CConv, which is designed specifically for fluid dynamics, rollouts fairly good results, such asthe surface of water, in this domain. GNS has artifacts when predicting the waves (t = 63) and predicts overlysmooth surfaces of fluid (t = 90). GraphTrans fails in this domain, suggesting the insufficiency of capturingthe complex interactions from outer forces. SiT can also achieve compatible results with less parameters.
Figure 10: Rollouts on RiceGrip. For the surface of the rice, we can see at t = 38 that DPI-Net seems to putmore pressure to the rice; GNS and GraphTrans has difficulties in maintaining the smooth surfaces of the rice.
Figure 11: Rollouts on BoxBath. As CConv is designed for fluid dynamics, it treats all particles as fluidand fails in this domain. GNS is able to handle the rotations of rigid box, but has difficulties in modeling themotions of rigid box when pushed by the waves of fluid, suggesting the insufficient abilities of dealing withinteractions between different materials. SiT with abstract tokens achieves more faithful results in terms of therotation of rigid cubics, the interactions between fluid particles.
Figure 12: Rollouts on generalized FluidShake. DPI-Net achieves fairly good performance, while it stillhas difficulties to correctly predict the waves, such as the rollout at t = 123. CConv and GNS have similarproblems, such as the rollout at t = 215 and t = 123 respectively. GraphTrans still fails in this environment.
Figure 13: Rollouts on generalized RiceGrip. DPI-Net fails and cannot maintain the shape of the deformableobject, as is shown in the prediction at t = 38. GNS tends to rotate the corner of the rice, as is shown att = 38, the left lower corner is twisted when the grippers do not have contact with the rice’s surface. Our SiT+has better rollouts than GraphTrans, suggesting the effectiveness and robustness of our method.
Figure 14: Rollouts on generalized BoxBath, where we add more fluid particles. DPI-Net misses the cubicat the end. While GNS is able to simulate the rotations of rigid box, it fails to make further predictions of therigid after it falls into the water. While SiT+ predicts wrong motions of several fluid particles at the beginning,it still achieve better results compared with other models.
Figure 15: Rollouts on generalized BoxBath, where we add more rigid particles. DPI-Net starts to predictwrong rollouts for fluid particles at the beginning, and worse results for the rigid cubic. GNS seems overfit tothe rotations of rigid box. SiT+ achieves better results comparing with other models.
Figure 16: Rollouts on generalized BoxBath, where we change the shape from cubic to bunny. The shape ofbunny is more challenging, as the ears of the bunny do not have direct connections to the body. While DPI-Netfails in this scene, the bunny is submerged in the rollouts of GNS. SiT+ predicts rollouts as correctly as possible.
Figure 17: Rollouts on generalized BoxBath, where we use a rigid ball. For simple comparison, the positionsof the rigid ball suggest models’ abilities of simulation. SiT+ predicts more faithful positions of the ball andoverall shapes of the fluid.
Figure 18: Rollouts on generalized BoxBath, where we use a rigid cubiod. It seems that the cuboid is harderto move. DPI-Net fails in this scenes by predicting wrong rotations for the cuboid, GNS overfits to the rotationsof rigid box. SiT+ still achieves better results.
