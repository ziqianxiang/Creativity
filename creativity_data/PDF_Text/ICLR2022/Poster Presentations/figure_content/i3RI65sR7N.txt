Figure 1: Computational graph ofhierarchical variational memory forprototypical few-shot learning. Thememory consists of L layers of thehierarchy: each layer Ml is used tobuild up the corresponding latent pro-totype zl. ST and Qt are the supportset and the query set. X and y are thesample and label. The latent memoryml is inferred from the memory con-tent Ml and the upper latent memoryml-1, and the latent prototype Zl isconstructed from the support set S,latent memory ml, and the latent pro-totype ZlT in the upper layer.
Figure 2: Visualization of weights αl at different residual blocks. The weight αl varies Per test-domain, the larger the domain shift between the training and test domain, the larger the weight of thelow-level prototype.
Figure 3: Prototype distributions at different levels with our hierarchical variational memory onChestX under the 5-way 5-shot setting, where different colors indicate different categories. Theprototypes of Level 1 are more distinctive and distant from each other, which reflects the lower-levelfeature are more crucial when the domain shift is large.
Figure 4: Examples from each dataset. The color of the border of each image represents the categoryof this image in this task. S and Q indicate the support and query sets for each task.
Figure 5: Training loss versus iterations for different algorithms. Our hierarchical variational memoryachieves fastest training convergence.
