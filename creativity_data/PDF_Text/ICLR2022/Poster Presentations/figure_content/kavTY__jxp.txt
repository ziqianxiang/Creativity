Figure 1: Overview of Spatial Graph Attention defined by equations (1) to (4). Highlighted nodesand edge are the examples undergoing forward propagation. The attention mechanism is node cen-tric: nodes are embedded leveraging information from adjacent nodes and edges (different colorsof dash lines denote different attentions); edges are embedded leveraging information from adjacentnodes. Spatial information is separately encoded according to sparsified inverse distance matrix (redcrosses represent weights that are omitted) and embedded with such attention mechanism. The twohidden representations acquired respectively are aggregated at the end of each layer.
Figure 2: An overview of the Distilled Graph Attention Policy Network during a single step of thegenerating process.
Figure 3: Loss curves over 40 runseach with sample size 100,000	Docking Score				QED	SA	1st	2nd	3rd	mean		GAPN	-9.19	-8.96	-8.90	-6.71	0.28	2.78DGAPN	-10.07	-9.83	-9.19	-6.77	0.31	2.91CReM Greedy	-9.65	-9.36	-9.36	-7.73	0.39	2.83DGAPN -eval	-10.38	-9.84	-9.81	-7.73	0.34	3.03Table 2: Docking scores and other metrics under differenttraining and evaluation settingsgenerated by the greedy approach, we can see that the environment and the stochasticity design ofaction space alone are powerful for the efficacy and exploration of our policies. While the innovationbonus helped discover molecules with better docking scores, it also worsened SA. We further inves-tigated this docking score vs. SA trade-off in Section 3.2.3. To see samples of molecules generatedby DGAPN in evaluation, visit our repoSitoryL3.2.2	Constrained optimizationThe goal of constrained optimization is to find molecules that have large improvement over a givenmolecule from the dataset while maintaining a certain level of similarity:rmo(sτ) = rm(ST) - λ ∙ max{0, δ - SIM{so, ST}}	(12)where λ is a scaling coefficient, for which We chose 100; SIM{∙, ∙} is the Tanimoto similarity
Figure 4: Summary of the molecules obtained by DGAPN. Left and middle plots show QED andSA vs. docking scores for the latest 1,000 molecules generated under each weight ω. Right plotshows the top 3 molecules (out of 10,000) with the highest multi-objective rewards under each ω .
Figure 5: The search space in NSP15 defined for molecular docking (green box). An NSP15 pro-tomer, which was used as the receptor in the calculations, is shown (cartoon backbone representa-tion, in pink/magenta). The nucleotide density located at the catalytic site is depicted (blue surface).
