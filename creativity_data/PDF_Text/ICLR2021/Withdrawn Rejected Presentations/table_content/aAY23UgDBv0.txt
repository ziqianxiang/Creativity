Table 1:	Prediction error on stochastic Lorenz attractor for three evaluation metrics (details in maintext). VDM(k = 13) achieves the best performance, and AESMC also gives comparable results.
Table 2:	Prediction error on taxi trajectories for three evaluation metrics (details in main text). CF-VAE gives the best result in multi-steps prediction, since it uses one global latent variable, whilesequential models rely on a sequence of local latent variables. Meanwhile, VDM(k = 13) outper-forms all sequential models, and performs better in other metrics than CF-VAE.
Table 3:	Prediction error on U.S. pollution data for two evaluation metrics (details in main text).
Table 4:	Prediction error on basketball players’ trajectories (details in main text). VDM makes themost accurate multi-step and one-step predictions.
Table 5: Ablation study of the regularization terms for synthetic data from Fig. 3LELBO	LELBO&Lpred	LELBO&Ladv LVDMVDM(k = 9)--2.439±0.005^^2.379±0.008	2.381±0.006^^2.363±0.004VDM(k = 1)3.756±0.003	3.960±0.008	3.743±0.005	3.878±0.007F Supplementary to Experiments SetupF.1 Stochastic lorenz attractor setupLorenz attractor is a system of three ordinary differential equations:dx	dy	dzdt = σ(y-X),	dt = X(P-Z)-y,	dt = Xy TZ ,	(25)where σ, ρ, and β are system parameters. We set σ = 10, ρ = 28 and β = 8/3 to make the systemchaotic. We simulate the trajectories by RK4 with a step size of 0.01. To make it stochastic, we addprocess noise to the transition, which is a mixture of two Gaussians 0.5N(m0, P) + 0.5N (m2 , P),where0.06 0.03 0.01P = 0.03 0.03 0.03 .	(26)0.01 0.03 0.05m0010m10
Table 6: Number of parameters for each model in three experiments. VDM, AESMC, VRNN, andRKN have comparable number of parameters. CF-VAE has much more parameters.
Table 7: Definition of VDM variants	VDM(k =	1)	VDM-MC+δ	VDM-SCA+Cat	VDM-SCA+δSampling method Weighting function	Monte-Carlo n.a.		Monte-Carlo δ-function	SCA Categorical distribution	SCA δ-functionform inference of the weighting function with an additional inference network. In Table 7, we showthe choices in different variants. All models are trained with LELBO&Lpred.
Table 8: Ablation study of VDM’s variants on stochastic Lorenz attractor for three distance metrics(see main text). The variants are defined in Table 7. All variants give comparable quantitative results.
Table 9:	Ablation study of VDM’s variants on taxi trajectories for three distance metrics (see maintext). The variants are defined in Table 7. VDM-SCA+δ outperforms other variants and approachesour default VDM (trained with Ladv additionally).
Table 10:	Ablation study of VDM’s variants on U.S. pollution data for two distance metrics (seemain text). The variants are defined in Table 7. VDM-SCA+δ outperforms other variants.
