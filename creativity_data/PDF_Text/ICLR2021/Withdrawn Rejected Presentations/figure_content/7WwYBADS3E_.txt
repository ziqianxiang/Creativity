Figure 1: (a) Schematic of our FGN model. Gadv applies the effect of body force and viscosity to thefluids. Gpres predicts the pressure. Gcol handles collision between particles. (b) In a node-focusednetwork, input are represented as node features and then passed to a shared processor. Advectionand pressure impose influence on each particle separately, thus they can be interpreted as messageslying on each node and predicted via node-focused networks. (c) In an edge-focused network, inputare represented as edge features of a directed graph, the edge features are then passed to a sharedprocessor. Collision is a pairwise effect, which can be easily represented as edge attributes betweeneach pair of particles. Hence we use the edge-focused network to predict collision.
Figure 2: Qualitative analysis on: (a) Dam collapse. (b) Water fall. In CConv and GNS, we canobserve oscillation on the free surface of fluids, while the results generated from our model maintainsa much more compact and smoother shape. After long time steps, CConv’s result fails to maintainsmooth and compact fluid distributions and GNS’ prediction is significantly slower than ground truth,while our model’s prediction has minor difference from the ground truth.
Figure 3: Pressure distribution contour. Our model can learn to generate reasonable pressuredistribution. The distribution agreed with ground truth, which captures the shape of shifting highpressure and low pressure region.
Figure 4: Qualitative comparison of model using different time step sizes. We use different time stepsize to simulate with our model. Despite the training set is generated with a time step size of 0.002s,our model can be generalized to a larger time step size with a neglectable increase in error. Othermodels diverge immediately when extrapolate to time step size different from training data.
Figure 5: Generalization to complex geometries. Top: A fluid block drop on Stanford bunny. Bottom:A fluid emitter is placed at the front of Grand Canyon 3D model and emitted fluids gradually fillup reservoir at downstream. Although the training data only has basic geometries such as cube andcylinder, our FGN model can be generalized to complex geometries which are beyond the distributionof training data.
Figure 6: Three kinds of obstacles: Square pillar(Width:10, length:10, height:40), cylinder(radius:4,height:40) and cube(15x15x15)Figure 7: Fluid block and box(a) Dam Collapse	(b) Water Fall	(c) FloW around CylinderFigure 8: Visualizations of initial condition settings in evaluation scenarios13Under review as a conference paper at ICLR 2021Figure 9: Error trend with respect to time. The density deviation of our model remain close to zerodespite some oscillation at first. Although GNS also maintains a low density deviation, its averagedensity oscillates more severely. This is consistent with the qualitative comparison, in which the fluidsurface from GNS is oscillating and less compact. CConv fails to maintain constant density and itsdensity increases significantly after collision to the wall boundary. Both our model and GNS canpredict a low divergence velocity field while CConv fails to capture this property. This somehowexplains why CConv struggles to maintain constant density.The average Chamfer distance to theground truth data accumulates at first and stabilizes after system is in equilibrium. CConv has largeraverage Chamfer distance while graph-based model’s distances are smaller.
Figure 7: Fluid block and box(a) Dam Collapse	(b) Water Fall	(c) FloW around CylinderFigure 8: Visualizations of initial condition settings in evaluation scenarios13Under review as a conference paper at ICLR 2021Figure 9: Error trend with respect to time. The density deviation of our model remain close to zerodespite some oscillation at first. Although GNS also maintains a low density deviation, its averagedensity oscillates more severely. This is consistent with the qualitative comparison, in which the fluidsurface from GNS is oscillating and less compact. CConv fails to maintain constant density and itsdensity increases significantly after collision to the wall boundary. Both our model and GNS canpredict a low divergence velocity field while CConv fails to capture this property. This somehowexplains why CConv struggles to maintain constant density.The average Chamfer distance to theground truth data accumulates at first and stabilizes after system is in equilibrium. CConv has largeraverage Chamfer distance while graph-based model’s distances are smaller.
Figure 8: Visualizations of initial condition settings in evaluation scenarios13Under review as a conference paper at ICLR 2021Figure 9: Error trend with respect to time. The density deviation of our model remain close to zerodespite some oscillation at first. Although GNS also maintains a low density deviation, its averagedensity oscillates more severely. This is consistent with the qualitative comparison, in which the fluidsurface from GNS is oscillating and less compact. CConv fails to maintain constant density and itsdensity increases significantly after collision to the wall boundary. Both our model and GNS canpredict a low divergence velocity field while CConv fails to capture this property. This somehowexplains why CConv struggles to maintain constant density.The average Chamfer distance to theground truth data accumulates at first and stabilizes after system is in equilibrium. CConv has largeraverage Chamfer distance while graph-based model’s distances are smaller.
Figure 9: Error trend with respect to time. The density deviation of our model remain close to zerodespite some oscillation at first. Although GNS also maintains a low density deviation, its averagedensity oscillates more severely. This is consistent with the qualitative comparison, in which the fluidsurface from GNS is oscillating and less compact. CConv fails to maintain constant density and itsdensity increases significantly after collision to the wall boundary. Both our model and GNS canpredict a low divergence velocity field while CConv fails to capture this property. This somehowexplains why CConv struggles to maintain constant density.The average Chamfer distance to theground truth data accumulates at first and stabilizes after system is in equilibrium. CConv has largeraverage Chamfer distance while graph-based model’s distances are smaller.
Figure 10: Average Chamfer distance to the ground truth data of FGN model under different timestep sizes. FGN can generalized to different time scale with minor difference in performance. Thetraining data uses a time step size of dt = 0.002s, and FGN converges for all dt < 0.005s.
Figure 11: Average Chamfer distance to the ground truth data of complex scenes. For both scenes, atfirst, position error accumulates quickly as system evolves. At some point, the error starts to decreaseuntil reaching an equilibrium.
