Figure 1: We are interested to learn f : U → W having a fully mediating representation V suchthat f factors into U → V → W . In the case of optical graph recognition of chemical compoundsfrom 2D images, the fully mediating layer is represented using the planar embedding of the chemicalgraph structure we are predicting.
Figure 2: Two examples of chemical compounds graphs with their graph edit distance. The nodesof the graphs are first aligned before computing the graph edit distance. The node alignments aremarked with the gray dashed arrows. The differences after graph alignment are highlighted and thesubstitutions are marked with the red dashed arrows.
Figure 3:	Comparison performance of methods on Indigo and Maybridge data set. Self-labeling bycorrecting graph alignment is clearly better performing than when exact graph alignment is used.
Figure 4:	We take the best performing methods and analyze their performance on different atomand bond types per iteration. We observe that for some atom types the method is able to increaseperformance even though initial performance was 0%. This is the case in for example R-groups inIndigo data set or superatom NO2 in Maybridge data set.
Figure 5: Comparison initial segmentation with final segmentation after applying self-labeling offully mediating representations for Indigo data set. We observe that the initial model is makingmistakes on the R-group atom type and carbon represented with a ’C’. In the final model we see thatnow predictions are all correct.
Figure 6: Comparison initial segmentation with final segmentation after applying self-labeling offully mediating representations for Maybridge data set. The initial model predicts the superatomNO2 as two separate atoms O and N which is chemically not correct. The final model makes thecorrect prediction.
Figure 7: Example 1: It is clear that to align the graph prediction W0 with the true graph W morethan 2 node substitutions are needed. So no rich labeling is possible for this example in this iteration.
Figure 8: Example 2: It is clear that alignment of the graph prediction W0 with the true graph Wcan not be solved with only substitutions.
Figure 9: Example 3: It is clear that alignment of the graph prediction W0 with the true graph Wcan not be solved with only substitutions.
