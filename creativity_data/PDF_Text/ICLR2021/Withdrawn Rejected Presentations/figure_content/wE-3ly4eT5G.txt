Figure 1: Illustration of Factored NN. Given the factored graph on the left, the Ordinary NN takesall the inputs and produce the corresponding outputs whereas the Factored NN masks out irrelevantinput dimensions when predicting each output dimension, concatenating the outputs at the end.
Figure 2: (a): Factored Graph for Multi-Cartpole with 2 cartpoles. Stk , Atk , Rtk for k ∈ {0, 1}represent the state vector, action, and reward for each individual cartpole. (b)-(d): Graphicalrepresentation of Factored NN applications, in MCTS, DQN and PPO respectively. In each case, theinput variables into the Factored NN are in blue and the outputs of the factored NN are in green.
Figure 3: Environment model prediction loss (first row) and game score (second row) for each of theenvironments. Columns a and b represent environments with 4 and 8 cartpoles respectively. Columnc shows the results for the Taxi environment. The solid lines show the average over 5 random seedsand the shaded area shows ± 1 standard deviation.
Figure 4:	DQN with Factored NN vs. NN performance on Bitflip (a) and Multi-Cartpole (b, c). Thesolid lines show the average over 5 random seeds and the shaded area shows ± 1 standard deviation.
Figure 5:	PPO with Factored NN vs. Ordinary NN performance on multi BitFlip with 8 bits (a), 4 (b)and 8 (c) cartpoles. The solid lines show the average over 5 random seeds and the shaded area shows± 1 standard deviation.
Figure 6:	PPO with Factored NN vs. Ordinary NN performance on Half Cheetah (a), Ant (b), andHumanoid (c). The solid lines show the average over 5 random seeds and the shaded area shows ± 1standard deviation.
Figure 7: Bin Packing Factored GraphSecond, there is the Newsvendor problem (Balaji et al., 2019; Zipkin, 2008; Gijsbrechts et al., 2019),which has a common industrial counterpart in purchase ordering decisions (e.g. from a retailer toa vendor). In an RL formulation, the state is given by the economic parameters of the item to beordered, the inventory on-hand, and the inventory to-arrive from the vendor in timesteps t+1, t+2, etc.,13Under review as a conference paper at ICLR 2021the action is how much of the item to order, and the reward is a function of inventory on-hand andcustomer demand. The factored graph structure in this problem is especially helpful for simplifyingthe dynamics of the inventory to-arrive, since this is a linear pipeline from the vendor to the agent, i.e.
Figure 8: Newsvendor Factored GraphA.2 ROBOTICSIn robotics, the state may be high-dimensional, but the subspaces of the state may evolve independentlyof others, and only depend on a low dimensional subspace of the previous state. We have includedexamples of Ant, Half-Cheetah, and Humanoid in the paper with factor graph given in appendix A.4,where the transition dynamics of a robot,s arms may be reasonably assumed to be independent of thetransition dynamics of its legs. A similar example, we can use factored graphs for drone control withdeep RL (Hodge et al., 2020).
Figure 9: Drone Control Factored Graphcontrol of each zone is independent of each other. The reward function can also be factorized as thethermal comfort in each zone is measured independently. Figure 10 depicts the factored graph.
Figure 10: HVAC Control Factored Graph15Under review as a conference paper at ICLR 2021A.4 Portfolio ManagementThese problems (e.g. Ye et al. (2020)) generally have states of the form [stock of asset A, stockof asset B, . . . ] and action spaces of the form [buy/sell of asset A, buy/sell of asset B, . . . ]. In thisscenario we have important prior knowledge about the factor graph, for example we know that thesub-action of buying/selling asset A will not influence the sub-state stock of asset B. The methodwould allow us to incorporate this prior knowledge into our RL Agent and improve performance.
Figure 11: Portfolio Management Factored GraphB Factored Graphs of Environments USED IN EvaluationB .1 Multiple-CartpoleLet pt，Vi and θ∖ represent the position, velocity and angle for cart i at time t and let At, R representthe force and reward for cart i at time t, then the factored graph for this environment can be resepentedbyB.2	BitflipDefine Si to be the bit at position i at time t, define Ai to be the action of whether to flip the i-th bitat time t and let Rt represents whether the i-th bit equals to the i-th bit of the target bits. Then thefactored graph for this environment can be resepented byB.3	TAXIDefine pttaxi, ptdest., ptpass to be the location of the taxi, target destination and passenger at time trespectively, let atmove, atpick, atdrop to be the action of moving (up, down, left, right), picking up anddropping off passengers at time t. Then the factored graph for this environment can be resepented byB.4	RoboticsDefine sglobal to be the global features of the robot (e.g., position, contact force) and define sit to bethe state of joint i at time t. The action for each joint is denoted by ait . Here we show only 3 actions16Under review as a conference paper at ICLR 2021Cartpole 0	[pt0, vt0, θt0]
Figure 12: DQN vs Factored DQN performance on Bitflip (a,b,c) and Multi-Cartpole (d,e,f). Thesolid lines show the average over 5 random seeds and the shaded area shows ± 1 standard deviation.
Figure 13: PPO with Factored NN vs. NN performance on Bit Flip with 2 (left) and 4 (middle) bitsas well as Multi-CartPole with 2 poles (right). The solid lines show the average over 5 random seedsand the shaded area shows ± 1 standard deviation.
Figure 14: PPO (without a critic) with Factored NN vs. NN performance on Bit Flip with 2 (left), 4(middle) and 8 (right) bits. The solid lines show the average over 5 random seeds and the shaded areashows ± 1 standard deviation.
Figure 15: PPO (with a critic) with Factored NN vs. NN performance on Bit Flip with 2 (left), 4(middle) and 8 (right) bits. The solid lines show the average over 5 random seeds and the shaded areashows ± 1 standard deviation.
Figure 16: PPO (without a critic) with Factored NN vs. NN performance on multi Cart Pole with 2(left), 4 (middle) and 8 (right) cartpoles. The solid lines show the average over 5 random seeds andthe shaded area shows ± 1 standard deviation.
Figure 17:	PPO (with a critic) with Factored NN vs. NN performance on multi Cart Pole with 2 (left),4 (middle) and 8 (right) cartpoles. The solid lines show the average over 5 random seeds and theshaded area shows ± 1 standard deviation.
Figure 18:	PPO with Factored NN vs. NN performance on Half Cheetah (left), Ant (middle), andHumanoid (right). The solid lines show the average over 5 random seeds and the shaded area shows± 1 standard deviation.
Figure 19:	PPO with Factored NN vs. NN performance on Half Cheetah (left), Ant (middle), andHumanoid (right). The solid lines show the average over 5 random seeds and the shaded area shows± 1 standard deviation.
