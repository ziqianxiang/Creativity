Figure 1: Results for evaluating EMaQ on D4RL benchmark’s (Fu et al., 2020b) standard Mujoco domains,With N ∈ {5,10, 25, 50, 100, 200, 400}. Values above μ(a|s) represent the result of evaluating the basebehavior policies. Horizontal green lines represent the reported performance of BEAR in the D4RL benchmark(apples to apples comparisons in Figure 2). The types of offline datasets are: random: 1M transitions arecollected by a random agent, medium: 1M transitions are collected by a half-trained SAC (Haarnoja et al.,2018) policy, mixed: the replay buffer of this half-trained policy, and medium-expert: combination of themedium dataset and 1M additional transitions from a fully trained policy. Refer to main text (Section 5.1)for description of color-coding. For better legibility, We have included a larger variant of these plots in theAppendix L. Full experimental details in Appendix G.
Figure 2: Comparison of EMaQ, BCQ, and BEAR on D4RL (Fu et al., 2020b) benchmark domains whenusing our proposed autoregressive μ(a∣s). For both BCQ and BEAR, from left to right as the value of thehyperparameter increases, the allowed deviation from μ(a∣s) increases. Horizontal green lines represent thereported performance of BEAR in the D4RL benchmark. Color-coding follows Figure 1. For better legibility,we have included a larger variant of these plots in the Appendix L. Full experimental details in Appendix G.
Figure 3: Online RL results under different trajectory batch sizes.
Figure 4: All results for batch size 1G.2 EMaQ Ablation ExperimentHyperparameters are identical to those in Table 2, except batch size is 100 and number of updates is500K.
Figure 5: All results for batch size 50K20Under review as a conference paper at ICLR 2021Shared Hyperparameters	λ Batch Size NUm Updates NUm Q Functions Q Architecture μ lr α	1.0 256 1e6 8 MLP, 3 layers, 750 hid dim, relu 5e-4 	0.995	EMaQ Hyperparameters	Q k		1e-4	BEAR Hyperparameters	π Architecture Q lr π lr	MLP, 3 layers, 750 hid dim, relu 1e-3 	3e-5	BCQ Hyperparameters	π Architecture Q lr π lr	MLP, 3 layers, 750 hid dim, relu 1e-4 	5e-4	Table 2: Hyperparameters for Mujoco Experimentssize of Lini , number of bins for action discretization). Increasing the number of discretization binsfrom 40 (value for standard Mujoco experiments) to 80 was the most important change. Outputdimension of state-embedding MLP is the same as the hidden size.
Figure 6: Results for evaluating EMaQ on D4RL (Fu et al., 2020b) benchmark domains when using thedescribed VAE implementation, with N ∈ {5,10, 25, 50,100, 200, 400}. Values above μ(a∣s) represent theresult of evaluating the base behavior policies. Horizontal green lines represent the reported performance ofBEAR in the D4RL benchmark (apples to apples comparisons in Figure 7).
Figure 7: Comparison of EMaQ, BCQ, and BEAR on D4RL (Fu et al., 2020b) benchmark domains whenusing When using the described VAE implementation for μ(a∣s). For both BCQ and BEAR, from left to rightthe allowed deviation from μ(a∣s) increases. Horizontal green lines represent the reported performance ofBEAR in the D4RL benchmark.
Figure 8: Results with both autoregressive and VAE models in one plot for easier comparison.
Figure 9: Results with both autoregressive and VAE models in one plot for easier comparison.
Figure 10:	Comparison of Soft-EMaQ with EMaQ under a large range of hypeιparameters in the Halfcheetah domain.
Figure 11:	Results for evaluating EMaQ on D4RL (Fu et al., 2020b) benchmark domains, with N ∈ {5,10, 25,50,100, 200,400}. Values above μ(α∣s) representthe result of evaluating the base behavior policies. Horizontal green lines represent the reported performance of BEAR in the D4RL benchmark (apples to applescomparisons in Figure 2). Refer to main text (Section 5.1) for description of color-coding.
Figure 12: Comparison of EMaQ, BCQ, and BEAR on D4RL (Fu et al., 2020b) benchmark domains when using our proposed autoregressive μ(a∖s). For bothBCQ and BEAR, from left to right the allowed deviation from μ(a∖s) increases. Horizontal green lines represent the reported performance of BEAR in the D4RLbenchmark. Color-coding follows Figure 1.
