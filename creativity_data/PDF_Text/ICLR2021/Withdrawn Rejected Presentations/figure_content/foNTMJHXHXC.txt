Figure 1: Left: Robust optimization optimizes worst-case performance over the convex hull oftraining distributions. Right: By extrapolating risks, REx encourages robustness to larger shifts. Here#	»#	»e1, e2, and e3 represent training distributions, and P1 (X, Y), P 2(X, Y) represent some particulardirections of variation in the affine space of quasiprobability distributions over (X, Y).
Figure 2: Training accuracies (left) and risks (right) on colored MNIST domains with varyingP(Y = 0|color = red) after 500 epochs. Dots represent training risks, lines represent test risks.
Figure 3: Extrapolation can yield a distribution with negative P (x) for some x. Left: P (x) fordomains e1 and e2. Right: Point-wise interpolation/extrapolation of Pe1 (x) and Pe2 (x).
Figure 4: REx outperforms IRM on Colored MNIST variants that include covariate shift. Thex-axis indexes increasing amount of shift between training distributions, with p = 0 corresponding todisjoint supports. Left: class imbalance, Center: shape imbalance, Right: color imbalance.
Figure 5: Performance and standard error on walker_walk (left), finger_spin (right).
Figure 6: Illustration of the importance of extrapolation for generalizing in high dimensional space.
Figure 7: Each grey line is a risk Rq(p) as functions ofp for a specific value of q. The blue line iswhen q = ω. We highlight in red the curve maxq Rq(p) whose minimum is the saddle point markedby a purple star in p = ω .
Figure 8: The perturbation set for MM-REx can include “distributions” which assign invalid (e.g.
Figure 9: Vector fields of the gradient evaluated at different values of training risks R1 (θ), R2(θ).
Figure 10:	This is Figure 4 of main text with additional results using MM-REx. For each covariateshift variant (class imbalance, digit imbalance, and color imbalance from left to right as described in"CMNIST with covariate shift" subsubsection of Section 4.1 in main text) of CMNIST, the standarderror (the vertical bars in plots) is higher for MM-REx than for V-REx.
Figure 11:	This is Figure 4 of main text (class imbalance, digit imbalance, and color imbalance fromleft to right as described in "CMNIST with covariate shift" subsubsection of Section 4.1 in main text),but with hyperparameters of REx and IRM each tuned to perform as well as possible for each valueof p for each covariate shift type.
Figure 12: This also corresponds to class imbalance, digit imbalance, and color imbalance from leftto right as described in "CMNIST with covariate shift" subsubsection of Section 4.1 in main text;but now the y-axis refers to what percentage of the randomly sampled hyperparameter combinationswe deemed to to be satisfactory. We define satisfactory as simultaneously being better than randomguessing and having train accuracy greater than test accuracy. For p less than .5, a larger percentageof hyperparameter combinations are often satisfactory for REx than for IRM; for p greater than .5,a larger percentage of hyperparameter combinations are often satisfactory for IRM than for RExbecause train accuracy is greater than test accuracy for more hyperparameter combinations for IRM.
Figure 13: Hyperparameter sweep for IRM and REx on cartpole_swingup. Green, blue, andorange curves correspond to REx, ERM, and IRM, respectively. The subfigure titles state the penaltystrength (“penalty”) and after how many iterations the penalty strength was increased (“iters”). Wechose a penalty factor of 1 and 10k iterations.
Figure 14: Stability penalties should be applied around when traditional overfitting begins, to ensurethat the model has learned predictive features, and that penalties still give meaningful training signals.
Figure 15: Given sufficient training time, empirical risk minimization (ERM) minimizes both RExand IRMv1 penalty terms on Colored MNIST (without including either term in the loss function).
Figure 16: Financial indicators tasks. The left panel indicates the set of training domains; themiddle and right panels show the test accuracy on the respective domains relative to ERM (a blackdot corresponds to a training domain; a colored patch indicates the test accuracy on the respectivedomain.)wcc山 2 φ≥⅞-φ^ω3 UeuJ」0 七ωd	Overall accuracy	Min acc.	Max acc.
