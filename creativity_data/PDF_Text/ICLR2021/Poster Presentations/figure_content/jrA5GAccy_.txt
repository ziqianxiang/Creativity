Figure 1: Causal Bayesian networks for different distribution shifts.
Figure 2: Comparisons: a) CS-CMNIST, b) CF-CMNIST, c) AC-CMNIST and d) HB-CMNIST.
Figure 3: Graphical model for CS-CMNISTP(Yge = 1,Ce = 0,Ue = 1|Xge) = P(Yge = 1|Xge)P(Ce = 0)P(U e = 1|Yge = 1,Ce = 0)= 0.5plψeP(Yge = 0,Ce = 0,Ue = 1|Xge) = P(Yge = 0|Xge)P(Ce = 0)P(U e = 1|Yge = 1,Ce = 0)= 0.5(1 - pl)(1 - ψe)P(Ye = 1|Xe) = P(Yge = 1|Xge,Ce = 0,Ue = 1) =	(13)P(Yge = 1,Ce = 0, Ue = 1|Xe)P(Yge = 1,Ce = 0, Ue = 1|Xe) + P(Yge = 0,Ce = 0, Ue = 1|Xe)P(Y e = 1|X e) = —■~plψe-----------2pi ψe + 1 - Pl - ψeObserve that under standard assumption of deterministic labeling pl = 1, P(Ye = 1|Xe) remainsinvariant and for high values of Pi it is relatively stable across the environments.
Figure 4: Graphical model for CF-CMNIST, AC-CMNIST, HB-CMNISTCS-RegreSSionFigure 5: Graphical models for the different regression datasetsdependent standard deviation, We use two training environments with σ1 = 0.2 and σ2 = 2.0respectively and both environments .
Figure 5: Graphical models for the different regression datasetsdependent standard deviation, We use two training environments with σ1 = 0.2 and σ2 = 2.0respectively and both environments .
Figure 6: Comparisons: n = 10 CS-regressionl. 1.75-O⅛ 1∙5°-O 1∙25 -E 1.00-⅛ 0.75 -Φ"φ 0.50-P: 0.25-o.oo-0	500	1000 1500 2000 2500 3000 3500 4000Number of samplesFigure 7: Comparisons: n = 10 CF-regressionFigure 8: Comparisons: n = 10 AC-regression0.25-0.00-U------1--------1---1------1------1-----1------1----->—0	500	1000	1500	2000	2500	3000	3500	4000Number of samples
Figure 7: Comparisons: n = 10 CF-regressionFigure 8: Comparisons: n = 10 AC-regression0.25-0.00-U------1--------1---1------1------1-----1------1----->—0	500	1000	1500	2000	2500	3000	3500	4000Number of samplesFigure 9: Comparisons: n = 10 HB-regression19Published as a conference paper at ICLR 2021Method	Number of samples	Model estimation errorERM	50	0.65 ± 0.06IRM	50	0.57 ± 0.10ERM	200	0.18 ± 0.02IRM	200	0.13 ± 0.02ERM	500	0.08 ± 0.005IRM	500	0.08 ± 0.014ERM	1000	0.037 ± 0.004IRM	1000	0.051 ± 0.007ERM	1500	0.021 ± 0.002IRM	1500	0.045 ± 0.007
Figure 8: Comparisons: n = 10 AC-regression0.25-0.00-U------1--------1---1------1------1-----1------1----->—0	500	1000	1500	2000	2500	3000	3500	4000Number of samplesFigure 9: Comparisons: n = 10 HB-regression19Published as a conference paper at ICLR 2021Method	Number of samples	Model estimation errorERM	50	0.65 ± 0.06IRM	50	0.57 ± 0.10ERM	200	0.18 ± 0.02IRM	200	0.13 ± 0.02ERM	500	0.08 ± 0.005IRM	500	0.08 ± 0.014ERM	1000	0.037 ± 0.004IRM	1000	0.051 ± 0.007ERM	1500	0.021 ± 0.002IRM	1500	0.045 ± 0.007ERM	2000	0.018 ± 0.002
Figure 9: Comparisons: n = 10 HB-regression19Published as a conference paper at ICLR 2021Method	Number of samples	Model estimation errorERM	50	0.65 ± 0.06IRM	50	0.57 ± 0.10ERM	200	0.18 ± 0.02IRM	200	0.13 ± 0.02ERM	500	0.08 ± 0.005IRM	500	0.08 ± 0.014ERM	1000	0.037 ± 0.004IRM	1000	0.051 ± 0.007ERM	1500	0.021 ± 0.002IRM	1500	0.045 ± 0.007ERM	2000	0.018 ± 0.002IRM	2000	0.035 ± 0.006Table 6: Comparison of ERM vs IRM: n = 10 CS-regressionMethod	Number of samples	Model estimation errorERM	50	1.48 ± 0.15IRM	50	0.59 ± 0.10
