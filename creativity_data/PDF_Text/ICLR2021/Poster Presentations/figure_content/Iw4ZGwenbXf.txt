Figure 1: Learned energy functions: plots depict the log of the normalized energy function trained us-ing 10 inner loop iterations of (a) unrolled gradient descent (reproduced from Amos & Yarats (2019)), (b)NOVAS with the entire inner-loop graph unrolled, and (c) NOVAS without unrolling (only the last iterationon-graph). Black/white curve denotes the ground truth solution x sin(x).
Figure 2: Convergence analysis and computation time: (a). convergence (test set loss) and (b). computationtime for unrolled gradient descent (U-GD), unrolled DCEM (U-DCEM), NOVAS in unrolled mode (U-NOVAS)and without unrolling (NOVAS). In terms of speed, NOVAS offers an approximate speedup of 5x compared toU-DCEM, and if unrolled is on-par with U-GD. (c). Inference on trained models with altered inner-loopparameters: All models were trained using 10 inner loop iterations. Unrolled GD causes the energy networkto over-fit to that number (as noted in Amos & Yarats (2019)). Unrolled DCEM does not suffer from thisphenomenon, but optimization seems to be less efficient (more inner-loop iterations are required for the sameloss as NOVAS). NOVAS, in both its regular and unrolled form does not over-fit, and is the most efficient.
Figure 3: NOVAS-FBSDE neural network architecture: the NOVAS module is incorporated in the neuralnetwork to minimize the Hamiltonian over the control at each time step.
Figure 4: Cartpole: Validation of the NOVAS-FBSDE algorithm on a task that allows explicit minimizationof the Hamiltonian with respect to the control. Replacing the explicit minimization with NOVAS leads to thesame solution (compare with Fig. 6 in Pereira et al. (2019b)). (a) cart position, (b) pole angle, (c) cart velocity(d) pole angular velocity. Blue line denotes mean trajectory, shaded regions show controllerâ€™s response toinjected noise. Target states are indicated with red. Plots above show statistics over 128 test trials.
Figure 5: Portfolio Optimization: (a) Violin plots for the comparison of trading strategies in terms of thedefined loss. The FBSDE controller outperforms in probability both strategies of equal and random allocationamong traded stocks. (b) Wealth - market index difference (W - I) at the end of one year for the threeinvestment strategies. (c) Trajectory corresponding to the lowest cost (best case). (d) Trajectory correspondingto the highest cost (worst case).
