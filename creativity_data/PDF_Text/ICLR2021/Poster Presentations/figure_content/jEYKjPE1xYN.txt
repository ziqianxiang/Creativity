Figure 1: (a) Illustration of a rotation-covariant state-action representation. If the structure is rotatedby R, the position x of the action transforms accordingly. (b) Rollout with bag B0 = SOF4 . Theagent builds a molecule by repeatedly taking atoms from the bag and placing them onto the 3Dcanvas. Bonds connecting atoms are only for illustration and not part of the MDP.
Figure 2: Action representation of the auto-regressive policy. The agent chooses focal atom f,element e, distance d, and orientation x. We then map back to global coordinates X to obtain actiona = (e, x). Bonds between atoms are only for illustration.
Figure 3: Illustration of the state embedding, actor, and critic networks. Both canvas C and bag B arefed to the state embedding network CORMORANT to obtain rotation-covariant (scov) and -invariant(sinv) state representations. The actor network then samples the different sub-actions highlighted inbold. The critic takes the invariant representation sinv to compute a value V .
Figure 4: Example of two con-figurations (a) and (b) that theagent by Simm et al. (2020) can-not distinguish. While the valuesfor distance d, angle α and dihe-dral angle ψ are the same, choos-ing different reference points (inred) leads to a different action.
Figure 5: (a) Average offline performance on the single-bag task with bags SOF4 (left) and IF5(right) across 10 seeds. In the lower right, molecular structures generated by the agents are shown.
Figure 6: Average offline performance on the stochastic-bag task with B* = C7H10O2 evaluated on(a) C7H10O2 and (b) larger, unseen bags {C6H14O3, C7H16O, C7H16O2, C8H18O} over 10 seeds.
Figure 7: Comparison of Covariant agent (red) with an agent employing alternative distributionfor the orientation X (green). The average online performance on the single-bag task with B = SF6across 5 seeds is shown. Dashed lines denote the optimal return for the experiment. Error barsindicate two standard deviations.
Figure 8: Average offline performance on the stochastic-bag task with B* = C7H8N2O2 evaluatedon (a) C7H8N2O2 and (b) larger, unseen bags {C6H14O3, C7H16O, C7H16O2, C8H18O} across 10seeds. For comparison, we show an agent that is trained only on the test bags (purple). Error barsindicate two standard deviations.
Figure 9: Selection of molecular structures generated by (a) Opt, (b) Internal, and (c) Covari-ANT during the last offline evaluation. The agents are trained on a distribution over bags with B* =C7H10O2 and tested on the out-of-distribution bags {C6H14O3 , C7H16O, C7H16O2 , C8H18O}.
Figure 10: Average offline performance on the solvation task with 5 H2O molecules and formalde-hyde as the solute across 10 seeds. Error bars show two standard errors. The dashed line denotes theoptimal return. A selection of molecular clusters generated by the Covariant agent is shown.
