Figure 1: Computing one station,s S predictions using the univariate architecture. Vector Xs ofobservations is processed by a dedicated recurrent encoder Es which computes a hidden state hs+ιfor each t which is decoded into the prediction by Ds.
Figure 2: Computing predictions using the multivariate architecture. Vector X of observations isprocessed by a recurrent encoder which computes a hidden state ht+ι for each t. This state, whichrepresents all the subway stations is finally decoded into S predictions.
Figure 3: Computing one station,s S predictions using the spatial architecture. Observations Xs ∈RT are concatenated with a vector of embeddings Zs ∈ Rλs and then processed by a recurrentencoder which computes a hidden state hs+ι ∈ Rh for each t. This state is then decoded into asingle prediction.
Figure 4: Computing predictions for a particular station S using the spatial architecture with temporalcontext. Given a day d, at each step t, the observed value Xs is concatenated with three embeddingsrepresenting the station, the day and the time, respectively Zs ∈ Rλs, Zd ∈ Rλd and zt ∈ Rλt. Theobtained vector is processed by a recurrent encoder E (common to all stations) to compute a hiddenstate ht+ι. Finally this vector is decoded into a single prediction Xs+ι4	Experiments4.1	EXPERIMENTAL SETTINGSWe train our models on a data set provided by Ile-de-France Mobilites (the transport agency of theParisian region). It contains 256,028,548 logs (user, station, time) between October and Decem-5Under review as a conference paper at ICLR 2019ber 2015 across 300 subway stations. We aggregate the logs by windows of 15 minutes, in order toreduce inherent noise in the data and allow tractable computation.
Figure 5: Predicted logs at the station Pont de Levallois-Becon on Wednesday 11/04/2015. Novem-ber 4th is not a particular day by itself but an anomaly seems to have happened. The baselinemispredicts while our recurrent models correctly fit with the ground truth.
Figure 6: Evolution of RMSE values when the predictive window increases for GRU models. Thevalues at t+1 can be found in the previous tables. Dashed lines correspond to models augmentedwith day and time embeddings.
Figure 7: Predictions for the test set are computed using only he 16th first values of each day, i.e.
