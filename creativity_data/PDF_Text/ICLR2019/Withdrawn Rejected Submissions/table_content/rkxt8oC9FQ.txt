Table 1: Comparison of several representative state-of-the-art methods for counterfactual inferenceshowing whether they were designed for > 2 treatments and their complexity of implementation.
Table 2: Comparisons of the datasets used in our experiments. We evaluate on three semi-syntheticdatasets with varying numbers of treatments and samples, and a real-world clinical trial dataset.
Table 3: Comparison of methods for counterfactual inference with two available treatment options on IHDP, Jobs and News-2. We report the mean value ± the standard deviation of √∈pehe, ∈ate, Rpol and ATT on the test sets over a number of repeated runs. Where available we list the numbers reported by the original authors. n.r. = not reported. * = significantly different from PM (α < 0.05)						Method	IHDP (1000 repeats)		Jobs (10 repeats)		News-2 (50 repeats)		76pehe	ATE	RPol (π)	ATT	，^PEHE	^ATEPM	0.84 ± 0.61	0.24 ± 0.20	0.18 ± 0.10	0.16 ± 0.07	16.76 ± 1.26	3.99 ± 1.01+ on X	0.81 ± 0.57	0.24 ± 0.20	0.23 ± 0.11	0.19 ± 0.09	17.06 ± 1.22	4.14 ± 1.27+ MLP	0.83 ± 0.57	0.23 ± 0.20	0.19 ± 0.12	0.16 ± 0.07	t 18.38 ± 1.46	t 5.90 ± 2.07kNN	t 4.1 ± 0.2	t 0.79 ± 0.05	t 0.26 ± 0.0	0.13 ± 0.05	t 18.14 ± 1.64	t 7.83 ± 2.55PSMPM	n.r.	n.r.	0.18 ± 0.12	0.18 ± 0.09	t 17.49 ± 1.49	t 5.02 ± 2.34PSMMI	t 2.70 ± 3.85	t 0.49 ± 0.81	0.20 ± 0.09	t 0.42 ± 0.22	t 17.40 ± 1.30	t 4.89 ± 2.39RF	t 6.6 ± 0.3	t 0.96 ± 0.06	t 0.28 ± 0.0	t 0.09 ± 0.04	t 17.39 ± 1.24	t 5.50 ± 1.20CF	t 3.8 ± 0.2	t 0.40 ± 0.03	0.20 ± 0.0	t 0.07 ± 0.03	t 18.36 ± 1.73	t 8.48 ± 2.46BART	t 2.3 ± 0.1	t 0.34 ± 0.02	t 0.25 ± 0.0	t 0.08 ± 0.03	t 18.53 ± 2.02	t 5.40 ± 1.53GANITE	t 2.4 ± 0.4	t 0.49 ± 0.05	0.14 ± 0.01	t 0.06 ± 0.03	t 18.28 ± 1.66	t 4.65 ± 2.12BNN	t 2.1 ± 0.1	t 0.42 ± 0.03	0.24 ± 0.0	t 0.09 ± 0.04	n.r.	n.r.
Table 4: Comparison of methods for counterfactual inference with more than two available treatmentoptions on the News-4, News-8 and News-16. Numbers are mean value ± the standard deviation of√^mPEHE and ^mATE over 50 repeated runs. * = significantly different from PM (α < 0.05)Method	News-4 (κ = 10)		News-8 (κ = 10)		News-16 (κ = 7)		V ^mPEHE	ʌ mATE	V ^mPEHE	ʌ mATE	V ^mPEHE	ʌ mATEPM	21.58 ± 2.58	10.04 ± 2.71	20.76 ± 1.86	6.51 ± 1.66	20.24 ± 1.46	5.76 ± 1.33+ on X	21.41 ± 1.75 *	8.91 ± 2.00	20.90 ± 2.07	6.36 ± 1.65	20.67 ± 1.42	5.73 ± 1.16+ MLP	t 25.05 ± 2.80 *	14.92 ± 3.14	* 24.88 ± 1.98 *	14.00 ± 2.45	* 27.05 ± 2.47	* 16.90 ± 2.01kNN	* 27.92 ± 2.44 *	19.40 ± 3.12	* 26.20 ± 2.18 *	15.11 ± 2.34	* 27.64 ± 2.40	* 17.27 ± 2.10PSMPM	* 22.74 ± 2.58 *	11.62 ± 2.69	* 22.16 ± 1.79 *	8.81 ± 1.96	* 23.57 ± 2.48	* 11.04 ± 2.50PSMMI	* 37.26 ± 2.28 *	30.19 ± 2.47	* 30.50 ± 1.70 *	22.09 ± 1.98	* 28.17 ± 2.02	* 18.81 ± 1.74RF	* 26.59 ± 3.02 *	18.03 ± 3.18	* 23.77 ± 2.14 *	12.40 ± 2.29	* 26.13 ± 2.48	* 15.91 ± 2.00CF	* 27.28 ± 2.59 *	19.04 ± 3.15	* 25.76 ± 2.05 *	15.12 ± 2.20	* 26.85 ± 2.29	* 17.03 ± 1.99BART	* 26.41 ± 3.10 *	17.14 ± 3.51	* 25.78 ± 2.66 *	14.80 ± 2.56	* 27.45 ± 2.84	* 17.50 ± 2.49GANITE	* 24.50 ± 2.27 *	13.84 ± 2.69	* 23.58 ± 2.48 *	11.20 ± 2.84	* 25.12 ± 3.53	* 13.20 ± 3.28PD	20.88 ± 3.24 *	8.47 ± 4.51	21.19 ± 2.29	7.29 ± 2.97	* 22.28 ± 2.25	* 10.65 ± 2.22TARNET	* 23.40 ± 2.20 *	13.63 ± 2.18	* 22.39 ± 2.32 *	9.38 ± 1.92	* 21.19 ± 2.01	* 8.30 ± 1.66CFRNETWass	* 22.65 ± 1.97 *	12.96 ± 1.69	* 21.64 ± 1.82 *	8.79 ± 1.68	* 20.87 ± 1.46	* 8.05 ± 1.40Architectures. To ensure that differences between methods of learning counterfactual representa-tions for neural networks are not due to differences in architecture, we based the neural architectures
Table S1: Comparison of PM with varying numbers of nearest neighbours k considered for ran-domised matching on the News-2/4/8/16 datasets (k=1 corresponds to no randomisation; k=6, incursive, are the results reported in the main body). We report the mean value ± the standard devia-tion of √^pehe on the test sets over 50 runs. There was no significant differences between differentlevels of k and k=6 (significance level α < 0.05). In particular, there was no significant differencebetween using randomisation and not using randomisation.
Table S2:	Hyperparameter ranges used in the performed experiments.
Table S3:	Origins of the performance results reported in Table 3. Entries show the reference to theoriginal report of the performance results, or ”ours” if we produced the results. n.r. = not reportedMethod	IHDP	JobsPM	ours	ours+ on X	ours	ours+ MLP	ours	ourskNN	(ShalitetaL 2017)	(Shalit et al. 2017)PSMPM	n.r.	oursPSMMI	ours	oursRF	(Shalitetal. 2017)	(Shalit et al. 2017)CF	(Shalit et al. 2017)	(Shalit et al. 2017)BART	(Shalit et al. 2017)	(Shalit et al. 2017)GANITE	(Yoon etal. 2018)	(Yoon et al. 2018)BNN	(Shalit et al. 2017)	(Shalit et al. 2017)PD	n.r.	n.r.
