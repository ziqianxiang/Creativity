Figure 1: Box-World and StarCraft II tasks demand reasoning about entities and their relations.
Figure 2: Box-World agent architecture and multi-head dot-product attention. E is a matrix thatcompiles the entities produced by the visual front-end; gθ is a multilayer perceptron applied in parallelto each row of the output of an MHDPA step, A, and producing updated entities, E.
Figure 3: Box-World task: example observations (left), underlying graph structure that determinesthe proper path to the goal and the distractor branches (middle), and training curves (right).
Figure 4: Visualization of attention weights. (a) The underlying graph of one example level; (b)the result of the analysis for that level, using each of the entities along the solution path (1-5) asthe source of attention. Arrows point to the entities that the source is attending to. An arrow’stransparency is determined by the corresponding attention weight.
Figure 5: Generalization in Box-World. Zero-shot transfer to levels that required: (a) opening alonger sequence of boxes; (b) using a key-lock combination that was never required during training.
Figure 6: Final performance across StarCraft II mini-games. The relational-agent achieved abovegrandmaster scores in 4 out of 7 levels. The main difference between our new control agent and therelational agent is most relevant in the Defeat Zerglings and Banelings task. Here, the underlyingstrategy requires agents to split their army and kite enemy units in order to alleviate the incomingimpact (as Banelings incur area damage); a strategy requiring reasoning and fine control over manyunits. A relational agent with iterative blocks of attention was required for this strategy to emerge.
Figure 7: Alternative RL algorithms produced similar results on Box-World. The difference inperformance that we observed between relational and baseline agents using the RL algorithmproposed by Espeholt et al. (2018) was still present when using A3C or distributed DQN. Theseexperiments were done using 10 × 10 pixel maps, solution sequences of up to 3 boxes and up to 3distractor branches.
Figure 8: Box-World: forward branching versus backward branching. With backward branching, anygiven key can only open one box; however, each key type (i.e. color), can appear in multiple boxes.
Figure 9: Generalization results on the StarCraft II mini-game Collect Mineral Shards. Agents weretrained on levels with 2 marines and tested on levels with 1, 2, 3, 4, 5 or 10 marines. Colored barsindicate mean score over the ten best runs; error bars indicate standard error.
