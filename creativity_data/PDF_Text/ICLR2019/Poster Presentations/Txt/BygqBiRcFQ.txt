Published as a conference paper at ICLR 2019
Diffusion S cattering Transforms on Graphs
Fernando Gama
Dept. of Electrical and Systems Engineering
University of Pennsylvania
Alejandro Ribeiro
Dept. of Electrical and Systems Engineering
University of Pennsylvania
Joan Bruna
Courant Institute of Mathematical Sciences
New York University
Ab stract
Stability is a key aspect of data analysis. In many applications, the natural notion
of stability is geometric, as illustrated for example in computer vision. Scattering
transforms construct deep convolutional representations which are certified stable
to input deformations. This stability to deformations can be interpreted as stability
with respect to changes in the metric structure of the domain.
In this work, we show that scattering transforms can be generalized to non-
Euclidean domains using diffusion wavelets, while preserving a notion of stability
with respect to metric changes in the domain, measured with diffusion maps. The
resulting representation is stable to metric perturbations of the domain while being
able to capture “high-frequency” information, akin to the Euclidean Scattering.
1	Introduction
Convolutional Neural Networks (CNN) are layered information processing architectures. Each of
the layers in a CNN is itself the composition of a convolution operation with a pointwise nonlinear-
ity where the filters used at different layers are the outcome of a data-driven optimization process
(LeCun et al., 2010; 2015). Scattering transforms have an analogous layered architecture but dif-
fer from CNNs in that the convolutional filters used at different layers are not trained but selected
from a multi-resolution filter bank (Mallat, 2012; Bruna & Mallat, 2013). The fact that they are not
trained endows scattering transforms with intrinsic value in situations where training is impossible
-and inherent limitations in the converse case. That said, an equally important value of scattering
transforms is that by isolating the convolutional layered architecture from training effects it permits
analysis of the fundamental properties of CNN information processing architectures. This analysis
is undertaken in Mallat (2012); Bruna & Mallat (2013) where the fundamental conclusion is about
the stability of scattering transforms with respect to deformations in the underlying domain that are
close to translations.
In this paper we consider graphs and signals supported on graphs such as brain connectivity net-
works and functional activity levels (Huang et al., 2016), social networks and opinions (Jackson,
2008), or user similarity networks and ratings in recommendation systems (Huang et al., 2018). Our
specific goals are: (i) To define a family of graph-scattering transforms. (ii) To define a notion of
deformation for graph signals. (iii) To study the stability of graph scattering transforms with respect
to this notion of deformation. To accomplish goal (i) we consider the family of graph diffusion
wavelets which provide an appropriate construction of a multi-resolution filter bank (Coifman &
Maggioni, 2006). Our diffusion scattering transforms are defined as the layered composition of dif-
fusion wavelet filter banks and pointwise nonlinearities. To accomplish goal (ii) we adopt the graph
diffusion distance as a measure of deformation of the underlying domain (Coifman & Lafon, 2006;
Nadler et al., 2006). Diffusion distances measure the similarity of two graphs through the time it
takes for a signal to be diffused on the graph. The major accomplishment of this paper is to show
that the diffusion graph scattering transforms are stable with respect to deformations as measured
with respect to diffusion distances. Specifically, consider a signal x supported on graph G whose
diffusion scattering transform is denoted by the operator ΨG . Consider now a deformation of the
1
Published as a conference paper at ICLR 2019
signal’s domain so that the signal’s support is now described by the graph G0 whose diffusion scat-
tering operator is ΨG0. We show that the operator norm distance kΨG - ΨG0 k is bounded by a
constant multiplied by the diffusion distance between the graphs G and G0 . The constant in this
bound depends on the spectral gap of G but, very importantly, does not depend on the number of
nodes in the graph.
It is important to point out that finding stable representations is not difficult. E.g., taking signal
averages is a representation that is stable to domain deformations - indeed, invariant. The challenge
is finding a representation that is stable and rich in its description of the signal. In our numerical
analyses we show that linear filters can provide representations that are either stable or rich but that
cannot be stable and rich at the same time. The situation is analogous to (Euclidean) scattering
transforms and is also associated with high frequency components. We can obtain a stable repre-
sentation by eliminating high frequency components but the representation loses important signal
features. Alternatively, we can retain high frequency components to have a rich representation but
that representation is unstable to deformations. Diffusion scattering transforms are observed to be
not only stable - as predicted by our theoretical analysis - but also sufficiently rich to achieve good
performance in graph signal classification examples.
2	Related Work
Since graph and graph signals are of increasing interest but do not have the regular structure that
would make use of CNNs appealing, it is pertinent to ask the question of what should be an ap-
propriate generalization of CNNs to graphs and the graph signals whose topology they describe
(Bronstein et al., 2017). If one accepts the value of convolutions as prima facie, a natural solution is
to replace convolutions with graph shift invariant filters which are known to be valid generalizations
of (convolutional) time invariant filters (Bruna et al., 2014). This idea is not only natural but has
been demonstrated to work well in practical implementations of Graph Neural Networks (GNNs)
(Defferrard et al., 2016; Gama et al., 2019; Gilmer et al., 2017; Henaff et al., 2015; Kipf & Welling,
2017). Same as Euclidean scattering transforms, our graph scattering transforms differ from GNNs
in that they do not have to be trained. The advantages and limitations of the absence of training
notwithstanding, our work also sheds light on the question of why graph convolutions are appro-
priate generalizations of regular domain convolutions for signal classification problems. Our work
suggests that the value of GNNs stems from their stability relative to deformations of the underlying
domain that are close to permutations - which is the property that a pair of graphs must satisfy to
have small diffusion distance.
The stability results obtained in this paper build on the notion of scattering transforms. These scat-
tering representations were introduced by Mallat (2012) and further developed in Bruna & Mallat
(2013) with computer vision applications. Since, these representations have been extended to handle
transformations on more complex groups, such as roto-translations (Sifre & Mallat, 2013; Oyallon
& Mallat, 2015), and to domains such as audio processing (Anden & Mallat, 2014) and quantum
chemistry (Eickenberg et al., 2017).
Similarly as in this work, extensions of scattering to general graphs have been considered in Chen
et al. (2014) and Zou & Lerman (2018). Chen et al. (2014) focuses on Haar wavelets that hierarchi-
cally coarsen the graph, and relies on building multiresolution pairings. The recent Zou & Lerman
(2018) is closest to our work. There, the authors define graph scattering using spectrally constructed
wavelets from (Hammond et al., 2011), and establish some properties of the resulting representa-
tion, such as energy conservation and stability to spectral perturbations. In contrast, our stability
results are established with respect to diffusion metric perturbations, which are generally weaker, in
the sense that they define a weaker topology (see Section 3). We use diffusion wavelets (Coifman
& Maggioni, 2006) to obtain multi-resolution graph filter banks that are localized in frequency as
well as in the graph domain, while spanning the whole spectrum. Diffusion wavelets serve as the
constructive basis for the obtained stability results. Our work is also closely related to recent anal-
ysis of stability of Graph Neural Networks in the context of surface representations in (Kostrikov
et al., 2017). In our work, however, we do not rely on extrinsic deformations and exploit the specific
multiresolution structure of wavelets.
2
Published as a conference paper at ICLR 2019
3	Problem Set-up
This section introduces our framework and states the desired stability properties of signal represen-
tations defined on general non-Euclidean domains.
3.1	Euclidean Stability to Deformations with Scattering
Motivated by computer vision applications, our analysis starts with the notion of deformation sta-
bility. If X(U) ∈ L2(Ω) is an image defined over an Euclidean domain Ω ⊂ Rd, We are interested
in signal representations Φ : L2(Ω) → RK that are stable with respect to small deformations. If
XT (U) := X(U - T(U)) denotes a change of variables with a differentiable field T : Ω → Ω such that
∣∣Vτk < 1, then we ask
∀X,T , kΦ(X) - Φ(Xτ)k . kXkkT k , with	(1)
∣T ∣ := ∣VT ∣∞ denoting a uniform bound on the operator norm of VT. In this setting, a notorious
challenge to achieving (1) while keeping enough discriminative power in Φ(X) is to transform the
high-frequency content of X in such a way that it becomes stable.
Scattering transforms (Mallat, 2012; Bruna & Mallat, 2013) provide such representations by cas-
cading wavelet decompositions with pointwise modulus activation functions. We briefly summarize
here their basic definition. Given a mother wavelet ψ ∈ L1(Ω) with at least a vanishing mo-
ment ψ(U)dU = 0 and with good spatial localization, we consider rotated and dilated versions
ψj,c(u) = 2-jdψ(2-jRcU) using scale parameter j and angle θ ∈ {2∏c∕C}c=o,…,c-i. A wavelet
decomposition operator is defined as a filter bank spanning all scales up to a cutoff 2J and all angles:
Ψj : x → (x * Ψj,c)j≤j,c≤c. This filter bank is combined with a pointwise modulus activation
function ρ(z ) = |z|, as well as a low-pass average pooling operator U computing the average over
the domain. The resulting representation using m layers becomes
Φ(X)	=	{S0(X),S1(X), . . . , Sm-1(X)} , with	(2)
Sk (x)	=	UρΨjρ... Ψj X = {U (||x * Ψɑι | * Ψɑ2∣∙∙∙*	ψαk |)；	}ɑ1,...,αk	(k =。,.一，Μ — 1).
The resulting signal representation has the structure of a CNN, in which feature maps are not re-
combined with each other, and trainable filters are replaced by multiscale, oriented wavelets. It
is shown in Mallat (2012) that for appropriate signal classes and wavelet families, the resulting
scattering transform satisfies a deformation stablity condition of the form (1), which has been subse-
quently generalised to broader multiresolution families (Wiatowski & Bolcskei, 2018). In essence,
the mechanism that provides stability is to capture high-frequency information with the appropriate
spatio-temporal tradeoffs, using spatially localized wavelets.
3.2	Deformations and Metric Stability
Whereas deformations provide the natural framework to describe geometric stability in Euclidean
domains, their generalization to non-Euclidean, non-smooth domains is not straightforward. Let
x ∈ L2(X). If X is embedded into a low-dimension Euclidean space Ω ⊂ Rd, such as a 2-
surface within a three-dimensional space, then one can still define meaningful deformations on X
via extrinsic deformations of Ω (Kostrikov et al., 2017).
However, in this work we are interested in intrinsic notions of geometric stability, that do not nec-
essarily rely on a pre-existent low-dimensional embedding of the domain. The change of variables
夕(U) = U - τ(u) defining the deformation can be seen as a perturbation of the Euclidean metric in
L2 (Rd). Indeed,
hxτ, yτ iL2(Rd,μ) = J XT(U) y τ (U) dμ (U) = J X(U)y(U)|I - VT (U)ldμ(U) = hχ, yiL2(Rd,μ,),
with dμ(U) = |I - Vt(U)∣dμ(U), and |I - Vτ(u)| ≈ 1 if ∣∣Vτ∣∣ is small, where I is the identity.
Therefore, a possible way to extend the notion of deformation stability to general domains L2 (X)
is to think of X as a metric space and reason in terms of stability of Φ : L2 (X) → RK to metric
changes in X . This requires a representation that can be defined on generic metric spaces, as well
as a criteria to compare how close two metric spaces are.
3
Published as a conference paper at ICLR 2019
3.3	Diffusion Wavelets and Metrics on Graphs
Graphs are flexible data structures that enable general metric structures and modeling non-Euclidean
domains. The main ingredients of the scattering transform can be generalized using tools from
computational harmonic analysis on graphs. We note that, unlike the case of Euclidean domains,
where deformations are equivalent whether they are analyzed from the function domain or its image,
in the case of graphs, we focus on deformations on the underlying graph domain, while keeping the
same function mapping (i.e. we model deformations as a change of the underlying graph support
and analyze how this affects the interaction between the function mapping and the graph).
In particular, diffusion wavelets (Coifman & Maggioni, 2006) provide a simple framework to define
a multi-resolution analysis from powers of a diffusion operator defined on a graph. A weighted,
undirected graph G = (V, E, W) with |V | = n nodes, edge set E and adjacency matrix W ∈ Rn×n
defines a diffusion process A in its nodes, given in its symmetric form by the normalized adjacency
A := D-1/2W D-1/2 , with D = diag(d1,. . . ,dn) ,	(3)
where di = P(i,j)∈E Wi,j denotes the degree of node i. Denote by d = W 1 the degree vector
containing di in the ith element. By construction, A is well-localized in space (it is nonzero only
where there is an edge connecting nodes), it is self-adjoint and satisfies kAk ≤ 1, where kAk is
the operator norm. Let λ0 ≥ λ1 ≥ . . . λn-1 denote its eigenvalues in decreasing order. Defining
d1/2 = (√dι,..., √dn), one can easily verify that the normalized squared root degree vector
v = d1/2/kd1/2 k2 = d/kdk1 is the eigenvector with associated eigenvalue λ0 = 1. Also, note that
λn-1 = -1 if and only if G has a connected component that is non-trivial and bipartite (Chung,
1997).
In the following, it will be convenient to assume that the spectrum of A (which is real and discrete
since A is self-adjoint and in finite-dimensions) is non-negative. Since we shall be taking powers
of A, this will avoid folding negative eigenvalues into positive ones. For that purpose, we adopt the
so-called lazy diffusion, given by T = 2(I + A). In Section 4 We use this diffusion operator to
define both a multiscale wavelet filter bank and a low-pass average pooling, leading to the diffusion
scattering representation.
This diffusion operator can also be used to construct a metric on G. The so-called diffusion distances
(Coifman & Lafon, 2006; Nadler et al., 2006) measure distances betWeen tWo nodes x, x0 ∈ V in
terms of their associated diffusion at time s: dG,s(x, x0) = kTGs δx - TGs δx0 k, Where δx is a vector
With all zeros except a 1 in position x.
In this Work, We build on this diffusion metric to define a distance betWeen tWo graphs G, G0 .
Assuming first that G and G0 have the same size, the simplest formulation is to compare the diffusion
metric generated by G and G0 up to a node permutation:
Definition 3.1. Let G = (V, E, W), G0 = (V 0, E0, W0) have the same size |V | = |V 0| = n. The
normalized diffusion distance between graphs G, G0 at time s > 0 is
ds(G, G0) :
inf k(TG)*(TG) -πt(TG,)*(TG0)∏k
Π∈Πn
Πi∈nΠf kTG2s-ΠTTG2s0Πk ,
(4)
where Πn is the space of n × n permutation matrices.
The diffusion distance is defined at a specific time s. As s increases, this distance becomes Weaker1,
since it compares points at later stages of diffusion. The role of time is thus to select the smoothness
of the ‘graph deformation,, similarly as ∣∣Vτ∣∣ measures the smoothness of the deformation in the
Euclidean case. For convenience, We denote d(G, G0) = d1/2 (G, G0) and use the distance at s =
1/2 as our main deformation measure. The quantity d defines a distance betWeen graphs (seen as
metric spaces) yielding a stronger topology than other alternatives such as the Gromov-Hausdorff
distance, defined as
"Gh(G,G0) = inf sup ∣dG(x,x0) — dGo (∏(x), π(x0))∣
Π x,x0∈V
With dsG(x, x0) = ∣TGt (δx - δx0 )∣L2(G) . We choose d(G, G0) in this Work for convenience and
mathematical tractability, but leave for future Work the study of stability relative to dsGH . Finally,
1In the sense that it defines a Weaker topology, i.e., limm→∞ ds(G, Gm) → 0 ⇒ limm→∞ ds0 (G, Gm) =
0 for s0 > s, but not vice-versa.
4
Published as a conference paper at ICLR 2019
we consider for simplicity only the case where the sizes of G and G0 are equal, but definition
(3.1) can be naturally extended to compare variable-sized graphs by replacing permutations by soft-
correspondences (see Bronstein et al., 2010).
3.4	Problem Statement
Our goal is to build a stable and rich representation ΦG(x). The stability property is stated in terms
of the diffusion metric above: For a chosen diffusion time s, ∀ x ∈ Rn , G = (V, E, W), G0 =
(V0, E0, W0) with |V | = |V0| = n , we want
kΦG(x) - ΦG0 (x)k. kxkds(G, G0).	(5)
This representation can be used to model both signals and domains, or just domains G, by con-
sidering a prespecified x = f (G), such as the degree, or by marginalizing from an exchangeable
distribution, Φg = Ex〜qΦg(x).
The motivation of (5) is two-fold: On the one hand, we are interested in applications where the
signal of interest may be measured in dynamic environments that modify the domain, e.g. in mea-
suring brain signals across different individuals. On the other hand, in other applications, such as
building generative models for graphs, we may be interested in representing the domain G itself. A
representation from the adjacency matrix of G needs to build invariance to node permutations, while
capturing enough discriminative information to separate different graphs. In particular, and simi-
larly as with Gromov-Hausdorff distances, the definition of d(G, G0) involves a matching problem
between two kernel matrices, which defines an NP-hard combinatorial problem. This further moti-
vates the need for efficient representations of graphs ΦG that can efficiently tell apart two graphs,
and such that `(θ) = kΦG - ΦG(θ) k can be used as a differentiable loss for training generative
models.
4	Graph Diffusion S cattering
Let T be a lazy diffusion operator associated with a graph G of size n such as those described in
Section 3.3. Following Coifman & Maggioni (2006), we construct a family of multiscale filters by
exploiting the powers of the diffusion operator T2j . We define
ψo ：= I — T, ψj ：= T2j-1 (I — T2j-1) = T2j-1 - T2j , (j > 0).	(6)
This corresponds to a graph wavelet filter bank with optimal spatial localization. Graph diffusion
wavelets are localized both in space and frequency, and favor a spatial localization, since they can
be obtained with only two filter coefficients, namely h0 = 1 for diffusion T 2j-1 and h1 = —1
for diffusion T2j . The finest scale ψ0 corresponds to one half of the normalized Laplacian operator
ψo = (1∕2)∆ = 1/2(1—D-1/2WD-1/2), here seen as a temporal difference in a diffusion process,
seeing each diffusion step (each multiplication by ∆) as a time step. The coarser scales ψj capture
temporal differences at increasingly spaced diffusion times. Forj = 0, . . . , Jn — 1, we consider the
linear operator
Ψ : L2(G)	→ (L2(G))Jn
x 7→ (ψjx)j=0,...,Jn-1,	(7)
which is the analog of the wavelet filter bank in the Euclidean domain. Whereas several other
options exist to define graph wavelet decompositions (Rustamov & Guibas, 2013; Gavish et al.,
2010), and GNN designs that favor frequency localization, such as Cayley filters (Levie et al., 2019),
we consider here wavelets that can be expressed with few diffusion terms, favoring spatial over
frequential localization, for stability reasons that will become apparent next. We choose dyadic
scales for convenience, but the construction is analogous if one replaces scales 2j by dγje for any
γ > 1 in (6).
If the graph G exhibits a spectral gap, i.e., Bg = supi=1,...n-1 ∣λ∕ < 1, the following proposition
proves that the linear operator Ψ defines a stable frame.
Proposition 4.1. For each n, let Ψ define the diffusion wavelet decomposition (7) and assume
βG < 1. Then there exists a constant 0 < C(β) depending only on β such that for any x ∈ Rn
5
Published as a conference paper at ICLR 2019
satisfying hx, vi = 0,
Jn -1
C(β)kxk2 ≤ X kψjxk2 ≤ kxk2 .
j=0
(8)
This proposition thus provides the Littlewood-Paley bounds of Ψ, which control the ability of the
filter bank to capture and amplify the signal x along each ‘frequency’ (i.e. the ability of the filter to
increase or decrease the energy of the representation, relative to the energy of the x). We note that
diffusion wavelets are neither unitary nor analytic and therefore do not preserve energy. However,
the frame bounds in Proposition 4.1 provide lower bounds on the energy lost, such that the smaller
1 - β is, the less “unitary” our diffusion wavelets are. It also informs us about how the spectral
gap β determines the appropriate diffusion scale J: The maximum of p(u) = (ur - u2r)2 is at
U = 2-1/r, thus the cutoff r* should align with β as r* = 匕-累,since larger values of r capture
energy in a spectral range where the graph has no information. Therefore, the maximum scale can
be adjusted as J =d1 + log2 r*] = 1 +
[lθg2 (l⅞⅛)].
Recall that the Euclidean Scattering transform is constructed by cascading three building blocks: a
wavelet decomposition operator, a pointwise modulus activation function, and an averaging opera-
tor. Following the Euclidean scattering, given a graph G and x ∈ L2 (G), we define an analogous
Diffusion Scattering transform ΦG(x) by cascading three building blocks: the Wavelet decompo-
sition operator Ψ, a pointwise activation function ρ, and an average operator U which extracts the
average over the domain. The average over a domain can be interpreted as the diffusion at infinite
time, thus Ux = limt→∞ Ttx = hvT, xi. More specifically, we consider a first layer transformation
given by
φ1 (G, x) = UρΨx = {U ρψj x}0≤j ≤Jn -1 , ,	(9)
followed by second order coefficients
φ2 (G, x) = U ρΨρΨx = {U ρψj2 ρψj1x}0≤j1,j2 ≤Jn-1 ,,	(10)
and so on. The representation obtained from m layers of such transformation is thus
ΦG(x) = {Ux,φ1(G,x), . . . , φm-1(G,x)} = {U(ρΨ)kx; k = 0, . . . ,m - 1} .	(11)
5 Stability of Graph Diffusion S cattering
5.1 Stability and Equivariance of Diffusion Wavelets
Given two graphs G, G0 of size n and a signal x ∈ Rn, our objective is to bound kΦG(x) - ΦG0 (x)k
in terms of d(G, G0). Let π* the permutation minimising the distortion between G and G0 in (4).
Since all operations in Φ are either equivariant or invariant with respect to permutations, we can
assume w.l.o.g. that π = 1, so that the diffusion distance can be directly computed by comparing
nodes with the given order. A key property ofG that drives the stability of the diffusion scattering is
given by its spectral gap 1 一 Bg = 1 一 supi=ι n-ι ∣λ∕ ≥ 0. In the following, we use '2 operator
norms, unless stated otherwise.
Lemma 5.1. Assume β := max(βG, βG0) < 1. Then
inf ∣∣ΨG 一 ΠΨGoΠTk ≤ 2d(G,G0)
Π∈Πn
∕β2(1 + β2)
V (1— β2)3
(12)
Remark: If diffusion distance is measured at time different from s = 1/2, the stability bound would
be modified due to scales j such that 2j < s.
The following lemma studies the stability of the low-pass operator U with respect to graph pertur-
bations.
Lemma 5.2. Let G, G0 be two graphs with same size, denote by v and v0 their respective squared-
root degree vectors, and by β, β0 their spectral gap. Then
inf
Π∈Πn
∣v 一 Πv0 ∣2 ≤ 2
d(G, G0)
1 一 min(β, β0)
(13)
6
Published as a conference paper at ICLR 2019
Spectral Gap asymptotic behavior Lemmas 5.1 and 5.2 leverage the spectral gap of the lazy
diffusion operator associated with G. In some cases, such as regular graphs, the spectral gap vanishes
asymptotically as n → ∞, thus degrading the upper bound asymptotically. Improving the bound by
leveraging other properties of the graph (such as regular degree distribution) is an important open
task.
5.2 Stability and Invariance of Diffusion S cattering
The scattering transform coefficients ΦG(x) obtained after m layers are given by equation 11, for
low-pass operator U such that Ux = hv, xi so that U = vT.
From Lemma 5.1 We have that, ∣∣Ψg - Ψgo∣∣ ≤ εψ = 2d(G,G0),β2(1 + β2)/(1 一 β2)3. We
also know, from Proposition 4.1 that Ψ conforms a frame, i.e. C(β)kxk2 ≤ kΨxk2 ≤ kxk2 for
knoWn constant C(β) given in Prop. 4.1. Additionally, from Lemma 5.2 We get that kUG 一 UG0 k ≤
εu = 2d(G, G0)∕(1 — min(β, β0)).
The objective noW is to prove stability of the scattering coefficients ΦG(x), that is, to prove that
kΦG(x) 一 ΦG0(x)k . d(G,G0)kxk.	(14)
This is captured in the folloWing Theorem:
Theorem 5.3. Let G, G0 be two graphs and let d(G, G0) be their distance measured as in equation 4.
Let TG and TG0 be the respective diffusion operators. Denote by UG, ρG and ΨG and by UG0, ρG0
and ΨG0 the low pass operator, pointwise nonlinearity and the wavelet filter bank used on the
scattering transform defined on each graph, respectively, cf. equation 11. Assume ρG = ρG0 and
that ρG is non-expansive. Let β- = min(βG, βG0), β+ = max(βG, βG0) and assume β+ < 1.
Then, we have that, for each k = 0, . . . , m 一 1, the following holds
kUG(ρGΨG)k 一 UG0 (ρG0 ΨG0)k k ≤
2	d(G	g，))	/ +	k /β+(I + β+)d(G	g!\	(15)
1 一 §	d(G，G ) j +	ky (i 一 β2 )3 d(G，G ). (15)
Defining kΦG(x)k2 = Pkm=-01 kUG(ρGΨG)kk2 analogously to Bruna & Mallat (2013), itis straight-
forWard to compute the stability bound on the scattering coefficients as folloWs.
Corollary 5.4. In the context of Theorem 5.3, letx ∈ Rn andletΦG(x) be the scattering coefficients
computed by means of equation 11 on graph G after m layers, and let ΦG0 (x) be the corresponding
coefficients on graph G0. Then,
C	m-1「/	2	、1/2	I §2 (1+ β2 )
kφG(X) 一 φG0(X)k ≤ X (1 β~d(G,G))	+ k∖ Tlβ2)3~
k=0	1 一 §-	(1 一 §+)
kΦG(X) 一 ΦG0 (X)k .m1/2d1/2(G,G0)kXk	ifd(G,G0)1.
d(G, G0)	kxk2 (16)
Corollary 5.4 satisfies equation 5. It also shoWs that the closer the graphs are in terms of the diffusion
metric, the closer their scattering representations Will be. The constant is given by topological
properties, the spectral gaps of G and G0, as Well as design parameters, the number of layers m.
We observe that the stability bound groWs the smaller the spectral gap is and also as more layers are
considered. The spectral gap is tightly linked With diffusion processes on graphs, and thus it does
emerge from the choice of a diffusion metric. Graphs With values of beta closer to 1, exhibit Weaker
diffusion paths, and thus a small perturbation on the edges of these graphs Would lead to a larger
diffusion distance. The contrary holds as Well. In other Words, the tolerance of the graph to edge
perturbations (i.e., d(G, G) being small) depends on the spectral gap of the graph. We also note
that, as stated at the end of Section 5.1, the spectral gap appears in our upper bounds, but it is not
necessarily sharp. In particular, the spectral gap is a poor indication of stability in regular graphs,
and We believe our bound can be improved by leveraging structural properties of regular domains.
Finally, We note that the size of the graphs impacts the stability result inasmuch as it impacts the
distance measure d(G, G0). This is expected, since graphs of different size can be compared, as
mentioned in Section 3.3. Different from Zou & Lerman (2018), our focus is on obtaining graph
Wavelet banks that are localized in the graph domain to improve computational efficiency as dis-
cussed in Defferrard et al. (2016). We also notice that the scattering transform in Zou & Lerman
7
Published as a conference paper at ICLR 2019
(2018) is stable with respect to a graph measure that depends on the spectrum of the graph through
both eigenvectors and eigenvalues. More specifically, it is required that the spectrum gets concen-
trated as the graphs grow. However, in general, it is not straightforward to relate the topological
structure of the graph with its spectral properties.
As mentioned in Section 3.3, the stability is computed with a metric d(G, G0) which is stronger
than what could be hoped for. Our metric is permutation-invariant, in analogy with the rigid trans-
lation invariance in the Euclidean case, and stable to small perturbations around permutations. The
extension of (16) to weaker metrics, using e.g. multiscale deformations, is left for future work.
5.3 From Diffusion S cattering to Diffusion GNNs
By denoting Tj = T2j , observe that one can approximate the diffusion wavelets from (6) as a
cascade of low-pass diffusions followed by a high-pass filter at resolution 2j :
ψj=Tj-1(I-Tj-1)≈TPj0<j-12j0(I-Tj-1)=	Y Tj0	(I-Tj-1).
j0<j-1
This pyramidal structure of multi-resolution analysis wavelets — in which each layer now corre-
sponds to a different scale, shows that the diffusion scattering is a particular instance of GNNs
where each layer j is generated by the pair of operators {I, Tj-1}. If x(j) ∈ Rn×dj denotes the
feature representation at layer j using dj feature maps per node, the corresponding update is given
by
x(j+1) = ρ x(j) θ1(j) + Tj-1x(j)θ2(j) ,	(17)
where θ1(j), θ2(j) are dj × dj+1 weight matrices. In this case, a simple modification of the previous
theorem shows that the resulting GNN representation ΦG (x, Θ), Θ = (θ1(j), θ2(j))j≤J
is also stable
with respect to d(G, G0), albeit this time the constants are parameter-dependent:
Corollary 5.5. The J layer GNN with parameters Θ = (θ1(j), θ2(j))j≤J
satisfies
∣∣Φg(x, Θ) - Φgo(x, Θ)k ≤ d(G,G0)风
1-β
2
Y (1 + kθ1(j)k + kθ2(j)k)
j≤J
(18)
This bound is thus learning-agnostic and is proved by elementary application of the diffusion dis-
tance definition. An interesting question left for future work is to relate such stability to gradient
descent optimization biases, similarly as in (Gunasekar et al., 2018; Wei et al., 2018), which could
provide stability certificates for learnt GNN representations.
6	Numerical Experiments
In this section, we first show empirically the dependence of the stability result with respect to the
spectral gap, and then we illustrate the discriminative power of the diffusion scattering transform in
two different classification tasks; namely, the problems of authorship attribution and source local-
ization.
Consider a small-world graph G with N = 200 nodes, edge probability pSW and rewiring proba-
bility qsw = 0.1. Let X 〜N(0, I) be a random graph signal defined on top of G and Φg(x) the
corresponding scattering transform. Let G0 be another realization of the small-world graph, and
let ΦG0 (X) be the scattering representation of the same graph signal X but on the different support
G0. we can then proceed to compute kΦG(X) - ΦG0 (X)k. By changing the value of pSw we can
change value of the spectral gap β and study the dependence of the difference in representations as
a function of the spectral gap. Results shown in Fig. 1a are obtained by varying pSw from 0.1 to 0.9.
For each value of pSw we generate one graph G and 50 different graphs G0 ; and for each graph G0
we compute kΦG(X) - ΦG0 (X)k for 1, 000 different graph signal realizations X. The average across
all signal realizations is considered the estimate of the representation difference, and then the mean
as well as the variance across all graphs are computed and shown in the figure (error bars).
8
Published as a conference paper at ICLR 2019
(a) Small world
(b) Authorship attribution
(c) Facebook graph
Figure 1. (a) Difference in representation between the signal defined on the original graph G and on the
deformed graph G0 as a function of the spectral gap β. (b)-(c) Classification error percentage as a function of
perturbation for the authorship attribution and the Facebook graph, respectively.
Fig. 1a shows the average difference kΦG(x) - ΦG(x0)k as a function of the spectral gap (changing
pSW from 0.1 to 0.9 led to values of spectral gap between 0.5 and close to 1). First and foremost
we observe that, indeed, as β reaches one, the stability result gets worse and the representation
difference increases. We also observe that, for deeper scattering representations, the difference also
gets worse, although it is not a linear behaviour as predicted in equation 16, which suggest that the
bound is not tight.
For classifying we train a SVM linear model fed by features obtained from different representations.
We thus compare with two non-trainable linear representations of the data: a data-based method
(using the graph signals to feed the classifier) and a graph-based method (obtaining the GFT coef-
ficients as features for the data). Additionally, we consider the graph scattering with varying depth
to analyze the richness of the representation. Our aim is mainly to illustrate that the scattering
representation is rich enough, relative to linear representations, and is stable to graph deformations.
First, we consider the problem of authorship attribution where the main task is to determine if a
given text was written by a certain author. We construct author profiles by means of word adjacency
networks (WAN). This WAN acts as the underlying graph support for the graph signal representing
the word count (bag-of-words) of the target text of unknown authorship. Intuitively, the choice of
words of the target text should reflect the pairwise connections in the WAN, see Segarra et al. (2015)
for detailed construction of WANs. In particular, we consider all works by Jane Austen. To illustrate
the stability result, we construct a WAN with 188 nodes (functional words) using a varying number
of texts to form the training set, obtaining an array of graphs that are similar but not exactly the
same. For the test set, we include 154 excerpts by Jane Austen and 154 excerpts written by other
contemporary authors, totaling 308 data points. Fig. 1b shows classification error as a function of
the number of training samples used. We observe that graph scattering transforms monotonically
improve while considering more training data, whereas other methods vary more erratically, showing
their lack of stability (their representations vary more wildly when the underlying graph support
changes). This shows that scattering diffusion transforms strike a good balance between stability
and discriminative power.
For the second task, let Gbe a 234-node graph modeling real-world Facebook interactions (McAuley
& Leskovec, 2012). In the source localization problem, we observe a diffusion process after some
unknown time t, that originated at some unknown node i, i.e. we observe x = W tδi, where δi is
the signal with all zeros except a 1 on node i. The objective is to determine which community the
source node i belongs to. These signals can be used to model rumors that percolate through the social
network by interaction between users and the objective is to determine which user group generated
said rumor (or initiated a discussion on some topic). We generate a training sample of size 2, 000,
for nodes i chosen at random and diffusion times t chosen as random as well. The GFT is computed
by projecting on the eigenbasis of the operator T . We note that, to avoid numerical instabilities,
the diffusion is carried out using the normalized operator (W∕λmaχ(W)) and t ≤ tmaχ = 20.
The representation coefficients (graph signals, GFT or scattering coefficients) obtained from this set
are used to train different linear SVMs to perform classification. For the test set, we draw 200 new
signals. We compute the classification errors on the test set as a measure of usefulness of the obtained
representations. Results are presented in Fig. 1c, where perturbations are illustrated by dropping
edges with probability p (adding or removing friends in Facebook). Again, it is observed that the
9
Published as a conference paper at ICLR 2019
scattering representation exhibits lower variations when the underlying graph changes, compared to
the linear approaches.
Finally, to remark the discriminative power of the scattering representation, we observe that as the
graph scattering grows deeper, the obtained features help in more accurate classification. We re-
mark that in regimes with sufficient labeled examples, trainable GNN architectures will generally
outperform scattering-based representations.
7	Conclusions
In this work we addressed the problem of stability of graph representations. We designed a scattering
transform of graph signals using diffusion wavelets and we proved that this transform is stable under
deformations of the underlying graph support. More specifically, we showed that the scattering
transform of a graph signal supported on two different graphs is proportional to the diffusion distance
between those graphs. As a byproduct of our analysis, we obtain stability bounds for Graph Neural
Networks generated by diffusion operators. Additionally, we showed that the resulting descriptions
are also rich enough to be able to adequately classify plays by author in the context of authorship
attribution, and identify the community origin of a signal in a source localization problem.
That said, there are a number of directions to build upon from these results. First, our stability
bounds depend on the spectral gap of the graph diffusion. Although lazy diffusion prevents this
spectral gap to vanish, as the size of the graph increases we generally do not have a tight bound, as
illustrated by regular graphs. An important direction of future research is thus to develop stability
bounds which are robust to vanishing spectral gaps. Next, and related to this first point, we are
working on extending the analysis to broader families of wavelet decompositions on graphs and
their corresponding graph neural network versions, including stability with respect to the Gromov-
Hausdorff metric, which can be achieved by using graph wavelet filter banks that achieve bounds
analogous to those in Lemmas 5.1 and 5.2.
Acknowledgments
Work supported by NSF CCF 1717120, US ARO W911NF1710438, ARL DCIST CRA W911NF-
17-2-0181, ISTC-WAS and Intel AI DevCloud.
References
J. Anden and S. Mallat. Deep scattering spectrum. IEEE Trans. Signal Process., 62(16):4114-4128,
Aug. 2014.
A. M. Bronstein, M. M. Bronstein, R. Kimmel, M. Mahmoudi, and G. Sapiro. A Gromov-Hausdorff
framework with diffusion geometry for topologically-robust non-rigid shape matching. Int. J. of
Comput. Vision, 89(2-3):266-286, 2010.
M. M. Bronstein, J. Bruna, Y. LeCun, A. Szlam, and P. Vandergheynst. Geometric deep learning:
Going beyond euclidean data. IEEE Signal Process. Mag., 34(4):18-42, July 2017.
J. Bruna and S. Mallat. Invariant scattering convolution networks. IEEE Trans. Pattern Anal. Mach.
Intell., 35(8):1872-1886, Aug. 2013.
J. Bruna, W. Zaremba, A. Szlam, and Y. LeCun. Spectral networks and deep locally connected
networks on graphs. arXiv:1312.6203v3 [cs.LG], 21 May 2014. URL http://arxiv.org/
abs/1213.6203.
X. Chen, X. Cheng, and S. Mallat. Unsupervised deep Haar scattering on graphs. In Annu. Conf.
Neural Inform. Process. Syst. 2014, Montreal, QC, 8-13 Dec. 2014. NIPS Foundation.
F. R. K. Chung. Spectral Graph Theory. Number 92 in Conference Board of the Mathematical Sci-
ences: Regional Conference Series in Mathematics. American Mathematical Society, Providence,
RI, 1997.
R.	R. Coifman and S. Lafon. Diffusion maps. Appl. Comput. Harmonic Anal., 21(1):5-30, July
2006.
10
Published as a conference paper at ICLR 2019
R. R. Coifman andM. Maggioni. Diffusion wavelets. APPL Comput Harmonic Anal., 21(1):53-94,
July 2006.
M. Defferrard, X. Bresson, and P. Vandergheynst. Convolutional neural networks on graphs with
fast localized spectral filtering. In Annu. Conf. Neural Inform. Process. Syst. 2016, Barcelona,
Spain, 5-10 Dec. 2016. NIPS Foundation.
M. Eickenberg, G. Exarchakis, M. Hirn, and S. Mallat. Solid harmonic wavelet scattering: Pre-
dicting quantum molecular energy from invariant descriptors of 3d electronic densities. In Annu.
Conf. Neural Inform. Process. Syst. 2017, Long Beach, CA, 4-9 Dec. 2017. NIPS Foundation.
F. Gama, A. G. Marques, G. Leus, and A. Ribeiro. Convolutional neural network architectures for
signals supported on graphs. IEEE Trans. Signal Process., 67(4):1034-1049, Feb. 2019.
M. Gavish, B. Nadler, and R. R. Coifman. Multiscale wavelets on trees, graphs and high dimensional
data: Theory and applications to semi supervised learning. In 27th Int. Conf. Mach. Learning,
Haifa, Israel, 21-24 June 2010.
J. Gilmer, S. S. Schoenholz, P. F. Riley, O. Vinyals, and G. E. Dahl. Neural message passing for
quantum chemistry. In 34th Int. Conf. Mach. Learning, Sydney, Australia, 6-11 Aug. 2017.
S.	Gunasekar, J. Lee, D. Soudry, and N. Srebro. Characterizing implicit bias in terms of optimization
geometry. In 35th Int. Conf. Mach. Learning, number 80, pp. 1832-1841, Stockholm, Sweden,
10-15 July 2018.
D. K. Hammond, P. Vandergheynst, and R. Gribonval. Wavelets on graphs via spectral graph theory.
APPl. ComPut. Harmonic Anal., 30(2):129-150, March 2011.
M. Henaff, J. Bruna, and Y. LeCun. Deep convolutional networks on graph-structured data.
arXiv:1506.051631v1 [cs.LG], 16 June 2015. URL http://arxiv.org/abs/1506.
05163.
W. Huang, L. Goldsberry, N. F. Wymbs, S. T. Grafton, D. S. Bassett, and A. Ribeiro. Graph fre-
quency analysis of brain signals. IEEE J. Select. ToPics Signal Process., 10(7):1189-1203, Oct.
2016.
W. Huang, A. G. Marques, and A. Ribeiro. Matrix completion via graph signal processing. In 43rd
IEEE Int. Conf. Acoust., SPeech and Signal Process., Calgary, AB, 15-20 Apr. 2018. IEEE.
M. O. Jackson. Social and Economic Networks. Princeton University Press, Princeton, NJ, 2008.
T. N. Kipf and M. Welling. Semi-supervised classification with graph convolutional networks. In
5th Int. Conf. Learning RePresentations, Toulon, France, 24-26 Apr. 2017. Assoc. Comput. Lin-
guistics.
I. Kostrikov, J. Bruna, D. Panozzo, and D. Zorin. Surface networks. arXiv:1705.10819v1 [stat.ML],
30 May 2017. URL http://arxiv.org/abs/1705.10819.
Y. LeCun, K. Kavukcuoglu, and C. Farabet. Convolutional networks and applications in vision. In
2010 IEEE Int. SymP. Circuits and Syst., Paris, France, 30 May-2 June 2010. IEEE.
Y. LeCun, Y. Bengio, and G. Hinton. Deep learning. Nature, 521(7553):85-117, 2015.
R.	Levie, F. Monti, X. Bresson, and M. M. Bronstein. Cayleynets: Graph convolutional neural
networks with complex rational spectral filters. IEEE Trans. Signal Process., 67(1):97-109, Jan.
2019.
S.	Mallat. Group invariant scattering. Communications on Pure and APPlied Mathematics, 65(10):
1331-1398, 2012.
J. McAuley and J. Leskovec. Learning to discover social circles in Ego networks. In 26th Annu.
Conf. Neural Inform. Process. Syst., Stateline, TX, 3-8 Dec. 2012. NIPS Foundation.
11
Published as a conference paper at ICLR 2019
B. Nadler, S. Lafon, I. Kevrekidis, and R. R. Coifman. Diffusion maps, spectral clustering and
eigenfunctions of fokker-planck operators. In Annu. Conf. Neural Inform. Process. Syst. 2006,
Vancouver, BC, 4-9 Dec. 2006. NIPS Foundation.
E. Oyallon and S. Mallat. Deep roto-translation scattering for object classification. In IEEE Comput.
Soc. Conf. Comput. Vision and Pattern Recognition 2015, Boston, MA, 7-12 June 2015. IEEE
Comput. Soc.
R.	Rustamov and L. J. Guibas. Wavelets on graphs via deep learning. In Annu. Conf. Neural Inform.
Process. Syst. 2013, Lake Tahoe, NV, 5-10 Dec. 2013. NIPS Foundation.
S.	Segarra, M. Eisen, and A. Ribeiro. Authorship attribution through function word adjacency
networks. IEEE Trans. SignalProcess., 63(20):5464-5478, Oct. 2015.
L. Sifre and S. Mallat. Rotation, scaling and deformation invariant scattering for texture discrimina-
tion. In IEEE Comput. Soc. Conf. Comput. Vision and Pattern Recognition 2013, Portland, OR,
23-28 June 2013. IEEE Comput. Soc.
C.	Wei, J. D. Lee, Q. Liu, and T. Ma. On the margin theory of feedforward neural net-
works. arXiv:1810.05369v1 [stat.ML], 12 Oct. 2018. URL http://arxiv.org/abs/
1810.05369.
T. WiatoWski and H. Bolcskei. A mathematical theory of deep convolutional neural networks for
feature extraction. IEEE Trans. Inf. Theory, 64(3):1845-1866, 2018.
D.	Zou and G. Lerman. Graph convolutional neural networks via scattering. arXiv:1804.00099v1
[cs.IT], 31 March 2018. URL http://arxiv.org/abs/1804.00099.
12
Published as a conference paper at ICLR 2019
A	Proof of Proposition 4.1
Since all operators ψj are polynomials of the diffusion T , they all diagonalise in the same basis.
Let T = V ΛV T, where V TV = I contains the eigenvectors of T and Λ = diag(λ0, . . . , λn-1) its
eigenvalues. The frame bounds C1, C2 are obtained by evaluating kΨxk2 for x = vi, i = 1, . . . , n-
1, since v0 corresponds to the square-root degree vector and x is by assumption orthogonal to v0 .
We verify that the spectrum of ψj is given by (pj(λ0), . . . ,pj(λn-1)), where pj (x) = x2j-1 - x2j
for j > 0 and p0 (x) = 1 - x. Denote by QJ (x) = PjJ=-01 pj(x)2. It follows from the definition that
kΨvi k2 = QJ (λi) for i = 1, . . . , n - 1 and therefore
C1 = min QJ (x) , C2 = max QJ (x) .	(19)
x∈(0,β)	x∈(0,β)
We check that C1 ≥ minx∈(0,β) p0 (x)2 = (1 - β)2 and C2 = QJ (0) = 1. Indeed, denote by
Q(x) = Pj∞=0 pj(x)2. One easily verifies that Q(x) is continuous in [0, 1) since it is bounded by a
geometric series. Also, observe that Q(x) = (1 -x)2 + Pj>0(x2j-1 -x2j)2 satisfies the recurrence
Q(x2) = Q(x) + 2x(1 - x)2 ≥ Q(x)
since x ∈ [0, 1). By continuity it thus follows that
sup QJ(x) ≤ sup Q(X) = lim Q(X) = Q(0) = 1 □.
x∈[0,1)	x∈[0,1)	x→0
B Proof of Lemma 5.1
By definition ∣∣Ψg - Ψgo ∣∣2 = ∣∣[Ψg - Ψg,]*[Ψg - Ψg,]∣∣ and
Jn -1
[Ψg — Ψgo]*[Ψg - Ψgo] = E (Ψj(G) - Ψj(G0))*(ψj(G)- Ψj(Gy) .	(20)
j=0
Since TG and TG0 are self-adjoint, so are ψj(G) and ψj(G0). From the triangular inequality, we thus
obtain
∣ΨG-ΨG0∣2 ≤X∣ψj(G)-ψj(G0)∣2.	(21)
j
Denote by v the eigenvector associated with λ0 = 1, [v]i = (di/ Pjn=1 dj)1/2. Since β < 1, we can
write T = VvT + T with ∣∣T∣∣ < 1 and V ∈ Null(T). It follows by induction that Tr = VvT + T,
Md hence	Ψj (G) = TGjT- TGj= TG- - TG,,
and equivalently for G0, resulting in
kψj(G) - Ψj(G0)k2 ≤ 2 (kTGr- TG-I k2 + kTGj - Tjk2),
and thus
∣Ψg - Ψgok2 ≤ 4 X ∣TTG - T嚷 k2.	(22)
j
Let us show that for matrices A and B such that β = max(∣A∣, ∣B∣) < 1 and r ∈ N, one has
∣Ar-Br∣ ≤ rβr-1∣A - B∣ .	(23)
Indeed, by noting g(t) = (tB + (1 - t)A)r, we have
∣Ar-Br∣ = ∣g(1) - g(0)∣ = Z 1g0(t)dt ≤Z 1∣g0(t)∣dt≤ sup ∣g0(t)∣ .
0	0	t∈(0,1)
A1
Published as a conference paper at ICLR 2019
By noting At = tB + (1 - t)A we verify that
r-1
g0(t) = X Alt(B - A)Atr-l-1,
l=0
which results in kg0(t)k ≤ rβr-1 kB - Ak, proving (23).
By plugging (23) into (22) we thus obtain
kΨG-ΨG0k2	≤
≤
≤
which yields ∣∣Ψg - Ψgo k ≤ 2∣∣TG - Tg，k {(1-+2)3. Finally, We observe that kTG - Tg，∣∣
kTG - Tg，k, which proves (12) as claimed. □
4∣TG - TG0 k2 X 22jβ2j+1
j
4kTG - TG0 k2 X t2(β2)t
t
4kTG - TG0 k2β⅛+β2^ ,
(24)
C Proof of Lemma 5.2
Without loss of generality, assume that the node assignment that minimizes ∣∣Tg - ∏Tgo∏∣∣t is the
identity. We need to bound the leading eigenvectors of two Symmetric_matrices TG and Tg，with
a spectral gap. As before, let TG = VvT + TG and Tg，= v0(v0)t + Tg，. Let α =(v, v0)≥ 0
since both are non-negative vectors. Denote by E_= TG - Tg，and E = TG 一 Tg，. Then
E = vvτ — v0(v0)τ + E. Hence Ev = v — v0α — Tg，(v — av0), so
(I — T g，)(v — v0α) = Ev
Since ∣∣E∣ ≤ d(G,G0) and ∣∣Tg，k < β0, we have
(1 — α)(1 — β0) ≤ k(I — Tg，)(v — v0α)k≤ d(G,G0),
so
1 — α ≤
d(G, G0)
1 — β0
Finally, since ∣∣v — v0∣ = √2 — 2α, we have
∣v - v0∣2 ≤ 2"
(25)
Since we are free to swap the role of V and v0, the result follows. □
D	Proof of Theorem 5.3
First, note that PG = Pg，= P since it is a pointwise nonlinearity (an absolute value), and is
independent of the graph topology. Now, let’s start with k = 0. In this case, we get ∣UGx — UG， x∣
which is immediately bounded by Lemma 5.2 satisfying equation 15.
For k = 1 we have
∣∣UgpΨgx — UgopΨgoXk = ∣∣UgpΨgx - Ug∕Ψgx + Ug∕ΨgX - Ug，P&g，Xk	(26)
≤ k(UG — Ugo)pΨgx∣ + ∣Ugop((Ψg - Ψgo)x)k	(27)
where the triangular inequality of the norm was used, together with the fact that ∣Pu — Pu0 ∣ ≤
∣P(u — u0)∣ for any real vector u since P is the pointwise absolute value. Using the submultiplica-
tivity of the operator norm, we get
∣UgpΨgx — UgopΨgoXk ≤ ∣Ug - Ug，IlkPkkΨG∣∣kx∣∣ + ∣Ugokkρk∣ΨG — Ψgokkx∣. (28)
A2
Published as a conference paper at ICLR 2019
From Lemmas 5.1 and 5.2 we have that kΨG - ΨG0 k ≤ εΨ and kUG - UG0 k ≤ εU, and from
Proposition 4.1 that kΨGk ≤ 1. Note also that kUG0 k = kUGk = 1 and that kρk = 1. This yields
kUGρΨGx - UG0 ρΨG0 xk ≤ εU kxk +εΨkxk.	(29)
satisfying equation 15 for k = 1.
For k = 2, we observe that
kUGρΨGρΨGx-UG0ρΨG0ρΨG0xk
= kUGρΨGρΨGx-UG0ρΨGρΨGx+UG0ρΨGρΨGx-UG0ρΨG0ρΨG0xk	(30)
≤ k(UG-UG0)ρΨGρΨGxk+kUG0(ρΨGρΨGx-ρΨG0ρΨG0x)k	(31)
The first term is bounded in a straightforward fashion by k(UG - UG0)ρΨGρΨGxk ≤ εU kxk in
analogy to the development for k = 1. Since kUG0 k = 1, for the second term, we focus on
kρΨGρΨGx - ρΨG0ρΨG0xk = kρΨGρΨGx - ρΨGρΨG0x + ρΨGρΨG0x - ρΨG0ρΨG0xk
(32)
≤ kρΨGρΨGx - ρΨGρΨG0xk + kρΨGρΨG0x - ρΨG0ρΨG0xk	(33)
We note that, in the first term in equation 33, the first layer induces an error, but after that, the pro-
cessing is through the same filter banks. So we are basically interested in bounding the propagation
of the error induced in the first layer. Applying twice the fact that kρ(u) - ρ(u0)k ≤ kρ(u - u0)k
we get
kρΨGρΨGx - ρΨGρΨG0xk ≤ kρ(ΨG(ρΨGx-ρΨG0x))k ≤ kρ(ΨGρ((ΨG - ρΨG0)x))k.
(34)
And following with submultiplicativity of the operator norm,
kρΨGρΨGx - ρΨGρΨG0 xk ≤ εΨkxk.	(35)
For the second term in equation 33, we see that the first layer applied is the same in both, namely
ρΨG0 so there is no error induced. Therefore, we are interested in the error obtained after the first
layer, which is precisely the same error obtained for k = 1. Therefore,
kρΨGρΨG0x - ρΨG0 ρΨG0 xk = kρΨGx - ρΨG0 xk ≤ εΨkxk.	(36)
Plugging equation 35 and equation 36 back in equation 31 we get
kUGρΨGρΨGx - UG0 ρΨG0 ρΨG0 xk ≤ εU kxk + εΨkxk + εΨkxk	(37)
satisfying equation 15 for k = 2.
For general k we see that we will have a first term that is the error induced by the mismatch on the
low pass filter that amounts to εU, a second term that accounts for the propagation through (k - 1)
equal layers of an initial error, yielding εΨ, and a final third term that is the error induced by the
previous layer, (k - 1)εΨ. More formally, assume that equation 15 holds for k - 1, implying that
k(ρΨG)k-1x-(ρΨG0)k-1xk ≤ (k - 1)εΨkxk	(38)
Then, for k, we can write
kUG(ρΨG)kx-UG0(ρΨG0)kxk ≤ k(UG-UG0)(ρΨG)kxk+kUG0((ρΨG)kx-(ρΨG0)kx)k (39)
Again, the first term we bound it in a straightforward manner using submultiplicativity of the oper-
ator norm
k(UG - UG0)(ρΨG)kxk ≤ εUkxk.	(40)
For the second term, since kUG0 k = 1 we focus on
k(ρΨG)kx - (ρΨG0)kxk = k(ρΨG)kx - (ρΨG)k-1ρΨG0x + (ρΨG)k-1ρΨG0x - (ρΨG0)kxk
(41)
≤ k(ρΨG)k-1ρΨGx - (ρΨG)k-1ρΨG0xk + k(ρΨG)k-1ρΨG0x - (ρΨG0)k-1ρΨG0xk (42)
The first term in equation 42 computes the propagation in the initial error caused by the first layer.
Then, repeatedly applying kρ(u) - ρ(u0)k ≤ kρ(u - u0)k in analogy with k = 2 and using submul-
tiplicativity, we get
k(ρΨG)k-1ρΨGx - (ρΨG)k-1ρΨG0xk ≤ εΨkxk.	(43)
A3
Published as a conference paper at ICLR 2019
The second term in equation 42 is the bounded by equation 38, since the first layer is exactly the
same in this second term. Then, combining equation 43 with equation 38, yields
k(ρΨG)kx - (ρΨG0)kxk ≤ εΨ + (k - 1)εΨkxk = kεΨ kxk.	(44)
Overall, we get
kUG(ρΨG)kx - UG0 (ρΨG0)k xk ≤ εU kxk +εΨkxk	(45)
which satisfies equation 15 for k. Finally, since this holds for k = 2, the proof is completed by
induction. □
E Proof of Corollary 5.4
From Theorem 5.3, we have
kUG(PGΨG)k - Ugo(PG0Ψgo)kk ≤ (-2-ds(G,G0)}12 + k√β+¾β+Pd(G,G0)
1- β-	(1- β+ )
and, by definition (Bruna & Mallat, 2013, Sec. 3.1),
m-1
kΦG(x)k2 = X kUG(ρGΨG)kxk2
k=0
so that
m-1
kΦG(x) - ΦG0 (x)k2 = X kUG(ρGΨG)kx - UG0 (ρG0 ΨG0)k xk2
k=0
Then, applying the inequality of Theorem 5.3, we get
kΦG - ΦG0 k2
d(G,
1/2
G0)
+ kJβ+(I + β+)d(G GO)
+ N (1 - β+ )3 d(G,G )
(46)
(47)
(48)
(49)
2
Now, considering each term, such that
m-1
kΦG-ΦG0k2≤X
k=0
(τ⅛d(G，G0))
m-1 β2 (1 + β2 )
+ X k2 (I-βg+ d2(G,G0)
m-1
+ X 23/2k
k=0
I~β+ (1+β+)-
V(i-β-)(i-β+ )3
d3/2(G,G0)
(50)
(51)
we observe that the second and third term vanish for d(G, G0)	1, leaving only the first term,
yielding
kΦG — Φgok2 . m (1-2βzd(G,G0))	(52)
Finally, this leads to the corollary result
kΦG(x) -ΦG(x)k . m1/2d1/2(G,G0)kxk if d(G, G0)	1	(53)
completing the proof.
F Proof of Corollary 5.5
Let us denote by ej = kx(Gj ) - x(Gj0) k. From (17), from the triangle inequality we verify that
ej+1 ≤ aj ej + bj , with
aj = kθ1(j)k + kθ2(j)k , bj =β2j-1d(G,G0)kx(Gj0)k and e0 =0.
A4
Published as a conference paper at ICLR 2019
(X %
It follows that
J +1 ≤ X	Yl & %≤ Y(1 + a)
j≤J ∖i=j+1 )	∖j=1
and since
bj = βv-d(G,G0)kxj)k ≤ βv-d(G, G0)kxk ("1 + %)
we obtain
(54)
eJ +1 ≤
II(1 + aj)) d(G,G')3∣ Xβ2j-1 ≤
J (1 + aj)) d(aG')∣∣x∣∣ 占
(55)
as desired. □
A5