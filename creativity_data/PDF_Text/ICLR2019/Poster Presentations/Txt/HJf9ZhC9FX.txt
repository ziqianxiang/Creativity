Published as a conference paper at ICLR 2019
Stochastic Gradient/Mirror Descent: Mini-
max Optimality and Implicit Regularization
Navid Azizan
California Institute of Technology
Pasadena, CA 91125
azizan@caltech.edu
Babak Hassibi
California Institute of Technology
Pasadena, CA 91125
hassibi@caltech.edu
Ab stract
Stochastic descent methods (of the gradient and mirror varieties) have become
increasingly popular in optimization. In fact, it is now widely recognized that
the success of deep learning is not only due to the special deep architecture of
the models, but also due to the behavior of the stochastic descent methods used,
which play a key role in reaching “good” solutions that generalize well to unseen
data. In an attempt to shed some light on why this is the case, we revisit some
minimax properties of stochastic gradient descent (SGD) for the square loss of
linear models—originally developed in the 1990’s—and extend them to general
stochastic mirror descent (SMD) algorithms for general loss functions and non-
linear models. In particular, we show that there is a fundamental identity which
holds for SMD (and SGD) under very general conditions, and which implies the
minimax optimality of SMD (and SGD) for sufficiently small step size, and for
a general class of loss functions and general nonlinear models. We further show
that this identity can be used to naturally establish other properties of SMD (and
SGD), namely convergence and implicit regularization for over-parameterized lin-
ear models (in what is now being called the “interpolating regime”), some of
which have been shown in certain cases in prior literature. We also argue how
this identity can be used in the so-called “highly over-parameterized” nonlinear
setting (where the number of parameters far exceeds the number of data points)
to provide insights into why SMD (and SGD) may have similar convergence and
implicit regularization properties for deep learning.
1	Introduction
Deep learning has proven to be extremely successful in a wide variety of tasks (Krizhevsky et al.,
2012; LeCun et al., 2015; Mnih et al., 2015; Silver et al., 2016; Wu et al., 2016). Despite its tremen-
dous success, the reasons behind the good generalization properties of these methods to unseen data
is not fully understood (and, arguably, remains somewhat of a mystery to this day). Initially, this
success was mostly attributed to the special deep architecture of these models. However, in the past
few years, it has been widely noted that the architecture is only part of the story, and, in fact, the
optimization algorithms used to train these models, typically stochastic gradient descent (SGD) and
its variants, play a key role in learning parameters that generalize well.
In particular, it has been observed that since these deep models are highly over-parameterized, they
have a lot of capacity, and can fit to virtually any (even random) set of data points (Zhang et al.,
2016). In other words, highly over-parameterized models can “interpolate” the data, so much so that
this regime has been called the “interpolating regime” (Ma et al., 2018). In fact, on a given dataset,
the loss function often has (uncountably infinitely) many global minima, which can have drastically
different generalization properties, and it is not hard to construct “trivial” global minima that do
not generalize. Which minimum among all the possible minima we pick in practice is determined
by the optimization algorithm that we use for training the model. Even though it may seem at first
that, because of the non-convexity of the loss function, the stochastic descent algorithms may get
stuck in local minima or saddle points, in practice they almost always achieve a global minimum
(Kawaguchi, 2016; Zhang et al., 2016; Lee et al., 2016), which perhaps can also be justified by the
fact that these models are highly over-parameterized. What is even more interesting is that not only
1
Published as a conference paper at ICLR 2019
do these stochastic descent algorithms converge to global minima, but they converge to “special”
ones that generalize well, even in the absence of any explicit regularization or early stopping (Zhang
et al., 2016). Furthermore, it has been observed that even among the common optimization algo-
rithms, namely SGD or its variants (AdaGrad (Duchi et al., 2011), RMSProp (Tieleman & Hinton,
2012), Adam (Kingma & Ba, 2014), etc.), there is a discrepancy in the solutions achieved by differ-
ent algorithms and their generalization capabilities (Wilson et al., 2017), which again highlights the
important role of the optimization algorithm in generalization.
There have been many attempts in recent years to explain the behavior and properties of these
stochastic optimization algorithms, and many interesting insights have been obtained (Achille &
Soatto, 2017; Chaudhari & Soatto, 2018; Shwartz-Ziv & Tishby, 2017; Soltanolkotabi et al., 2017).
In particular, it has been argued that the optimization algorithms perform an implicit regulariza-
tion (Neyshabur et al., 2017; Ma et al., 2017; Gunasekar et al., 2017; 2018a; Soudry et al., 2017;
Gunasekar et al., 2018b) while optimizing the loss function, which is perhaps why the solution gen-
eralizes well. Despite this recent progress, most results explaining the behavior of the optimization
algorithm, even for SGD, are limited to linear or very simplistic models. Therefore, a general char-
acterization of the behavior of stochastic descent algorithms for more general models would be of
great interest.
1.1	Our Contribution
In this paper, we present an alternative explanation of the behavior of SGD, and more generally, the
stochastic mirror descent (SMD) family of algorithms, which includes SGD as a special case. We
do so by obtaining a fundamental identity for such algorithms (see Lemmas 2 and 5). Using these
identities, we show that for general nonlinear models and general loss functions, when the step size
is sufficiently small, SMD (and therefore also SGD) is the optimal solution of a certain minimax
filtering (or online learning) problem. The minimax formulation is inspired by, and rooted, in H∞
filtering theory, which was originally developed in the 1990’s in the context of robust control the-
ory (Hassibi et al., 1999; Simon, 2006; Hassibi et al., 1996), and we generalize several results from
this literature, e.g., (Hassibi et al., 1994; Kivinen et al., 2006). Furthermore, we show that many
properties recently proven in the learning/optimization literature, such as the implicit regulariza-
tion of SMD in the over-parameterized linear case—when convergence happens—(Gunasekar et al.,
2018a), naturally follow from this theory. The theory also allows us to establish new results, such
as the convergence (in a deterministic sense) of SMD in the over-parameterized linear case. We also
use the theory developed in this paper to provide some speculative arguments into why SMD (and
SGD) may have similar convergence and implicit regularization properties in the so-called “highly
over-parameterized” nonlinear setting (where the number of parameters far exceeds the number of
data points) common to deep learning.
In an attempt to make the paper easier to follow, we first describe the main ideas and results in a
simpler setting, namely, SGD on the square loss of linear models, in Section 3, and mention the
connections to H ∞ theory. The full results, for SMD on a general class of loss functions and for
general nonlinear models, are presented in Section 4. We demonstrate some implications of this
theory, such as deterministic convergence and implicit regularization, in Section 5, and we finally
conclude with some remarks in Section 6. Most of the formal proofs are relegated to the appendix.
2	Preliminaries
Denote the training dataset by {(xi, yi) : i = 1, . . . , n}, where xi ∈ Rd are the inputs, and yi ∈ R
are the labels. We assume that the data is generated through a (possibly nonlinear) model fi (w) =
f (xi , w) with some parameter vector w ∈ Rm, plus some noise vi, i.e., yi = f (xi , w) + vi for
i = 1, . . . , n. The noise can be due to actual measurement error, or it can be due to modeling error
(if the model f (xi, ∙) is not rich enough to fully represent the data), or it can be a combination of
both. As a result, we do not make any assumptions on the noise (such as stationarity, whiteness,
Gaussianity, etc.).
Since typical deep models have a lot of capacity and are highly over-parameterized, we are particu-
larly interested in the over-parameterized (so-caled interpolating) regime, i.e., when m > n. In this
case, there are many parameter vectors w (in fact, uncountably infinitely many) that are consistent
2
Published as a conference paper at ICLR 2019
with the observations. We denote the set of these parameter vectors by
W = {w ∈ Rm | yi = f (xi, w), i = 1, . . . ,n} .	(1)
(Note the absence of the noise term, since in this regime we can fully interpolate the data.) The set
W is typically an (m - n)-dimensional manifold and depends only on the training data {(xi, yi) :
i = 1,...,n} and nonlinear model f (∙, ∙).
The total loss on the training set (empirical risk) can be denoted by L(w) = Pin=1 Li(w), where
Li(∙) is the loss on the individual data point i. We assume that the loss Li(∙) depends only on the
residual, i.e., the difference between the prediction and the true label. In other words,
Li(w) = l(yi - f(xi, w)),	(2)
where l(∙) can be any nonnegative differentiable function with l(0) = 0. Typical examples of l(∙)
include square (l2) loss, Huber loss, etc. We remark that, in the interpolating regime, every parameter
vector in the set W renders each individual loss zero, i.e., Li(w) = 0, for all w ∈ W.
3	Warm-up: Revisiting SGD on S quare Loss of Linear Models
In this section, we describe the main ideas and results in a simple setting, i.e., stochastic gradient
descent (SGD) for the square loss of a linear model, and we revisit some of the results from H∞
theory (Hassibi et al., 1999; Simon, 2006). In this case, the data model is yi = xiTw + vi, i =
1,...,n (where there is no assumption on Vi) and the loss function is Li(W) = 2 (yi - XT w)1 2.
Assuming the data is indexed randomly, the SGD updates are defined as Wi = Wi-1 — nVLi (w—),
where η> 0 is the step size or learning rate.1 The update in this case can be expressed as
Wi = Wi-1 + η yi - xiT Wi-1 xi ,	(3)
for i ≥ 1 (for i > n, we can either cycle through the data, or select them at random).
Remark. We should point out that, when the step size ηis fixed, the SGD recursions have no
hope of converging, unless there exists a weight vector W which perfectly interpolates the data
{(xi, yi) : i = 1, . . . , n}. The reason being that, if this is not the case, for any estimated weight
vector in SGD there will exist at least one data point that has a nonzero instantaneous gradient and
that will therefore move the estimate by a non-vanishing amount.2 It is for this reason that the results
on the convergence of SGD and SMD (Sections 3.3 and 5) pertain to the interpolating regime.
3.1	Conservation of Uncertainty
Prior to the i-th step of any optimization algorithm, we have two sources of uncertainty: our un-
certainty about the unknown parameter vector W, which we can represent by W - Wi-1, and our
uncertainty about the i-th data point (xi, yi), which we can represent by the noise vi. After the i-th
step, the uncertainty about W is transformed to W - Wi . But what about the uncertainty in vi ? What
is it transformed to? In fact, we will view any optimization algorithm as one which redistributes the
uncertainties at time i - 1 to new uncertainties at time i. The two uncertainties, or error terms, we
will consider are ei and ep,i, defined as follows.
ei := yi - xiTWi-1, and ep,i := xiTW - xiTWi-1.	(4)
ei is often referred to as the innvovations and is the error in predicting yi, given the input xi. ep,i
is sometimes called the prediction error, since it is the error in predicting the noiseless output xiT W,
i.e., in predicting what the best output of the model is. In the absence of noise, ei and ep,i coincide.
One can show that SGD transforms the uncertainties in the fashion specified by the following lemma,
which was first noted in (Hassibi et al., 1996).
1For the sake of simplicity of presentation, we present the results for constant step size. We show in the
appendix that all the results extend to the case of time-varying step-size.
2Of course, one may get convergence by having a vanishing step size ηi → 0. However, in this case,
convergence is not surprising—since, effectively, after a while the weights are no longer being updated—and
the more interesting question is “what” the recursion converges to.
3
Published as a conference paper at ICLR 2019
Figure 1: Illustration of Lemma 1. Each step of SGD can be viewed as a transformation of the
uncertainties with the right coefficients.
W — Wi
÷√r∕(l -77∣∣aji∣∣2)βj
÷ Sep#
Lemma 1. For any parameter w and noise values {vi} that satisfy yi = xiTw + vi for i = 1, . . . , n,
and for any step size η > 0, the following relation holds for the SGD iterates {wi} given in Eq. (3)
∣∣w - wi-1k2 +	ηv2	= ∣∣w - Wik2 + η	(1	- nlEk2) e2 +	ηep,i,	∀i	≥	1.	(5)
As illustrated in Figure 1, this means that each step of SGD can be thought of as a lossless transfor-
mation of the input uncertainties to the output uncertainties, with the specified coefficients.
Once one knows this result, proving it is straightforward. To see that, note that we can write vi =
yi - xTw as Vi = (yi — xτWi-ι) — (XTW — XTWi-ι). Multiplying both sides by √η, We have
√ηvi = √η(yi - XT Wi-ι) — √η(χT W - xT Wi-1).	(6)
On the other hand, subtracting both sides of the update rule (3) from W yields
W - Wi = (W - Wi-1) - η yi - xiT Wi-1 xi.	(7)
Squaring both sides of (6) and (7), and subtracting the results leads to Equation (5).
A nice property of Equation (5) is that, if We sum over all i = 1, . . . , T, the terms ∣W - Wi ∣2 and
∣W - Wi-1 ∣2 on different sides cancel out telescopically, leading to the folloWing important lemma.
Lemma 2. For any parameter W and noise values {vi} that satisfy yi = xiTW + vi for i = 1, . . . , n,
any initialization W0, any step size η > 0, and any number of steps T ≥ 1, the following relation
holds for the SGD iterates {Wi } given in Eq. (3)
T
∣W - W0∣2 + ηXvi2 =
i=1
kw - WT k2 + n£ (1 -ηkχik2) e2 + ηfep,i∙
i=1	i=1
(8)
As We Will shoW next, this identity captures most properties of SGD, and implies several important
results in a very transparent fashion. For this reason, this relation can be vieWed as a “fundamental
identity” for SGD.
3.2	Minimax Optimality of SGD
For a given horizon T , consider the folloWing minimax problem:
min max
{wi} w,{vi}
∣w - WT『+ η PT=I ep,i
kW - Wok2 + η PT=I v2
(9)
This minimax problem is motivated by the theory of H∞ control and estimation (Francis, 1987; Has-
Sibi et al., 1999; BaSar & Bernhard, 2008). The denominator of the cost function can be interpreted
as the energy of the uncertainties and consists of tWo terms, ∣W - W0 ∣2, the energy of our uncer-
tainty of the unknoWn Weight vector at the beginning of learning When We have not yet observed
the data, and PiT=1 vi2, the energy of the uncertainty in the measurements. The numerator denotes
the energy of the estimation errors in an online setting. The first term, ∣W - WT ∣2, is the energy of
our uncertainty of the unknoWn Weight vector after We have observed T data points, and the second
term, PiT=1 e2p,i = PiT=1(xiTW - xiTWi-1)2, is the energy of the prediction error, i.e., hoW Well We
can predict the true uncorrupted output xiTW using measurements up to time i - 1. The parameter
4
Published as a conference paper at ICLR 2019
η weighs the two energy terms relative to each other. In this minimax problem, nature has access
to the unknown weight vector w and the noise sequence vi and would like to maximize the energy
gain from the uncertainties to prediction errors (so that the estimator behaves poorly), whereas the
estimator attempts to minimize the energy gain. Such an estimator is referred to as H∞-optimal and
is robust because it safeguards against the worst-case noise. It is also conservative—for the exact
3
same reason.3
Theorem 3. For any initialization w°, any step size 0 < η ≤ mini WF，and any number of steps
T ≥ 1, the stochastic gradient descent iterates {wi} given in Eq. (3) are the optimal solution to the
minimax problem (9). Furthermore, the optimal minimax value (achieved by SGD) is 1.
This theorem explains the observed robustness and conservatism of SGD. Despite the conservative-
ness of safeguarding against the worst-case disturbance, this choice may actually be the rational
thing to do in situations where we do not have much knowledge about the disturbances, which is the
case in many machine learning tasks.
Theorem 3 holds for any horizon T ≥ 1. A variation of this result, i.e., when T → ∞ and without
the kw - wT k2 term in the numerator, was first shown in (Hassibi et al., 1994; 1996). In that case,
η P∞ e2 i
the ratio 口仅-仅#2+； P,∞ 虱2 in the minimax problem is in fact the H∞ norm of the transfer operator
that maps the unknown disturbances (W - wo, {√ηvi}) to the prediction errors {√ηep,i}.
We end this section with a stochastic interpretation of SGD (Hassibi et al., 1996). Assume that the
true weight vector has a normal distribution with mean w0 and covariance matrix ηI , and that the
noise vi are iid standard normal. Then SGD solves
min E exp
{wi}
T
- wTk2 + η	(xiT w -
i=1
xiTwi-1)2
(10)
and no exponent larger than 2 is possible, in the sense that no estimator can keep the expected cost
finite. This means that, in the Gaussian setting, SGD minimizes the expected value ofan exponential
quadratic cost. The algorithm is thus very adverse to large estimation errors, as they are penalized
exponentially larger than moderate ones.
3.3	Convergence and Implicit Regularization
The over-parameterized (interpolating) linear regression regime is a simple but instructive setting,
recently considered in some papers (Gunasekar et al., 2018a; Zhang et al., 2016). In this setting,
We can show that, for sufficiently small step, i.e. 0 < n ≤ mini ∣∣ 1∣∣2, SGD always converges to
kxik
a special solution among all the solutions W, in particular to the one with the smallest l2 distance
from w0 . In other words, if, for example, initialized at zero, SGD implicitly regularizes the solution
according to an l2 norm. This result follows directly from Lemma 2.
To see that, note that in the interpolating case the vi are zero, and we have ei = yi - xiT wi-1 =
xiTw - xiT wi-1 = ep,i. Hence, identity (8) reduces to
T
kw - wok2 = Ilw - WT Il2 + η X(2-ηkxik2) e2,	(II)
i=1
for all w ∈ W. By dropping the Iw - wT I2 term and taking T → ∞, we have
ηP∞=ι(2 - η∣∣xik2) e ≤ ∣∣w - wok2, which implies that, for 0 < n < mini ^2p, we must
have ei → 0 as i → ∞. When ei = yi - xiT wi-1 goes to zero, the updates in (3) vanish and we
get convergence, i.e., w → w∞ . Further, again because ei → 0, all the data points are being fit,
which means w∞ ∈ W. Moreover, it is again very straightforward to see from (11) that the solution
converged to is the one with minimum Euclidean norm from the initial point. To see that, notice that
3The setting described is somewhat similar to the setting of online learning, where one considers the relative
performance of an online learner who needs to predict, compared to a clairvoyant one who has access to the
entire data set (Shalev-Shwartz, 2012; Hazan, 2016). In online learning, the relative performance is described
as a difference, rather than as a ratio in H∞ theory, and is referred to as regret.
5
Published as a conference paper at ICLR 2019
the summation term in Eq. (11) is independent of w (it depends only on xi , yi and w0). Therefore,
by taking T → ∞ and minimizing both sides with respect to w ∈ W, we get
w∞ = arg min kw - w0k.	(12)
w∈W
Once again, this also implies that if SGD is initialized at the origin, i.e., w0 = 0, then it converges
to the minimum-l2-norm solution, among all the solutions.
4	Main Result: General Characterization of Stochastic Mirror
Descent
Stochastic Mirror Descent (SMD) (Nemirovskii et al., 1983; Beck & Teboulle, 2003; Cesa-Bianchi
et al., 2012; Zhou et al., 2017) is one of the most widely used families of algorithms for stochastic
optimization, which includes SGD as a special case. In this section, we provide a characterization
of the behavior of general SMD, on general loss functions and general nonlinear models, in terms
of a fundamental identity and minimax optimality.
For any strictly convex and differentiable potential ψ(∙),the corresponding SMD updates are defined
as
Wi = arg min ηwTVLi(wi-i) + Dψ (w,wi-i),	(13)
w
where
Dψ(w,Wi-i) = ψ(w) - ψ(wi-i) - Vψ(wi-i)T(W - Wi-1)	(14)
is the Bregman divergence with respect to the potential function ψ(∙). Note that Dψ(∙, ∙) is non-
negative, convex in its first argument, and that, due to strict convexity, Dψ(W, W0) = 0 iff W = W0.
Moreover, the updates can be equivalently written as
Vψ(Wi) = Vψ(Wi-1) - ηVLi(Wi-1),	(15)
which are uniquely defined because of the invertibility of Vψ (again, implied by the strict convexity
of ψ(∙)). In other words, stochastic mirror descent can be thought of as transforming the variable
w, with a mirror map Vψ(∙), and performing the SGD update on the new variable. For this reason,
Vψ(W) is often referred to as the dual variable, while W is the primal variable.
Different choices of the potential function ψ(∙) yield different optimization algorithms, which, as
we will see, result in different implicit regularizations. To name a few examples: For the potential
function ψ(w) = 1111 w k2 ,the Bregman divergence is Dψ (w,w0) = 2 ∣∣w - w0∖∖2, and the update rule
reduces to that of SGD. For ψ(W) = Pj Wj log Wj, the Bregman divergence becomes the unnormal-
ized relative entropy (Kullback-Leibler divergence) Dψ (w,w0) = Pj Wjlog 等 -Pj Wj + Pj Wj,
which corresponds to the exponentiated gradient descent (aka the exponential weights) algorithm.
Other examples include Ψ(w) = ɪIlWIlQ = 1WTQW for a positive definite matrix Q, which yields
Dψ (w,w0) = 2(W-WZ)TQ(w-w0), andthe q-norm squared Ψ(w) = 2 ∣∣w∣2, which with P + q = 1
yields the p-norm algorithms (Grove et al., 2001; Gentile, 2003).
In order to derive an equivalent “conservation law” for SMD, similar to the identity (5), we first need
to define anew measure for the difference between the parameter vectors W and W 0 according to the
loss function Li(∙). To that end, let us define
DLi (W, W 0) := Li(W) - Li(W0) - VLi(W0)T (W - W0),	(16)
which is defined in a similar way to a Bregman divergence for the loss function.4 The difference
though is that, unlike the potential function of the Bregman divergence, the loss function Li(∙)=
'(yi - f (xi, ∙)) need not be convex, even when '(∙) is, due to the nonlinearity of f (∙, ∙). Asa result,
DLi (W, W0) is not necessarily non-negative. The following result, which is the general counterpart
of Lemma 1, states the identity that characterizes SMD updates in the general setting.
Lemma 4. For any (nonlinear) model f (∙, ∙), any differentiable loss l(∙), any parameter W and noise
values {vi} that satisfy yi = f(xi, W) + vi for i = 1, . . . , n, and any step size η > 0, the following
relation holds for the SMD iterates {Wi} given in Eq. (15)
Dψ(W, Wi-1) + ηl(vi) = Dψ (W, Wi) + Ei(Wi, Wi-1) + ηDLi (W, Wi-1),	(17)
4It is easy to verify that for linear models and quadratic loss we obtain DLi (w, w0) = (xiT w - xiT w0)2 .
6
Published as a conference paper at ICLR 2019
for all i ≥ 1, where
Ei(wi,wi-1) := Dψ(wi,wi-1) - ηDLi(wi,wi-1) + ηLi(wi).	(18)
The proof is provided in Appendix A. Note that Ei(wi, wi-1) is not a function of w. Furthermore,
even though it does not have to be nonnegative in general, for η sufficiently small, it becomes
nonnegative, because the Bregman divergence Dψ (., .) is nonnegative.
Summing Equation (17) over all i = 1, . . . , T leads to the following identity, which is the general
counterpart of Lemma 2.
Lemma 5. For any (nonlinear) model f (∙, ∙), any differentiable loss l(∙), any parameter W and
noise values {vi} that satisfy yi = f(xi, w) + vi for i = 1, . . . , n, any initialization w0, any step
size η > 0, and any number of steps T ≥ 1, the following relation holds for the SMD iterates {wi}
given in Eq. (15)
TT
Dψ(w, w0) + η	l(vi) = Dψ(w,wT) +	(Ei(wi,wi-1) + ηDLi (w, wi-1)) .	(19)
We should reiterate that Lemma 5 is a fundamental property of SMD, which allows one to prove
many important results, in a direct way.
In particular, in this setting, we can show that SMD is minimax optimal in a manner that generalizes
Theorem 3 of Section 3, in the following 3 ways: 1) General potential ψ(∙),2) General model f (∙, ∙),
and 3) General loss function l(∙). The result is as follows.
Theorem 6. Consider any (nonlinear) model f (∙, ∙), any non-negative differentiable loss l(∙) with
the property l(0) = l0 (0) = 0, and any initialization w0. For sufficiently small step size, i.e., for any
η > 0for which ψ(w) - ηLi(w) is convex for all i, and for any number of steps T ≥ 1, the SMD
iterates {wi} given by Eq. (15), w.r.t. any strictly convex potential ψ(∙), is the optimal solution to
the following minimization problem
Dψ(w,wT) + η PiT=1 DLi (w, wi-1)
mm max   --------------i=1 T----------
{wi} w,{vi}	Dψ(w, w0) + η i=1 l(vi)
(20)
Furthermore, the optimal value (achieved by SMD) is 1.
The proof is provided in Appendix B. For the case of square loss and a linear model, the result
reduces to the following form.
Corollary 7. For Li(W) = ɪ(y% 一 xτw)2, for any initialization w°, any sufficiently small step size,
i.e., 0 < η ≤ 口方;产,and any number ofsteps T ≥ 1, the SMD iterates {wi} given by Eq. (15), w.r.t.
any α-StrOngIy convex potential ψ(∙), is the optimal solution to
min max
Dψ (W,wτ) + 2 PT=I ep,i
{wi} WNvi} Dψ (w,wo) + 2
PiT=1 vi2
(21)
The optimal value (achieved by SMD) is 1.
We should remark that Theorem 6 and Corollary 7 generalize several known results in the literature.
In particular, as mentioned in Section 3, the result of (Hassibi et al., 1994) is a special case of Corol-
lary 7 for ψ(w) = ɪ∣∣w∣∣2. Furthermore, our result generalizes the result of (Kivinen et al., 2006),
which is the special case for the p-norm algorithms, again, with square loss and a linear model. An-
other interesting connection to the literature is that it was shown in (Hassibi & Kailath, 1995) that
SGD is locally minimax optimal, with respect to the H∞ norm. Strictly speaking, our result is not
a generalization of that result; however, Theorem 6 can be interpreted as SGD/SMD being globally
minimax optimal, but with respect to different metrics in the numerator and denominator. Namely,
the uncertainty about the weight vector w is measured by the Bregman divergence of the potential,
the uncertainty about the noise by the loss, and the prediction error by the “Bregman-divergence-
like” expression of the loss.
7
Published as a conference paper at ICLR 2019
5	Convergence and Implicit Regularization in
Over-Parameterized Models
In this section, we show some of the implications of the theory developed in the previous section.
In particular, we show convergence and implicit regularization, in the over-parameterized (so-called
interpolating) regime5, for general SMD algorithms. We first consider the linear interpolating case,
which has been studied in the literature, and show that the known results follow naturally from
our Lemma 5. Further, we shall obtain some new convergence results. Finally, we discuss the
implications for nonlinear models, and argue that the same results hold qualitatively in highly-
overparameterized settings, which is the typical scenario in deep learning.
5.1	Over-Parameterized Linear Models
In this setting, the vi are zero, W = w | yi = xiT w, i = 1, . . . , n , and Li (w) = l(yi - xiT w),
with any differentiable loss l(∙). Therefore, Eq.(19) reduces to
T
Dψ(w, w0) = Dψ(w,wT) +	(Ei(wi,wi-1) + ηDLi (w, wi-1)) ,	(22)
i=1
for all w ∈ W, where
DLi(w,Wi-ι) = Li(W)- Li(wi-ι) - VLi(wi-ι)T(W - Wi-i)	(23)
= 0 - l(yi - xiTwi-1) + l0 (yi - xiTwi-1)xiT (w - wi-1)	(24)
= -l(yi - xiTWi-1) + l0(yi - xiTWi-1)(yi - xiTWi-1)	(25)
which is notably independent of W. As a result, we can easily minimize both sides of Eq. (22) with
respect to W ∈ W, which for T → ∞ leads to the following result.
Proposition 8. For any differentiable loss l(∙), any initialization wo, and any step size η, consider
the SMD iterates given in Eq. (15) with respect to any strictly convex potential ψ(∙). Ifthe iterates
converge to a solution W∞ ∈ W, then
W∞ = arg min Dψ (W, W0).	(26)
w∈W
Remark. In particular, for the initialization W0 = arg minw∈Rm ψ(W), if the iterates converge to a
solution W∞ ∈ W, then
W∞ = arg min ψ(W).	(27)
w∈W
An equivalent form of Proposition 8 has been shown recently in, e.g., (Gunasekar et al., 2018a).6
Other implicit regularization results have been shown in (Gunasekar et al., 2018b; Soudry et al.,
2017) for classification problems, which are not discussed here. Note that the result of (Gunasekar
et al., 2018a) does not say anything about whether the algorithm converges or not. However, our
fundamental identity of SMD (Lemma 5) allows us to also establish convergence to the regularized
point, for some common cases, which will be shown next.
What Proposition 8 says is that depending on the choice of the potential function ψ(∙), the opti-
mization algorithm can perform an implicit regularization without any explicit regularization term.
In other words, for any desired regularizer, if one chooses a potential function that approximates
the regularizer, we can run the optimization without explicit regularization, and if it converges to a
solution, the solution must be the one with the minimum potential.
In principle, one can choose the potential function in SMD for any desired convex regularization.
For example, we can find the maximum entropy solution by taking the potential to be the negative
entropy. Another illustrative example follows.
5In the classical under-parameterized (online streaming) case with white noise, the same theory can be used
to establish convergence to the true parameter under the so-called Robbins-Monro conditions (P∞=ι η =
∞, Pi∞=1 ηi2 < ∞) in a very direct and simple way (see Azizan & Hassibi (2019)).
6To be precise, the authors in (Gunasekar et al., 2018a) assume convergence to a global minimizer of the
loss function L(W) = pi=ι l(yi — XT w), which with their assumption of the loss function l(∙) having a unique
finite root is equivalent to assuming convergence to a point w∞ ∈ W.
8
Published as a conference paper at ICLR 2019
Example [Compressed Sensing]: In compressed sensing, one seeks the sparsest solution to an
under-determined (over-parameterized) system of linear equations. The surrogate convex problem
one solves is:
min kwk1
subject to yi = xiT w, i = 1, . . . n
(28)
One cannot choose ψ(w) = kwk1, since it is neither differentiable nor strictly convex. However,
ψ(w) = kwk1+, for any > 0, can be used. Figure 4 shows a compressed sensing example,
with n = 50, m = 100, and sparsity k = 10. SMD was used with a step size of η = 0.001 and
the potential function was ψ(∙) = ∣∣ ∙ ∣∣1.1. SMD converged to the true sparse solution after around
10,000 iterations. On this example, it was an order of magnitude faster than standard l1 optimization.
Figure 2: The training loss and actual error of stochastic mirror descent for compressed sensing.
SMD recovers the actual sparse signal.
Next we establish convergence to the regularized point for the convex case.
Proposition 9. Consider the following two cases.
(i)	l(∙) is differentiable and convex and has a unique root at 0, ψ(∙) is strictly convex, and
η > 0 is such that ψ - ηLi is convex for all i.
(ii)	l(∙) is differentiable and quasi-convex, l0(∙) is zero only at zero, ψ(∙) is ɑ-Strongly convex,
and 0 < η ≤ mini	噂-% WT-1|.
i	kxik2|l0(yi-xiTwi-1)|
If either (i) or (ii) holds, then for any w0, the SMD iterates given in Eq. (15) converge to
w∞ = arg min Dψ(w, w0).	(29)
w∈W
The proof is provided in Appendix C.
5.2	Discussion of Highly Over-Parameterized Nonlinear Models
Let us consider the highly-overparameterized nonlinear model
yi = f(xi, w), i = 1, . . . , n, w ∈ Rm	(30)
where by highly-overparameterized we mean m n. Since the model is highly over-parameterized,
it is assumed that we can perfectly interpolate the data points (xi, yi) so that the noise vi is zero. In
this case, the set of parameter vectors that interpolate the data is given by W = {w ∈ Rm | yi =
f(xi, w), i = 1, . . . , n}, and Eq. (19), again, reduces to
T
Dψ(w, w0) = Dψ(w, wT) +	(Ei(wi, wi-1) + ηDLi (w, wi-1)) ,	(31)
i=1
9
Published as a conference paper at ICLR 2019
for all w ∈ W. Our proofs of convergence and implicit regularization for SGD and SMD in the linear
case relied on two facts: (i) DLi (w, wi-1) was non-negative (this allowed us to show convergence),
and (ii) DLi (w, wi-1) was independent of w (this allowed us to show implicit regularization). Un-
fortunately, neither of these hold in the nonlinear case.
However, they do hold in a local sense. In other words, (i) DLi (w, wi-1) ≥ 0 for wi-1 “close
enough” to w (see Figure 3), and (ii) DLi (w, wi-1) is weakly dependent on w for wi-1 “close
enough.” (Both statements can be made precise.)
Figure 3: Non-negativity of DLi (w, wi-1) for wi-1 “close enough” to w.
Now define
w* = arg min Dψ(w, wo).	(32)
w∈W
Then one can show the following result.
Theorem 10. There exists an > 0, such that if kw* - w0 k < , then for sufficiently small step size
η > 0:
1.	SMD iterates converge to a point w∞ ∈ W
2.	kw∞ - w* k = o()
This shows that if the initial condition is close enough, then we have convergence to a point w∞ that
interpolates the data, and that w∞ is an order of magnitude closer to w* (the implicitly regularized
solution) than the initial w0 was. At first glance, this result seems rather dissatisfying. It relies on
w0 being close to the manifold W which appears hard to guarantee. We would now like to argue
that in deep learning w0 being close to W is often the case.
In the highly-overparameterized regime, m n, and so the dimension of the manifold W is m - n,
which is very large. Now if the xi are sufficiently random, then the tangent space to W at w*
will be a randomly oriented affine subspace of dimension m - n. This means that any randomly
chosen w0 will whp have a very large component when projected onto W . In particular, it can
be shown that ∣∣w* — wok2 = O(m) ∙ ∣∣y — f(x,w)k2, where y = vec(yi,i = 1,…，n) and
f(x, w) = vec(f (xi, w), i = 1, . . . , n). Thus, we may expect that, when m n, the distance
of any randomly chosen wo to W will be small and so SMD will converge to a point on W that
approximately performs implicit regularization.
The gist of the argument is that (i) When m n, any random initial condition is “close” to the
n - m dimensional solution manifold W, (ii) when wo is “close” to w*, then SMD converges to a
point w∞ ∈ W, (iii) w∞ is “an order of magnitude closer” to w* than wo was, and (iv) thus, when
highly overparamatrized, SMD converges to a point that exhibits implicit regularization.
Of course, this was a very heuristic argument that merits a much more careful analysis. But it is
suggestive of the fact that SGD and SMD, when performed on highly-overparameterized nonlinear
models, as occurs in deep learning, may exhibit implicit regularization.
6 Concluding Remarks
We should remark that all the results stated throughout the paper extend to the case of time-varying
step size ηi , with minimal modification. In particular, it is easy to show that in this case, the identity
(the counterpart of Eq. (19)) becomes
TT
Dψ(w,wo) +	ηil(vi) = Dψ(w,wT) +	(Ei(wi,wi-1) + ηiDLi(w,wi-1)) ,	(33)
i=1	i=1
10
Published as a conference paper at ICLR 2019
where Ei(wi, wi-1) = Dψ(wi, wi-1) - ηiDLi (wi, wi-1) + ηiLi(wi). As a consequence, our main
result will be the same as in Theorem 6, with the only difference that the small-step-size condition
in this case is the convexity of ψ(w) - ηiLi (w) for all i, and the SMD with time-varying step size
will be the optimal solution to the following minimax problem
min max
{wi} w,{vi}
Dψ (w,wτ) + PT=I ηiD% (w,wi-ι)
Dψ (w, w0) + PiT=1 ηil(vi)
(34)
Similarly, the convergence and implicit regularization results can be proven under the same condi-
tions (See Appendix D for more details on the time-varying case).
This paper opens up a variety of important directions for future work. Most of the analysis devel-
oped here is general, in terms of the model, the loss function, and the potential function. Therefore,
it would be interesting to study the implications of this theory for specific classes of models (such
as different neural networks), specific losses, and specific mirror maps (which induce different reg-
ularization biases). Something for future work.
Acknowledgments
This work was supported in part by the National Science Foundation under grants CCF-1423663,
CCF-1409204 and ECCS-1509977, by a grant from Qualcomm Inc., by NASA’s Jet Propulsion
Laboratory through the President and Director’s Fund, and by Amazon Web Services Inc. and
PIMCO LLC through fellowships.
References
Alessandro Achille and Stefano Soatto. On the emergence of invariance and disentangling in deep
representations. arXiv preprint arXiv:1706.01350, 2017.
Navid Azizan and Babak Hassibi. A characterization of stochastic mirror descent algorithms and
their convergence properties. In IEEE International Conference on Acoustics, Speech and Signal
Processing, 2019.
Tamer BaSar and Pierre Bernhard. H-infinity optimal Control and related minimax design problems:
a dynamic game approach. Springer Science & Business Media, 2008.
Amir Beck and Marc Teboulle. Mirror descent and nonlinear projected subgradient methods for
convex optimization. Operations Research Letters, 31(3):167-175, 2003.
Nicolo Cesa-Bianchi, Pierre Gaillard, Gabor Lugosi, and Gilles Stoltz. Mirror descent meets fixed
share (and feels no regret). In Advances in Neural Information Processing Systems, pp. 980-988,
2012.
Pratik Chaudhari and Stefano Soatto. Stochastic gradient descent performs variational inference,
converges to limit cycles for deep networks. In International Conference on Learning Represen-
tations, 2018.
John Duchi, Elad Hazan, and Yoram Singer. Adaptive subgradient methods for online learning and
stochastic optimization. Journal of Machine Learning Research, 12(Jul):2121-2159, 2011.
Bruce A Francis. A course in H-infinity control theory. Berlin; New York: Springer-Verlag, 1987.
Claudio Gentile. The robustness of the p-norm algorithms. Machine Learning, 53(3):265-299,
2003.
Adam J Grove, Nick Littlestone, and Dale Schuurmans. General convergence results for linear
discriminant updates. Machine Learning, 43(3):173-210, 2001.
Suriya Gunasekar, Blake E Woodworth, Srinadh Bhojanapalli, Behnam Neyshabur, and Nati Srebro.
Implicit regularization in matrix factorization. In Advances in Neural Information Processing
Systems, pp. 6152-6160, 2017.
11
Published as a conference paper at ICLR 2019
Suriya Gunasekar, Jason Lee, Daniel Soudry, and Nathan Srebro. Characterizing implicit bias in
terms of optimization geometry. arXiv preprint arXiv:1802.08246, 2018a.
Suriya Gunasekar, Jason Lee, Daniel Soudry, and Nathan Srebro. Implicit bias of gradient descent
on linear convolutional networks. arXiv preprint arXiv:1806.00468, 2018b.
Babak Hassibi and Thomas Kailath. Hoo optimal training algorithms and their relation to backprop-
agation. In Advances in Neural Information Processing Systems 7, pp. 191-198. 1995.
Babak Hassibi, Ali H. Sayed, and Thomas Kailath. Hoo optimality criteria for LMS and backprop-
agation. In Advances in Neural Information Processing Systems 6, pp. 351-358. 1994.
Babak Hassibi, Ali H Sayed, and Thomas Kailath. Hoo optimality of the LMS algorithm. IEEE
Transactions on Signal Processing, 44(2):267-280, 1996.
Babak Hassibi, Ali H Sayed, and Thomas Kailath. Indefinite-Quadratic Estimation and Control: A
Unified Approach to H2 and H-infinity Theories, volume 16. SIAM, 1999.
Elad Hazan. Introduction to online convex optimization. Foundations and Trends in Optimization,
2(3-4):157-325, 2016. ISSN 2167-3888.
Kenji Kawaguchi. Deep learning without poor local minima. In Advances in Neural Information
Processing Systems, pp. 586-594, 2016.
Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint
arXiv:1412.6980, 2014.
Jyrki Kivinen, Manfred K Warmuth, and Babak Hassibi. The p-norm generalization of the LMS al-
gorithm for adaptive filtering. IEEE Transactions on Signal Processing, 54(5):1782-1793, 2006.
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton. Imagenet classification with deep convo-
lutional neural networks. In Advances in Neural Information Processing Systems, pp. 1097-1105,
2012.
Yann LeCun, Yoshua Bengio, and Geoffrey Hinton. Deep learning. Nature, 521(7553):436, 2015.
Jason D Lee, Max Simchowitz, Michael I Jordan, and Benjamin Recht. Gradient descent only
converges to minimizers. In Conference on Learning Theory, pp. 1246-1257, 2016.
Cong Ma, Kaizheng Wang, Yuejie Chi, and Yuxin Chen. Implicit regularization in nonconvex sta-
tistical estimation: Gradient descent converges linearly for phase retrieval, matrix completion and
blind deconvolution. arXiv preprint arXiv:1711.10467, 2017.
Siyuan Ma, Raef Bassily, and Mikhail Belkin. The power of interpolation: Understanding the effec-
tiveness of SGD in modern over-parametrized learning. In Proceedings of the 35th International
Conference on Machine Learning, volume 80, pp. 3325-3334. PMLR, 2018.
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Andrei A Rusu, Joel Veness, Marc G Belle-
mare, Alex Graves, Martin Riedmiller, Andreas K Fidjeland, Georg Ostrovski, et al. Human-level
control through deep reinforcement learning. Nature, 518(7540):529, 2015.
Arkadii Nemirovskii, David Borisovich Yudin, and Edgar Ronald Dawson. Problem complexity and
method efficiency in optimization. 1983.
Behnam Neyshabur, Ryota Tomioka, Ruslan Salakhutdinov, and Nathan Srebro. Geometry of opti-
mization and implicit regularization in deep learning. arXiv preprint arXiv:1705.03071, 2017.
Shai Shalev-Shwartz. Online learning and online convex optimization. Foundations and Trends in
Machine Learning, 4(2):107-194, 2012. ISSN 1935-8237.
Ravid Shwartz-Ziv and Naftali Tishby. Opening the black box of deep neural networks via informa-
tion. arXiv preprint arXiv:1703.00810, 2017.
12
Published as a conference paper at ICLR 2019
David Silver, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George Van Den Driessche,
Julian Schrittwieser, Ioannis Antonoglou, Veda Panneershelvam, Marc Lanctot, et al. Mastering
the game of go with deep neural networks and tree search. Nature, 529(7587):484—489, 2016.
Dan Simon. Optimal state estimation: Kalman, H infinity, and nonlinear approaches. John Wiley
& Sons, 2006.
Mahdi Soltanolkotabi, Adel Javanmard, and Jason D Lee. Theoretical insights into the optimiza-
tion landscape of over-parameterized shallow neural networks. arXiv preprint arXiv:1707.04926,
2017.
Daniel Soudry, Elad Hoffer, Mor Shpigel Nacson, Suriya Gunasekar, and Nathan Srebro. The im-
plicit bias of gradient descent on separable data. arXiv preprint arXiv:1710.10345, 2017.
Tijmen Tieleman and Geoffrey Hinton. Lecture 6.5-rmsprop: Divide the gradient by a running
average of its recent magnitude. COURSERA: Neural networks for machine learning, 4(2):26-
31, 2012.
Ashia C Wilson, Rebecca Roelofs, Mitchell Stern, Nati Srebro, and Benjamin Recht. The marginal
value of adaptive gradient methods in machine learning. In Advances in Neural Information
Processing Systems, pp. 4151-4161, 2017.
Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, et al. Google’s neural machine trans-
lation system: Bridging the gap between human and machine translation. arXiv preprint
arXiv:1609.08144, 2016.
Chiyuan Zhang, Samy Bengio, Moritz Hardt, Benjamin Recht, and Oriol Vinyals. Understanding
deep learning requires rethinking generalization. arXiv preprint arXiv:1611.03530, 2016.
Zhengyuan Zhou, Panayotis Mertikopoulos, Nicholas Bambos, Stephen Boyd, and Peter W Glynn.
Stochastic mirror descent in variationally coherent optimization problems. In Advances in Neural
Information Processing Systems, pp. 7043-7052, 2017.
13
Published as a conference paper at ICLR 2019
Supplementary Material
A Proof of Lemma 4
Proof. Let us start by expanding the Bregman divergence Dψ (w, wi) based on its definition
Dψ(w,wi) = ψ(w) - ψ(wi) - Vψ(wi)T(W - Wi).
By plugging the SMD update rule Vψ(wi) = Vψ(w%-ι) — ηVLi(wi-ι) into this, We can write it
as
Dψ(W, Wi) = ψ(W) - ψ(Wi) - Vψ(Wi-1)T(W - Wi) + ηVLi(Wi-1)T(W - Wi).	(35)
Using the definition of Bregman divergence for (W, Wi-1) and (Wi, Wi-1), i.e., Dψ(W, Wi-1) =
ψ(W) - ψ(Wi-1) - Vψ(Wi-1)T (W - Wi-1) and Dψ(Wi, Wi-1) = ψ(Wi) - ψ(Wi-1) -
Vψ(Wi-1)T (Wi - Wi-1), we can express this as
Dψ(W, Wi) = Dψ(W, Wi-1) + ψ(Wi-1) + Vψ(Wi-1)T(W - Wi-1) - ψ(Wi)
- Vψ(Wi-1)T (W - Wi) + ηVLi (Wi-1)T (W - Wi) (36)
= Dψ(W, Wi-1) + ψ(Wi-1) - ψ(Wi) + Vψ(Wi-1)T(Wi - Wi-1)
+ ηVLi(Wi-1)T(W - Wi) (37)
= Dψ(W, Wi-1) - Dψ(Wi, Wi-1) + ηVLi (Wi-1)T (W - Wi).	(38)
Expanding the last term using W - Wi = (W - Wi-1) - (Wi - Wi-1), and following the definition
of DLi (., .) from (16) for (W, Wi-1) and (Wi, Wi-1), we have
Dψ(W, Wi) = Dψ(W, Wi-1) - Dψ(Wi, Wi-1) + ηVLi (Wi-1)T (W - Wi-1)
- ηVLi(Wi-1)T(Wi - Wi-1) (39)
= Dψ(W, Wi-1) - Dψ(Wi, Wi-1) + η (Li (W) - Li(Wi-1) - DLi (W, Wi-1))
- η (Li(Wi) - Li(Wi-1) - DLi (Wi, Wi-1)) (40)
= Dψ(W, Wi-1) - Dψ(Wi,Wi-1) + η (Li(W) - DLi (W, Wi-1))
- η (Li(Wi) - DLi(Wi, Wi-1))	(41)
Defining Ei(Wi, Wi-1) := Dψ(Wi, Wi-1) - ηDLi (Wi, Wi-1) + ηLi(Wi), we can write the above
equality as
Dψ(W, Wi) = Dψ(W, Wi-1) - Ei(Wi, Wi-1) + η (Li (W) - DLi (W, Wi-1)) .	(42)
Notice that for any model class with additive noise, and any loss function Li that depends only on
the residual (i.e. the difference between the prediction and the true label), the term Li (W) depends
only on the noise term, for any “true” parameter W. In other words, for all W that satisfy yi =
f(xi, W) + vi, we have Li(W) = l(yi - f(xi, W)) = l(yi - (yi - vi)) = l(vi) . Finally, reordering
the terms leads to
Dψ(W, Wi) + ηDLi (W, Wi-1) + Ei(Wi, Wi-1) = Dψ(W, Wi-1) + ηl(vi),	(43)
which concludes the proof.	□
B Proof of Theorem 6
Proof. We prove the theorem in two parts. First, we show that the value of the minimax is at least
1. Then we prove that the values is at most 1, and is achieved by stochastic mirror descent for small
enough step size.
1.	Consider the maximization problem
max Dψ (w, WT) + η PT=I DLi(W,Wi-1
w,{vi}	Dψ (W, W0) + η PiT=1 l(vi)
14
Published as a conference paper at ICLR 2019
Clearly, the optimal solution(s) and the optimal value of this problem can, and will, be a
function of {wi }. Similarly, we can also choose feasible points that depend on {wi}. Any
choice of a feasible point (W, {Vi}) gives a lower bound on the value of the problem. Before
choosing a feasible point, let us first expand the DLi (w, wi-1) term in the numerator,
according to its definition.
DLi(W,Wi-i) = l(vi)-l(yi-fi(wi-i))+l∕(yi-fi(wi-i)Nf(wi-i)T(w-Wi-i), (44)
where we have used the fact that l(yi - fi(w)) = l(vi) for all consistent w , in the first term.
Now, we choose a feasible point as follows
Vi = fi(wi-ι) - fi(W),	(45)
where W is the choice of w, as will be described soon. The reason for choosing this value
for the noise is that it “fools” the estimator by making its loss on the corresponding data
point zero. In other words, for this choice, we have
DLi(w,Wi-ι) = I(Vi)- l(0) + l0(0)Vf(Wi-I)T(W - Wi-ι)
=I(Vi)
because l(0) = l0(0) = 0. It should be clear at this point that this choice makes the second
terms in the numerator and the denominator equal, independent of the choice of W. What
remains to do, in order to show the 1 lower-bound, is to take care of the other two terms,
i.e., Dψ (W, WT) and Dψ (W, W0). As we would like to make the ratio equal to one, we
would like to have Dψ(W, WT) = Dψ(W, W0), which is equivalent to having
ψ(W) - ψ(WT) - Vψ(WT)T (W - WT) = ψ(W) - ψ(W0) - Vψ(W0)T(W - W0)
which is, in turn, equivalent to
(Vψ(WT) - Vψ(W0))T W = -ψ(WT) + ψ(W0) + Vψ(WT)T WT - Vψ(W0)T W0. (46)
Since Vψ is an invertible function, Vψ(WT) - Vψ(W0) 6= 0, if WT 6= W0. Therefore, the
above equation has a solution for w, if WT = w0. As a result, choosing W to be a solution
to (46) makes Dψ(W, WT) = Dψ(W, wo), if WT = w0. For the case when WT = wo, it
is trivial that Dψ (W, WT) = Dψ (W, wo) for any choice of W. In this case, We only need
to choose W to be different from wo, to avoid making the ratio 0. Hence, We have the
following choice
a solution of (46)
Wo + δW for some δW 6= 0
for WT 6= Wo
for WT = Wo
(47)
Choosing the feasible point W, {vi} according to (47) and (45) leads to
Dψ (W, WT) + η PiT=1 DLi (W, Wi-1)
max ---------------- T------------
w,{vi}	Dψ(W, Wo) + η	i=1 l(Vi)
、Dψ(W,wt)+ η PT=I l(fi(wi-ι) - fi(W))
≥	. (48)
Dψ(w,wo) + η Pi=I l(fi(wi-i) - fi(W)
Taking the minimum of both sides with respect to {Wi}, we have
min max
{wi} w,{vi}
Dψ (w,wt) + η PL DLi (w,Wi-i)
Dψ(W,Wo) + η PiT=1 l(Vi)
≥ min Dψ(W,wt)+ η PT=ι l(fi(Wi-I) — fi(W)
一{Wi} Dψ (W,wo) + η PT=I l(fi(wi-i) - fi(W)
1.
(49)
The equality to 1 comes from the fact the that the optimal solution of the minimization
either has WT = wo or WT = wo, and in both cases the ratio is equal to 1.
15
Published as a conference paper at ICLR 2019
2.	Now we prove that, under the small step size condition (convexity of ψ(w) - ηLi (w) for
all i), SMD makes the minimax value at most 1, which means that it is indeed an optimal
solution. Recall from Lemma 5 that
T
TT
Dψ(w, w0) + η	l(vi) = Dψ(w, wT) +	Ei(wi, wi-1) + η	DLi (w, wi-1),
where
Ei(wi, wi-1) = Dψ (wi, wi-1) - ηDLi (wi, wi-1) + ηLi(wi).
It is easy to check that when ψ(w) - ηLi (w) is convex, Dψ (wi, wi-1) - ηDLi (wi, wi-1)
is in fact a Bregman divergence (i.e. the Bregman divergence with respect to the potential
ψ(w) - ηLi (w)), and therefore it is nonnegative for any wi and wi-1. Furthermore, we
know that the loss Li(wi) is also nonnegative for all wi. It follows that Ei(wi, wi-1) is
nonnegative for all values of wi, wi-1 and i. As a result, we have the following bound.
TT
Dψ(w, w0) + η	l(vi) ≥ Dψ(w, wT) + η	DLi (w, wi-1).	(50)
i=1	i=1
Since the Bregman divergence Dψ (w, w0) and the loss l(vi) are nonnegative, the left-hand
side expression is nonnegative, and it follows that
Dψ (w,wτ) + η PT=I DLi (w,Wi-ι) ≤ 1
Dψ(w, w0) + η PiT=1 l(vi)
(51)
In fact, this means that independent of the choice of the maximizer (i.e. for all {vi} and
w), as long as the step size condition is met, SMD makes the ratio less than or equal to 1.
Combining the results of 1 and 2 above concludes the proof.
□
B.1 Proof of Theorem 3
Proof. This result is a special case of Theorem 6, which was proven above. In this case, ψ(w) =
2∣∣w∣∣1 2, f(xi,w) = xTw, and l(z) = 1 z2. Therefore, Dψ(w, WT) = 2∣∣w — WT∣∣2, Dψ(w, w0)=
2 ∣∣w 一 wo∣2, DLi(w, Wi-I) = 1 (XTw 一XTWi-ι)2, and l(g) = ɪv2 which leads to the result. 口
C Proof of Proposition 9
Proof. To prove convergence, we appeal again to Equation (22), i.e.
T
Dψ(W, W0) = Dψ(W, WT) +	(Ei(Wi, Wi-1) + ηDLi (W, Wi-1)) ,	(52)
i=1
for all W ∈ W . We prove the two cases separately.
1. The proof of case (i) is straightforward. When l(∙) is differentiable and convex, Li is
also convex, and therefore DLi (W, Wi-1) is nonnegative. Moreover, when ψ 一 ηLi is
convex, Ei(Wi, Wi-1) is also nonnegative. Therefore, the entire summand in Eq. (52) is
nonnegative, and has to go to zero for i → ∞. That is because as T → ∞, the sum
should remain bounded, i.e., Pi∞=1 (Ei(Wi, Wi-1) + ηDLi (W, Wi-1)) ≤ Dψ(W, W0). As a
result of the non-negativity of both terms in the sum, we have both Ei(Wi, Wi-1) → 0 and
DLi (W, Wi-1) → 0 as i → ∞, the latter of which implies Li(Wi-1) → 0. This implies that
the updates in (15) vanish and we get convergence, i.e., W → W∞. Further, again because
Li(Wi-I) → 0, and 0 is the unique root of l(∙), allthe data point are being fit, which means
W∞ ∈ W.
16
Published as a conference paper at ICLR 2019
2.	To prove case (ii), note that we have
DLi(w, Wi-ι) = Li(W) - Li(Wi-1) - ^Li(wi-ι)T(W - wi-ι)	(53)
= 0 - l(yi - xiTwi-1) + l0 (yi - xiTwi-1)xiT(w - wi-1)	(54)
= -l(yi - xiTWi-1) + l0(yi - xiTWi-1)(yi - xiTWi-1),	(55)
and
Ei(Wi,Wi-1) = Dψ(Wi,Wi-1) - ηDLi (Wi, Wi-1) + ηLi(Wi)	(56)
=Dψ(wi,Wi-ι) + η (Li(wi-ι) + RLi(Wi-1)T(Wi- Wi-I))	(57)
= Dψ(Wi,Wi-1) + η l(yi - xiTWi-1) - l0(yi - xiTWi-1)xiT (Wi - Wi-1) .
(58)
It follows from (55) and (58) that the summand in Equation (52) is
Ei(Wi, Wi-1) + ηDLi (W, Wi-1) = Dψ(Wi,Wi-1) + ηl0(yi - xiTWi-1)(yi - xiTWi).
(59)
The first term is a Bregman divergence, and is therefore nonnegative. In order to establish
convergence, one needs to argue that the second term is nonnegative as well, so that the
summand goes to zero as i → ∞. Since l(∙) is increasing for positive values and decreasing
for negative values, itis enough to show that yi -xiT Wi-1 and yi -xiTWi have the same sign,
in order to establish nonnegativity. It is not hard to see that if the distance between the two
points is less than or equal to the distance of yi -xiTWi from the origin, then the signs are the
same. In other words, if |(yi-xiT Wi)-(yi-xiT Wi-1)| = |xiT (Wi-Wi-1)| ≤ |yi-xiT Wi-1|,
then the sign are the same.
Note that by the definition of α-strong convexity of ψ(∙), we have
(Rψ(Wi) - Rψ(Wi-1))T(Wi - Wi-1) ≥ αkWi - Wi-1k2,	(60)
which implies
- ηRLi(Wi-1)T (Wi - Wi-1) ≥ αkWi - Wi-1k2,	(61)
by substituting from the SMD update rule. Upper-bounding the left-hand side by
ηkRLi(Wi-1)kk(Wi - Wi-1)k implies
ηkRLi(Wi-1)k ≥ αkWi -Wi-1k.	(62)
This implies that we have the following bound
T	ηkxikkRLi(Wi-1)k
∣Xi (Wi - Wi-ι)∣ ≤ ∣∣Xik∣∣Wi - Wi-IIl ≤---------------.	(63)
α
It follows that if η ≤ kJy/Xawi-：1”, for all i, then the signs are the same, and the
summand in Eq.(52) is indeed nonnegative. This condition can be equivalently expressed as
η ≤ kJ-：- WTwi-J for all i,or η ≤ mini kxiα⅜(yχ- WTwi-J,which is the condition
in the statement of the proposition.
Now that we have argued that the summand is nonnegative, the convergence to W∞ ∈ W is
immediate. The reason is that both Dψ(Wi, Wi-1) → 0 and l0 (yi - xiT Wi-1)(yi -xiTWi) →
0, as i → ∞. The first one implies convergence to a point W∞ . The second one implies
that either yi - xiT Wi-1 = 0 or yi - xiT Wi = 0, which, in turn, implies W∞ ∈ W.
□
D Time-Varying Step-Size
The update rule for the stochastic mirror descent with time-varying step size is as follows.
Wi = arg min ηiWT RLi(Wi-1) + Dψ(W, Wi-1),	(64)
w
which can be equivalently expressed as Rψ(Wi) = Rψ(Wi-1) - ηiRLi(Wi-1), for all i. The main
results in this case are as follows.
17
Published as a conference paper at ICLR 2019
Lemma 11. For any (nonlinear) model f (∙, ∙), any differentiable loss l(∙), any parameter W and
noise values {vi} that satisfy yi = f(xi, w) + vi for i = 1, . . . , n, any initialization w0, any step
size sequence {ηi}, and any number of steps T ≥ 1, the following relation holds for the SMD
iterates {wi } given in Eq. (64)
TT
Dψ(w, w0) +	ηil(vi) = Dψ(w, wT) +	(Ei(wi,wi-1) + ηiDLi(w, wi-1)) ,	(65)
i=1	i=1
Proof. The proof is straightforward by summing the following equation for all i = 1, . . . , T
Dψ(w,wi-1) + ηil(vi) = Dψ(w,wi) + Ei(wi,wi-1) + ηiDLi (w, wi-1),	(66)
which can be easily shown in the same way as in the proof of Lemma 4 in Appendix A.	□
Theorem 12. Consider any general model f (∙, ∙), and any differentiable loss function l(∙) with
property l(0) = l0 (0) = 0. For sufficiently small step size, i.e., for any sequence {ηi} for which
ψ(w) - ηiLi(w) is convex for all i, the SMD iterates {wi} given by Eq. (64) are the optimal solution
to the following minimization problem
min max
{wi} w,{vi}
Dψ (w,wT) + PT=I ηiDL (w,Wi-ι)
Dψ (w, w0) + PiT=1 ηil(vi)
(67)
Furthermore, the optimal value (achieved by SMD) is 1.
Proof. The proof is similar to that of Theorem 6, as presented in Appendix B. The argument for the
upper-bound of 1 is exactly the same. For the second part of the proof, we use the previous Lemma.
It follows from the convexity of ψ(w) - ηiLi (w) that Ei(wi, wi-1) ≥ 0, and as a result we have
Dψ(W,wτ) + pT=ιηiDLi(w,wi-ι) ≤ ι
Dψ (w, w0) + PiT=1 ηil(vi)
for SMD updates, which concludes the proof.
(68)
□
The convergence and implicit regularization results hold similarly, and can be formally stated as
follows.
Proposition 13. Consider the following two cases.
(i)	l(∙) is differentiable and convex and has a unique root at 0, ψ(∙) is StrictIy convex, and the
positive sequence {ηi} is such that ψ - ηiLi is convex for all i.
(ii)	l(∙) is differentiable and quasi-convex and has zero derivative only at 0, ψ(∙) is ɑ-strongly
COnvex, and 0 <ηi ≤ kXiigyi-x- WTwL)I for all" .
If either (i) or (ii) holds, then for any initialization W0, the SMD iterates given in Eq. (64) converge
to
W∞ = arg min Dψ (W, W0).	(69)
w∈W
Proof. The proof is similar to that of Proposition 9, as provided in Appendix C.	□
18