Published as a conference paper at ICLR 2020
A Theory of Usable Information under
Computational Constraints
Yilun Xu
CFCS, Peking University
xuyilun@pku.edu.cn
Shengjia Zhao
Stanford University
sjzhao@stanford.edu
Jiaming Song
Stanford University
tsong@cs.stanford.edu
Russell Stewart
russell.sb.nebel@gmail.com
Stefano Ermon
Stanford University
ermon@cs.stanford.edu
Ab stract
We propose a new framework for reasoning about information in complex systems.
Our foundation is based on a variational extension of Shannon’s information theory
that takes into account the modeling power and computational constraints of the
observer. The resulting predictive V-information encompasses mutual information
and other notions of informativeness such as the coefficient of determination.
Unlike Shannon’s mutual information and in violation of the data processing
inequality, V-information can be created through computation. This is consistent
with deep neural networks extracting hierarchies of progressively more informative
features in representation learning. Additionally, we show that by incorporating
computational constraints, V -information can be reliably estimated from data
even in high dimensions with PAC-style guarantees. Empirically, we demonstrate
predictive V-information is more effective than mutual information for structure
learning and fair representation learning.
1	Introduction
Extracting actionable information from noisy, possibly redundant, and high-dimensional data sources
is a key computational and statistical challenge at the core of AI and machine learning. Information
theory, which lies at the foundation of AI and machine learning, provides a conceptual framework
to characterize information in a mathematically rigorous sense (Shannon & Weaver, 1948; Cover &
Thomas, 1991). However, important computational aspects are not considered in information theory.
To illustrate this, consider a dataset of encrypted messages intercepted from an opponent. According
to information theory, these encrypted messages have high mutual information with the opponent’s
plans. Indeed, with infinite computation, the messages can be decrypted and the plans revealed.
Modern cryptography originated from this observation by Shannon that perfect secrecy is (essentially)
impossible if the adversary is computationally unbounded (Shannon & Weaver, 1948). This motivated
cryptographers to consider restricted classes of adversaries that have access to limited computational
resources (Pass & Shelat, 2010). More generally, it is known that information theoretic quantities
can be expressed in terms of betting games (Cover & Thomas, 1991). For example, the (conditional)
entropy of a random variable X is directly related to how predictable X is in a certain betting game,
where an agent is rewarded for correct guesses. Yet, the standard definition unrealistically assumes
agents are computationally unbounded, i.e., they can employ arbitrarily complex prediction schemes.
Leveraging modern ideas from variational inference and learning (Ranganath et al., 2013; Kingma
& Welling, 2013; LeCun et al., 2015), we propose an alternative formulation based on realistic
computational constraints that is in many ways closer to our intuitive notion of information, which
we term predictive V-information. Without constraints, predictive V-information specializes to
classic mutual information. Under natural restrictions, V-information specializes to other well-known
notions of predictiveness, such as the coefficient of determination (R2). A consequence of this new
formulation is that computation can “create usable information” (e.g., by decrypting the intercepted
messages), invalidating the famous data processing inequality. This generalizes the idea that clever
1
Published as a conference paper at ICLR 2020
feature extraction enables prediction with extremely simple (e.g., linear) classifiers, a key notion in
modern representation and deep learning (LeCun et al., 2015).
As an additional benefit, we show that predictive V -information can be estimated with statistical
guarantees using the Probably Approximately Correct framework (Valiant, 1984). This is in sharp
contrast with Shannon information, which is well known to be difficult to estimate for high dimen-
sional or continuous random variables (Battiti, 1994). Theoretically we show that the statistical
guarantees of estimating V information translate to statistical guarantees for a variant of the Chow-Liu
algorithm for structure learning. In practice, when the observer employs deep neural networks as a
prediction scheme, V-information outperforms methods that approximate Shannon information in
various applications, including Chow-Liu tree contruction in high dimension and gene regulatory
network inference.
2	Definitions and Notations
To formally define the predictive V-information, we begin with a formal model of a computationally
bounded agent trying to predict the outcome of a real-valued random variable Y ; the agent is either
provided another real-valued random variable X as side information, or provided no side information
0. We use X and Y to denote the samples spaces of X and Y respectively (while assuming they are
separable), and use P(X) to denote the set of all probability measures over the Borel algebra on X
(P(Y) similarly defined for Y).
Definition 1 (Predictive Family). 1 Let Ω = {f : X ∪ {0} → P(Y)}. We say that V ⊆ Ω is a
predictive family if it satisfies
∀f∈V,∀P ∈range(f), ∃f0 ∈V, s.t. ∀x∈X,f0[x] =P,f0[0] =P (1)
A predictive family is a set of predictive models the agent is allowed to use, e.g., due to computational
or statistical constraints. We refer to the additional condition in Eq.(1) as optional ignorance.
Intuitively, it means that the agent can, in the context of the prediction game we define next, ignore
the side information if she chooses to.
Definition 2 (Predictive conditional V -entropy). Let X, Y be two random variables taking values in
X × Y, and V be a predictive family. Then the predictive conditional V -entropy is defined as
HV(Y|X) = inf Eχ,y〜x,y [-logf [x](y)]
HV(Y∣0) = inf Ey〜Y [- log f [0](y)]
We additionally call HV (Y |0) the V -entropy, and also denote it as HV (Y)
In our notation f is a function X ∪ {0} → P(Y), so f[x] ∈ P(Y) is a probability measure on Y
chosen based on the received side information X (We use f [∙] instead of the more conventional f (∙));
and f [x](y) ∈ R is the value of the density evaluated at y ∈ Y. Intuitively, V (conditional) entropy is
the smallest expected negative log-likelihood that can be achieved predicting Y given observation
(side information) X (or no side information 0), using models from V. Eq.(1) means that whenever
the agent can use P to predict Y’s outcomes, it has the option to ignore the input, and use P no matter
whether X is observed or not.
Definition 2 generalizes several known definitions of uncertainty. For example, as shown in
proposition 2, if the V is the largest possible predictive family that includes all possible mod-
els, i.e. V = Ω, then Definition 2 reduces to Shannon entropy: Hω(Y|X) = H(Y|X) and
HV(Y∣0) = Hω(Y) = H(Y). By choosing more restrictive families V, we recover several other
notions of uncertainty such as trace of covariance, as will be shown in Proposition 1.
Shannon mutual information is a measure of changes in entropy when conditioning on new variables:
I (X ； Y) = H (Y) - H (Y |X) = Hω(Y ) — Hω(Y |X)	(2)
Here, we will use predictive V-entropy to define an analogous quantity, IV(X → Y), to represent the
change in predictability of an output variable Y when given side information X .
1Regularity Conditions: To minimize technical overhead we restrict out discussion only to distributions with
probability density functions (PDF) or probability mass functions (PMF) with respect to the underlying measure.
Also 0 6∈ X .
2
Published as a conference paper at ICLR 2020
Definition 3 (Predictive V -information). Let X, Y be two random variables taking values in X × Y,
and V be a predictive family. The predictive V -information from X to Y is defined as
IV(X → Y) = HV(Y∣0) - HV(Y|X)	(3)
2.1	Important Special Cases
Several important notions of uncertainty and predictiveness are special cases of our definition. Note
that when we are defining V-entropy of a random variable Y in sample space Y ∈ Rd (without
side information), out of convenience We can assume X is empty X = 0 (this does not violate our
requirement that 0 ∈ X.)
Proposition 1. For V -entropy and V -information, we have
1.	Let Ω be as in Def 1. Then Hω(Y) is the Shannon entropy, Hω (Y | X) is the Shannon
conditional entropy, and Iω(Y → X) is the Shannon mutual information.
2.	Let Y = Rd and V = {f : {0} → Pμ | μ ∈ Rd}, where Pμ is the distribution with density
y → Zz e-ky-μk2 where Z = / e-ky-μk2 dy, then the V-entropy of a random variable Y
equals its mean absolute deviation, up to an additive constant.
3.	Let Y = Rd and V = {f : {0} → N (μ, Σ) | μ ∈ Rd, Σ = 1∕2Id×d}, then the V -entropy
ofa random variable Y equals the trace of its covariance tr (Cov(Y)), upto an additive
constant.
4.	Let V = {f : {0} → Qt,θ, θ ∈ Θ}, where Qt,θ is a distribution in a minimal exponential
family with sufficient statistics t : Y → Rd and set of natural parameters Θ. For a random
variable Y with expected sufficient statistics μγ = E[t(Y)], the V-entropy of Y is the
maximum Shannon entropy over all random variables Y with identical expected sufficient
statistics, ι.e. E[t(Y)] = μγ.
5.	Let Y = Rd, X be any vector space, and V = {f : x 7→ N (φ(x), Σ), x ∈ X; 0 7→
N(μ, ∑)∣μ ∈ Rd； ∑ = 1∕2Id×d, φ ∈ Φ}, where Φ is the set of linear functions {φ : X →
Rd}, then V -information IV(X → Y) equals the (unnormalized) maximum coefficient of
determination R2 ∙ tr (Cov(Y)) Jbr linear regression.
The trace of covariance represents a natural notion of uncertainty - for example, a random variable
With zero variance (When d = 1,tr (Cov(Y)) = Var(Y))) is trivial to predict. Proposition 1.3
shoWs that the trace of covariance corresponds to a notion of surprise (in the Shannon sense) for
an agent restricted to make predictions using certain Gaussian models. More broadly, a similar
analogy can be draWn for other exponential families of distributions. In the same spirit, the coefficient
of determination, also knoWn as the fraction of variance explained, represents a natural notion of
informativeness for computationally bounded agents. Also note that in the case of Proposition 1.4,
the V-entropy is invariant if the expected sufficient statistics remain the same.
3	PROPERTIES OF V -INFORMATION
3.1	Elementary Properties
We first shoW several elementary properties of V-entropy and V -information. In particular, V-
information preserves many properties of Shannon information that are desirable in a machine
learning context. For example, mutual information (and V-information) should be non-negative as
conditioning on additional side information X should not reduce an agent’s ability to predict Y.
Proposition 2. Let Y and X be any random variables on Y and X, and V and U be any predictive
families, then we have
1.	Monotonicity: IfV ⊆ U, thenHV(Y) ≥ HU(Y), HV(Y | X) ≥ HU(Y | X).
2.	Non-Negativity: IV(X → Y) ≥ 0.
3.	Independence: IfX is independent ofY, IV(X → Y) = IV(Y → X) = 0.
3
Published as a conference paper at ICLR 2020
The optional ignorance requirement in Eq.(1) is a technical condition needed for these properties
to hold. Intuitively, it guarantees that conditioning on side information does not restrict the class of
densities the agent can use to predict Y . This property is satisfied by many existing machine learning
models, often by setting some weights to zero so that an input is effectively ignored.
3.2	On the production of information through preprocessing
The Data Processing Inequality guarantees that computing on data cannot increase its mutual infor-
mation with other random variables. Formally, letting t : X → X be any function, t(X) cannot have
higher mutual information with Y than X: I(t(X); Y ) ≤ I(X; Y ). But is this property desirable?
In analyzing optimal communication, yes - it demonstrates a fundamental limit to the number of
bits that can be transmitted through a communication channel. However, we argue that in machine
learning settings this property is less appropriate.
Consider an RSA encryption scheme where the public key is known. Given plain text and its
corresponding encrypted text X , if we have infinite computation, we can perfectly compute one from
the other. Therefore, the plain text and the encrypted text should have identical Shannon mutual
information with respect to any label Y we want to predict. However, to any human (or machine
learning algorithm), it is certainly easier to predict the label from the plain text than the encrypted
text. In other words, decryption increases a human’s ability to predict the label: processing increases
the “usable information”. More formally, denoting t as the decryption algorithm and V as a class of
natural language processing functions, we have that: IV (t(X) → Y ) > IV(X → Y ) ≈ 0.
As another example, consider the mutual information between an image’s pixels and its label. Due to
data processing inequality, we cannot expect to use a function to map raw pixels to “features” that
have higher mutual information with the label. However, the fundamental principle of representation
learning is precisely the ability to learn predictive features — functions of the raw inputs that
enable predictions with higher accuracy. Because of this key difference between V -information and
Shannon information, machine learning practices such as representation learning can be justified in
the information theoretic context.
3.3	ON THE ASYMMETRY OF PREDICTIVE V-INFORMATION
V -information also captures the intuition that sometimes, it is easy to predict Y from X but not vice
versa. In fact, modern cryptography is founded on the assumption that certain functions h : X → Y
are one-way, meaning that there exists an polynomial algorithm to compute h(x) but no polynomial
algorithm to compute h-1 (y). This means that if V contains all polynomial-time computable
functions, then IV(X → h(X)) IV (h(X) → X).
This property is also reasonable in the machine learning context. For example, several important
methods for causal discovery (Peters et al., 2017) rely on this asymmetry: if X causes Y , then usually
it is easier to predict Y from X than vice versa; another commonly used assumption is that Y |X can
be accurately modeled by a Gaussian distribution, while X |Y cannot (Pearl, 2000).
4	PAC GUARANTEES FOR V-INFORMATION ESTIMATION
For many practical applications of mutual information (e.g., structure learning), we do not know the
joint distribution of X, Y , so cannot directly compute the mutual information. Instead we only have
samples {(xi, yi)}N=ι 〜X,Y and need to estimate mutual information from data.
Shannon information is notoriously difficult to estimate for high dimensional random variables.
Although non-parametric estimators of mutual information exist (Kraskov et al., 2004; Darbellay &
Vajda, 1999; Gao et al., 2017), these estimators do not scale to high dimensions. Several variational
estimators for Shannon information have been recently proposed (van den Oord et al., 2018; Nguyen
et al., 2010; Belghazi et al., 2018), but have two shortcomings: due to their variational assumptions,
their bias/variance tradeoffs are poorly understood and they are still not efficient enough for high
dimensional problems. For example, the CPC estimator suffers from large bias, since its estimates
saturate at log N where N is the batch size (van den Oord et al., 2018; Poole et al., 2019); the NWJ
estimator suffers from large variance that grows at least exponentially in the ground-truth mutual
information (Song & Ermon, 2019). Please see Appendix B for more details and proofs.
4
Published as a conference paper at ICLR 2020
On the other hand, V -information is explicit about the assumptions (as a feature instead of a bug).
V -information is also easy to estimate with guarantees if we can bound the complexity of V (such as
its Radamacher or covering number complexity) As we will show, bounds on the complexity of V
directly translate to PAC (Valiant, 1984) bounds for V-information estimation. In practice, we can
efficiently optimize over V, e.g., via gradient descent. In this paper we will present the Rademacher
complexity version; other complexity measures (such as covering number) can be derived similarly.
Definition 4 (Empirical V -information). Let X, Y be two random variables taking values in X, Y and
D ={(xi,yi)}N=ι 〜 X, Y denotes the set of samples drawn from the joint distribution over X and
Y. V is a predictive family. The empirical V -information (under D) is the following V -information
under the empirical distribution defined via D:
1	11	1
IV (X → Y; D)= inf — T log 「 ,, 、 - inf「T log 「 ,, 、	(4)
f∈V |D| 匕	f [0](yi)	f∈v |D| x.XD	f [xi](yi)
yi ∈	xi ,yi ∈
Then we have the following PAC bound over the empirical V -information:
Theorem 1. Assume ∀f ∈ V, x ∈ X, y ∈ Y, log f [x](y) ∈ [-B, B]. Then for any δ ∈ (0, 0.5),
with probability at least 1 - 2δ, we have:
IIV (X → Y) - IV (X → Y; D)I ≤
4R|D|(GV)+2B
1∕2log δ
V |D|
(5)
where we define the function family GV = {g |g(x, y) = log f [x](y), f ∈ V}, and RN (G) denotes
the Rademacher complexity of G with sample number N.
Typically, the Rademacher complexity term satisfies R∣d∣ (Gv) = O(∣D∣-2) (Bartlett & Mendelson,
2001; Gao & Zhou, 2016). It’s worth noticing that a complex function family V (i.e., with large
Rademacher complexity) could lead to overfitting. On the other hand, an overly-simple V may not be
expressive enough to capture the relationship between X and Y. As an example of the theorem, we
provide a concrete estimation bound when V is chosen to be linear functions mapping X to the mean
of a Gaussian distribution. This was shown in Proposition 1 to lead to the coefficient of determination.
Corollary 1.1. Assume X = {x ∈ Rdx , kxk2 ≤ kx} and Y = {y ∈ Rdy, kyk2 ≤ ky}. If
V = {f ： f [x]= N(Wx + b,I),f [0]= N(c,I),W ∈ Rdy×dx,b,c ∈ Rdy,k(W,b)k2 ≤ 1}
Denote M = (kx + ky)2 + log 2π, then ∀δ ∈ (0, 0.5), with probability at least 1 - 2δ:
IIV(X → Y) - IV (X → Y; D)
≤ Ph 1+4Mgδ
Similar results can be obtained using other classes of machine learning models with known
(Rademacher) complexity.
5 STRUCTURE LEARNING WITH V-INFORMATION
Among many possible applications of V-information, we show how to use it to perform structure
learning with provable guarantees. The goal of structure learning is to learn a directed graphical
model (Bayesian network) or undirected graphical model (Markov network) that best captures the
(conditional) independence structure of an underlying data generating process. Structure learning is
difficult in general, but if we restrict ourselves to certain set of graphs G, there are efficient algorithms.
In particular, the Chow-Liu algorithm (Chow & Liu, 1968) can efficiently learn tree graphs (i.e. G is
the set of trees). Chow & Liu (1968) show that the problem can be reduced to:
g* = argmax X	I (Xi,Xj)	(6)
g∈Gtree (Xi,Xj)∈edge(g)
where I(Xi , Xj ) is the Shannon mutual information between variables Xi and Xj . In other words, it
suffices to construct the maximal weighted spanning tree where the weight between two vertices is
5
Published as a conference paper at ICLR 2020
their Shannon mutual information. Chow & Wagner (1973) show that the Chow-Liu algorithm is
consistent, i.e, it recovers the true solution as the dataset size goes to infinity. However, the finite
sample behavior of the Chow-Liu algorithm for high dimensional problems is much less studied,
due to the difficulty of estimating mutual information. In fact, we show in our experiments that the
empirical performance is often poor, even with state-of-the-art estimators. Additionally, methods
based on mutual information cannot take advantage of intrinsically asymmetric relationships, which
are common for example in gene regulatory networks (Meyer et al., 2007).
To address these issues, we propose a new structure learning algorithm based on V-information
instead of Shannon information. The idea is that we can associate to each directed edge in G (i.e.,
each pair of variables) a suitable predictive family Vi,j (cf. Def 1). The main challenge is that we
cannot simply replace mutual information with V-information in Eq. 6 because V-information is
asymmetric - We now have to optimize over directed trees:
m
g* = argmaχ EIVt(g)(i),i (Xt(g)(i) → Xi)	⑺
g ∈Gd-tree i=2
where Gd-tree is the set of directed trees, and t(g) : N → N is the function mapping each non-root
node of directed tree g to its parent, and Vi,j is the predictive family for random variables Xi and Xj.
After estimating V -information on each edge, we use the Chu-Liu algorithm (Chu & Liu, 1965) to
construct the maximal directed spanning tree. This allows us to solve (7) exactly, even though there
is a combinatorially large number of trees to consider. Pseudocode is summarized in Algorithm 1 in
Appendix. Denote C(g) = Pim=2 IVt(g)(i),i (Xt(g)(i) → Xi), we show in the following theorem that
unlike the original Chow-Liu algorithm, our algorithm has guarantees in the finite samples regime,
even in continuous settings:
Theorem 2. Let {Xi}im=1 be the set of m random variables, Di,j (resp. Dj) be the set of samples
drawn from P(Xi, Xj) (resp. P (Xj)). Denote the optimal directed tree with maximum expected edge
weights sum C(g) as g* and the optimal directed tree constructed on the dataset D as g. Then with
the assumption in theorem 1,for any δ ∈ (0, ?_(；—i)), with probability at least 1 一 2m(m — 1)δ,
we have:
C(g) ≥ C(g*) — 2(m — 1) maX ∣2RDi,j 停以“)+ 2Rdj (GVj) + B^2∖og 1 (|Dj|-2 + @,犷1)}
(8)
Theorem 2 shows that the total edge weights of the maximal directed spanning tree constructed
by algorithm 1 would be close to the optimal total edge weights if the Rademacher term is small.
Although larger C(g) does not necessarily lead to better Chow-Liu trees, empirically we find that
the optimal tree in the sense of equation (7) is consistent with the optimal tree in equation (6) under
commonly used V .
6 Experimental results
6.1	Structure learning with continuous high-dimensional data
We generate synthetic data using various ground-truth tree structures g* with between 7 and 20
variables, where each variable is 10-dimensional. We use Gaussians, Exponentials, and Uniforms
as ground truth edge-conditionals. We use V-information(Gaussian) and V-information(Logistic) to
denote Algorithm 1 with two different V families. Please refer to Appendix D.1 for more details. We
compare with the original Chow-Liu algorithm equipped with state-of-the-art mutual information
estimators: CPC (van den Oord et al., 2018), NWJ (Nguyen et al., 2010) and MINE (Belghazi et al.,
2018), with the same neural network architecture as the V-families for fair comparison. All the
experiments are repeated for 10 times. As a performance metric, we use the wrong-edges-ratio (the
ratio of edges that are different from ground truth) as a function of the amount of training data.
We show two illustrative experiments in figure 1a; please refer to Appendix D.1 for all simulations.
We can see that although the two V -families used are misspecified with respect to the true underlying
(conditional) distributions, the estimated Chow-Liu trees are much more accurate across all data
regimes, with CPC (blue) being the best alternative. Surprisingly, V -information(Gaussian) works
consistently well in all cases and only requires about 100 samples to recover the ground-truth
Chow-Liu tree in simulation-A.
6
Published as a conference paper at ICLR 2020
.8.64 2 Q
o.ao.a a
o43⅛sJls<uM)poMUOIM pσpodxw
V-information(Guassian)	V-information(Laplacican)	MINE --------- CPC	NWJ
(a) Chow-Liu tree Construction
υ3
(b) Gene network inference
0.2	0.4	0.6	0.8
Sample Size
(C) V-information of frames
2.5	5.0	7.5	10.0 12.5 15.0 17.5
Frame Distance

Figure 1: (a) The expected WrOng-edges-ratio of algorithm 1 with different V and other mutual
information estimators-based algorithms from sample size 10 to 5 × 103. (b) AUC curve for gene
regulatory network inference. (c) The predictive V-information versus frame distance.
6.2	Gene regulatory network inference
Mutual information between pairs of gene expressions is often used to construct gene regulatory
networks. We evaluate V-information on the in-silico dataset from the DREAM5 challenge (Marbach
et al., 2012) and use the setup of Gao et al. (2017), where 20 genes with 660 datapoints are utilized to
evaluate all methods. We compare with state-of-the-art non-parametric Shannon mutual information
estimators in this low dimensional setting: KDE, the traditional kernel density estimator; the KSG
estimator (Kraskov et al., 2004); the Mixed KSG estimator (Gao et al., 2017) and Partitioning, an
adaptive partitioning estimator (Darbellay & Vajda, 1999) implemented by Szabo (2014). For fair
comparison with these low dimensional estimators, we select V = {f : f [x] = N(g(χ), 1), X ∈
X; f [0] = N(μ, 2)∣μ ∈ range(g)}, where g is a 3-rd order polynomial.
The task is to predict whether a directed edge between genes exists in the ground-truth gene network.
We use the estimated mutual information and V -information for gene pairs as the test statistic to
obtain the AUC for various methods. As shown in Figure 1b, our method outperforms all other
methods in network inference under different fractions of data used for estimation. The natural
information measure in this task is asymmetry since the goal is to find the pairs of genes (Ai, Bi)s in
which Ai regulates Bi , thus V -information is more suitable for such case than mutual information.
7
Published as a conference paper at ICLR 2020
6.3	Recovering the order of video frames
Let Xi,…，X20 be random variables each representing a frame in videos from the Moving-MNIST
dataset, which contains 10,000 sequences each of length 20 showing two digits moving with stochastic
dynamics. Can Algorithm 1 be used to recover the natural (causal) order of the frames? Intuitively,
predictability should be inversely related with frame distance, thus enabling structure learning. Using
a conditional PixelCNN++ (Salimans et al., 2017) as predictive family V, we shown in Figure 1c
that predictive V-information does indeed decrease with frame distance, despite some fluctuations
when the frame distances are large. Using Algorithm 1 to construct a Chow-Liu tree, we find that the
tree perfectly recovers the relative order of the frames.
We also generate a Deterministic-Moving-MNIST dataset, where digits move according to deter-
ministic dynamics. From the perspective of Shannon mutual information, every pair of frames has
the same mutual information. Hence, standard Chow-Liu tree learning algorithm would fail to
discover the natural ordering of the frames (causal structure). In contrast, once we constrain the
observer to PixelCNN++ models, algorithm 1 with predictive V-information can still recover the
order of different frames when the frame distances are relatively small (less than 9). Compared to the
stochastic dynamics case, V-information is more irregular with increasing frame distance, since the
PixelCNN++ tends to overfit.
6.4	Information theoretic approaches to fairness
The goal of fair representation learning is to map inputs X ∈ X to a feature space Z ∈ Z such that
the mutual information between Z and some sensitive attribute U ∈ U (such as race or gender) is
minimized. The motivation is that using Z (instead of X) as input we can no longer use the sensitive
attributes U to make decisions, thus ensuring some notion of fairness. Existing methods obtain fair
representations by optimizing against an “adversarial” discriminator so that the discriminator cannot
predict U from Z (Edwards & Storkey, 2015; Louizos et al., 2015; Madras et al., 2018; Song et al.,
2018). Under some assumptions on U and V, we show in Appendix D.2 that these works actually use
V -information minimization as part of their objective, where V depends on the functional form of the
discriminator.
However, it is clear from the V-information perspective that features trained with VA-information
minimization might not generalize to VB -information and vice versa. To illustrate this, we use a
function family Vj as the attacker to extract information from features trained with IVi (Z → U )
minimization, where all the Vs are neural nets. On three datasets commonly used in the fairness
literature (Adult, German, Heritage), previous methods work well at preventing information “leak”
against the class of adversary they’ve been trained on, but fail when we consider different ones. As
shown in Figure 3b in Appendix, the diagonal elements in the matrix are usually the smallest in
rows, indicating that the attacker function family Vi extracts more information on featured trained
with Vj(j 6=i) -information minimization. This challenges the generalizability of fair representations in
previous works. Please refer to Appendix D.2 for details.
7	Related work
Alternative definitions of Information Several alternative definitions of mutual information are
available in the literature. Renyi entropy and Renyi mutual information (Lenzi et al., 2000) extend
Shannon information by replacing KL divergence with f -divergences. However, they have the same
difficulty when applied to high dimensional problems as Shannon information.
The line of work most related to ours is the H entropy and H mutual information (DeGroot et al.,
1962; Grunwald et al., 2004), which associate a definition of entropy to every prediction loss. However,
there are two key differences. First, literatures in H entropy only consider a few special types of
prediction functions that serve unique theoretical purposes; for example, (Duchi et al., 2018) considers
the set of all functions on a feature space to prove surrogate risk consistency, and (Grunwald et al.,
2004) only considers the H entropy to prove the duality between maximum entropy and worst-case
loss minimization. In contrast, our definition takes a completely different perspective — emphasizing
bounded computation and intuitive properties of “usable” information. Furthermore H entropy still
suffers from difficulty of estimation in high dimension because the definitions do not restrict to
functions with small complexity (e.g. Rademacher complexity).
8
Published as a conference paper at ICLR 2020
Mutual information estimation The estimation of mutual information in the machine learning
field is often on the continuous underlying distribution. For non-parametric mutual information
estimators, many methods have exploited the 3H principle to calculate the mutual information, such
as the Kernel density estimator (Paninski & Yajima, 2008), k-Nearest-Neighbor estimator and the
KSG estimator (Kraskov et al., 2004). However, these non-parametric estimators usually aren’t
scalable to high dimension. Recently, several works utilize the variational lower bounds of MI
to design MI estimator based on deep neural network in order to estimate MI of high dimension
continuous random variables (Nguyen et al., 2010; van den Oord et al., 2018; Belghazi et al., 2018).
8	Conclusion
We defined and investigated V -information, a variational extension to classic mutual information
that incorporates computational constraints. Unlike Shannon mutual information, V-information
attempts to capture usable information, and has very different properties, such as invalidating the data
processing inequality. In addition, V -information can be provably estimated, and can thus be more
effective for structure learning and fair representation learning.
Acknowledgements
This research was supported by AFOSR (FA9550-19-1-0024), NSF (#1651565, #1522054, #1733686),
ONR, and FLI.
References
Peter L. Bartlett and Shahar Mendelson. Rademacher and gaussian complexities: Risk bounds and
structural results. J. Mach. Learn. Res., 3:463-482, 2001.
Roberto Battiti. Using mutual information for selecting features in supervised neural net learning.
IEEE Transactions on neural networks, 5(4):537-550, 1994.
Mohamed Ishmael Belghazi, Aristide Baratin, Sai Rajeshwar, Sherjil Ozair, Yoshua Bengio, R. Devon
Hjelm, and Aaron C. Courville. Mutual information neural estimation. In ICML, 2018.
C Chow and Cong Liu. Approximating discrete probability distributions with dependence trees.
IEEE transactions on Information Theory, 14(3):462-467, 1968.
C. K. Chow and Terry J. Wagner. Consistency of an estimate of tree-dependent probability distribu-
tions (corresp.). IEEE Trans. Information Theory, 19:369-371, 1973.
Yau Chu and T. Liu. On the shortest arborescence of a directed graph. Scientia Sinica, 14:1396-1400,
1965.
Thomas M. Cover and Joy A. Thomas. Elements of information theory. 1991.
Georges A. Darbellay and Igor Vajda. Estimation of the information by an adaptive partitioning of
the observation space. IEEE Trans. Information Theory, 45:1315-1321, 1999.
Morris H DeGroot et al. Uncertainty, information, and sequential experiments. The Annals of
Mathematical Statistics, 33(2):404-419, 1962.
John Duchi, Khashayar Khosravi, Feng Ruan, et al. Multiclass classification, information, divergence
and surrogate risk. The Annals of Statistics, 46(6B):3246-3275, 2018.
Harrison A Edwards and Amos J. Storkey. Censoring representations with an adversary. CoRR,
abs/1511.05897, 2015.
Wei Gao and Zhi-Hua Zhou. Dropout rademacher complexity of deep neural networks. Science
China Information Sciences, 59(7):072104, 2016.
Weihao Gao, Sreeram Kannan, Sewoong Oh, and Pramod Viswanath. Estimating mutual information
for discrete-continuous mixtures. In NIPS, 2017.
9
Published as a conference paper at ICLR 2020
Peter D Grunwald, A Philip Dawid, et al. Game theory, maximum entropy, minimum discrepancy
and robust bayesian decision theory. the Annals of Statistics, 32(4):1367-1433, 2004.
Edwin T Jaynes. On the rationale of maximum-entropy methods. Proceedings of the IEEE, 70(9):
939-952, 1982.
Sham M. Kakade, Karthik Sridharan, and Ambuj Tewari. On the complexity of linear prediction:
Risk bounds, margin bounds, and regularization. In NIPS, 2008.
Diederik P. Kingma and Max Welling. Auto-encoding variational bayes. CoRR, abs/1312.6114, 2013.
Alexander Kraskov, Harald Stogbauer, and Peter Grassberger. Estimating mutual information. Phys.
Rev. E, 69:066138, Jun 2004. doi: 10.1103/PhysRevE.69.066138. URL https://link.aps.
org/doi/10.1103/PhysRevE.69.066138.
Yann LeCun, Yoshua Bengio, and Geoffrey Hinton. Deep learning. Nature, 521:436-444, 2015.
Michel Ledoux and Michel Talagrand. Probability in Banach Spaces: isoperimetry and processes.
Springer Science & Business Media, 2013.
EK Lenzi, RS Mendes, and LR Da Silva. Statistical mechanics based on renyi entropy. Physica A:
Statistical Mechanics and its Applications, 280(3-4):337-345, 2000.
Christos Louizos, Kevin Swersky, Yujia Li, Max Welling, and Richard S. Zemel. The variational fair
autoencoder. CoRR, abs/1511.00830, 2015.
David Madras, Elliot Creager, Toniann Pitassi, and Richard S. Zemel. Learning adversarially fair and
transferable representations. ArXiv, abs/1802.06309, 2018.
Daniel Marbach, James C. Costello, Robert Kuffner, N. Vega, Robert J. Prill, Diogo M Camacho,
Kyle R. Allison, Manolis Kellis, James J. Collins, and Gustavo Stolovitzky. Wisdom of crowds for
robust gene network inference. In Nature Methods, 2012.
Patrick E. Meyer, Kevin Kontos, Frederic Lafitte, and Gianluca Bontempi. Information-theoretic
inference of large transcriptional regulatory networks. In EURASIP J. Bioinformatics and Systems
Biology, 2007.
XuanLong Nguyen, Martin J. Wainwright, and Michael I. Jordan. Estimating divergence functionals
and the likelihood ratio by convex risk minimization. IEEE Transactions on Information Theory,
56:5847-5861, 2010.
Liam Paninski and Masanao Yajima. Undersmoothed kernel entropy estimators. IEEE Transactions
on Information Theory, 54:4384-4388, 2008.
Rafael Pass and Abhi Shelat. A course in cryptography. 2010.
Judea Pearl. Causality: Models, reasoning, and inference. 2000.
Jonas Peters, Dominik Janzing, and Bernhard Scholkopf. Elements of causal inference: foundations
and learning algorithms. MIT press, 2017.
Ben Poole, Sherjil Ozair, Aaron van den Oord, Alexander A Alemi, and George Tucker. On variational
bounds of mutual information. arXiv preprint arXiv:1905.06922, 2019.
Rajesh Ranganath, Sean Gerrish, and David M. Blei. Black box variational inference. In AISTATS,
2013.
Tim Salimans, Andrej Karpathy, Xi Chen, and Diederik P. Kingma. Pixelcnn++: Improving the pixel-
cnn with discretized logistic mixture likelihood and other modifications. ArXiv, abs/1701.05517,
2017.
Claude E. Shannon and Warren Weaver. The mathematical theory of communication. 1948.
Jiaming Song and Stefano Ermon. Understanding the limitations of variational mutual information
estimators. arXiv preprint arXiv:1910.06222, 2019.
10
Published as a conference paper at ICLR 2020
Jiaming Song, Pratyusha Kalluri, Aditya Grover, Shengjia Zhao, and Stefano Ermon. Learning
controllable fair representations. In AISTATS, 2018.
Zoltan Szabo. Information theoretical estimators toolbox. J. Mach. Learn. Res., 15:283-287, 2014.
Leslie G Valiant. A theory of the learnable. CommunicationsoftheACM, 27(11):1134-1142, 1984.
Aaron van den Oord, Yazhe Li, and Oriol Vinyals. Representation learning with contrastive predictive
coding. ArXiv, abs/1807.03748, 2018.
Martin J Wainwright, Michael I Jordan, et al. Graphical models, exponential families, and variational
inference. Foundations and Trends® in Machine Learning, 1(1-2):1-305, 2008.
11
Published as a conference paper at ICLR 2020
A Proofs
A.1 Proof of Proposition 1
Proposition 1. For V -entropy and V -information, we have
1.	Let Ω be as in Def 1. Then Hω(Y) is the Shannon entropy, Hω (Y | X) is the Shannon
conditional entropy, and Iω(Y → X) is the Shannon mutual information.
2.	Let Y = Rd and V = {f : {0} → Pμ | μ ∈ Rd}, where Pμ is the distribution with density
y → Zz e-ky-μk2 where Z = / e-ky-μk2 dy, then the V-entropy of a random variable Y
equals its mean absolute deviation, up to an additive constant.
3.	Let Y = Rd and V = {f : {0} → N (μ, Σ) | μ ∈ Rd, Σ = 1∕2Id×d}, then the V -entropy
ofa random variable Y equals the trace of its covariance tr (Cov(Y)), upto an additive
constant.
4.	Let V = {f : {0} → Qt,θ, θ ∈ Θ}, where Qt,θ is a distribution in a minimal exponential
family with sufficient statistics t : Y → Rd and set of natural parameters Θ. For a random
variable Y with expected SuffiCient statistics μγ = E[t(Y)], the V-entropy of Y is the
maximum Shannon entropy over all random variables Y with identical expected sufficient
statistics, ι.e. E[t(Y)] = μγ.
5.	Let Y = Rd, X be any vector space, and V = {f : x → N(φ(x), Σ),x ∈ X; 0 一
N(μ, ∑)∣μ ∈ R%∑ = 1∕2Id×d,φ ∈ Φ}, where Φ is the set of linear functions {φ : X →
Rd}, then V -information IV(X → Y) equals the (unnormalized) maximum coefficient of
determination R2 ∙ tr (Cov(Y)) for linear regression.
Proof. (1)
Let PY|x denote the density function of random variable Y conditioned on X = x (we denote this
random variable as Y | x).
1	PY|x (y)
Hω(Y|X)= inf Eχ,y〜X,Y log ɪɪʒ = inf Ex〜XEy〜γ∣x log 打1J	、
f∈ω	, L	f[χ](y)J	f∈ω	y 1 L	f[χ](y)Pγ∣x(y)J
=inf Ex〜X [KL(Pγ∣xkf [χ]) + H(Y|x)]
f ∈Ω	J .......................
=Ex〜X [H(Y|x)] = h(Y|X)
(9)
where infimum is achieved for f where f[x] = PY|x and H is the Shannon (conditional) entropy.
The same proof technique can be used to show that Hω(Y) = H(Y), With the infimum achieved by
f where f[0] = PY. Hence we have
Iω(Y → X )= Hω(Y ) - Hω(Y |X )= H (Y) - H (Y |X )= I (Y; X)	(10)
(2)
HV(Y) = infEy〜Y [-logf[0](y)] = inf Ey〜γ [-logge-ky-μk2
f ∈V	μ∈Rd	|_ Z
=inf Ey〜Y [k y - μ ∣∣2] + log Z
μ∈Rd
= MAD(Y) +logZ	(11)
where MAD denotes mean absolute deviation Ey〜Y [∣ y 一 E[Y] k2].
12
Published as a conference paper at ICLR 2020
(3)
HV(Y) = fnV Ey〜Y [- log f [0](y)]
inf Ey〜Y
μ∈Rd
- log
inf Ey〜γ[(y - μ)T(y - μ)] + d log ∏
μ∈Rd	2
inf Ey〜γ[tr ((y - μ)(y - μ)T)] + d log ∏
μ∈Rd	2
tr(Cov(Y)) + d logπ
(Cyclic property of trace)
(Linearity of trace)
(4)	The density function of an exponential family distribution with sufficient statistics t is y 7→
exp (θ ∙ t(y) - A(θ)) where A(θ) is the partition function.
HV(Y) = inf Ey〜Y [- logf [0](y)] = inf Ey〜Y [-logexp(θ ∙ Ey〜γ[t(y)] - A(θ))]
f∈V	θ∈Θ
=-SuP (θ ∙ Ey〜y[t(y)] - A(θ))]
θ∈Θ
=-A*(Ey〜Y[t(y)])	(12)
where A* is the Fenchel dual of the log-partition function A(θ). Under mild conditions (Wainwright
et al., 2008)
-A*(μ) = H(Pμ)
where Pμ is the maximum entropy distribution out of all distributions satisfying Ey〜Pμ[t(y)]=
μ (Jaynes, 1982), and H(∙) is the Shannon entropy.
(5)	Assume random variable Y ∈ Rd, V = {f : x → N(φ(x), Σ),x ∈ X; 0 - N(μ, Σ)∣μ ∈
Rd; Σ = 11d×d; φ ∈ Φ}. Then the V-information from X to Y is
IV(X→Y) =HV(Y) - HV(Y|X)
inf Ey〜Y
μ∈Rd
- log
__________e-ky-μk2
(2∏)2 ∣Σ∣ 2
-inf Eχ,y〜x,y -log —d1-1 e-ky-φ(x)k2
φ∈φ	[	(2π)号 ∣Σ∣ 2
inf Exy〜X y ∣^k y - μ ∣∣∣1 - inf Exy〜X Y ∣^∣∣ y - φ(x) ∣∣∣1
μ∈Rd x,y x,y	2 φ∈φ x,y x,y	2-I
tr (Cov(Y))
Jnf Ex,y〜χ,γ [∣∣ y - φ(χ) ∣H]
φ∈Φ
tr (Cov(Y))
tr (Cov(Y)) R2
(13)
□
A.2 Proof of Proposition 2
Proposition 2. Let Y and X be any random variables on Y and X, and V and U be any predictive
families, then we have
1.	Monotonicity: IfV ⊆ U, thenHV(Y) ≥ HU(Y), HV(Y | X) ≥ HU(Y | X).
2.	Non-Negativity: IV(X → Y) ≥ 0.
3.	Independence: If X is independent of Y, IV(X → Y) = IV(Y → X) = 0.
Proof. (1)
HV (Y) = inf Ey 〜Y [log J ] ≥ inf Ey 〜Y [log frJ1∕ J = HU (Y)
f∈V	f [0](y)	f∈U	f [0](y)
HV(Y|X) = f∈V Ex,y〜X,Y
log f[x⅛)] ≥ fnU Ex,y~χ,γ [log f⅛d =HU (YX)
(14)
(15)
13
Published as a conference paper at ICLR 2020
The inequalities (14) and (15) are because we are taking the infimum over a larger set.
(2)
Denote V0 ⊂ V as the subset of f that satisfy f [x] = f [0], ∀χ ∈ X.
HV(Y) = fnVEχ,y~X,Y [- log f [0](y)]
= Jnf Eχ,y~X,Y [- log f [0](y)]
f ∈V0
= Jnf Eχ,y~X,Y [- log f [x]⑻]
f ∈V0
≥ inf Eχ,y~x,γ [-logf [x](y)] = HV(Y | X)
(By Optional Ignorance)
Therefore
IV(Y→X) = HV (Y) - HV(Y|X) ≥ 0
(3)
Denote V0 ⊂ V as the subset of f that satisfy f[x] = f [0], ∀x ∈ X.
HV(Y |X)
fnV Ex,y~X,γ[-logf [x](y)]
inf Eχ~xEy~Y [- log f [x](y)]
Ex~x inf Ey~γ [- log f [x](y)]
Ex~x	inf Ey~γ [- log f [x](y)]
Lf ∈V0	/	J
inf Ey~γ [- log f [0](y)]
f ∈V0
f∈V Ey~γ[-log f [0](y)] = HV (Y)
(Independence)
(Jensen)
(Optional Ignorance)
(No dependence on x)
Therefore IV(Y → X) = HV (Y) - HV(Y|X) ≤ 0. Combined with the Proposition 2.2 that
IV(X → Y) must be non-negative, IV(X → Y) must be 0.
A.3 Proof of Theorem 1
Theorem 1. Assume ∀f ∈ V, x ∈ X, y ∈ Y, log f [x](y) ∈ [-B, B]. Then for any δ ∈ (0, 0.5),
with probability at least 1 - 2δ, we have:
IIv(X → Y) - IV(X → Y；D)∣ ≤
4R|D|(GV)+2B
1∕2ι0gT
V |D|
(5)
≥
≥
□
where we define the function family GV = {g |g(x, y) = log f [x](y), f ∈ V}, and RN (G) denotes
the Rademacher complexity of G with sample number N.
Before proving theorem 1, we introduce two lemmas. Proofs for these Lemmas follow the same
strategy as theorem 8 in Bartlett & Mendelson (2001):
Lemma 3. Let X, Y be two random variables taking values in X, Y andD denotes the set of samples
drawn from the joint distribution over X ×Y. Assume ∀f ∈ V, x ∈ X, y ∈ Y, log f [x](y) ∈ [-B, B].
Take f = arg min & E- log f [x∕(yi) ,then ∀δ ∈ (0,1), With probability at least 1 - δ, we
f ∈V	xi,yi∈D
have:
1
HV(YIX) - ∣d∣ E - log f [xi](yi)
xi,yi∈D
≤ 2R∣d∣ (GV) + 2B
∕2log1
V IDI
(16)
14
Published as a conference paper at ICLR 2020
Proof. We apply McDiarmid,s inequality to the function Φ defined for any sample D by
Φ(D) = sup
f ∈V
Eχ,y [- l°g f[x](y)] — ∣D∣ X - l°g f[xi](yi)
χi,yi∈D
(17)
Let D and D0 be two samples differing by exactly one point, then since the difference of suprema
does not exceed the supremum of the difference and ∀f ∈ V,x ∈ X, y ∈ Y, log f [χ](y) ∈ [-B, B],
we have:
Φ(D) - Φ(D0)
≤ sup
f ∈V
焉 X logf [χi]3)- Ex,y [logf [x](y)]-
Xi,yi∈D
焉 X logf [χi]3)- Ex,y [logf [x](y)]
χi,yi ∈D0
≤ sup
f ∈V
2B
≤ 一
≤ |D|
|D| X - lθg f [xi](yi)1- iD| X - lθg f [xi](yi)
Xi,yi∈D	Xi,yi∈D0
then by McDiarmid,s inequality, for any δ ∈ (0,1), with probability at least 1 - δ, the following
holds:
Φ(D) ≤ ED [Φ(D)] + B
1∕210gT
V |D|
(18)
Then we bound the ED [Φ(D)] term:
ED [Φ(D)] = ED
= ED
≤ ED
sup Eχ,y [- log f [x](y)] - ɪ X - log f [x∕(%)
f∈V	IDI XiMD
sup Ed o
f ∈v
焉 X log f[xi](y0)
1	1 χi,yi ∈d	.
-|D| X logf E](yi)
Xi,yi∈D
sup Edo
f ∈V
ipTT	X log f [xi](yi)| -
1	1 Xi,y0 ∈d
|Dr X logf[xi](yi)
Xi,yi∈D
≤ eD,D'

EdjD'
I/
sup
f ∈V
sup
f ∈V
言 X logf[xi](yi)|一焉 X logf[xi](yi)
1	1 Xi,y/∈D0	1 1 Xi,yi∈D
I |D|	-
|D| X(logf [xi](Vi) - logf /(y/
(19)
(20)
(21)
(22)
(23)
≤ ED,D0,σ
1	|D|
SUP 由 ∑2σi (IOgf [xi](yi) - logf [xiKyi))
f∈V |D| M
(24)
≤ ED,σ
sup
f ∈V
1	|D|
|D| 52σi log f [xi](yi)
+ Edo ,σ
1	|D|
SUP 而 Eσi logf [xi](y0)
f ∈V |D| M
(25)
2ED,σ
1	|D|
sup 而 Tai log f [xi](yi)
f ∈V |D| M
(26)
15
Published as a conference paper at ICLR 2020
2ED,σ
1 IDI
SUP kFiΣZσig(xi,yi)
g∈G ∣D∣ i=1
sup
2R|D|(GV)
(27)
where σis are Rademacher variables that is uniform in {-1, +1}. Inequality (22) follows from
the convexity of sup, inequality (24) follows from the symmetrization argument for `1 norm for
Radermacher random variables (Ledoux & Talagrand (2013), Section 6.1), inequality (21) follows
from the convexity of |x - c|. (27) follows from the definition of G and Rademacher complexity.
Finally, combining inequality (18) and (27) yields for all f ∈ V, with probability at least 1 -
δ
J2log δ
ViDr
Ex,y [- log f [x](y)] - ∣D∣ X - log f [xi](yi) ≤ 2R∣D∣(GV) + B
xi,yi∈D
(28)
ɪ	I	,ι	I ∙ , ill f P	∙	1	Kɔ	i r Γ 1 / ∖	t
In particular, the inequality holds for f = arg min D E 一 log f [xi](yi) and
f∈V	xi,yi∈D
〜
f
arg min Eχ,y〜x,y [- log f [x](y)]. Then we have:
f∈V
Eχ,y〜X,Y [- log f[x](y)]
≤ Eχ,y〜X,Y [- log f[x](y)]
ɪ X
∣D∣
xi,yi ∈D
—X
∣D∣
xi,yi ∈D
1
-log f[χi](yi) ≤ HV (Y |X) - ∣D∣ E - log fE](yi)
xi,yi∈D
i Pr ι /	∖
- log f[xi](yi)
—
—
Hence the bound (16) holds.
□
Similar bounds can be derived for HV(Y) when We choose the domain of X to be X = {0}:
Lemma 4. Let Y be random variable taking values in Y and D denotes the set of samples drawn
from the underlying distribution P (Y). Assume Vf ∈ V, y ∈ Y, log f [0](y) ∈ [-B,B]. Take
1
f = arg min D E- log f [0](yi),thenfor any δ ∈ (0,1), With probability at least 1 一 δ, we
f∈V	xi,yi∈D
have:

HV (Y)-IDi yXD

-	z'r	_	. .	，一	、	„
-logf[0](yi) ≤ 2R∣d∣(Gv。) + B
(29)
≤ 2r∣d∣(gv )+B y2⅛
(30)
where Gv。= {g∣g(y) = logf [0](y),f ∈ V}.
Proof. The first inequality (29) can be derived similarly as Lemma 3. Since V is a predictive family,
hence there exits a function h : V → V, such that h(f) = f and ∀χ ∈ X, f 0[χ] = f [0].
RIDI(GV 0 ) = ED,σ
ED,σ
≤ ED,σ
sup
f∈V
sup
f∈V
sup
f∈V
IDI
X σi log f [0](yi)
i=1
IDI
σi log h(f)[xi](yi)
i=1
1D1	-
σi log f[xi](yi)
i=1
(31)
1
D
1
D
1
D
= RIDI (GV)
The inequality (31) holds because of h(V) ⊆ V.
□
16
Published as a conference paper at ICLR 2020
Now We prove theorem 1:
Theorem 1. Assume ∀f ∈ V, x ∈ X, y ∈ Y, log f [x](y) ∈ [-B,B], for any δ ∈ (0,0.5), with
probability at least 1 - 2δ, we have:
IV (X → Y) - IV (X → Y； D) ∣ ≤ 4R∣d∣(Gv) + 2B y2⅛
O
O
Proof. Define f = arg min E - log f [xi](yi) and f0 = arg min E - log f [0](yi). Using
f ∈v χi,yi∈D	f ∈v yi∈D
the triangular inequality we have:
I Iv (X → Y) - Iv (X → Y； D) ∖
=∖ (HV(Y) - HV(Y 1X)) - I |D| X - log fe[0](Ui)- |D| X - log f [xi](Ui)
∖	∖	yi∈D	χi,yi∈D
≤∣(HV(Y) - ∣D∣ X - log f[0](yi)) - (HV(YIX) - D X - log f[χi](yi)
≤∖ HV(Y ㈤-∣D∣ JD
O,
-log f[χi](yi) + HV(Y)-
1 L . ʌ ʊ ,
|D| T -logfe[0]3i)
1D1 yi∈D
(32)
For simplicity let
DY ∣x
1
HV (Y |X) - ∣D∣ E - log f [xi](yi)
Xi,yi∈D
and
1
Dy = hv(y) -IDiE TOgfe[0]3i)
With inequality (32), Lemma 3 and Lemma 4, we have:
Pr(IIV(X → Y) - IV(X → Y； D) I > 4R | d∣(Gv) + 2Bj2∣Di
≤ Pr (DY | X + DY > 4R ∣ D∣ (GV) + 2bJ2∣D
(Inequality (32))
≤ Pr ((dy∣ x > 2R । D∣(Gv) + B^2^) V (DY > 2R ∣ D∣(Gv) + B^2^
≤ Pr (DY ∣ χ > 2R ∣ D∣ (GV) + Bj2⅛ I + Pr (DY > 2R ∣ D∣ (GV) + Bj2∣D
≤ 2δ
Hence we have:
(Union bound)
(Lemma 3 and Lemma 4)
Pr ( ∣ Iv (X → Y) - IV (X → Y； D) ∣ ≤ 4R ID∣(Gv)+2B ʌ/2^) ≥ 1 - 2δ
which completes the proof.
□
17
Published as a conference paper at ICLR 2020
A.4 Proof of Corollary 1.1
Corollary 1.1. Assume X = {x ∈ RdxJxg ≤ kχ} and Y = {y ∈ Rdy, ∣∣y∣∣2 ≤ ky}. If
V = {f : f [x] = N(WX + b,I),f [0]= N(c,I),W ∈ Rdy×dx,b,c ∈ Rdy,∣∣(W,b)∣∣2 ≤ 1}
Denote M = (kχ + ky )2 + log 2π, then ∀δ ∈ (0, 0.5), with probability at least 1 — 2δ:
IIV (X →Y)-IV (X → Y； D)I ≤ -m= (ι+4J2iogδ)
The proof is an adaptation of the proof for theorem 3 in Kakade et al. (2008).
Proof. From theorem 1 we have:
,/HgI
V |D|
I Iv(X → Y) — IV(X → Y; D) I ≤ 4R∣d∣(Gv) + 2B
In the following ∣∣(W, b) ∣∣ 2 is the matrix 2-norm of (W, b), then the Rademacher term can be bounded
as follows:
R | DI (GV) = ∣D∣ Eσ	sup W,b,k(W,b)k2≤1	D E σ l i=1		og √π	-2 lly2	-WXi	―即2)1 J		
≤∣⅛Eσ	sup WMI(W,b)∣∣2≤1		D E σi i=1	[-2 ∣yi	-WXi	-bl2)	j +1⅛Eσ	D E σ log i=1	1 √2π
(33)
The second term in RHS can be bounded as follows:
1 Γ ∣d∣	1 I 1
向 Eσ J X σilθg √2π i J
=|D| jD|*(IOg
/(log 志)2
=V ∣d∣
The first term in RHS can be bounded as follows:
1
≤ 一
≤ |D|
(concavity of X 2)
(Independence of σis)
(34)
卷 ED,σ
sup
WAk(W,b)∣∣2 ≤1
D	1
工2(-2 kyi - WXi- "C
2∣dΓ ED，。	sup
2|DI	W,b,k(W, b)k2≤1
∣d∣
Eσ (I" - Wxi — b∣∣2)
2=1
≤ maxi∣"k2
≤	2
|D| + max∣xi∣
2
2
max2∣"k2
+ 2⅛ ED,σ
sup
W,b,k(W,b)k2≤1
|D|
I D I
Eσ (∣Wxi + b∣∣2)
i=1
(35)
18
Published as a conference paper at ICLR 2020
maxi kyi k2 cik2V	|D| sup W,b,k(W,b)k2≤1	1D1	- X σi (kWxi + bk) i=1
19
Published as a conference paper at ICLR 2020
From lemma 4 and lemma 3 we have:
Pr >max 2RDi,j(Gi,j)+2RDj(Gj)+B
(∣Dj ∣-1 + ∣Di,j∣-1)})
≤ Pr (∃i,j,∣IVi,j(Xi → Xj) - IVi,j(Xi → Xj； D)∣ > 2RDi,j(Gi,j) + 2RDj (Gj) + B^2log 1(∣Dj∣-2 + ∣Di,j∣-1)
≤ Pr 卜 i,j, ∣ (HVj (Xj ) - ∣D^∣ X - lθg f0[0](xj ))-
HVi,j (Xj∣Xi) - ∣D^-∣	X	-log f[χi](χj)
∣Di,j ∣ xi,xj ∈Di,j
> 2RDi,j(Gij)+2RDj(Gj)+ Bʌ/ɪiogɪ(|Dj|-1 + ∣Di,j∣-2)
≤ Pr ∃i, j,
HVj (Xj)-∣⅛ι
xj ∈Dj
E - log f0[0](xj) > 2RDj (Gj) +
B
∣Dj∣-2

∨ (∣HVi,j (XjIXi)-I⅛ χ.χXD..
xi ,xj ∈ i,j
-log f[xi](Xj ) > 2RDi,j (Gij ) + B V2log j ∣Di,j∣-
≤ m(m - 1)2δ
(By lemma 3, 4 and union bound)
Hence

1
2
Pr ≤max 2RDi,j(Gi,j)+2RDj(Gj)+B
(∣Dj∣-2 + ∣Di,j∣-2)	≥ 1 - m(m - 1)2δ
(40)
Then combining inequality (39) and (40) we arrive at the result.
□
B Analysis of approximate estimators for Shannon information
We consider two approximate estimators for Shannon information. The first is the CPC (or InfoNCE
in Poole et al. (2019)) estimator (ICPC) proposed by van den Oord et al. (2018):
ICPC = E
ɪ X log fθ (xi,yi)____________
N i=1 寺 Pj=ιfθ (Xi,yj)
≤ I(X;Y)
(41)
where the expectation is over N independent samples form the joint distribution	p(xi, yi).
i
The second is the NWJ estimator (INWJ) proposed by Nguyen et al. (2010):
INWJ = Ex,y~p(x,y) [fθ(x, y)] - e Ex,y~p(x)p(y)"，")]≤ I(X; Y)
(42)
In both cases, fθ is a parameterized function, and the objectives are to maximize these lower bounds
parameterized by θ to approximate mutual information. Ideally, with sufficiently flexible models and
data, we would be able recover the true mutual information. However, these ideal cases does not
carry over to practical scenarios.
For ICPC, van den Oord et al. (2018) show that ICPC is no larger than log N, where N is the batch
size. This means that the ICPC estimator will incur large bias when I(X; Y) ≥ log N. We provide a
proof for completeness as follows.
Proposition 3. ∀fθ : X × Y → R+,
ICPC ≤ log N.
(43)
20
Published as a conference paper at ICLR 2020
Proof. We have:
ICPC := E
≤E
which completes the proof.
ɪ X log______fθ (Xi,yi)_
N i=1	Nn Pj= fθ (My)
1 XX lo fθ (Xi,yi)
N = °g Nfθ(Xi,y)
≤E
1N
N ∑log N
i=1
log N
(44)
(45)
□
For NWJ, We note that the INWJ involves a term denoted as Eχ,y〜p(x)p(y)[efθ(x,y)] /e, which could
be dominated by rare data-points that have high fθ values. Intuitively, this would make it a poor
mutual information estimator by optimizing θ. The NWJ estimator may suffer from high variance
when the estimator is optimal (Song & Ermon, 2019), this is also empirically observed in Poole et al.
(2019). We provide a proof for completeness as follows.
Proposition 4. Assume that fθ achieves the optimum value for INWJ. Then the variance of the
empirical NWJ estimator satisfies Var (INWJ) ≥。"二；)-1, where
N	-1 N
INWJ = N X [fθ(Xi, yi)] - eN X [efθ(≡i,yi)]
i=1	i=1
is the empirical NWJ estimator with N i.i.d. samples {(Xi, yi)}iN=1 from p(X, y) and N i.i.d. samples
{(Xi,yi)}N=ι from p(x)p(y).
Proof. Let Us denote Zi = Ppxxipyyi). Clearly Ep(X)p(y)[zi] = 1. Then we have:
Ep(X)p(y)〕( PPXX)Pyyi))
-1
-P(Xi,y)-
-P(Xi)P(yi) 一
-1
≥ eEp(x,y) hlog Ppxiipyyi) i -1 = eI(XY) -1
where we use Jensen’s inequality for log at the last step.
From Nguyen et al. (2010), we have:
fθ (X, y) = 1 + log
p(X,y)
P(X)P(y)
(46)
(47)
(48)
for all X, y. Since {(Xi, yi)}N=1 (resp. {(Xi, yi)}N=1) are N datapoints independently sampled from
the distribution P(X, y) (resp. P(X)P(y)), we have
1 N	e-1 N
Var (INWJ) =Var N X [fθ(x,, yi)] - -N X [efθ(≡i,yi)
i=1	i=1
≥ Var
Var fɪ X z) ≥ eI(X;Y) T
Ngi	N
which completes the proof.
□
(49)
21
Published as a conference paper at ICLR 2020
Algorithm 1 Construct Chow-Liu Trees with V -Information
Require: D = {Xi}im=1, with each Xi being a set of datapoints sampled from the underlying
distribution of random variable Xi. The set of function families {Vi,j }im,j=1,i6=j between all the
nodes.
1:	for i = 1, . . . , m do
2:	for j = 1, . . . , m do
3:	if i 6= j then
4:	Calculate the edge weight: ei→j = IVi,j (Xi → Xj; {Xi, Xj}).
5:	end if
6:	end for
7:	end for
8:	Construct the fully connected graph G = (V, E), with node set V = (X1, . . . , Xm) and edge
set E = {ei→j }im,j =1,i6=j.
9:	Construct the maximal directed spanning tree g on G by Chow-Liu algorithm, where mutual
information is replaced by V -information.
10:	return g
C The new algorithm for Chu-Liu tree construction
See Algorithm 1; IVi,j (Xi → Xj; {Xi, Xj}) denotes the empirical V -information.
D	Detailed Experiments setup
D.1 Chu-Liu tree construction
Figure 2 shows the Chu-Liu tree construction of Simulation-1 〜Simulation-6. The Simulation-A and
Simulation-B in the main body correspond to Simulation-1 and Simulation-4.
Simulation-1 〜Simulation-3
The ground-truth Chu-Liu tree is a star tree (i.e. all random variables are conditionally independent
given X1 ). We conduct all experiments for 10 times, each time with random simulated orthogonal
matrices {Wi}2=2. Simulation-1: Xi 〜U(0,10) and Xi | Xi 〜N(WiXι, 6I), (2 ≤ i ≤ 20);
Simulation-2: Xi 〜U(0,10) and Xi | Xi 〜WiE(Xi + Ci), (2 ≤ i ≤ 20), Ci 〜E(0.1); Simulation-
3 is a mixed version:Xi 〜U(0,10), Xi | Xi 〜ɪN(WiXi, 6I) + ɪ WiE(Xi + ci), (2 ≤ i ≤ 20).
Simulation-4 〜Simulation-6
The ground-truth Chu-Liu tree is a tree of depth two. We conduct all experiments for 10 times, each
time with random simulated orthogonal matrices {Wi}7=2∙ Simulation-4: Xi 〜U(0,10), Xi | Xi 〜
N(WiXi, 2I)(i = 2,3), Xi | X2 〜N(WiX2,2I)(i = 4,5), Xi | X3 〜N(WiX3, 2I)(i = 6, 7);
Simulation-5: Xi 〜U(0,10), Xi | Xi 〜E(Xi + ej(i = 2, 3), Xi | X2 〜WiE(X2 + Ci)(i = 4,5),
Xi | X3 〜 WiE(X3 + Ci)(i = 6, 7), Ci 〜 E (0.1); Simulation-6 is a mixed version: Xi 〜
U(0, 10), Xi | Xi 〜 WiE(Xi +Ci)(i = 2, 3), Xi | X2 〜 N(WiX2,2I)(i = 4, 5), Xi | X3 〜
N(WiX3,2I)(i=6,7),Ci 〜 E(0.1).
D.2 Fairnes s
We can adapt the V -information perspective to fairness. Denote the random variable that represents
sensitive data and the representation as U and Z respectively. Assume U is discrete and V belongs to
preditive family 1. Then we have HV(U) = H(U) as long as V has softmax on the top and belongs
to predictive family. In this case, minimizing IV(Z → U) equals to minimize -HV (Y |X). Let the
joint distribution of Z and U be paramterized by φ. Hence the final objective is:
min{Iv(u; z)} = min sup Ez,u^qφ(z,u) [log Pf(Z|u)]
φ	φ	f∈V
In Edwards & Storkey (2015); Madras et al. (2018); Louizos et al. (2015); Song et al. (2018), functions
in V are parameterized by a discriminator.
22
Published as a conference paper at ICLR 2020
.86 4 2 Q
a0.0.0.0.
OnBJls<uω)ps⅛uo,IM PaPQdXW
E 7-6543.2JQ
o.o.o.ao.ao.o.o.
O□BYS⅛P3⅛UOJM PM8dx口
V-information(Guassian)	V-information(Lapladcan)	MINE -------- CPC ---------- NWJ
Figure 2: Chu-Liu Tree Construction: The expected Wrong-edges-ratio of algorithm 1 with different
V and other mutual information estimators-based algorithms from sample size 10 to 5 X 103.
For the (Fi, Fj-) elements described in the main body, please refer to figure 3b. The three datasets
are: the UCI Adult dataset2 which has gender as the sensitive attribute; the UCI German credit
dataset3 which has age as the sensitive attribute and the Heritage Health dataset4 which has the 18
configurations of ages and gender as the sensitive attribute.
The models in the figure are:
VA = {f : Z→P (U)If [z](u) = P,ekzi-z[-zk2,“ * I(Ui = u),h ∈ R}, where D is
(zi,ui)∈D	(zi,ui)∈D ekzi-zk2 /h
the training set.
VB = {f : f[z] = softmax(g(z))}, where g is a two-layer MLP with Relu as the activation function.
VC = {f : f[z] = softmax(g(z))}, where g is a three-layer MLP with LeakyRelu as the activation
function.
We further visualize a special case of the (VA, VB) pair in figure 3a, where the Vi = {f : Z →
P (U )∣f [z](u) = P ---------ekzi ZIkj/-z∣∣2- * I(Ui = u), h ∈ R} explicitly makes the features
(zi,ui)∈D	(zi,ui)∈D e	2 /h
of different sensitivity attributes more evenly spread, and functions in VB is a simple two layers MLP
with softmax at the top. The leaned features by VA-information minimization appear more evenly
spread as expected, however, the attacker functions in VB can still achieve a high AUC of 0.857.
The (i, j ) elements of tables in Figure 3b stand for using function family Vi to attack features trained
with Vj -information minimization. The diagonal elements in the matrix are usually the smallest in
rows, indicating that the attacker function family Vi extracts more information on featured trained
with Vj(j6=i)-information minimization.
2https://archive.ics.uci.edu/ml/datasets/adult
3https://archive.ics.uci.edu/ml/datasets
4https://www.kaggle.com/c/hhp
23
Published as a conference paper at ICLR 2020
ɔ. 673 O. 682
Figure 3: T-SNE Visualization and AUC of predicted sensitive attribute
E Minimality of Predictive Family
Define Vχ→p(γ) = {g : X → P(Y)∣∃f ∈ V,∀x ∈ X,g[x] = f [x]}. Similarly define V0→p(γ)=
{g : 0 → P(Y)∣∃f ∈ V,g[0] = f [0]}. Intuitively, Vχ→p(γ)(resp. V0→p(γ)) restricts the domain
of functions in V to X (resp. 0).
Non-Negativity As we demonstrated in Proposition 2, optional-ignorance guarantees that informa-
tion will be non-negative for any X and Y. Conversely, given any discrete X, Z, V0→p(Y), Vχ→p(Y)
that does not satisfy optional-ignorance, there exists distribution X, Y such that IV (X → Y) < 0.
Choose Y 〜f *[0] where f * is the function that has no corresponding g ∈ Vχ→p(Y)that can
ignore its inputs. Pick X as the uniform distribution, and note that for all g ∈ G, there exists some
measurable subset X0 ⊂ X on which g will produce a distribution unequal to f* [0], and therefore
having higher cross entropy. The expected cross entropy expressed in HVX→P(Y) (Y|X) is thus higher
than in 四⑦一尸①)(Y), and IV(X → Y) < 0. Thus, if the function class does not satisfy optional
ignorance, then the V-information could be negative.
Independence Given any discrete X, Y, V0→p(γ), Vχ→p(Y)that does not satisfy optional-
ignorance, there exists an independent X, Y such that IV (X → Y) > 0. Choose Y such that the
distribution PY can be expressed as g[x] for some x ∈ X, g ∈ VX→P(Y), but cannot be expressed by
any f ∈ V0→p(Y). Let X be the distribution with all its mass on x; note that the cross entropy of
PY with g [x] will be zero, and is less than that of the function f [0] (because f [0] and PY differs on
a measurable subset, the cross entropy will be positive). Thus, if the function class does not satisfy
optional ignorance, then the V-information does not take value 0 when the two distributions are
independent.
F Limitations and Future Work
V -information is empirically useful, has several intuitive theoretical properties, but exhibits certain
limitations. For example, Shannon information can be manipulated with certain additive algebra
(e.g. H(X, Y) = H(X) + H(Y | X)), while the same does not hold true for general V -Information.
However, this could be possible if we choose V to be a mathematically simple set, such as the
set of polynomial time computable functions. It would be interesting to find special classes of
V -Information where additional theoretical development is possible.
Another interesting direction is better integration of V -Information with machine learning. The
production of usable information (representation learning), acquisition of usable information (active
learning) and exploitation of usable information (classification and reinforcement learning) could
potentially be framed in a similar V -information-theoretic manner. It is interesting to see whether
fruitful theories can arise from these analyses.
24