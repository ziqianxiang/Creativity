Figure 1: Illustration of possible trajectories. Thegrey lines represent the unperturbed evolution ofthe physical system. The amount of applied forcecorresponds to how far the trajectory deviatesfrom the natural evolution.
Figure 2: Single-shooting optimization with a control force estimator (CFE). (a) The forward passsimulates the full sequence. (b) Backpropagation computes the adjoint problem. (c) Weight updatesare accumulated and applied to the CFE.
Figure 3: Overview of the different execution schemes.
Figure 4: Trajectories for an example control task using Burger’s equation. Initial and target statesare plotted with thick dashed lines in red and blue, respectively. Inferred states are shown as solidlines. (a) Natural evolution. (b) Reconstruction using a CFE chain. (c,d) Reconstructions using ourhierarchical predictor-corrector scheme. (e) Ground-truth trajectory generated with constant force.
Figure 5: Example reconstructed trajectory from (a) the natural flow test set and (b) the shape testset. The target state o* is shown on the right.
Figure 6: Indirect control sequence. Obstacles are marked white, control regions light blue. Thewhite arrows indicate the velocity field. The domain is enclosed in a solid box with an open top.
Figure 7: OP and CFE+Solver (Sol) executions for a sequence of length 8 performed by (a) thestaggered execution scheme, (b) the prediction refinement scheme. The execution order is from topto bottom.
Figure 8: Trajectories for example control tasks using Burger’s equation. The initial state is plot-ted in red, the target state in blue. (a) Natural evolution, (b) Ground truth trajectory generatedwith constant force, (c) CFE with supervised loss, (d) CFE with differentiable physics loss, (e) Re-construction with supervised loss, (f) Reconstruction with differentiable physics loss and staggeredexecution, (g) Reconstruction with differentiable physics loss and prediction refinement.
Figure 9: Histogram comparing the frequency of force strengths of different methods, summed over100 examples from the Burger’s experiment.
Figure 10: Reconstruction of an example natural flow sequence from the test set. The predictionsop are plotted above the reconstructions u. The target state o* is shown in the last column of thepredictions.
Figure 11: Reconstruction of multiple shapes using prediction refinement. The CFE is trained on thenatural flow dataset and OPs are trained on single-shape transitions. The predictions of all shapesare added and passed to the CFE as one prediction.
Figure 12: Histogram comparing the frequency of force strengths applied in the direct fluid controlexperiment on the natural flow dataset, summed over 100 examples.
Figure 13: Two reconstructed trajectories from the test set of the indirect smoke control problem.
Figure 14: Iterative optimization of the indirect incompressible fluid control problem. The graphshows the fraction of smoke that ends up in the correct bucket vs number of optimization steps,averaged over 10 examples.
Figure 15: Mean convergence curves of the adjoint method optimization for 100 shape transitions.
Figure 16: Mean convergence curves of the adjoint method optimization for 100 shape transitions,taking the reconstruction from the refinement scheme as initial guess.
Figure 17: Example reconstruction of a shape transition. (a) Direct shooting optimization, 2300iterations, (b) multi-scale shooting optimization, 1500 iterations, (c) output of our neural networkbased method with prediction refinement. Our model infers the shown solution in a single pass, andgeneralizes to a large class of inputs.
Figure 18: Five additional sequences from the test sets of the natural flow and shape transitionsetups. The first nine frames contain frames from our reconstruction. The far right image shows thetarget.
