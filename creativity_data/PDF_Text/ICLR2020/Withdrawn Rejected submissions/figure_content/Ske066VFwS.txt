Figure 1: A) Hierarchy of dynamical systems, B) Schema of calcium and Lorenz dynamics, C)Schema of our hierarchical model. Latent dynamics model in blue, spike inference and calciumdynamics model in red.
Figure 2: A) Example calcium fluorescence traces, B) Example Poisson intensity functions, C)Example spike trains, D) Inferred dynamics. Red: Ground-truth, Blue: Reconstructed, E-H Scatterplots of reconstructions and ground truthJU_⅛⅛JUUUUlJU-JMjlLl⅛ΛU ι⅛u∪Λ____h_______位14 spikesL≡2cs I______wukFluorescence3.1	Lorenz systemThe model was tested on synthetic data with Lorenz dynamics embedded in the frequency of cal-cium fluorescence transients, as described by Zhao & Park (2017), where generated spikes wereconvolved with an exponential kernel with a time constant of 0.4 ms, and white noise added tothe resulting traces. We measure the performance of the model in three ways: 1) uncovering the4Under review as a conference paper at ICLR 2020Table 1: Comparison of model performance on synthetic Lorenz dataset. A hyphen indicates it isnot possible to compare, as the model does not infer this variable. The top row is italicized as itis considered the upper limit on performance in this task with LFADS since there is no additional
Figure 3: A) Example calcium fluorescence traces, B) Example spike trains, C) Example Poissonintensity functions, D) Inferred latent dynamics, E) Inferred input. The black arrow indicates thetrue timing of external perturbation. Red: Ground-truth, Blue: ReconstructedFigure 3A-C shows examples that illustrates the performance of our model in reconstructing fluores-cence traces (Fig 3A), spike trains (Fig 3B), and intensity functions (Fig 3C). Visually, the fluores-cence traces and spike trains have been reconstructed reasonably well, whereas reconstructions ofthe the intensity functions are highly noisy. The latent dynamics represented by the factors (Fig 3D)and external inputs (Fig 3E) also show a lot of noise. This appears to be due to difficulty in inferringexternal inputs, in which it is not clear whether the timing of external perturbation has been accu-rately inferred, despite a slight transient at roughly the time of the perturbation in the example. Table2 compares the R2 goodness-of-fit on reconstructing held-out validation data, which demonstratesthat our model performs very well in reconstructing the fluorescence signal and does reasonablywell at reconstructing spikes. However, in this more complex benchmark where the deeper dynamic6Under review as a conference paper at ICLR 2020system is perturbed by external input, the pre-processing of fluorescence transients with the OASISdeconvolution algorithm reconstructs firing rates far better than our method.
Figure A1: Directed acyclic graph for hierarchical model. Solid arrows denote deterministic map-pings, open arrows denote sampling steps.
