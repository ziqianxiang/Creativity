Figure 1: Overview of the recurrent training, in which the NN model is coupled with a differentiablePDE solver. Each unit, shown with dashed-lines, represents one time step, and multiple steps areunrolled so that the model can take into account temporal information when learning.
Figure 2: Rising smoke. (a) The initial size of a smoke volume is randomized in two simulations.
Figure 3: Corrected rising smoke simulation. Our model is applied to two test cases A and B. Aftercorrecting 400 steps, the density fields are compared among the basic method, ground truth, andcorrected method (our model). (See Fig. 11 in Appx. A.2 for more comparisons.)using the Boussinesq model. We randomize the initial size of the smoke volume. Fig. 2 showstwo selected randomized initial setups at the left most. Additionally, two different results of thereference and basic simulations after 1,000 simulation steps are shown in the subsequent columns,respectively. It is worth noting that the reference simulations are significantly different from thebasic ones, moreover, the small variations in the initial setup result in significant differences evenafter short periods of time. We use a regular MacCormack scheme (Selle et al., 2008) for the basicsimulation and the more accurate and compute-intensive advection-reflection scheme (Zehnder et al.,2018) for the reference. The grid resolution of the basic simulation is 32×64, and a four times finergrid is used for the reference.
Figure 4: Relative errors of the risingsmoke correction model. The trainedmodel corrects the velocity field for 500steps. Relative errors in (a) density and(b) velocity with respect to reference areshown for Test A from Fig. 3.
Figure 5: Comparison between the naive and our model.
Figure 6: Analysis of the corrected simulations for rising smoke. Example frames after 80 timestepsfor the following versions are shown: basic, reference, and our model. Our model is trained with 48recurrent steps as in Fig. 1. The trained model, then, corrects the velocity field for 100 steps. TheL2 errors in (a) velocity and (b) correction are measured from the ground truth at every step. (SeeFig. 12 in Appx. A.2 for more results.)7Under review as a conference paper at ICLR 2020containing larger per step differences with respect to ground truth corrections. This indicates that,by looking ahead more steps from the solver, the model learns to anticipate the future dynamicsand corrects the target function accordingly instead of relying on the seemingly ideal corrections foreach time step.
Figure 7: Relative errors of both super-vised and unsupervised models. Rela-tive errors in (a) density and (b) velocitywith respect to reference are shown forTest A from Fig. 8.
Figure 8: Corrected rising smoke simulations. Both supervised and unsupervised models are appliedto two test cases A and B. After correcting 200 steps, the corrected density fields are compared withrespect to the ground truth and the reference.
Figure 9:	NN architectures. Two models that are used in our experiments are presented. The blue andmagenta colors indicate the ReLU and LeakyReLU activation functions, respectively. The curvedlines indicate skip connections; the dotted lines show an additional 1×1 convolution, which makesthe number of channels same when adding.
Figure 10:	Comparison of errors in inferred correction between two supervised models with differentnumbers of input channels. Here, k denotes the number of subsequent states used for the input.
Figure 11: Corrected rising smoke simulation. Our supervised model is applied to two test casesshown at each row. At three selected steps, the density fields are visualized among the basic method,ground truth, and corrected method (our model).
Figure 12: Two test simulations for the rising smoke example. After individual training with differ-ent numbers (i.e., 8, 16, and 48) of recurrent steps, each model is applied to two test setups, test Aand B. The images at the top row show the density visualization after 80 steps. The graphs in (a)compare the corrected velocity fields, and those in (b) show the errors of inferences for the giveninput steps.
Figure 13: Stream flow starting from a randomly initialized setup for the width and height of twoobstacles. The color indicates the direction of velocity, in each case, for basic, reference, and groundtruth versions.
Figure 14: Corrected stream flow simulations. Our model is applied to two test cases A and B. Thedensity fields are compared at the selected steps. The color indicates the direction of velocity.
