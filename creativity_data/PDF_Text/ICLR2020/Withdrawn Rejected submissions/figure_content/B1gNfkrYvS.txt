Figure 1: 3D convolution: tensor-to-sCalar mapping. The shape of input is 8 X 8 X 4. The shape of3D kernel is 4 X 4 X 3. As a result, the shape of output is 5 X 5 X 3. Yellow area shows current inputarea being convolved by kernel and corresponding output.
Figure 2: Capsule convolution in P-CapsNets: tensor-to-tensor mapping. The input is a tensorof 1's which has a shape of 1 X 5 X 5 x(3 X 3 X 3) (correspond to the the input channel, inputheight, input width, first capsule dimension, second capsule dimension, and third capsule dimension,respectively). The capsule kernel is also a tensor of 1,s which has a shape of 4 X 4 X 1 X 1 x(3 X 3 X 3)— kernel height, kernel width, number of input channel, number of output channel, and the threedimensions of the 3D capsule. As a result, we get an output tensor of 48’s which has a shape of1 X 2 X 2 ^ (3 X 3 X 3). Yellow areas show current input area being convolved by kernel andcorresponding output.
Figure 3: Visualization of filters in P-CapsNets. Top: conv1 layer, conv2 layer. Bottom: conv3layer, conv4 layer.
Figure 4: Correlation Matrix of Convolution Layers between CNNs and P-CapsNets. CNN: (a)conv1: 5x5x1x256; (b) conv2: 5x5x256x256. P-CaspNets: (c) capconv1: 1x1x3x3x(1x1x16); (d)capconv2: 1x1x3x3x(1x4x8).
Figure 7: The structure P-CapsNets#2.
