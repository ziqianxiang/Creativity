{
    "Decision": {
        "title": "Final Decision",
        "decision": "Accept (Spotlight)",
        "comment": "The paper proposes a novel loss for segmentation tasks, which incorporates reasoning about topological accuracy of predicted segmentations vs. ground truth. All reviewers, after the rebuttal period, recommend acceptance, and I agree -- it's an interesting paper, offering a potentially useful and clearly novel building block for training segmentation models."
    },
    "Reviews": [
        {
            "title": "Interesting and well-grounded method for end-to-end learning of topologically correct segmentations; evaluated on a large number of benchmark datasets",
            "review": "The paper focus on the segmentation of images in which the correct topology of the segmentation an important role plays. The key idea of the paper is the use of Discrete Morse Theory to identify those areas of the segmentation/likelihood map that are important for ensuring the correct topology of the segmentation. This is achieved by modulating the normal binary cross entropy loss function so that areas of Morse structures are focused on during the learning. \n\nWhile DMT  is not my area of core expertise, I believe that the proposed use Morse structures for the end-to-end training of a network is novel and a very interesting idea. While the basic idea sounds simple, the implementation is not that simple. In particular, the computation of Morse structures is slow and also sometimes unstable. The paper addresses all of these issues nicely (adopting a fast approximation and pruning step).\n\nThe paper is well written but still difficult to read for somebody who is not very familiar with DMT. The proposed approach has been well evaluated on a number of biomedical and non-biomedical datasets. This evaluation includes the comparison to other approaches with and without topology-aware segmentation.",
            "rating": "7: Good paper, accept",
            "confidence": "2: The reviewer is willing to defend the evaluation, but it is quite likely that the reviewer did not understand central parts of the paper"
        },
        {
            "title": "An interesting piece of theory",
            "review": "This manuscript introduces a segmentation framework that combines discrete morse theory to encourage topological correctness of the segmentation. Based on the evaluation on both 2D and 3D datasets, the proposed method has the potential to improve segmentation in selective applications where the topology is of great interest. \n\nSome constructive feedbacks:\nWhile the Morse theory itself seems to be interesting, the way it is incorporated with deep learning can be better justified. The MST algorithm is not a functional, is non-deterministic, and changes with iterations, so the converging property of the objective function is not clearly studied.\n\nBoth hyperparameters are not chosen by inner cross-validation. Instead, the optimal results reported for the proposed method are based on a search via cross-validation, which is not the case for other baselines according to my reading.\n\nThe proposed method essentially highlights segmentation accuracy in geometrically rich regions. I wonder how essential it is to have the Morse theory compared to other simpler choices, e.g. edge detector, ridges/valleys estimator, or even just a gradient field.\n\nOften times the biggest drawbacks for conventional geometric methods are their inferior generalizability and vulnerability to noise. An experiment with respect to noise level can be very helpful\n\n",
            "rating": "8: Top 50% of accepted papers, clear accept",
            "confidence": "3: The reviewer is fairly confident that the evaluation is correct"
        },
        {
            "title": "Interesting method, but missing details and comparison to state of the art segmentation methods",
            "review": "## Summary and contributions\nThis paper tackles the problem of topological correctness of segmentation of fine structures.\nEspecially for the study of biological or medical processes this is often essential.\nThe authors propose to use discrete Morse theory (DMT) to help a deep neural network focus on areas that are currently topologically incorrectly segmented.\nThe result of DMT is similar to the classical watershed transform, yet provides a sound mathematical basis.\nMoreover the paper claims that commonly used metrics often do not value topological correctness enough and proposes to use metrics that are more in line with this goal.\n\n## Strengths\n- The paper combines theoretical advances in topology and Morse theory with current practical methods\n in deep learning. Thus it tries to motivate its approach with a sound mathematical basis.\n- The imbalances often present in datasets with fine structures, resulting in a sampling bias, are are alleviated using global features.\n- It is written in a clear and comprehensible way\n- The method is evaluated on multiple datasets and compared to a range of related work\n\n## Weaknesses:\n- Many details are missing to make this work reproducible\n- The method uses topology to create a mask for the loss, however the topology is not directly enforced in the loss\n- Even though most of the datasets are from challenges, the results are not compared to the current leader board\n\n\n## Clarity:\nFor the most parts the paper is written very clearly. The introductions to Morse theory are well understandable.\nThe related work part is a little dense, making it hard to extract really relevant work.\n\n\n## Reproducibility:\nIn the current form it is not possible to reproduce the results without considerable effort.\nThere are many parameters missing.\n- It is mentioned that epsilon is chosen using cross-validation, but not in which value this resulted, the same holds for beta.\n- The authors mention that a neural network architecture inspired by the U-Net is used, however all details about the specifics of the used networks are missing (dimensions, layers, feature maps, learning rate, used optimizer etc)\n- The authors mention required training time, however without specifying the used hardware or number of steps.\n- Will the code be published? Is existing code used to compute the Morse structures or did the authors implement it?\n\n\n## Additional feedback, comments, suggestions for improvement\nGeneral comments:\n- It is a nice aspect for the reader that the authors tried to distinguish significant from insignificant improvements over previous methods.\n\nRequests for clarification:\n- Could the authors please clarify how they use the word epoch? Usually it is used to describe one pass through the whole dataset, but it sounds like\nit is used here to refer to a single step.\n- Page 5, computation: Could the authors please clarify how the (costly) persistence computation can be avoided if it is needed, according to the next\nsentence, to distinguish between below and above the persistence threshold epsilon.\n- The result seems to be similar to an increased weight for FP,FN and TP pixels or a decreased weight for TN pixels.\nCould the authors please elaborate on how the effect of their method differs from this.\nHave the authors performed experiments with this as a baseline/part of an ablation study (with cross-validated weights)?\nThis would be very interesting.\n\nClaims that might be formulated a bit to strongly:\n- The authors correctly claim that unbalanced data is an issue and that just using more annotated data (with the same unbalance) is often not a simple\nremedy. This is often true, however, a number of approaches have been developed to alleviate this problem and more annotations with more hard cases\ncan be helpful for it.\n- The authors claim that \"by focusing on more critical locations early, our method is more likely to escape poor local minima of the loss landscape\".\nCan the authors please elaborate on the experimental basis for this claim?\n- The authors claim, citing related work (Hardt et al), that shorter training time might improve performance. However, just the same, there is related\nwork claiming the opposite ([1]). This seems to be an open problem and thus speculating about it should be founded in experimental data.\n- Fig 1, caption (\"baseline ...without topological guarantee\"): This gives the impression that the presented method provides topological guarantees.\nIn the introduction the authors mention that the method tackles the sampling bias, which sounds reasonable, but it does not provide guarantees. If it\ndoes provide guarantees, could the authors please elaborate on how these are strongly enforced?\n\nSuggestions:\n- The authors nicely cite a lot of related work. However, it would be interesting how they are different and how the work at hand tackles specific\nproblems that are left open by them. Or if they solve the same problem with a very different approach, which is also perfectly fine and still valuable\nfor the field.\n- The complexity given for 3d images for S_1 gives, to a cursory look, the slightly misleading impression that it is still n log n whereas it seems to\nbe more than quadratic due to the n^w in T.\n- The conclusion might benefit from a few more details regarding for example remaining issues.\n- I understand that there is a page limit, however the discussion of the results comes up a bit short.\n\nTypos:\n- Page 4, Sec 2.2: on the the original definition\n\n## note about review:\n- I cannot fully judge the formal correctness of the authors' description of DMT.\n\n[1] Hoffer et. al.: Train longer, generalize better: closing thegeneralization gap in large batch training of neural networks\n",
            "rating": "5: Marginally below acceptance threshold",
            "confidence": "3: The reviewer is fairly confident that the evaluation is correct"
        },
        {
            "title": "Improvement of Topoloss",
            "review": "The paper introduces an elegant, yet not fully novel, idea: use a discrete morse complex to define a new loss for image and volume segmentation. The idea of using topology in the loss is similar to TopoLoss, but the use of larger critical structures makes this approach slightly outperform topoloss.\n\nThe paper is in a difficult spot: most of the paper (pages 2-6) provides an overview of Morse theory, the discrete version, and an algorithm to compute it on images. I don’t see any novelty there, as it seems to be all coming from the cited papers, except for the loss in section 2.3. Could you clarify if this is the case or if there is anything else that is novel? If indeed that is the only novelty the paper could be shortened by citing the corresponding papers instead of repeating well-known material  (or maybe moving it to an appendix to make it self-contained).\n\nThe comparison is extensive and while the method outperforms most of the baselines, the results are quite similar (2D) to TopoLoss (which uses a loss based on persistent homology, closely related to the one proposed here), with minor differences (the more noticeable in the betti error, which is ~10-15% better). In 3D the difference is even smaller and there is no clear winner between the two.\n\nI do not understand how the Morse structure used in the loss can be differentiable. The authors state explicitly that both the structure and the mask change not continuously. I don’t understand the logical step that leads to the conclusion that the loss is differentiable, could you clarify?\n\nOverall, the paper is a variant of Topoloss which has slightly better results. I am neutral on this paper as I am not familiar with the expectations for an ICLR paper. I don’t think the paper novelty is sufficient for acceptance, but there are measurable numerical improvements in the 2D results that might be useful in applications (no applications of the resulting segmentations are shown in the paper, unfortunately).",
            "rating": "6: Marginally above acceptance threshold",
            "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"
        }
    ]
}