{
    "Decision": {
        "title": "Final Decision",
        "decision": "Accept (Poster)",
        "comment": "The paper combines flow-based and energy-based models to generate molecular conformations given a molecular graph.\nFor this, a continuous flow model is used to map the graph-based molecular representation into a distribution over conformations. \nAn energy-based model (EBM) is used to further help the model capture long-range atomic interactions. The proposed method is compared with strong baselines: CVGAE, GraphDG, and RDKit.\n\nThe authors addressed most of the reviewers' concerns in the rebuttal.\n\nAll the reviewers agree on acceptance."
    },
    "Reviews": [
        {
            "title": "Novel use of continuous flow in molecular conformation generation",
            "review": "The authors of this manuscript proposed a generative dynamics system for the modelling and generation of 3D conformations of molecules. Specifically, there are three components: (1) conditional graph continuous flow (CGCF) to transform random noise to distances,  (2)a closed-form distribution p(R|d, G), and (3) an energy-based tilting model (ETM) to capture long-range interactions and correct the position matrix distribution. The proposed framework was compared with two deep learning methods for conformation generations -- CVGAE & GraphDG, as well as the computational chemistry tool RDKit on GEOM-QM9, GEOM-Drugs, and ISO17 data sets. Comparisons in terms of COV and MAT scores show that the proposed method (particularly the one enhanced with ETM) can outperform baselines. Further comparisons of distances densities show that CGCF (but without ETM) worked best over baselines. \n\nOverall, I think it is an interesting work. The major novelty is the use of continuous flow to model the conditional distribution of the distances and an energy-based model to correct the conditional distribution of positions. However, I have the following concerns.\n\n1. The presentation of this paper can be significantly improved. A few typos need to be corrected:\nsection x -? Section X\na optimization -> an optimization\nwhich a ...-> which is a...\ndemotes -> denotes\nreferences should be further formatted\n\n2. A bit more precise description about the force-fields algorithms in RDKit is needed.\n \n3. From results in Table 2, CGCF combined with the ETM component does work better than GraphDG, although the authors state that it is because the sharpness of the distance distribution. Clear justifications should be given to show the benefits, if any, of this phenomenon. ",
            "rating": "7: Good paper, accept",
            "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"
        },
        {
            "title": "Interesting new generative model for molecular conformations with strong results; Some questions on evaluation",
            "review": "This paper presents an approach to generate diverse small molecule conformations given its graph by combining a conditional flow-based model with an energy-based model. Sampling is performed in two separate stages: 1) a normalizing flow produces a distribution over interatomic distances (which is then postprocessed into cartesian coordinates), 2) sampled coordinates are refined by Langevin dynamics with gradient signal produced from an energy-based model. The models are trained separately.\n\nI thought that this was an interesting, principled approach that advances the state of the art in generative models for molecular conformation sampling.  This approach (CGCF+ETM) appears to generate better samples than the VAE-based baselines, though all methods are still improved by a final refinement step with traditional forcefields (esp. for larger drug-like molecules) which suggests room for improvement. The general sampling strategy is potentially relevant in many other domains.\n\nThere were some aspects of the evaluation that could be improved/clarified:\n- COV and MAT do not appear to measure false positives — the CGCF+ETM approach could be generating many junk conformations and this would not be captured by the COV/MAT.  Can the authors report a statistic over the generated distribution (instead of over the test set)?\n- The abstract/introduction focuses on the computational expense of competing approaches. Can the authors comment on the computationally expense for generating each conformation?\n- How do the molecular properties of the generated distribution compare to the test distribution (e.g. small molecule properties in Simm & Hernandez-Lobato Table 2)?\n- Can the authors clarify if any of the test set molecules from GEOM-QM9 or GEOM-DRUGS are in the training set? It was unclear from the writing.\n- Which bonds are in the set of interatomic distances? The authors defines distances as the set of all covalent bonds in the molecule in the methods section, but later mention auxiliary angle/dihedral bonds. This was confusing in the first read.\n- Typo in Eq (9) ‘==‘",
            "rating": "6: Marginally above acceptance threshold",
            "confidence": "3: The reviewer is fairly confident that the evaluation is correct"
        },
        {
            "title": "Creative modeling ",
            "review": "This paper combines flow-based and energy-based models to generate molecular conformations from a molecular graph.\n\nStrengths\n- The modeling is well-motivated and creative. A continuous flow model maps a graph-based molecular representation into a distribution over conformations. The continuous flow is well-motivated; it factors out the distance calculations to resolve concerns in previous works where pairwise distances are modeled independently. \n- Additionally, an energy-based model (EBM) is used to further help the model capture long-range atomic interactions. Recent advancements in EBMs are deployed for stable training, such as a lavengin dynamics.\n- The paper is well-written, clear and easy to follow, despite the complexity of the model\n- Strong baselines: CVGAE, GraphDG, and RDKit. Results are slightly better than CVGAE for conformation generation, and slightly better for distance distribution. \n\nWeaknesses\n- While the model performs better than neural baselines, it does not yet approach RDKit, which is based on expert knowledge features. This means the proposed model is not yet practically useful.\n- Only two tasks were investigated, and only one or two datasets within each task. The empirical evaluation of this paper could be improved by including more experiments (e.g. along the lines of Mansimov et al. 2019)\n- The paper attributes the advantage in RDKit to its inclusion of a force field. Therefore, the authors combine a force field with their model and assess the difference (good!) However, the conclusion in the paper seems misguided - looking at Table 1, including the force field does not result in a significant change in their model's performance. In fact, this experiment was also done in the CVGAE paper (Mansimov et al. 2019).\n- In Table 1, the EBM improves performance on the conformation generation tasks. However, in Table 2, the EBM decreases performance on the distribution over distances task. I would have liked to see more investigation or discussion of why this is the case.\n- The RDKit baseline is not included in Table 2. It is included in the GraphDG paper and should be included here as well.\n\nOverall, this paper presents a creative model that performs better than existing neural models. However, the evaluation feels preliminary compared to what we see in earlier works.",
            "rating": "6: Marginally above acceptance threshold",
            "confidence": "3: The reviewer is fairly confident that the evaluation is correct"
        }
    ]
}