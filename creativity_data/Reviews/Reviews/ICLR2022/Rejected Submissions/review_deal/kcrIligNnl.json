{
    "Decision": {
        "title": "Paper Decision",
        "decision": "Reject",
        "comment": "The paper proposed a new VAE-based generative model for generating molecular conformations from graphs. Reading the paper, the reviews and the rebuttal, it looks like this project is a work in progress and not yet ready for publication. Some reviewers indicate that the paper lacks significant technical novelty. \n\nThis is a worthy application. I encourage the authors to keep working and resubmit to another venue when they feel the work is ready and they have addressed all points raised by the reviewers."
    },
    "Reviews": [
        {
            "summary_of_the_paper": "The paper proposed a new VAE-based generative model for generating molecular conformations from graphs. The whole formulation and training objective are similar to existing VAE-based models like CVGAE, and the main contrition lies in the architecture of the decoder. The architecture borrows the idea from the recent advance of AlphaFold: the proposed decoder is composed of several identical updating blocks, where they iteratively update the node/edge embeddings as well as the coordinates in each block. And the blocks are implemented with advanced graph neural networks. \n",
            "main_review": "Strengths:\nThe paper is well-organized and clearly written. All content is easy to understand for me.\nThe experimental part is comprehensive. The author nicely compares the proposed method with competitive baselines on both small-scale and large-scale datasets. The results demonstrate that the model is better or comparable with state-of-the-art results with much less computational cost.\nWeaknesses:\nThe main concern of this paper is the originality. The main contribution of this paper is the decoder part, which is very similar to the “structure module” in Alphafold that iteratively updates the folding and node/edge features. However, I appreciate the efforts to extend the progress of protein folding to molecular modeling, so I also agree the adaption is non-trivial.\nA minor problem: the problem definition in Sec.2 seems not accurate enough. In your statement, it seems each graph only corresponds to a single conformation, but this is not true. Please restate it.\nI’m also interested in the design of the decoder block. I understand the training objective is invariant, however, I’m curious whether updating the coordinates with equivariant networks will further help the performance. Several recent works such as ConfGF have shown that equivariance is an important inductive bias for 3D generative models.\n",
            "summary_of_the_review": "The paper proposed a VAE model for molecular conformation generation, where the decoder borrows the idea of Alphafold to iteratively refine the generated structure. Personally, the paper seems an extension of the recent progress of protein folding to the small molecule setting, but I appreciate the authors’ efforts to make it work. So currently I vote for a weak acceptance.\n",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold",
            "confidence": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
        },
        {
            "summary_of_the_paper": "\nThe paper presents a direct method for generating a molecular\nconformation conditional on the molecular graph.  Inspired by the\nsuccess of AlphaFold2, the authors demonstrated that one could\ndirectly write out 3D coordinates for a small molecule rather than use\nthe previous ways of generating intermediate interatomic distance\nmatrices or iterate over forces. The method displays a decent\nperformance on the standard benchmark set of QM9.  It performs better\nthan past baseline methods for larger molecules.\n",
            "main_review": "\nOverall, this work appears to be an advance compared to the\nLangevin-based method it mainly compares against.  It is not clear to\nme if this is simply due to a different parameter setting (e.g. a\nlarger model than a year ago works better for larger molecules), or if\nthis improvement is due to a genuine algorithmic advance, and if so,\nwhat part of the algorithm helps the larger molecules the most and why\ncouldn't the authors beat the previous model on the smaller-sized\nmolecules.  I appreciated the authors effort to document the change of\nthe results across the methods in Table 3, but it would help if they\ncould also modify their new model (or ConfGf, or both) to a\ndrastically different size.\n\nI did not understand what was the contribution for the fine-grained\nloss function used in training. Unless I misunderstand something\nimportant, the particular matching loss is not invariant to\npermutations of symmetric atoms---think of the different ways to\nenumerate the atoms in a methyl group, or replace the hydrogen in a\nmethane by methyls, or take any symmetric groups in a molecule that\ncan generate a combinatorial number of equivalent coordinates that\nrepresent the same molecule graph. So I don't understand the statement\nof the authors that this loss is zero if and only if R1 and R2\nrepresent the same molecule structure---what would the loss be if I\nrandomly permute the symmetric hydrogen identities but not change the\ncoordinates?\n\nRegarding Secion 4.3, I understand that these types of tables have\nbeen published previously, but I wanted to state that I strongly\ndisagree with the terminology of calling the average energy of the\ngenerated conformers a \"property prediction\".  I don't think that\nthere exists a single experiment that can measure this particular\nquantity, although arguably one could use a Quantum Mechanical code,\nas these authors and others have done, and calculate a number for it.\nFrom a physics perspective, the somewhat more meaningful property is\nthe Boltzmann-weighted average of the energies of the molecules---is\nthat perhaps the quantity that this benchmark is supposed to evaluate?\nFurthermore, what is the meaning of switching to an MMFF force field\nfor optimization and then use Psi4---why not directly evaluate the\nconformation with Psi4?  Finally, what are the units in the energies\nof Table 4?  If these are in Hartree (which I thought were the default\nunits for Psi4, though I'm no expert in it), then the reported errors\nare all huge to be meaningful one way or another (to the order of more\nthan 13 kcal/mol for the smallest number listed in that table); these\ntypes of enormous errors have little meaning for any conformational\nenergy comparison, as a trivial small bond-length deviation could add\nthis level of energy, whereas a wrong dihedral angle couldn't (unless\nparts of the molecule almost clashed onto itself).  Perhaps the\nauthors would want to either clarify section 4.3 further (it took a\nwhile to parse what the authors actually calculate there, and from a\nquick check of the repo, I couldn't locate the relevant code for it)\nor simply drop it altogether since it probably distracts from the rest\nof this work.\n\nI also didn't understand the first two of the three future directions:\nI am not clear what the authors mean when they suggest combining this\nmethod with flow-based or Langevin dynamics models---can they clarify\nthis point?  Importantly, what are the cases that fail in the current\nmodel---can the authors document some examples in an appendix?\n\n",
            "summary_of_the_review": "\nI think that this paper is an advance on previous work and probably represents\nthe state of the art in generating molecular conformations conditional\non the graph.  The paper could use a review of the language to clarify\ncertain aspects of it, but I don't think that it is strong enough for ICLR.  \nImportantly, it should attempt to clarify if the improvement is mainly \ndue to model size changes or due to algorithm changes.\n",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "3: reject, not good enough",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The authors propose the generative model that constructs a conformation (set of 3d coordinates) of the molecular graph with a variational autoencoder (VAE) framework. Unlike several recent works on conformation generation based on generating of distance matrix and further conformation recovering by solving a time-consuming distance geometry problem, the proposed approach directly generates 3d coordinates with an iterative process inside the decoder part of the model.",
            "main_review": "**Originality:** The work suffers from the lack of originality. The described model shares the same idea as ConfVAE and the unnamed model, proposed in [1] and [2] respectively - the autoencoder-based framework for conformation generation, the iterative generation procedure, and RMSD objective were proposed earlier. The main novelty of the model is neural network architectures of encoder and decoder, that utilize advanced graph convolutions. Both of [1] and [2] works are missed in baselines, the model compared with.\n\n**Clarity and Quality:** The authors clearly describe their motivation and provide good discussion and ablation studies section, still paper contains vague contributions part and missed related work section. The paper is written in a hard-to-read way. The paper contains plenty of inline equations, inconvenient formatting of enumerated statements that make it hard to navigate over text and understand the method. The paper focuses too much attention on technical details of the model, that are minor and can be moved to the Supplementary materials.\n\n**Significance:** The novelty of the paper is minor. The experiment results show the increase of metric values between the proposed model and ConfGF baseline, still, it's hard to determine the significance of the performance gap due to the lack of standard deviation. Also, the significance of the results is doubtful since the important baselines [1] and [2] are missed in Experiment section.\n\n**Drawbacks / questions**:\n\n1. I would recommend using different Greek letters to denote the encoders/decoder parts instead of subscript text to increase the readability of formulas.\n2. The ablation studies cover only architecture details. Still [2] provide loss function based on distance differences that is also roto-translation invariant but do not require additional subproblem solving.\n3. The small-scale dataset results are redundant still large-scale dataset covers it. I would recommend training CVGAE and CGCF on the large-scale dataset and including the results of these models.\n4. The choice of conformation colors in Figure 3 is misleading. I would recommend to add an additional figure with aligned conformation cloud to show the diversity of generated conformations.\n\n[1] An End-to-End Framework for Molecular Conformation Generation via Bilevel Programming, Xu et al.\n\n[2] Auto-Encoding Molecular Conformations, Winter et al.",
            "summary_of_the_review": "The idea of the paper is not novel. The experiment part misses several important baselines. The text should be revised to improve readability and clarity. The ablation study section should provide experiments to justify loss function choice.",
            "correctness": "2: Several of the paper’s claims are incorrect or not well-supported.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "Not applicable",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "5: marginally below the acceptance threshold",
            "confidence": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
        },
        {
            "summary_of_the_paper": "The authors present a method that is able to accurately generate molecule confirmations, achieving competitive results across four datasets. \nUnlike previous methods that often rely on directly predicting various inter-atomic distances (through a distance matrix) (which in some cases results in physically impossible molecules), the presented work predicts the location of all atoms. The loss function is invariant to rotation, an important property of many molecules. ",
            "main_review": "Strengths:\n* The results are strong and the presented methodology is clear.\n* The ablations shown in Table 5 are very nice to see and I think are a useful part of the paper.\n\nWeaknesses:\n* Some of the discussion of results could be expanded, or at least included in an appendix. For example, \"This is consistent with our conjecture, and also demonstrates the potential of directly generating coordinates for complex molecules with more heavy atoms.\" This would be nice to have been further expanded upon.\n* The presented results are limited in scope, and largely rely on comparisons with ConfGF, though then some additional comparisons would be useful. For example, for the property prediction showing results comparing to Tables 3 and 4 in the ConfGF paper would be useful. \n\nComments:\n* In Fig. 3, what do the colors represent? Are two views shown?\n*  A table with exact hyper parameters/etc in the appendix could be useful (in addition to the details in section 4.1). It's great that code is provided.\n* Some methods, like G-SchNet (https://github.com/atomistic-machine-learning/G-SchNet) from my understanding do not produce confirmations which violate the triangle inequality. Is this a misunderstanding on my end, or is this approach of successively predicting distances an alternate approach that produces valid molecules?  I realise it is a different problem being approached, but molecules are still being generated. \n* In Table 2, what is your interpretation of the COV(%) being 100%? \n* For the property prediction, on QM9 various properties can be predicted. Could these all be shown?  \n* The text is at times a bit difficult to follow, but it does not detract from the ability to follow the work as a whole. \n* I don't quite follow the \"ours with /FF\" in Table 5, and why this is not the \"default\" flavour?",
            "summary_of_the_review": "The work presents strong results on molecular confirmation prediction. A novel method is developed that mitigates concerns of many previous methods by ensuring adherence to geometric rules. The results shown are very competitive, though I would like to see slightly broader comparisons and more exposition on various points that are raised in discussion. ",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        }
    ]
}