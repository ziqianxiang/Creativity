{
    "Decision": {
        "title": "Paper Decision",
        "decision": "Reject",
        "comment": "This paper proposes to generate 3D molecules using a step by step approach. The reviewers raised major concerns on the experiments, novelty, writing and technical details. The authors also were not aware of many of the important references, part (but not all) of which have been included during discussions. It is clear that this work is not ready to be accepted by ICLR."
    },
    "Reviews": [
        {
            "summary_of_the_paper": "The paper proposes a model to generate molecules using graph and geometric representations. The method is tested against several relevant baselines on standard and custom datasets, with a primary focus on chemical validity.",
            "main_review": "Pros:\n - Problem is relevant and clearly defined\n - Method is intuitive and accessible - generate atom type, generate connections to existing atoms, generate positions, repeat\n - Some results are positive, generally better or similar to other methods. The model's tendency to construct valid molecules without checks is impressive.\n - Writing is clear, organized, and developed, discrepancies are discussed\n\nCons:\n - The result in Table 1 make me question the overall value of the technique.\n   - The method w/o geometry has higher validity and uniqueness than the model w/ geometry.\n   - All of the methods (w/ checks) produce valid molecules and have similar uniqueness and higher novelty. The paper discusses this apparent shortcoming and largely concludes that the comparison is misleading due to intentional limitations (number of atoms) in the proposed method vs the other methods. If this is true, is it possible to reproduce Table 1 where only \"fair\" comparisons are made (maybe by dropping large molecules from the other methods)?\n - The paper discusses how the conditional model could be used to retain features from one molecule when constructing new molecules but doesn't demonstrate this. It would strengthen the paper to see a simple demonstration of this application.",
            "summary_of_the_review": "The paper takes a positive step forward in constructing generative models over molecules by including graphical and geometrical information in a single model. However, some of the empirical evaluations muddle the overall story and could be improved/clarified.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The authors propose GEN3D, an ML-based approach for 3D molecular structure generation. GEN3D places atoms in space to build molecules in an atom-by-atom fashion and constructs a corresponding molecular graph that can be employed to enforce organic chemistry rules.",
            "main_review": "1. The related work is pretty detailed but neglects some relevant related papers. \n   1) Simm, G. N. C.; Pinsler, R.; Hernández-Lobato, J. M. Reinforcement Learning for Molecular Design Guided by Quantum Mechanics. ICML 2020.\n   1) Gebauer, N. W. A.; Gastegger, M.; Hessmann, S. S. P.; Müller, K.-R.; Schütt, K. T. Inverse Design of 3d Molecular Structures with Conditional Generative Neural Networks. arXiv:2109.04824 [physics, stat] 2021.\n   1) Simm, G. N. C.; Pinsler, R.; Csányi, G.; Hernández-Lobato, J. M. Symmetry-Aware Actor-Critic for 3D Molecular Design. ICLR 2020.\n\n2. It is not clear how working with a graph is beneficial. 1) The authors claim that organic chemistry rules can easily be enforced through a graph representation. However, it's unclear to what extent these relatively simple rules are holding ML models back from proposing more chemically meaningful molecules. 2) Working with a graph restricts the application of this model to organic chemistry, and metals or multi-molecular clusters become unattainable.",
            "summary_of_the_review": "GEN3D appears to be a competitive approach for molecular structure generation. The main weakness of this paper is, however, that it lacks methodological novelty. Methods, such as G-Schnet, MolGym, and ENF, are closely related to this work, and the originality of this work is, in my view, insufficient for this venue.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "1: The contributions are neither significant nor novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "3: reject, not good enough",
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
        },
        {
            "summary_of_the_paper": "This paper proposes a generative model to sample a new molecule with its 3d coordinates. The generative process is divided into three different steps: 1) the atom network generates a new atom 2) the edge network connects the new atom to the existing atoms 3) the distance and angle network generates the pairwise distances and angles from existing atoms to the new atoms. EGNN is used for each of these sub-networks to impose the equivariance to translations and rotations. Experiments with QM9 datasets show the geometric correctness of the proposed generative process.\n",
            "main_review": "- Pros\n    - Highlights the importance of generating 3d structure for molecule generation.\n    - The paper provides new insight of the QM9 dataset.\n\n- Cons\n    - Insufficient description. The paper seems not-self contained. Difficult to understand some of the details.\n        - Since ICLR is not chemistry focused conference, it would be good to provide some details of domain-specific information\n    - The 3D structure generation is unclear.\n        - To generate 3D coordinates, the model places a probability mass over the grids of distances and angles.\n        - The provided process is likely to place a mass over the impossible configuration of distances and angles.\n        - From the grid, the model sample a new location. However, sampling is not back-propagatable in general. It is unclear how the model handles this.\n    - A mismatch between motivation and experiments\n        - None of the experiments is related to the proposed downstream tasks in the introduction. Although generating 3D structure seems plausible, the benefit of it is unclear without direct application of 3D structure\n            - JS divergence on distance is the only metric that is directly connected to the molecule geometry. However, it is not sufficient to show the usefulness of 3D structure.\n        - For example, it would be more interesting to show that the generated graphs have relatively low-energy conformations than those from the other models.\n    - A proper ablation study on model selection and training procedures would improve the strength of the proposed approach.\n\n- Questions\n    - What are the losses used to train the model? Please provide the detailed training procedure.\n    - Is the equivariance of the subnetworks sufficient to impose the equivariance of the entire network?\n        - Is permutation invariant unnecessary? Since the generation is autoregressive, to put the same distribution to the same molecule with different sequences, it needs to be permutation invariant.\n    - If the description of QM9 dataset is correct, how do we understand the reported performance of some previous models which achieve 90%+ uniqueness and novelty such as GraphDF[1] and MoFlow[2]. This seems impossible based on the description provided in this paper.\n    - In the Introduction, a significant portion has been used to criticize the approaches with SMILES. What problem can be arisen from converting SMILES string to 3D structure? and how the proposed solution can avoid this? - e.g., w. OpenBabel\n    - What is the GEOM-QM9 dataset, and how does it differ from QM9?\n        - In the last sentence of Section 3, a random uniform noise is added to each coordinate. Is this applied to all datasets?\n\n1. Luo, Youzhi, Keqiang Yan, and Shuiwang Ji. \"GraphDF: A discrete flow model for molecular graph generation.\" arXiv preprint arXiv:2102.01189 (2021).\n1. Liu, Meng, et al. \"GraphEBM: Molecular graph generation with energy-based models.\" arXiv preprint arXiv:2102.00546 (2021).",
            "summary_of_the_review": "Although the proposed method seems an important research direction for molecule generation, the experiments did not show the usefulness of such approaches to compare with the previously studied methods. Some of the descriptions are insufficient to understand the model details as well.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "5: marginally below the acceptance threshold",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "* The paper proposes an autoregressive generative model for 3D molecular graph generation, by predicting the next atom type, next edge type, next atom distances, and next atom angles sequentially based on the existing graph.\n* The authors claim that the proposed model can generate 3D molecules with higher rates of chemical validity, better atom-distance distributions, and is very cheap to train compared with previous models.",
            "main_review": "**Strengths**\n* The proposed model is a nice extension of previous autoregressive graph generative models, e.g., GCPN. Inspired by the mechanism of distance geometry and internal coordinates (e.g., pairwise distance and angles), the authors propose to autoregressively predict the next atom/edge type, next atom distances/angles, thus enabling the model to concurrently generate molecular graphs and 3D geometries. The whole methodology is classic and easy to follow.\n* They experimentally validate the effectiveness of the proposed model. The experiment design seems good as it covers several research topics ranging from 2D molecular graph generation, 3D molecule design, to molecular conformation generation.\n* They plan to release the code in the future.\n\n**Weaknesses**\n* The novelty of the work is limited. Compared to the previous autoregressive graph generative models (e.g., GCPN, GraphAF, MolecularRNN[1,2,3]), the key difference is that they incorporate the atomic distance prediction and angle prediction into their model. However, distance geometry modeling and angle prediction are not something new. So the model is more like a combination of techniques in 2D graph generation and 3D structure modeling.\n* Since the paper introduces a **new generative model** for 3D molecule design, I recommend authors introduce the generative model in a more formal (mathematical) way. For example, we can introduce the probabilistic distribution we want to model, the way we factorize the distribution (autoregressively), and how we estimate the parameters. This is a minor suggestion, but I think it will improve the quality of the draft. \n\n**Reference**\n1. Graph Convolutional Policy Network for Goal-Directed Molecular Graph Generation\n2. GraphAF: a Flow-based Autoregressive Model for Molecular Graph Generation\n3. MolecularRNN: Generating realistic molecular graphs with optimized properties\n\nPost rebuttal: The authors partially addressed my concerns and I would like to update the score to 5",
            "summary_of_the_review": "My main concerns of the paper are its novelty and the way it introduces the generative model.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "5: marginally below the acceptance threshold",
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
        }
    ]
}