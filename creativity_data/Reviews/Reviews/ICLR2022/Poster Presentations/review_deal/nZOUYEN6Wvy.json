{
    "Decision": {
        "title": "Paper Decision",
        "decision": "Accept (Poster)",
        "comment": "The AC and reviewers all agree that the paper proposes a very interesting framework to extend Granger Causality to DAG structured dynamical systems with important applications. \n\nThe submission was the object of extensive discussion, and the AC and reviewers all agree that the author feedback satisfactorily addresses the vast majority of their concerns. We strongly urge the authors to incorporate all the points and revisions mentioned in their feedback. \n\nWe certainly hope that the author will pursue this line of work and consider scaling their approach to tackle larger applications such as those related to social networks."
    },
    "Reviews": [
        {
            "summary_of_the_paper": "This paper developed an exciting method, GrID-net to infer granger causality between multi-modality on directed acyclic graph (DAG) in the framework of deep neural network (GNN), aiming to improve identifying causal interactions across modalities. Primarily, the authors first find the DAG among samples and represent the historical information of modal features via aggregating GNN layers over DAG. They then apply granger causal inference to test the causal interactions of any two features if adding such GNN-based historical information of one feature significantly helps reduce the prediction loss of another feature. \n\nAlso, it is nice that the authors applied GrID-net to multiple recent single-cell multi-modal datasets (scRNA-seq and scATAC-seq) and identified casual chromatin regions for gene expression at the cell type level (grander causal gene-region interactions), providing novel gene regulatory mechanistic insights. Besides, the authors validated gene-region interactions by eQTLs, Hi-C, and TFBS enrichment.  \n",
            "main_review": "Strengths\n•\tIntegrative and generalized modeling of DNN and granger causal inference over DAG\n\n•\tThe authors provided details and reasonable justifications on three datasets, data processing, training & hyperparameters and pseudotiming analysis for building DAGs\n\n•\tThe benchmark is comprehensive and convincing, providing different metrics to evaluate GrID vs. other state-of-arts\n\n•\tValidation of gene-region interactions by independent eQTLs and Hi-C data\n\nWeaknesses\n•\tThe authors probably need to elaborate on the GNN architecture to represent historical information, ideally via visualization on Fig 1b. Also, do Hy and Hx use the same architecture (e.g., # of layers)?\n\n•\tIs it possible to compare DAGs by alignment-based methods such as manifold alignment methods? For instance, UnionCom, MMD-MA, etc use manifolds to align scRNA-seq & scATAC-seq and uncover pseudotiming trajectories. I suggest that the authors also benchmark pseudotiming approaches.\n\n•\tHow cell-type specific are those causal gene-region interactions? Can they better classify cell types than gene expression/chromatin accessibility only? Also, the authors still used the bulk tissue eQTLs data in GTEx that can be confounded by different cell types. \n\n•\tThe authors should discuss scalability, esp. on single-cell data applications. \n",
            "summary_of_the_review": "In general, the manuscript was well written and organized logically. The GrID-net modeling was also presented clearly. I believe the new model has broad and timely impact on single cell data integration and understanding temproal gene regulatory mechanisms. ",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "Not applicable",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
        },
        {
            "summary_of_the_paper": "In this work, the authors propose a model framed as an extension to Granger causality for DAGs, and apply their model to infer “causal” relations between changes in gene expression and chromatin accessibility over time. Rather than relying on linear models and ordered data, the authors use a graph neural network to account for partially ordered data (i.e. branching structure). Similar to Granger inference, they compare a full model using paired data to a reduced model which excludes the lagging predictor. The authors then focus on analyzing temporally ordered scRNASeq and scATACSeq in 3 data sets from human and mouse. They test the method on predicting “causality” between the data modalities by using eQTLs and and chromatin interactions as proxy labels and compare against several baseline methods, noting that the method is robust to sparsity in data. Finally, they find enrichment of TF binding motifs in peak-gene pair regions and conclude that the model detects a lag between distal ATACSeq peaks and gene expression.  \n",
            "main_review": "Detailed Comments:\n\n1. There are some issues with the model or claims about it that we note:\n1.a. \nThere are many instances in the manuscript where the relation between genetic loci and expression is referred to as “casual”. It needs to be made clear that this is “Granger causal” or “temporally causal” as this does not represent true causality. An obvious example would be a true causal factor that affects ATAC peak at time X and later, after some unrelated process takes effect, expression of a gene at time X+t. Clearly the definitions used here would conclude a casual relation that does not exist.\n1.b.\nUsing a t-test to check for differences in means of the full and reduced model seems problematic. A reduced model will always have higher MSE than a full model on the sample data. The metric needs to be adjusted for the number of free parameters/model complexity. An F test would be more appropriate. Alternatively, the authors could evaluate performance on a held out test set. As it stands, this issue makes us doubt the reported results. \n1.c.\nThere is a somewhat misuse of terminology with regards to the L variable defined in the manuscript as this does not represent the same lag as that is defined by Granger causality. The manuscript interprets L correctly but overloads the use of the term “lag”. It would be helpful to show a scenario (i.e reduction) where GrID-Net is equivalent to Granger causality inference using a linear model. For example, using a linear graph (Fig. 1a left) as input with L=1.\n1.d.\nIt was somewhat unclear to us if model implementation and target function in Eq 10 means the parameters of the reduced and full are shared. It seems to be the case. If so, isn’t it possible that the reduced model suffers from the full model optimization problem? I.e. if the reduced model was optimized on its own without shared params it would converge to a better predictive solution? \n\n2. There are several issues with the analysis that we note:\nWe understand that a technical contribution is of prime importance for ICLR. However, the following suggestions for improving the data analysis could significantly improve the practical utility of the manuscript. \n2.a. Data\n2.a.i\nUsing liftover to map human eQTLs to mouse genome is problematic.\n2.a.ii\nThe direction of the eQTL is not clear since they are chosen purely based on a p-value cutoff. Analyzing the relation between variant creation, change in expression and change in ATAC peaks would help clarify what the model is learning (enhancer/repressor creation/disruption).  \n\n2.b Performance and Evaluation \n2.b.i\nThe choice of baselines is not optimal. The Var Granger approach will perform poorly since it is just a simplification of GrID-Net. The correlation methods could have been applied to the graph directly to make the comparison more fair given that the graph itself is not part of the proposed method and is created using existing software. \n2.b.ii \nThe model is almost making random predictions (AUROC hovering around 0.5). It also does not improve significantly compared to the baselines. We understand that the relation to eQTL based calls are problematic but with such poor correspondence it brings doubt to using this as a metric. \n2.b.iii\nThe sparsity analysis is ancillary and does not contribute much to the manuscript. First, it is strange that the performance is marginally better on the sparse data (correlation of 0s inflating the result?). Second, without explicitly modeling single cell sparsity, mentioning robustness to sparsity is not productive. \n\n2.c. Mechanistic Analysis\n2.c.i\nHow is a TF associated with a gene? You need to show that the KO of a TF is actually associated with a gene expression increase/decrease. Presence of a TF motif does not always mean the expression is altered. \n2.c.ii\nThere is no enrichment analysis of TF binding. Does the GrID-Net detect more peak-gene pairs overall compared to the baselines? If so, a raw number of detected pairs doesn’t tell us anything about enrichment. A simple fisher test would suffice.\n2.c.iii\nThe interpretation behind the proximal vs distal analysis is not supported biologically. This is an extremely bold claim without experimental evidence. The authors should rephrase this section to be more speculative.\n2.c.iv\nConsider using enrichment tests here instead of a percentage. It is not clear how different the shown percentage is from the null. For example, is the ratio of distal to proximal labels close to the observed percentage after changing L? If so, the percentage increase is too small to have any biological meaning. \n\n2.d. Lack of clarity\n2.d.i \nHow are the p-value cutoff chosen for classification in AUPRC? Even if a standard 0.05 is used, it should still be mentioned.\n2.d.ii\nHow is Pearson correlation being computed with missing values in the sparsity analysis? If using 0s, this would inflate the correlation. \n2.d.iii\nHow does the model handle multiple terminal lineages (i.e. multiple nodes without any outgoing edges). What is y in this case?\n\n2.e Relation to previous work:\n2.e.i\nThe authors frame the entire work as a novel generalization of Granger causality. While we understand the need to frame the work in terms of ML novelty in a ML conference, we found this to misrepresent the actual work. In practice, Granger causality is not defined exactly as it is here, and the “generalization of Granger causality for DAGs” boils down to standard GNN operations over graphs with a memory of length L, using two competing architectures. The solution seems fine for the problem at hand (given a good answer to the possible issues raised above), but the remote relation to Granger seems to justify not much more than a general comment in the discussion.\n\n\nUPDATE\n==============\nWe read all of the authors detailed answers and reviewed the updated manuscript. The authors did a very good job addressing many of the concerns and comments raised by us and the other reviewers. While some concerns may remain we acknowledge the good work and effort made by the authors to improve the analysis, clarify details and make more precise claims. We have updated our score accordingly.\n",
            "summary_of_the_review": "Overall, the paper introduces a model that, while a simple GNN, which appears to be a very reasonable approach for solving the problem of detecting the effects of chromatin accessibility on expression. The problem itself is interesting and important. In addition, the manuscript is generally clear and well written though the authors should be more careful about how claims are interpreted and described. However, the work does not offer many novel technical innovations since the GNN architecture is standard and the domain specific modeling/insights is lacking. Also, aspects of the evaluation of the model are concerning since the authors do not use out of sample data and should consider other baseline.  \n",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The authors propose a method for modeling single-cell multimodal data using Granger causality. They introduce a graph neural network called GrID-Net (Granger Inference on DAGs), where they assume that the network variables (the cells) follow a DAG structure. They focus on applying their method to the task of inferring non-coding genomic loci that causally influence the expression of a specific gene.",
            "main_review": "**Update:** After reading the rebuttal and other reviews, I have increased my original score. Thank you to the authors for addressing the concerns raised in great detail.\n\n**Strengths:**\n- The problem tackled by the authors is, in my opinion, an exceedingly difficult one.\n- The experimental section is extensive and the authors have done their best to analyze different facets of the problem. \n- The paper is very carefully written. \n\n**Weaknesses:**\n- The usefulness of the method heavily relies on how good the DAG construction is. In this paper, the authors construct a kNN graph to define the DAG, which seems a reasonable choice, but then how sensitive is the overall method to this choice?\n- Without confidence bands, many of the results presented are rather speculative. For example, based on the results reported in Table 5, the authors speculate that distal peak-gene interactions may be characterized by longer lags between peaks and genes. While this conclusion seems reasonable, it is rather hard to gauge whether there is a singificant decrease in proximal peak-gene pairs when going from two to ten GNN layers.\n- The authors make a decent attempt at putting their work into context, but if they want to focus on the causal aspect, there is a whole literature on causal Bayesian network inference and structural causal models that seems to be missing in the reference section. Apart from that, some other papers that seem relevant:\n   - https://www.jmlr.org/papers/volume16/basu15a/basu15a.pdf\n   - https://doi.org/10.1093/bioinformatics/btq377\n   - https://www.pnas.org/content/115/9/2252.short\n\nOther comments:\n- page 8, Table 3: How do you explain the huge increase in performance for GrID-Net (eQTL & Sparse Peaks + Chromatin interactions & Sparse Genes + Chromatin Interactions & Sparse Peaks) and VAR Granger (Chromatin interactions & Sparse Peaks) over the correlation methods for the SHARE-seq data set? Based on Tables 1 and 2 it seems to be related to a sudden increase in AUPRC? Could you comment on that?\n- page 11, title of reference by Heinz et al. is incorrect \n- page 13, DAG construction: I would be careful when normalizing the data when used for causal inference because the normalization might destroy those relationships. Here I understand that the DAG is determined post-normalization, so that should be okay, since these relationships are inferred.",
            "summary_of_the_review": "Overall the method is sound and the authors have put in a lot of work to showcase the merits of their approach. I wouldn't say that the proposed approach \"outperforms existing methods for inferring regulatory locus-gene links\", but it seems to be an incremental step forward. Keeping in mind that the problem tackled is an exceedingly difficult one, I am inclined to give this paper the benefit of a doubt.\n",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The paper proposes a modification of Granger causality so that it is applicable in partially ordered observations. Authors achieve that by adapting the architecture of GNNs to enable lagged-passed information in the DAG. Finally they apply it on a real data problem with the goal to infer non-coding genomic loci that causally influence the expression of a specific gene. In comparison with other three methods, the proposed method GrID net outperforms them on an open dataset.\n",
            "main_review": "\nOne thing that i would like the authors to mention in their paper is that the presented work assumes causal sufficiency; i.e. that there are no hidden confounders in the data. This is a very strict assumption which is also often violated in real datasets. It is important to point out here that any Granger related method suffers from this issue, and for that reason the interpretation of the findings as 'causal' should be careful, as such methods are not able to differentiate between X \\rightarrow Y, and X \\leftarrow H \\rightarrow Y, where H is a potential hidden node acting as a confounder. \n\nI would like to ask some questions the authors:\n\n1. What is the intuition of the authors about the robustness of their method in sparse settings? I see the data driven conclusion,\nbut i would be interested in the theoretical explanation or some intuition about it from the authors.\n\n2. I appreciate a lot the presentation of the related work and the comparison experiments. Nevertheless, I would like to also see comparison with a non-linear implementation of Granger, as it is not straightforward to understand here whether the poorer performance of VAR Granger comes from the linearity of the method, or from the fact that Granger itselelf does not take into account partial ordering of the data.\n\n3. What is the variance of the results presented in Table 1? Is the difference between GrID-Net and the other methods significant?\n\n4. In the paragraph about methods related to Granger causality (p.5), the authors make an effort to list the related work, however they miss some important causal discovery methods in time series (and lagged panel data in general) methods that outperform Granger and don't require causal sufficiency.\ni.e.\n - Mastakouri et al.2020 Necessary and Sufficient Conditions for Causal feature selection in time series with latent common causes.\n- D. Entner, and P. O. Hoyer (2010). On causal discovery from time series data using FCI (PGM2010)\n- N. Pfister, P. Bühlmann, J. Peters: Invariant Causal Prediction for Sequential Data. Journal of the American Statistical Association, 114(527):1264-1276.",
            "summary_of_the_review": "Overall I find the paper to be very well written, with a new method clearly motivated from a real-world problem the field of genomics. For that reason i am inclined for acceptance of the paper. I would like the authors to mention the strict assumption of causal sufficiency that their work assumes and make it clear that their results may suffer from it. I would also like to ask the authors to answer my questions above.\n\n--------------------- update ---------------------------\n\nSince the authors did not respond to any of my comments and concerns above, I decided to reduce my score. Not clearly stating that causal sufficiency is assumed is a major point, as it leads to wrong \"causal conclusions\". Moreover, the lack of explanation from the authors regarding their intuition in some key points of the paper contributes to lack of clarity. In addition to the above, the lack of comparison with linear Granger or at least discussion about it, make me decrease my score significantly. It is a pity because this could have been a good paper, if the authors have taken the time to answer and fix these points by answering to the reviewers. Without their responses/edits the paper contains strong overstatements.\n\n\n------------------- update after authors posted their rebuttal -------------------\nI am reverting my score to its original value, given that the authors answered all my comments and updated their paper accordingly.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
        }
    ]
}