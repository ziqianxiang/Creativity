{
    "Decision": {
        "title": "Paper Decision",
        "decision": "Accept (Poster)",
        "comment": "This work introduces an autoregressive flow model that generates molecular geometries by placing one atom at the time. \nIn order to preserve the E(3) invariance of the density, successive atom locations are sampled relative to already placed atoms (in a coordinate system described by distance, angle and torsion).\nThe paper is overall well-written and experimental results are compelling."
    },
    "Reviews": [
        {
            "summary_of_the_paper": "The paper proposes a new way to directly generate 3D molecular geometries from scratch. They output the atoms one by one, including the type of the atom and the related position from one chosen focal atom. They use a SphereNet (Liu et al. 2021d) - a spherical message-passing network and an additional multi-head attention network (Vaswani et al. 2017) to process the existed information in the partial generation results. They have shown in 2 different tasks that they are better than previous methods.",
            "main_review": "Pro:\n1. The paper proposes a good way to handle the invariance issue during generating 3D positions of the atoms in the molecule by outputting related position change (d, theta, phi) instead of outputting absolute coordinate r. They have given thorough reasoning in the paper why they should not use r.\n\n2. The paper has shown good results compared with previous methods and has done several ablation studies to show that different components in their method are useful.\n\nCon:\n1. The contribution seems limited. Most of their pipeline is based on previous work including (Liu et al. 2021d) and (Vaswani et al. 2017).\n\n2. The writing of the paper is a little bit messy. Some related algorithm like (Vaswani et al. 2017) is shown with proper math formulations, while some others like the message passing in (Liu et al. 2021d) are missing. It's better to rearrange the paper and make it more self-contained.",
            "summary_of_the_review": "The paper has improvements compared to previous work based on the system design and new algorithms, however, some critical parts seem incremental.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "Not applicable",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The paper introduces a new generative model for 3D molecular geometry, taking the form of a graph embedded in 3D where each node is an atom, and each edge is a bond. Differently from existing methods, the proposed pipeline attempts to generate the 3D molecule from scratch, instead of starting, e.g., from a 2D molecular graph as other methods do. The pipeline is sequential and is based on autoregressive flow models, which have been previously used for the generation of 2D molecular graphs, but not for the present task. The paper convincingly shows that the proposed model works better than competing approaches for the same task.",
            "main_review": "The main strength of the paper is in (i) showing that generating a 3D molecular structure from scratch is feasible, and (ii) in demonstrating that a sequential approach is particularly effective for this task. Both aspects are novel to my knowledge, and worthy of communication to the relevant community.\n\nThe paper is fluent, clear, and easy to follow. The positioning with respect to the literature is also rather clear, and the analogies and differences with existing approaches are well described. The experimental section is well executed, and includes an extensive ablation study confirming the validity of the proposed pipeline in its entirety. Comparisons with very recent methods addressing the same task are included. Code is also included.\n\nParticularly significant are the quantitative results, which demonstrate an important gap in accuracy compared with other approaches (>10% in most cases).\n\nOne aspect that I feel might benefit from additional discussion is on the rationale behind a sequential model being more effective for generation. The paper attempts to give some motivations (e.g. that it helps to capture the relation between atom and density more effectively), but additional insight would be useful. If the authors can share more of their insight during the discussion period, it would help my understanding of the approach.\n\nPerhaps more importantly, something that does not really exude from the paper is the potential impact that the method could have on practical applications. The conclusions mention that a promising future direction would be the generation of more complex molecules (such as proteins), but at the current stage, what is the main benefit of this method for downstream tasks in structural biology? If this is to be taken as a first step toward practical applications is also fine, but it would be nice to see this clarified in the manuscript.\n\nAs a minor comment, it is not clear to me how Figures 2 and 3 (in the supplementary material) should be interpreted. Is there a way to read these figures, that suggests that the generative model is doing a good job at synthesizing new molecules?",
            "summary_of_the_review": "This is a well written paper, with a novel contribution that is likely to leave an impact in the emerging field of generative models for molecular structures. The main weakness, in my opinion, lies in the complexity of the generated molecules, which at this point is not clear whether it can lead to relevant practical applications or not. But overall, I am still leaning positive in the light of the gap in accuracy with respect to previous methods.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The paper focuses on a generative model for 3D molecules that generates full 3D molecular gemoetry, instead of generating a molecular graph and then generating the 3D molecular geometry conditional on the graph. The method using an autoregressive flow model, which has been applied to molecular graph generation but not full geometry. This enables some new applications such as molecular design to target a geometry-dependent objective function.\n ",
            "main_review": "\nOverall the paper does a good job of extending autoregressive flow models to support full 3D molecular geometry. The extension depends on a few relevant insights in how to best parameterize the problem and shows good overall results and improvements over prior methods. As this is not a commonly explored area and outside my expertise, it is hard to judge how significant the improvmeents in Table 2 and related results are, but from my limited understanding they seem sufficiently significant.\n\n\"These conditional generation methods assume that we are given the target molecules in the form of molecular graphs, but we do not know their 3D geometries. However, this assumption does not hold in the targeted molecule discovery problem.\" -- it seemed to me when I read this that it should still be possible to still do targeted molecule discovery, by first generating the molecular graph then generate 3D geometry from the graph  and applying the loss to the generated 3D geometry?\n\nSeveral times the option of \"is randomly chosen from the atoms whose classification scores are higher than 0.5\" is taken, but it's not really described how this operates when there are no classification scores higher than 0.5; and furthermore it seems like this type of classifier might make network training unstable around the threshold, so it would be good to discuss how sensitive training is to metaparameter choice.\n\nI found the ablations useful to demonstrate the different components, and I think molecular design is potentially an important area to focus on more.\n",
            "summary_of_the_review": "\nThe paper extends autoregressive flow models for 3D molecular generation to also generative 3D geometry. This helps with some challenging molecular discovery tasks, and a set of ablations and comparisons demonsrtate the effectiveness of the method.  The main concern is that it is somewhat incremental over the most similar prior work which does not generate 3D molecular geometry.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        },
        {
            "summary_of_the_paper": "The paper addresses the problem of generating 3D molecular geometries.\nThe proposed G-SphereNet takes SphereNet as the backbone to generate 3D molecular geometries from scratch.\nThe generation is done in a step-by-step fashion, with each step generating a (distance, angle, torsion) triplet, conditioning on features extracted by an attention mechanism.",
            "main_review": "In G-SphereNet, the authors propose to generate the new atoms using a triplet of (d, theta, phi), which can be seen as spherical coordinates in a local system defined by the focal atom. Such a design seems to simplify the generating process. But such representation has a known issue of Gimbal lock, i.e. when theta = 0, phi no longer affects the atom generation, which I assume happens a lot in the molecule generation process. Despite pairwise distances used in EDMNet/3DMolNet might now indicate a valid 3D point, it doesn't necessarily matter to the generating process as long as (1) there always be a deterministic solution; (2) the distances are SE(3) equivariant/invariant. Compared to G-SchNeet, it makes sense to only generate new atoms near the focal atom. The constraint might serve as a regularizer to generate consistent/meaningful molecules and better capture the dependency between atoms. Most of the benefits listed in section 3.3 remain unproven. In my opinion, regarding the representation of the relative atom position, the author should devise a way to validate the necessity and the benefits of this contribution.\n\nOne thing I am confused about is that in Table 3(b), the performance with SchNet backbone is lower than G-SchNet. Does it indicate that the other contributions are actually lowering the performance of G-SchNet?\n\nThe organization of the paper structure could be improved. For example, (1) shorten the paragraph that describes the issue of SE(3) invariant in the traditional autoregression flow model; (2) there are two paragraphs describing the focal atom selection (Sec 3.2 and Sec 3.4), which brings confusion about whether the two steps use different focal atoms.\n\nI am not sure if MMD can substitute the original RMSD metric. As the RMSD between the generated model and the relaxed model evaluates the accuracy of the generated model, while MMD between the generated model and the dataset ignores the molecule structures.\n\nThere are a few details not clear to me in the paper:\n(1) Sec 2.3, G-SchNet also uses a flexible sequential generation pipeline based on autoregressive flow models?\n(2) Sec 3.3, what if c and e are mutually closest points?\n\nSome typos:\nGaussian distribution N(0, I) --> N(0, 1)\nSec 3.5 last sentence: genration --> generation",
            "summary_of_the_review": "Overall, the paper builds largely based on the setting of G-SchNet. There are a few designs to improve the performance. However, the benefits of the designs are not thoroughly/fairly evaluated.",
            "correctness": "3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "5: marginally below the acceptance threshold",
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
        }
    ]
}